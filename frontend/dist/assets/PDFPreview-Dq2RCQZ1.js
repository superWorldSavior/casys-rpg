var Kn=Object.defineProperty;var gn=B=>{throw TypeError(B)};var Jn=(B,e,U)=>e in B?Kn(B,e,{enumerable:!0,configurable:!0,writable:!0,value:U}):B[e]=U;var Kt=(B,e,U)=>Jn(B,typeof e!="symbol"?e+"":e,U),Me=(B,e,U)=>e.has(B)||gn("Cannot "+U);var t=(B,e,U)=>(Me(B,e,"read from private field"),U?U.call(B):e.get(B)),rt=(B,e,U)=>e.has(B)?gn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(B):e.set(B,U),ot=(B,e,U,n)=>(Me(B,e,"write to private field"),n?n.call(B,U):e.set(B,U),U),Y=(B,e,U)=>(Me(B,e,"access private method"),U);var he=(B,e,U,n)=>({set _(d){ot(B,e,d,U)},get _(){return t(B,e,n)}});import{r as requireCreateSvgIcon,a as jsxs,j as jsx,F as Fragment}from"./index-CTdJZ5md.js";import{b as getAugmentedNamespace,g as getDefaultExportFromCjs,r as reactExports,c as React}from"./vendor-BBF-xwg4.js";import{d as default_1$2}from"./Close-jEuwfnBl.js";import{N as PropTypes,O as clsx,i as interopRequireDefaultExports,j as jsxRuntimeExports,b as Box,d as Typography,r as IconButton,e as Button,Q as DialogContent,R as Dialog}from"./mui-CG_8jc0N.js";function _mergeNamespaces(B,e){for(var U=0;U<e.length;U++){const n=e[U];if(typeof n!="string"&&!Array.isArray(n)){for(const d in n)if(d!=="default"&&!(d in B)){const V=Object.getOwnPropertyDescriptor(n,d);V&&Object.defineProperty(B,d,V.get?V:{enumerable:!0,get:()=>n[d]})}}}return Object.freeze(Object.defineProperty(B,Symbol.toStringTag,{value:"Module"}))}function commonjsRequire(B){throw new Error('Could not dynamically require "'+B+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,U){module.exports=e.pdfjsLib=U()})(globalThis,()=>(()=>{var __webpack_modules__=[,(B,e)=>{var qt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=w,e.bytesToString=ct,e.createValidAbsoluteUrl=et,e.getModificationDate=Tt,e.getUuid=It,e.getVerbosityLevel=$,e.info=K,e.isArrayBuffer=Z,e.isArrayEqual=Pt,e.isNodeJS=void 0,e.normalizeUnicode=kt,e.objectFromMap=_t,e.objectSize=mt,e.setVerbosityLevel=tt,e.shadow=S,e.string32=bt,e.stringToBytes=ft,e.stringToPDFString=pt,e.stringToUTF8String=Et,e.unreachable=it,e.utf8StringToString=At,e.warn=H;const U=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=U;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const d=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=d;const V=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=V;const W=1.35;e.LINE_FACTOR=W;const dt=.35;e.LINE_DESCENT_FACTOR=dt;const x=dt/W;e.BASELINE_FACTOR=x;const P={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=P;const p={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=p;const N="pdfjs_internal_editor_";e.AnnotationEditorPrefix=N;const I={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=I;const b={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=b;const m={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=m;const E={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=E;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=g;const u={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=u;const y={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=y;const M={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=M;const A={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=A;const a={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=a;const h={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=h;const o={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=o;const l={O:"PageOpen",C:"PageClose"};e.PageActionEventType=l;const c={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=c;const O={NONE:0,BINARY:1};e.CMapCompressionType=O;const r={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=r;const v={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=v;let C=c.WARNINGS;function tt(vt){Number.isInteger(vt)&&(C=vt)}function $(){return C}function K(vt){C>=c.INFOS&&console.log(`Info: ${vt}`)}function H(vt){C>=c.WARNINGS&&console.log(`Warning: ${vt}`)}function it(vt){throw new Error(vt)}function w(vt,at){vt||it(at)}function G(vt){switch(vt==null?void 0:vt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function et(vt,at=null,lt=null){if(!vt)return null;try{if(lt&&typeof vt=="string"){if(lt.addDefaultProtocol&&vt.startsWith("www.")){const zt=vt.match(/\./g);(zt==null?void 0:zt.length)>=2&&(vt=`http://${vt}`)}if(lt.tryConvertEncoding)try{vt=Et(vt)}catch{}}const Rt=at?new URL(vt,at):new URL(vt);if(G(Rt))return Rt}catch{}return null}function S(vt,at,lt,Rt=!1){return Object.defineProperty(vt,at,{value:lt,enumerable:!Rt,configurable:!0,writable:!1}),lt}const s=function(){function at(lt,Rt){this.constructor===at&&it("Cannot initialize BaseException."),this.message=lt,this.name=Rt}return at.prototype=new Error,at.constructor=at,at}();e.BaseException=s;class i extends s{constructor(at,lt){super(at,"PasswordException"),this.code=lt}}e.PasswordException=i;class f extends s{constructor(at,lt){super(at,"UnknownErrorException"),this.details=lt}}e.UnknownErrorException=f;class k extends s{constructor(at){super(at,"InvalidPDFException")}}e.InvalidPDFException=k;class F extends s{constructor(at){super(at,"MissingPDFException")}}e.MissingPDFException=F;class D extends s{constructor(at,lt){super(at,"UnexpectedResponseException"),this.status=lt}}e.UnexpectedResponseException=D;class q extends s{constructor(at){super(at,"FormatError")}}e.FormatError=q;class nt extends s{constructor(at){super(at,"AbortException")}}e.AbortException=nt;function ct(vt){(typeof vt!="object"||(vt==null?void 0:vt.length)===void 0)&&it("Invalid argument for bytesToString");const at=vt.length,lt=8192;if(at<lt)return String.fromCharCode.apply(null,vt);const Rt=[];for(let zt=0;zt<at;zt+=lt){const $t=Math.min(zt+lt,at),j=vt.subarray(zt,$t);Rt.push(String.fromCharCode.apply(null,j))}return Rt.join("")}function ft(vt){typeof vt!="string"&&it("Invalid argument for stringToBytes");const at=vt.length,lt=new Uint8Array(at);for(let Rt=0;Rt<at;++Rt)lt[Rt]=vt.charCodeAt(Rt)&255;return lt}function bt(vt){return String.fromCharCode(vt>>24&255,vt>>16&255,vt>>8&255,vt&255)}function mt(vt){return Object.keys(vt).length}function _t(vt){const at=Object.create(null);for(const[lt,Rt]of vt)at[lt]=Rt;return at}function J(){const vt=new Uint8Array(4);return vt[0]=1,new Uint32Array(vt.buffer,0,1)[0]===1}function Q(){try{return new Function(""),!0}catch{return!1}}class _{static get isLittleEndian(){return S(this,"isLittleEndian",J())}static get isEvalSupported(){return S(this,"isEvalSupported",Q())}static get isOffscreenCanvasSupported(){return S(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?S(this,"platform",{isWin:!1,isMac:!1}):S(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var at,lt;return S(this,"isCSSRoundSupported",(lt=(at=globalThis.CSS)==null?void 0:at.supports)==null?void 0:lt.call(at,"width: round(1.5px, 1px)"))}}e.FeatureTest=_;const L=[...Array(256).keys()].map(vt=>vt.toString(16).padStart(2,"0"));class X{static makeHexColor(at,lt,Rt){return`#${L[at]}${L[lt]}${L[Rt]}`}static scaleMinMax(at,lt){let Rt;at[0]?(at[0]<0&&(Rt=lt[0],lt[0]=lt[1],lt[1]=Rt),lt[0]*=at[0],lt[1]*=at[0],at[3]<0&&(Rt=lt[2],lt[2]=lt[3],lt[3]=Rt),lt[2]*=at[3],lt[3]*=at[3]):(Rt=lt[0],lt[0]=lt[2],lt[2]=Rt,Rt=lt[1],lt[1]=lt[3],lt[3]=Rt,at[1]<0&&(Rt=lt[2],lt[2]=lt[3],lt[3]=Rt),lt[2]*=at[1],lt[3]*=at[1],at[2]<0&&(Rt=lt[0],lt[0]=lt[1],lt[1]=Rt),lt[0]*=at[2],lt[1]*=at[2]),lt[0]+=at[4],lt[1]+=at[4],lt[2]+=at[5],lt[3]+=at[5]}static transform(at,lt){return[at[0]*lt[0]+at[2]*lt[1],at[1]*lt[0]+at[3]*lt[1],at[0]*lt[2]+at[2]*lt[3],at[1]*lt[2]+at[3]*lt[3],at[0]*lt[4]+at[2]*lt[5]+at[4],at[1]*lt[4]+at[3]*lt[5]+at[5]]}static applyTransform(at,lt){const Rt=at[0]*lt[0]+at[1]*lt[2]+lt[4],zt=at[0]*lt[1]+at[1]*lt[3]+lt[5];return[Rt,zt]}static applyInverseTransform(at,lt){const Rt=lt[0]*lt[3]-lt[1]*lt[2],zt=(at[0]*lt[3]-at[1]*lt[2]+lt[2]*lt[5]-lt[4]*lt[3])/Rt,$t=(-at[0]*lt[1]+at[1]*lt[0]+lt[4]*lt[1]-lt[5]*lt[0])/Rt;return[zt,$t]}static getAxialAlignedBoundingBox(at,lt){const Rt=this.applyTransform(at,lt),zt=this.applyTransform(at.slice(2,4),lt),$t=this.applyTransform([at[0],at[3]],lt),j=this.applyTransform([at[2],at[1]],lt);return[Math.min(Rt[0],zt[0],$t[0],j[0]),Math.min(Rt[1],zt[1],$t[1],j[1]),Math.max(Rt[0],zt[0],$t[0],j[0]),Math.max(Rt[1],zt[1],$t[1],j[1])]}static inverseTransform(at){const lt=at[0]*at[3]-at[1]*at[2];return[at[3]/lt,-at[1]/lt,-at[2]/lt,at[0]/lt,(at[2]*at[5]-at[4]*at[3])/lt,(at[4]*at[1]-at[5]*at[0])/lt]}static singularValueDecompose2dScale(at){const lt=[at[0],at[2],at[1],at[3]],Rt=at[0]*lt[0]+at[1]*lt[2],zt=at[0]*lt[1]+at[1]*lt[3],$t=at[2]*lt[0]+at[3]*lt[2],j=at[2]*lt[1]+at[3]*lt[3],gt=(Rt+j)/2,wt=Math.sqrt((Rt+j)**2-4*(Rt*j-$t*zt))/2,Dt=gt+wt||1,Nt=gt-wt||1;return[Math.sqrt(Dt),Math.sqrt(Nt)]}static normalizeRect(at){const lt=at.slice(0);return at[0]>at[2]&&(lt[0]=at[2],lt[2]=at[0]),at[1]>at[3]&&(lt[1]=at[3],lt[3]=at[1]),lt}static intersect(at,lt){const Rt=Math.max(Math.min(at[0],at[2]),Math.min(lt[0],lt[2])),zt=Math.min(Math.max(at[0],at[2]),Math.max(lt[0],lt[2]));if(Rt>zt)return null;const $t=Math.max(Math.min(at[1],at[3]),Math.min(lt[1],lt[3])),j=Math.min(Math.max(at[1],at[3]),Math.max(lt[1],lt[3]));return $t>j?null:[Rt,$t,zt,j]}static bezierBoundingBox(at,lt,Rt,zt,$t,j,gt,wt){const Dt=[],Nt=[[],[]];let Ct,R,T,z,ht,ut,yt,St;for(let Wt=0;Wt<2;++Wt){if(Wt===0?(R=6*at-12*Rt+6*$t,Ct=-3*at+9*Rt-9*$t+3*gt,T=3*Rt-3*at):(R=6*lt-12*zt+6*j,Ct=-3*lt+9*zt-9*j+3*wt,T=3*zt-3*lt),Math.abs(Ct)<1e-12){if(Math.abs(R)<1e-12)continue;z=-T/R,0<z&&z<1&&Dt.push(z);continue}yt=R*R-4*T*Ct,St=Math.sqrt(yt),!(yt<0)&&(ht=(-R+St)/(2*Ct),0<ht&&ht<1&&Dt.push(ht),ut=(-R-St)/(2*Ct),0<ut&&ut<1&&Dt.push(ut))}let Lt=Dt.length,Ft;const xt=Lt;for(;Lt--;)z=Dt[Lt],Ft=1-z,Nt[0][Lt]=Ft*Ft*Ft*at+3*Ft*Ft*z*Rt+3*Ft*z*z*$t+z*z*z*gt,Nt[1][Lt]=Ft*Ft*Ft*lt+3*Ft*Ft*z*zt+3*Ft*z*z*j+z*z*z*wt;return Nt[0][xt]=at,Nt[1][xt]=lt,Nt[0][xt+1]=gt,Nt[1][xt+1]=wt,Nt[0].length=Nt[1].length=xt+2,[Math.min(...Nt[0]),Math.min(...Nt[1]),Math.max(...Nt[0]),Math.max(...Nt[1])]}}e.Util=X;const st=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function pt(vt){if(vt[0]>="ï"){let lt;if(vt[0]==="þ"&&vt[1]==="ÿ"?lt="utf-16be":vt[0]==="ÿ"&&vt[1]==="þ"?lt="utf-16le":vt[0]==="ï"&&vt[1]==="»"&&vt[2]==="¿"&&(lt="utf-8"),lt)try{const Rt=new TextDecoder(lt,{fatal:!0}),zt=ft(vt);return Rt.decode(zt)}catch(Rt){H(`stringToPDFString: "${Rt}".`)}}const at=[];for(let lt=0,Rt=vt.length;lt<Rt;lt++){const zt=st[vt.charCodeAt(lt)];at.push(zt?String.fromCharCode(zt):vt.charAt(lt))}return at.join("")}function Et(vt){return decodeURIComponent(escape(vt))}function At(vt){return unescape(encodeURIComponent(vt))}function Z(vt){return typeof vt=="object"&&(vt==null?void 0:vt.byteLength)!==void 0}function Pt(vt,at){if(vt.length!==at.length)return!1;for(let lt=0,Rt=vt.length;lt<Rt;lt++)if(vt[lt]!==at[lt])return!1;return!0}function Tt(vt=new Date){return[vt.getUTCFullYear().toString(),(vt.getUTCMonth()+1).toString().padStart(2,"0"),vt.getUTCDate().toString().padStart(2,"0"),vt.getUTCHours().toString().padStart(2,"0"),vt.getUTCMinutes().toString().padStart(2,"0"),vt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){rt(this,qt,!1);this.promise=new Promise((at,lt)=>{this.resolve=Rt=>{ot(this,qt,!0),at(Rt)},this.reject=Rt=>{ot(this,qt,!0),lt(Rt)}})}get settled(){return t(this,qt)}}qt=new WeakMap,e.PromiseCapability=Ut;let Bt=null,Vt=null;function kt(vt){return Bt||(Bt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Vt=new Map([["ﬅ","ſt"]])),vt.replaceAll(Bt,(at,lt,Rt)=>lt?lt.normalize("NFKC"):Vt.get(Rt))}function It(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const vt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(vt);else for(let at=0;at<32;at++)vt[at]=Math.floor(Math.random()*255);return ct(vt)}const Ht="pdfjs_internal_id_";e.AnnotationPrefix=Ht},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var B,U,n,d,re,_e,dt,x,P,p,N,I,b,m,E,ye,u,y,De,A,a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(o){if(typeof o=="string"||o instanceof URL?o={url:o}:(0,_util.isArrayBuffer)(o)&&(o={data:o}),typeof o!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!o.url&&!o.data&&!o.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:c}=l,O=o.url?getUrlProp(o.url):null,r=o.data?getDataProp(o.data):null,v=o.httpHeaders||null,C=o.withCredentials===!0,tt=o.password??null,$=o.range instanceof PDFDataRangeTransport?o.range:null,K=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let H=o.worker instanceof PDFWorker?o.worker:null;const it=o.verbosity,w=typeof o.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(o.docBaseUrl)?o.docBaseUrl:null,G=typeof o.cMapUrl=="string"?o.cMapUrl:null,et=o.cMapPacked!==!1,S=o.CMapReaderFactory||DefaultCMapReaderFactory,s=typeof o.standardFontDataUrl=="string"?o.standardFontDataUrl:null,i=o.StandardFontDataFactory||DefaultStandardFontDataFactory,f=o.stopAtErrors!==!0,k=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,F=o.isEvalSupported!==!1,D=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!_util.isNodeJS,q=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,nt=typeof o.disableFontFace=="boolean"?o.disableFontFace:_util.isNodeJS,ct=o.fontExtraProperties===!0,ft=o.enableXfa===!0,bt=o.ownerDocument||globalThis.document,mt=o.disableRange===!0,_t=o.disableStream===!0,J=o.disableAutoFetch===!0,Q=o.pdfBug===!0,_=$?$.length:o.length??NaN,L=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!_util.isNodeJS&&!nt,X=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:S===_display_utils.DOMCMapReaderFactory&&i===_display_utils.DOMStandardFontDataFactory&&G&&s&&(0,_display_utils.isValidFetchUrl)(G,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(s,document.baseURI),st=o.canvasFactory||new DefaultCanvasFactory({ownerDocument:bt}),pt=o.filterFactory||new DefaultFilterFactory({docId:c,ownerDocument:bt}),Et=null;(0,_util.setVerbosityLevel)(it);const At={canvasFactory:st,filterFactory:pt};if(X||(At.cMapReaderFactory=new S({baseUrl:G,isCompressed:et}),At.standardFontDataFactory=new i({baseUrl:s})),!H){const Tt={verbosity:it,port:_worker_options.GlobalWorkerOptions.workerPort};H=Tt.port?PDFWorker.fromPort(Tt):new PDFWorker(Tt),l._worker=H}const Z={docId:c,apiVersion:"3.11.174",data:r,password:tt,disableAutoFetch:J,rangeChunkSize:K,length:_,docBaseUrl:w,enableXfa:ft,evaluatorOptions:{maxImageSize:k,disableFontFace:nt,ignoreErrors:f,isEvalSupported:F,isOffscreenCanvasSupported:D,canvasMaxAreaInBytes:q,fontExtraProperties:ct,useSystemFonts:L,cMapUrl:X?G:null,standardFontDataUrl:X?s:null}},Pt={ignoreErrors:f,isEvalSupported:F,disableFontFace:nt,fontExtraProperties:ct,enableXfa:ft,ownerDocument:bt,disableAutoFetch:J,pdfBug:Q,styleElement:Et};return H.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const Tt=_fetchDocument(H,Z),Ut=new Promise(function(Bt){let Vt;$?Vt=new _transport_stream.PDFDataTransportStream({length:_,initialData:$.initialData,progressiveDone:$.progressiveDone,contentDispositionFilename:$.contentDispositionFilename,disableRange:mt,disableStream:_t},$):r||(Vt=(It=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(It):(0,_display_utils.isValidFetchUrl)(It.url)?new _displayFetch_stream.PDFFetchStream(It):new _displayNetwork.PDFNetworkStream(It))({url:O,length:_,httpHeaders:v,withCredentials:C,rangeChunkSize:K,disableRange:mt,disableStream:_t})),Bt(Vt)});return Promise.all([Tt,Ut]).then(function([Bt,Vt]){if(l.destroyed)throw new Error("Loading aborted");const kt=new _message_handler.MessageHandler(c,Bt,H.port),It=new WorkerTransport(kt,l,Vt,Pt,At);l._transport=It,kt.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(o,l){if(o.destroyed)throw new Error("Worker was destroyed");const c=await o.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(o.destroyed)throw new Error("Worker was destroyed");return c}function getUrlProp(o){if(o instanceof URL)return o.href;try{return new URL(o,window.location).href}catch{if(_util.isNodeJS&&typeof o=="string")return o}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(o){if(_util.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return(0,_util.stringToBytes)(o);if(typeof o=="object"&&!isNaN(o==null?void 0:o.length)||(0,_util.isArrayBuffer)(o))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${he(e,B)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l,c,O;this.destroyed=!0;try{(l=this._worker)!=null&&l.port&&(this._worker._pendingDestroy=!0),await((c=this._transport)==null?void 0:c.destroy())}catch(r){throw(O=this._worker)!=null&&O.port&&delete this._worker._pendingDestroy,r}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};B=new WeakMap,rt(e,B,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,c,O=!1,r=null){this.length=l,this.initialData=c,this.progressiveDone=O,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,c){for(const O of this._rangeListeners)O(l,c)}onDataProgress(l,c){this._readyCapability.promise.then(()=>{for(const O of this._progressListeners)O(l,c)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const c of this._progressiveReadListeners)c(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,c){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,c){this._pdfInfo=l,this._transport=c,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(O=>{if(!O)return O;const r=[];for(const v in O)r.push(...O[v]);return r}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,c,O,r=!1){rt(this,d);rt(this,U,null);rt(this,n,!1);this._pageIndex=l,this._pageInfo=c,this._transport=O,this._stats=r?new _display_utils.StatTimer:null,this._pdfBug=r,this.commonObjs=O.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:c=this.rotate,offsetX:O=0,offsetY:r=0,dontFlip:v=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:c,offsetX:O,offsetY:r,dontFlip:v})}getAnnotations({intent:l="display"}={}){const c=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,c.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:c,intent:O="display",annotationMode:r=_util.AnnotationMode.ENABLE,transform:v=null,background:C=null,optionalContentConfigPromise:tt=null,annotationCanvasMap:$=null,pageColors:K=null,printAnnotationStorage:H=null}){var i,f;(i=this._stats)==null||i.time("Overall");const it=this._transport.getRenderingIntent(O,r,H);ot(this,n,!1),Y(this,d,_e).call(this),tt||(tt=this._transport.getOptionalContentConfig());let w=this._intentStates.get(it.cacheKey);w||(w=Object.create(null),this._intentStates.set(it.cacheKey,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const G=!!(it.renderingIntent&_util.RenderingIntentFlag.PRINT);w.displayReadyCapability||(w.displayReadyCapability=new _util.PromiseCapability,w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(f=this._stats)==null||f.time("Page Request"),this._pumpOperatorList(it));const et=k=>{var F,D;w.renderTasks.delete(S),(this._maybeCleanupAfterRender||G)&&ot(this,n,!0),Y(this,d,re).call(this,!G),k?(S.capability.reject(k),this._abortOperatorList({intentState:w,reason:k instanceof Error?k:new Error(k)})):S.capability.resolve(),(F=this._stats)==null||F.timeEnd("Rendering"),(D=this._stats)==null||D.timeEnd("Overall")},S=new InternalRenderTask({callback:et,params:{canvasContext:l,viewport:c,transform:v,background:C},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:$,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!G,pdfBug:this._pdfBug,pageColors:K});(w.renderTasks||(w.renderTasks=new Set)).add(S);const s=S.task;return Promise.all([w.displayReadyCapability.promise,tt]).then(([k,F])=>{var D;if(this.destroyed){et();return}(D=this._stats)==null||D.time("Rendering"),S.initializeGraphics({transparency:k,optionalContentConfig:F}),S.operatorListChanged()}).catch(et),s}getOperatorList({intent:l="display",annotationMode:c=_util.AnnotationMode.ENABLE,printAnnotationStorage:O=null}={}){var $;function r(){C.operatorList.lastChunk&&(C.opListReadCapability.resolve(C.operatorList),C.renderTasks.delete(tt))}const v=this._transport.getRenderingIntent(l,c,O,!0);let C=this._intentStates.get(v.cacheKey);C||(C=Object.create(null),this._intentStates.set(v.cacheKey,C));let tt;return C.opListReadCapability||(tt=Object.create(null),tt.operatorListChanged=r,C.opListReadCapability=new _util.PromiseCapability,(C.renderTasks||(C.renderTasks=new Set)).add(tt),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},($=this._stats)==null||$.time("Page Request"),this._pumpOperatorList(v)),C.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:c=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:c===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(O=>_xfa_text.XfaText.textContent(O));const c=this.streamTextContent(l);return new Promise(function(O,r){function v(){C.read().then(function({value:$,done:K}){if(K){O(tt);return}Object.assign(tt.styles,$.styles),tt.items.push(...$.items),v()},r)}const C=c.getReader(),tt={items:[],styles:Object.create(null)};v()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const c of this._intentStates.values())if(this._abortOperatorList({intentState:c,reason:new Error("Page was destroyed."),force:!0}),!c.opListReadCapability)for(const O of c.renderTasks)l.push(O.completed),O.cancel();return this.objs.clear(),ot(this,n,!1),Y(this,d,_e).call(this),Promise.all(l)}cleanup(l=!1){ot(this,n,!0);const c=Y(this,d,re).call(this,!1);return l&&c&&this._stats&&(this._stats=new _display_utils.StatTimer),c}_startRenderPage(l,c){var r,v;const O=this._intentStates.get(c);O&&((r=this._stats)==null||r.timeEnd("Page Request"),(v=O.displayReadyCapability)==null||v.resolve(l))}_renderPageChunk(l,c){for(let O=0,r=l.length;O<r;O++)c.operatorList.fnArray.push(l.fnArray[O]),c.operatorList.argsArray.push(l.argsArray[O]);c.operatorList.lastChunk=l.lastChunk,c.operatorList.separateAnnots=l.separateAnnots;for(const O of c.renderTasks)O.operatorListChanged();l.lastChunk&&Y(this,d,re).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:c,annotationStorageSerializable:O}){const{map:r,transfers:v}=O,tt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:c,annotationStorage:r},v).getReader(),$=this._intentStates.get(c);$.streamReader=tt;const K=()=>{tt.read().then(({value:H,done:it})=>{if(it){$.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(H,$),K())},H=>{if($.streamReader=null,!this._transport.destroyed){if($.operatorList){$.operatorList.lastChunk=!0;for(const it of $.renderTasks)it.operatorListChanged();Y(this,d,re).call(this,!0)}if($.displayReadyCapability)$.displayReadyCapability.reject(H);else if($.opListReadCapability)$.opListReadCapability.reject(H);else throw H}})};K()}_abortOperatorList({intentState:l,reason:c,force:O=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!O){if(l.renderTasks.size>0)return;if(c instanceof _display_utils.RenderingCancelledException){let r=RENDERING_CANCELLED_TIMEOUT;c.extraDelay>0&&c.extraDelay<1e3&&(r+=c.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:c,force:!0})},r);return}}if(l.streamReader.cancel(new _util.AbortException(c.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[r,v]of this._intentStates)if(v===l){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}U=new WeakMap,n=new WeakMap,d=new WeakSet,re=function(l=!1){if(Y(this,d,_e).call(this),!t(this,n)||this.destroyed)return!1;if(l)return ot(this,U,setTimeout(()=>{ot(this,U,null),Y(this,d,re).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:c,operatorList:O}of this._intentStates.values())if(c.size>0||!O.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ot(this,n,!1),!0},_e=function(){t(this,U)&&(clearTimeout(t(this,U)),ot(this,U,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){rt(this,dt,new Set);rt(this,x,Promise.resolve())}postMessage(l,c){const O={data:structuredClone(l,c?{transfer:c}:null)};t(this,x).then(()=>{for(const r of t(this,dt))r.call(this,O)})}addEventListener(l,c){t(this,dt).add(c)}removeEventListener(l,c){t(this,dt).delete(c)}terminate(){t(this,dt).clear()}}dt=new WeakMap,x=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const o=(P=document==null?void 0:document.currentScript)==null?void 0:P.src;o&&(PDFWorkerUtil.fallbackWorkerSrc=o.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,l){let c;try{if(c=new URL(o),!c.origin||c.origin==="null")return!1}catch{return!1}const O=new URL(l,c);return c.origin===O.origin},PDFWorkerUtil.createCDNWrapper=function(o){const l=`importScripts("${o}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class _PDFWorker{constructor({name:o=null,port:l=null,verbosity:c=(0,_util.getVerbosityLevel)()}={}){var O;if(this.name=o,this.destroyed=!1,this.verbosity=c,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){if((O=t(_PDFWorker,p))!=null&&O.has(l))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,p)||ot(_PDFWorker,p,new WeakMap)).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));const l=new Worker(o),c=new _message_handler.MessageHandler("main","worker",l),O=()=>{l.removeEventListener("error",r),c.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||O()};l.addEventListener("error",r),c.on("test",C=>{if(l.removeEventListener("error",r),this.destroyed){O();return}C?(this._messageHandler=c,this._port=l,this._webWorker=l,this._readyCapability.resolve(),c.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),c.destroy(),l.terminate())}),c.on("ready",C=>{if(l.removeEventListener("error",r),this.destroyed){O();return}try{v()}catch{this._setupFakeWorker()}});const v=()=>{const C=new Uint8Array;c.send("test",C,[C.buffer])};v();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const c=`fake${PDFWorkerUtil.fakeWorkerId++}`,O=new _message_handler.MessageHandler(c+"_worker",c,l);o.setup(O,l);const r=new _message_handler.MessageHandler(c,c+"_worker",l);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){var o;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(o=t(_PDFWorker,p))==null||o.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){var c;if(!(o!=null&&o.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const l=(c=t(this,p))==null?void 0:c.get(o.port);if(l){if(l._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return l}return new _PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var o;try{return((o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};p=new WeakMap,rt(_PDFWorker,p);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,c,O,r,v){rt(this,E);rt(this,N,new Map);rt(this,I,new Map);rt(this,b,new Map);rt(this,m,null);this.messageHandler=l,this.loadingTask=c,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this._params=r,this.canvasFactory=v.canvasFactory,this.filterFactory=v.filterFactory,this.cMapReaderFactory=v.cMapReaderFactory,this.standardFontDataFactory=v.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=O,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,c=_util.AnnotationMode.ENABLE,O=null,r=!1){let v=_util.RenderingIntentFlag.DISPLAY,C=_annotation_storage.SerializableEmpty;switch(l){case"any":v=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":v=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(c){case _util.AnnotationMode.DISABLE:v+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:v+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:v+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,C=(v&_util.RenderingIntentFlag.PRINT&&O instanceof _annotation_storage.PrintAnnotationStorage?O:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${c}`)}return r&&(v+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:v,cacheKey:`${v}_${C.hash}`,annotationStorageSerializable:C}}destroy(){var O;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(O=t(this,m))==null||O.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const r of t(this,I).values())l.push(r._destroy());t(this,I).clear(),t(this,b).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const c=this.messageHandler.sendWithPromise("Terminate",null);return l.push(c),Promise.all(l).then(()=>{var r;this.commonObjs.clear(),this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(),(r=this._networkStream)==null||r.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:c}=this;l.on("GetReader",(O,r)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=v=>{this._lastProgress={loaded:v.loaded,total:v.total}},r.onPull=()=>{this._fullReader.read().then(function({value:v,done:C}){if(C){r.close();return}(0,_util.assert)(v instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(v),1,[v])}).catch(v=>{r.error(v)})},r.onCancel=v=>{this._fullReader.cancel(v),r.ready.catch(C=>{if(!this.destroyed)throw C})}}),l.on("ReaderHeadersReady",O=>{const r=new _util.PromiseCapability,v=this._fullReader;return v.headersReady.then(()=>{var C;(!v.isStreamingSupported||!v.isRangeSupported)&&(this._lastProgress&&((C=c.onProgress)==null||C.call(c,this._lastProgress)),v.onProgress=tt=>{var $;($=c.onProgress)==null||$.call(c,{loaded:tt.loaded,total:tt.total})}),r.resolve({isStreamingSupported:v.isStreamingSupported,isRangeSupported:v.isRangeSupported,contentLength:v.contentLength})},r.reject),r.promise}),l.on("GetRangeReader",(O,r)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const v=this._networkStream.getRangeReader(O.begin,O.end);if(!v){r.close();return}r.onPull=()=>{v.read().then(function({value:C,done:tt}){if(tt){r.close();return}(0,_util.assert)(C instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(C),1,[C])}).catch(C=>{r.error(C)})},r.onCancel=C=>{v.cancel(C),r.ready.catch(tt=>{if(!this.destroyed)throw tt})}}),l.on("GetDoc",({pdfInfo:O})=>{this._numPages=O.numPages,this._htmlForXfa=O.htmlForXfa,delete O.htmlForXfa,c._capability.resolve(new PDFDocumentProxy(O,this))}),l.on("DocException",function(O){let r;switch(O.name){case"PasswordException":r=new _util.PasswordException(O.message,O.code);break;case"InvalidPDFException":r=new _util.InvalidPDFException(O.message);break;case"MissingPDFException":r=new _util.MissingPDFException(O.message);break;case"UnexpectedResponseException":r=new _util.UnexpectedResponseException(O.message,O.status);break;case"UnknownErrorException":r=new _util.UnknownErrorException(O.message,O.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}c._capability.reject(r)}),l.on("PasswordRequest",O=>{if(ot(this,m,new _util.PromiseCapability),c.onPassword){const r=v=>{v instanceof Error?t(this,m).reject(v):t(this,m).resolve({password:v})};try{c.onPassword(r,O.code)}catch(v){t(this,m).reject(v)}}else t(this,m).reject(new _util.PasswordException(O.message,O.code));return t(this,m).promise}),l.on("DataLoaded",O=>{var r;(r=c.onProgress)==null||r.call(c,{loaded:O.length,total:O.length}),this.downloadInfoCapability.resolve(O)}),l.on("StartRenderPage",O=>{if(this.destroyed)return;t(this,I).get(O.pageIndex)._startRenderPage(O.transparency,O.cacheKey)}),l.on("commonobj",([O,r,v])=>{var C;if(!this.destroyed&&!this.commonObjs.has(O))switch(r){case"Font":const tt=this._params;if("error"in v){const H=v.error;(0,_util.warn)(`Error during font loading: ${H}`),this.commonObjs.resolve(O,H);break}const $=tt.pdfBug&&((C=globalThis.FontInspector)!=null&&C.enabled)?(H,it)=>globalThis.FontInspector.fontAdded(H,it):null,K=new _font_loader.FontFaceObject(v,{isEvalSupported:tt.isEvalSupported,disableFontFace:tt.disableFontFace,ignoreErrors:tt.ignoreErrors,inspectFont:$});this.fontLoader.bind(K).catch(H=>l.sendWithPromise("FontFallback",{id:O})).finally(()=>{!tt.fontExtraProperties&&K.data&&(K.data=null),this.commonObjs.resolve(O,K)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(O,v);break;default:throw new Error(`Got unknown common object type ${r}`)}}),l.on("obj",([O,r,v,C])=>{var $;if(this.destroyed)return;const tt=t(this,I).get(r);if(!tt.objs.has(O))switch(v){case"Image":if(tt.objs.resolve(O,C),C){let K;if(C.bitmap){const{width:H,height:it}=C;K=H*it*4}else K=(($=C.data)==null?void 0:$.length)||0;K>_util.MAX_IMAGE_SIZE_TO_CACHE&&(tt._maybeCleanupAfterRender=!0)}break;case"Pattern":tt.objs.resolve(O,C);break;default:throw new Error(`Got unknown object type ${v}`)}}),l.on("DocProgress",O=>{var r;this.destroyed||(r=c.onProgress)==null||r.call(c,{loaded:O.loaded,total:O.total})}),l.on("FetchBuiltInCMap",O=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(O):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",O=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(O):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var O;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:l,transfers:c}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:l,filename:((O=this._fullReader)==null?void 0:O.filename)??null},c).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const c=l-1,O=t(this,b).get(c);if(O)return O;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:c}).then(v=>{if(this.destroyed)throw new Error("Transport destroyed");const C=new PDFPageProxy(c,v,this,this._params.pdfBug);return t(this,I).set(c,C),C});return t(this,b).set(c,r),r}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,c){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:c})}getFieldObjects(){return Y(this,E,ye).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,E,ye).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,E,ye).call(this,"GetDocJSActions")}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",c=t(this,N).get(l);if(c)return c;const O=this.messageHandler.sendWithPromise(l,null).then(r=>{var v,C;return{info:r[0],metadata:r[1]?new _metadata.Metadata(r[1]):null,contentDispositionFilename:((v=this._fullReader)==null?void 0:v.filename)??null,contentLength:((C=this._fullReader)==null?void 0:C.contentLength)??null}});return t(this,N).set(l,O),O}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const c of t(this,I).values())if(!c.cleanup())throw new Error(`startCleanup: Page ${c.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),t(this,N).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:c}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:c})}}N=new WeakMap,I=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakSet,ye=function(l,c=null){const O=t(this,N).get(l);if(O)return O;const r=this.messageHandler.sendWithPromise(l,c);return t(this,N).set(l,r),r};class PDFObjects{constructor(){rt(this,y);rt(this,u,Object.create(null))}get(l,c=null){if(c){const r=Y(this,y,De).call(this,l);return r.capability.promise.then(()=>c(r.data)),null}const O=t(this,u)[l];if(!(O!=null&&O.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return O.data}has(l){const c=t(this,u)[l];return(c==null?void 0:c.capability.settled)||!1}resolve(l,c=null){const O=Y(this,y,De).call(this,l);O.data=c,O.capability.resolve()}clear(){var l;for(const c in t(this,u)){const{data:O}=t(this,u)[c];(l=O==null?void 0:O.bitmap)==null||l.close()}ot(this,u,Object.create(null))}}u=new WeakMap,y=new WeakSet,De=function(l){var c;return(c=t(this,u))[l]||(c[l]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(l){rt(this,A,null);ot(this,A,l),this.onContinue=null}get promise(){return t(this,A).capability.promise}cancel(l=0){t(this,A).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=t(this,A).operatorList;if(!l)return!1;const{annotationCanvasMap:c}=t(this,A);return l.form||l.canvas&&(c==null?void 0:c.size)>0}}A=new WeakMap,exports.RenderTask=RenderTask;const h=class h{constructor({callback:l,params:c,objs:O,commonObjs:r,annotationCanvasMap:v,operatorList:C,pageIndex:tt,canvasFactory:$,filterFactory:K,useRequestAnimationFrame:H=!1,pdfBug:it=!1,pageColors:w=null}){this.callback=l,this.params=c,this.objs=O,this.commonObjs=r,this.annotationCanvasMap=v,this.operatorListIdx=null,this.operatorList=C,this._pageIndex=tt,this.canvasFactory=$,this.filterFactory=K,this._pdfBug=it,this.pageColors=w,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=H===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=c.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:c}){var tt,$;if(this.cancelled)return;if(this._canvas){if(t(h,a).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(h,a).add(this._canvas)}this._pdfBug&&((tt=globalThis.StepperManager)!=null&&tt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:O,viewport:r,transform:v,background:C}=this.params;this.gfx=new _canvas.CanvasGraphics(O,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:c},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:v,viewport:r,transparency:l,background:C}),this.operatorListIdx=0,this.graphicsReady=!0,($=this.graphicsReadyCallback)==null||$.call(this)}cancel(l=null,c=0){var O;this.running=!1,this.cancelled=!0,(O=this.gfx)==null||O.endDrawing(),t(h,a).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,c))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(h,a).delete(this._canvas),this.callback())))}};a=new WeakMap,rt(h,a,new WeakSet);let InternalRenderTask=h;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(B,e,U)=>{var P,p,N,mn,b;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=U(1),d=U(4),V=U(8);const W=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=W;class dt{constructor(){rt(this,N);rt(this,P,!1);rt(this,p,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(E,g){const u=t(this,p).get(E);return u===void 0?g:Object.assign(g,u)}getRawValue(E){return t(this,p).get(E)}remove(E){if(t(this,p).delete(E),t(this,p).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of t(this,p).values())if(g instanceof d.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(E,g){const u=t(this,p).get(E);let y=!1;if(u!==void 0)for(const[M,A]of Object.entries(g))u[M]!==A&&(y=!0,u[M]=A);else y=!0,t(this,p).set(E,g);y&&Y(this,N,mn).call(this),g instanceof d.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(E){return t(this,p).has(E)}getAll(){return t(this,p).size>0?(0,n.objectFromMap)(t(this,p)):null}setAll(E){for(const[g,u]of Object.entries(E))this.setValue(g,u)}get size(){return t(this,p).size}resetModified(){t(this,P)&&(ot(this,P,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new x(this)}get serializable(){if(t(this,p).size===0)return W;const E=new Map,g=new V.MurmurHash3_64,u=[],y=Object.create(null);let M=!1;for(const[A,a]of t(this,p)){const h=a instanceof d.AnnotationEditor?a.serialize(!1,y):a;h&&(E.set(A,h),g.update(`${A}:${JSON.stringify(h)}`),M||(M=!!h.bitmap))}if(M)for(const A of E.values())A.bitmap&&u.push(A.bitmap);return E.size>0?{map:E,hash:g.hexdigest(),transfers:u}:W}}P=new WeakMap,p=new WeakMap,N=new WeakSet,mn=function(){t(this,P)||(ot(this,P,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=dt;class x extends dt{constructor(g){super();rt(this,b);const{map:u,hash:y,transfers:M}=g.serializable,A=structuredClone(u,M?{transfer:M}:null);ot(this,b,{map:A,hash:y,transfers:M})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,b)}}b=new WeakMap,e.PrintAnnotationStorage=x},(B,e,U)=>{var x,P,p,N,I,b,m,E,g,u,y,M,A,a,h,Le,Ie,c,Oe,Ne,bn,_n,yn,Be,An;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=U(5),d=U(1),V=U(6);const H=class H{constructor(w){rt(this,h);rt(this,x,"");rt(this,P,!1);rt(this,p,null);rt(this,N,null);rt(this,I,null);rt(this,b,!1);rt(this,m,null);rt(this,E,this.focusin.bind(this));rt(this,g,this.focusout.bind(this));rt(this,u,!1);rt(this,y,!1);rt(this,M,!1);Kt(this,"_initialOptions",Object.create(null));Kt(this,"_uiManager",null);Kt(this,"_focusEventsAllowed",!0);Kt(this,"_l10nPromise",null);rt(this,A,!1);rt(this,a,H._zIndex++);this.constructor===H&&(0,d.unreachable)("Cannot initialize AnnotationEditor."),this.parent=w.parent,this.id=w.id,this.width=this.height=null,this.pageIndex=w.parent.pageIndex,this.name=w.name,this.div=null,this._uiManager=w.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=w.isCentered,this._structTreeParentId=null;const{rotation:G,rawDims:{pageWidth:et,pageHeight:S,pageX:s,pageY:i}}=this.parent.viewport;this.rotation=G,this.pageRotation=(360+G-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[et,S],this.pageTranslation=[s,i];const[f,k]=this.parentDimensions;this.x=w.x/f,this.y=w.y/k,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,d.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(w){const G=new dt({id:w.parent.getNextId(),parent:w.parent,uiManager:w._uiManager});G.annotationElementId=w.annotationElementId,G.deleted=!0,G._uiManager.addToAnnotationStorage(G)}static initialize(w,G=null){if(H._l10nPromise||(H._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(S=>[S,w.get(S)]))),G!=null&&G.strings)for(const S of G.strings)H._l10nPromise.set(S,w.get(S));if(H._borderLineWidth!==-1)return;const et=getComputedStyle(document.documentElement);H._borderLineWidth=parseFloat(et.getPropertyValue("--outline-width"))||0}static updateDefaultParams(w,G){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(w){return!1}static paste(w,G){(0,d.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,A)}set _isDraggable(w){var G;ot(this,A,w),(G=this.div)==null||G.classList.toggle("draggable",w)}center(){const[w,G]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*G/(w*2),this.y+=this.width*w/(G*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*G/(w*2),this.y-=this.width*w/(G*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(w){this._uiManager.addCommands(w)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,a)}setParent(w){w!==null&&(this.pageIndex=w.pageIndex,this.pageDimensions=w.pageDimensions),this.parent=w}focusin(w){this._focusEventsAllowed&&(t(this,u)?ot(this,u,!1):this.parent.setSelected(this))}focusout(w){var et;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const G=w.relatedTarget;G!=null&&G.closest(`#${this.id}`)||(w.preventDefault(),(et=this.parent)!=null&&et.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(w,G,et,S){const[s,i]=this.parentDimensions;[et,S]=this.screenToPageTranslation(et,S),this.x=(w+et)/s,this.y=(G+S)/i,this.fixAndSetPosition()}translate(w,G){Y(this,h,Le).call(this,this.parentDimensions,w,G)}translateInPage(w,G){Y(this,h,Le).call(this,this.pageDimensions,w,G),this.div.scrollIntoView({block:"nearest"})}drag(w,G){const[et,S]=this.parentDimensions;if(this.x+=w/et,this.y+=G/S,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:F,y:D}=this.div.getBoundingClientRect();this.parent.findNewParent(this,F,D)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:i}=this;const[f,k]=Y(this,h,Ie).call(this);s+=f,i+=k,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*i).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[w,G]=this.pageDimensions;let{x:et,y:S,width:s,height:i}=this;switch(s*=w,i*=G,et*=w,S*=G,this.rotation){case 0:et=Math.max(0,Math.min(w-s,et)),S=Math.max(0,Math.min(G-i,S));break;case 90:et=Math.max(0,Math.min(w-i,et)),S=Math.min(G,Math.max(s,S));break;case 180:et=Math.min(w,Math.max(s,et)),S=Math.min(G,Math.max(i,S));break;case 270:et=Math.min(w,Math.max(i,et)),S=Math.max(0,Math.min(G-s,S));break}this.x=et/=w,this.y=S/=G;const[f,k]=Y(this,h,Ie).call(this);et+=f,S+=k;const{style:F}=this.div;F.left=`${(100*et).toFixed(2)}%`,F.top=`${(100*S).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(w,G){var et;return Y(et=H,c,Oe).call(et,w,G,this.parentRotation)}pageTranslationToScreen(w,G){var et;return Y(et=H,c,Oe).call(et,w,G,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:w,pageDimensions:[G,et]}=this,S=G*w,s=et*w;return d.FeatureTest.isCSSRoundSupported?[Math.round(S),Math.round(s)]:[S,s]}setDims(w,G){var s;const[et,S]=this.parentDimensions;this.div.style.width=`${(100*w/et).toFixed(2)}%`,t(this,b)||(this.div.style.height=`${(100*G/S).toFixed(2)}%`),(s=t(this,p))==null||s.classList.toggle("small",w<H.SMALL_EDITOR_SIZE||G<H.SMALL_EDITOR_SIZE)}fixDims(){const{style:w}=this.div,{height:G,width:et}=w,S=et.endsWith("%"),s=!t(this,b)&&G.endsWith("%");if(S&&s)return;const[i,f]=this.parentDimensions;S||(w.width=`${(100*parseFloat(et)/i).toFixed(2)}%`),!t(this,b)&&!s&&(w.height=`${(100*parseFloat(G)/f).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,p))return;const w=ot(this,p,document.createElement("button"));w.className="altText";const G=await H._l10nPromise.get("editor_alt_text_button_label");w.textContent=G,w.setAttribute("aria-label",G),w.tabIndex="0",w.addEventListener("contextmenu",V.noContextMenu),w.addEventListener("pointerdown",et=>et.stopPropagation()),w.addEventListener("click",et=>{et.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),w.addEventListener("keydown",et=>{et.target===w&&et.key==="Enter"&&(et.preventDefault(),this._uiManager.editAltText(this))}),Y(this,h,Be).call(this),this.div.append(w),H.SMALL_EDITOR_SIZE||(H.SMALL_EDITOR_SIZE=Math.min(128,Math.round(w.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,x),decorative:t(this,P)}}set altTextData({altText:w,decorative:G}){t(this,x)===w&&t(this,P)===G||(ot(this,x,w),ot(this,P,G),Y(this,h,Be).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,E)),this.div.addEventListener("focusout",t(this,g));const[w,G]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*G/w).toFixed(2)}%`,this.div.style.maxHeight=`${(100*w/G).toFixed(2)}%`);const[et,S]=this.getInitialTranslation();return this.translate(et,S),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(w){const{isMac:G}=d.FeatureTest.platform;if(w.button!==0||w.ctrlKey&&G){w.preventDefault();return}ot(this,u,!0),Y(this,h,An).call(this,w)}moveInDOM(){var w;(w=this.parent)==null||w.moveEditorInDOM(this)}_setParentAndPosition(w,G,et){w.changeParent(this),this.x=G,this.y=et,this.fixAndSetPosition()}getRect(w,G){const et=this.parentScale,[S,s]=this.pageDimensions,[i,f]=this.pageTranslation,k=w/et,F=G/et,D=this.x*S,q=this.y*s,nt=this.width*S,ct=this.height*s;switch(this.rotation){case 0:return[D+k+i,s-q-F-ct+f,D+k+nt+i,s-q-F+f];case 90:return[D+F+i,s-q+k+f,D+F+ct+i,s-q+k+nt+f];case 180:return[D-k-nt+i,s-q+F+f,D-k+i,s-q+F+ct+f];case 270:return[D-F-ct+i,s-q-k-nt+f,D-F+i,s-q-k+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(w,G){const[et,S,s,i]=w,f=s-et,k=i-S;switch(this.rotation){case 0:return[et,G-i,f,k];case 90:return[et,G-S,k,f];case 180:return[s,G-S,f,k];case 270:return[s,G-i,k,f];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ot(this,M,!0)}disableEditMode(){ot(this,M,!1)}isInEditMode(){return t(this,M)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var w,G;(w=this.div)==null||w.addEventListener("focusin",t(this,E)),(G=this.div)==null||G.addEventListener("focusout",t(this,g))}serialize(w=!1,G=null){(0,d.unreachable)("An editor must be serializable")}static deserialize(w,G,et){const S=new this.prototype.constructor({parent:G,id:G.getNextId(),uiManager:et});S.rotation=w.rotation;const[s,i]=S.pageDimensions,[f,k,F,D]=S.getRectInCurrentCoords(w.rect,i);return S.x=f/s,S.y=k/i,S.width=F/s,S.height=D/i,S}remove(){var w;this.div.removeEventListener("focusin",t(this,E)),this.div.removeEventListener("focusout",t(this,g)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(w=t(this,p))==null||w.remove(),ot(this,p,null),ot(this,N,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,h,bn).call(this),t(this,m).classList.remove("hidden"))}select(){var w;this.makeResizable(),(w=this.div)==null||w.classList.add("selectedEditor")}unselect(){var w,G,et;(w=t(this,m))==null||w.classList.add("hidden"),(G=this.div)==null||G.classList.remove("selectedEditor"),(et=this.div)!=null&&et.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(w,G){}disableEditing(){t(this,p)&&(t(this,p).hidden=!0)}enableEditing(){t(this,p)&&(t(this,p).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,y)}set isEditing(w){ot(this,y,w),this.parent&&(w?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(w,G){ot(this,b,!0);const et=w/G,{style:S}=this.div;S.aspectRatio=et,S.height="auto"}static get MIN_SIZE(){return 16}};x=new WeakMap,P=new WeakMap,p=new WeakMap,N=new WeakMap,I=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,M=new WeakMap,A=new WeakMap,a=new WeakMap,h=new WeakSet,Le=function([w,G],et,S){[et,S]=this.screenToPageTranslation(et,S),this.x+=et/w,this.y+=S/G,this.fixAndSetPosition()},Ie=function(){const[w,G]=this.parentDimensions,{_borderLineWidth:et}=H,S=et/w,s=et/G;switch(this.rotation){case 90:return[-S,s];case 180:return[S,s];case 270:return[S,-s];default:return[-S,-s]}},c=new WeakSet,Oe=function(w,G,et){switch(et){case 90:return[G,-w];case 180:return[-w,-G];case 270:return[-G,w];default:return[w,G]}},Ne=function(w){switch(w){case 90:{const[G,et]=this.pageDimensions;return[0,-G/et,et/G,0]}case 180:return[-1,0,0,-1];case 270:{const[G,et]=this.pageDimensions;return[0,G/et,-et/G,0]}default:return[1,0,0,1]}},bn=function(){if(t(this,m))return;ot(this,m,document.createElement("div")),t(this,m).classList.add("resizers");const w=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||w.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const G of w){const et=document.createElement("div");t(this,m).append(et),et.classList.add("resizer",G),et.addEventListener("pointerdown",Y(this,h,_n).bind(this,G)),et.addEventListener("contextmenu",V.noContextMenu)}this.div.prepend(t(this,m))},_n=function(w,G){G.preventDefault();const{isMac:et}=d.FeatureTest.platform;if(G.button!==0||G.ctrlKey&&et)return;const S=Y(this,h,yn).bind(this,w),s=this._isDraggable;this._isDraggable=!1;const i={passive:!0,capture:!0};window.addEventListener("pointermove",S,i);const f=this.x,k=this.y,F=this.width,D=this.height,q=this.parent.div.style.cursor,nt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(G.target).cursor;const ct=()=>{this._isDraggable=s,window.removeEventListener("pointerup",ct),window.removeEventListener("blur",ct),window.removeEventListener("pointermove",S,i),this.parent.div.style.cursor=q,this.div.style.cursor=nt;const ft=this.x,bt=this.y,mt=this.width,_t=this.height;ft===f&&bt===k&&mt===F&&_t===D||this.addCommands({cmd:()=>{this.width=mt,this.height=_t,this.x=ft,this.y=bt;const[J,Q]=this.parentDimensions;this.setDims(J*mt,Q*_t),this.fixAndSetPosition()},undo:()=>{this.width=F,this.height=D,this.x=f,this.y=k;const[J,Q]=this.parentDimensions;this.setDims(J*F,Q*D),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ct),window.addEventListener("blur",ct)},yn=function(w,G){const[et,S]=this.parentDimensions,s=this.x,i=this.y,f=this.width,k=this.height,F=H.MIN_SIZE/et,D=H.MIN_SIZE/S,q=kt=>Math.round(kt*1e4)/1e4,nt=Y(this,h,Ne).call(this,this.rotation),ct=(kt,It)=>[nt[0]*kt+nt[2]*It,nt[1]*kt+nt[3]*It],ft=Y(this,h,Ne).call(this,360-this.rotation),bt=(kt,It)=>[ft[0]*kt+ft[2]*It,ft[1]*kt+ft[3]*It];let mt,_t,J=!1,Q=!1;switch(w){case"topLeft":J=!0,mt=(kt,It)=>[0,0],_t=(kt,It)=>[kt,It];break;case"topMiddle":mt=(kt,It)=>[kt/2,0],_t=(kt,It)=>[kt/2,It];break;case"topRight":J=!0,mt=(kt,It)=>[kt,0],_t=(kt,It)=>[0,It];break;case"middleRight":Q=!0,mt=(kt,It)=>[kt,It/2],_t=(kt,It)=>[0,It/2];break;case"bottomRight":J=!0,mt=(kt,It)=>[kt,It],_t=(kt,It)=>[0,0];break;case"bottomMiddle":mt=(kt,It)=>[kt/2,It],_t=(kt,It)=>[kt/2,0];break;case"bottomLeft":J=!0,mt=(kt,It)=>[0,It],_t=(kt,It)=>[kt,0];break;case"middleLeft":Q=!0,mt=(kt,It)=>[0,It/2],_t=(kt,It)=>[kt,It/2];break}const _=mt(f,k),L=_t(f,k);let X=ct(...L);const st=q(s+X[0]),pt=q(i+X[1]);let Et=1,At=1,[Z,Pt]=this.screenToPageTranslation(G.movementX,G.movementY);if([Z,Pt]=bt(Z/et,Pt/S),J){const kt=Math.hypot(f,k);Et=At=Math.max(Math.min(Math.hypot(L[0]-_[0]-Z,L[1]-_[1]-Pt)/kt,1/f,1/k),F/f,D/k)}else Q?Et=Math.max(F,Math.min(1,Math.abs(L[0]-_[0]-Z)))/f:At=Math.max(D,Math.min(1,Math.abs(L[1]-_[1]-Pt)))/k;const Tt=q(f*Et),Ut=q(k*At);X=ct(..._t(Tt,Ut));const Bt=st-X[0],Vt=pt-X[1];this.width=Tt,this.height=Ut,this.x=Bt,this.y=Vt,this.setDims(et*Tt,S*Ut),this.fixAndSetPosition()},Be=async function(){var et;const w=t(this,p);if(!w)return;if(!t(this,x)&&!t(this,P)){w.classList.remove("done"),(et=t(this,N))==null||et.remove();return}H._l10nPromise.get("editor_alt_text_edit_button_label").then(S=>{w.setAttribute("aria-label",S)});let G=t(this,N);if(!G){ot(this,N,G=document.createElement("span")),G.className="tooltip",G.setAttribute("role","tooltip");const S=G.id=`alt-text-tooltip-${this.id}`;w.setAttribute("aria-describedby",S);const s=100;w.addEventListener("mouseenter",()=>{ot(this,I,setTimeout(()=>{ot(this,I,null),t(this,N).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},s))}),w.addEventListener("mouseleave",()=>{var i;clearTimeout(t(this,I)),ot(this,I,null),(i=t(this,N))==null||i.classList.remove("show")})}w.classList.add("done"),G.innerText=t(this,P)?await H._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,x),G.parentNode||w.append(G)},An=function(w){if(!this._isDraggable)return;const G=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let et,S;G&&(et={passive:!0,capture:!0},S=i=>{const[f,k]=this.screenToPageTranslation(i.movementX,i.movementY);this._uiManager.dragSelectedEditors(f,k)},window.addEventListener("pointermove",S,et));const s=()=>{if(window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),G&&window.removeEventListener("pointermove",S,et),ot(this,u,!1),!this._uiManager.endDragSession()){const{isMac:i}=d.FeatureTest.platform;w.ctrlKey&&!i||w.shiftKey||w.metaKey&&i?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",s),window.addEventListener("blur",s)},rt(H,c),Kt(H,"_borderLineWidth",-1),Kt(H,"_colorManager",new n.ColorManager),Kt(H,"_zIndex",1),Kt(H,"SMALL_EDITOR_SIZE",0);let W=H;e.AnnotationEditor=W;class dt extends W{constructor(w){super(w),this.annotationElementId=w.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(B,e,U)=>{var b,m,E,g,u,je,A,a,h,o,l,vn,r,v,C,tt,$,K,H,it,w,G,et,S,s,i,f,k,F,D,q,nt,ct,ft,bt,mt,_t,J,Q,_,L,X,st,pt,Et,At,Z,En,Ue,We,Ae,He,Ge,Zt,de,Sn,Tn,$e,ue,Ve;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=V,e.opacityToHex=W;var n=U(1),d=U(6);function V($t,j,gt){for(const wt of gt)j.addEventListener(wt,$t[wt].bind($t))}function W($t){return Math.round(Math.min(255,Math.max(1,255*$t))).toString(16).padStart(2,"0")}class dt{constructor(){rt(this,b,0)}getId(){return`${n.AnnotationEditorPrefix}${he(this,b)._++}`}}b=new WeakMap;const M=class M{constructor(){rt(this,u);rt(this,m,(0,n.getUuid)());rt(this,E,0);rt(this,g,null)}static get _isSVGFittingCanvas(){const j='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',wt=new OffscreenCanvas(1,3).getContext("2d"),Dt=new Image;Dt.src=j;const Nt=Dt.decode().then(()=>(wt.drawImage(Dt,0,0,1,1,0,0,1,3),new Uint32Array(wt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",Nt)}async getFromFile(j){const{lastModified:gt,name:wt,size:Dt,type:Nt}=j;return Y(this,u,je).call(this,`${gt}_${wt}_${Dt}_${Nt}`,j)}async getFromUrl(j){return Y(this,u,je).call(this,j,j)}async getFromId(j){t(this,g)||ot(this,g,new Map);const gt=t(this,g).get(j);return gt?gt.bitmap?(gt.refCounter+=1,gt):gt.file?this.getFromFile(gt.file):this.getFromUrl(gt.url):null}getSvgUrl(j){const gt=t(this,g).get(j);return gt!=null&&gt.isSvg?gt.svgUrl:null}deleteId(j){t(this,g)||ot(this,g,new Map);const gt=t(this,g).get(j);gt&&(gt.refCounter-=1,gt.refCounter===0&&(gt.bitmap=null))}isValidId(j){return j.startsWith(`image_${t(this,m)}_`)}};m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakSet,je=async function(j,gt){t(this,g)||ot(this,g,new Map);let wt=t(this,g).get(j);if(wt===null)return null;if(wt!=null&&wt.bitmap)return wt.refCounter+=1,wt;try{wt||(wt={bitmap:null,id:`image_${t(this,m)}_${he(this,E)._++}`,refCounter:0,isSvg:!1});let Dt;if(typeof gt=="string"){wt.url=gt;const Nt=await fetch(gt);if(!Nt.ok)throw new Error(Nt.statusText);Dt=await Nt.blob()}else Dt=wt.file=gt;if(Dt.type==="image/svg+xml"){const Nt=M._isSVGFittingCanvas,Ct=new FileReader,R=new Image,T=new Promise((z,ht)=>{R.onload=()=>{wt.bitmap=R,wt.isSvg=!0,z()},Ct.onload=async()=>{const ut=wt.svgUrl=Ct.result;R.src=await Nt?`${ut}#svgView(preserveAspectRatio(none))`:ut},R.onerror=Ct.onerror=ht});Ct.readAsDataURL(Dt),await T}else wt.bitmap=await createImageBitmap(Dt);wt.refCounter=1}catch(Dt){console.error(Dt),wt=null}return t(this,g).set(j,wt),wt&&t(this,g).set(wt.id,wt),wt};let x=M;class P{constructor(j=128){rt(this,A,[]);rt(this,a,!1);rt(this,h);rt(this,o,-1);ot(this,h,j)}add({cmd:j,undo:gt,mustExec:wt,type:Dt=NaN,overwriteIfSameType:Nt=!1,keepUndo:Ct=!1}){if(wt&&j(),t(this,a))return;const R={cmd:j,undo:gt,type:Dt};if(t(this,o)===-1){t(this,A).length>0&&(t(this,A).length=0),ot(this,o,0),t(this,A).push(R);return}if(Nt&&t(this,A)[t(this,o)].type===Dt){Ct&&(R.undo=t(this,A)[t(this,o)].undo),t(this,A)[t(this,o)]=R;return}const T=t(this,o)+1;T===t(this,h)?t(this,A).splice(0,1):(ot(this,o,T),T<t(this,A).length&&t(this,A).splice(T)),t(this,A).push(R)}undo(){t(this,o)!==-1&&(ot(this,a,!0),t(this,A)[t(this,o)].undo(),ot(this,a,!1),ot(this,o,t(this,o)-1))}redo(){t(this,o)<t(this,A).length-1&&(ot(this,o,t(this,o)+1),ot(this,a,!0),t(this,A)[t(this,o)].cmd(),ot(this,a,!1))}hasSomethingToUndo(){return t(this,o)!==-1}hasSomethingToRedo(){return t(this,o)<t(this,A).length-1}destroy(){ot(this,A,null)}}A=new WeakMap,a=new WeakMap,h=new WeakMap,o=new WeakMap,e.CommandManager=P;class p{constructor(j){rt(this,l);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:gt}=n.FeatureTest.platform;for(const[wt,Dt,Nt={}]of j)for(const Ct of wt){const R=Ct.startsWith("mac+");gt&&R?(this.callbacks.set(Ct.slice(4),{callback:Dt,options:Nt}),this.allKeys.add(Ct.split("+").at(-1))):!gt&&!R&&(this.callbacks.set(Ct,{callback:Dt,options:Nt}),this.allKeys.add(Ct.split("+").at(-1)))}}exec(j,gt){if(!this.allKeys.has(gt.key))return;const wt=this.callbacks.get(Y(this,l,vn).call(this,gt));if(!wt)return;const{callback:Dt,options:{bubbles:Nt=!1,args:Ct=[],checker:R=null}}=wt;R&&!R(j,gt)||(Dt.bind(j,...Ct)(),Nt||(gt.stopPropagation(),gt.preventDefault()))}}l=new WeakSet,vn=function(j){j.altKey&&this.buffer.push("alt"),j.ctrlKey&&this.buffer.push("ctrl"),j.metaKey&&this.buffer.push("meta"),j.shiftKey&&this.buffer.push("shift"),this.buffer.push(j.key);const gt=this.buffer.join("+");return this.buffer.length=0,gt},e.KeyboardManager=p;const O=class O{get _colors(){const j=new Map([["CanvasText",null],["Canvas",null]]);return(0,d.getColorValues)(j),(0,n.shadow)(this,"_colors",j)}convert(j){const gt=(0,d.getRGB)(j);if(!window.matchMedia("(forced-colors: active)").matches)return gt;for(const[wt,Dt]of this._colors)if(Dt.every((Nt,Ct)=>Nt===gt[Ct]))return O._colorsMapping.get(wt);return gt}getHexCode(j){const gt=this._colors.get(j);return gt?n.Util.makeHexColor(...gt):j}};Kt(O,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let N=O;e.ColorManager=N;const zt=class zt{constructor(j,gt,wt,Dt,Nt,Ct){rt(this,Z);rt(this,r,null);rt(this,v,new Map);rt(this,C,new Map);rt(this,tt,null);rt(this,$,null);rt(this,K,new P);rt(this,H,0);rt(this,it,new Set);rt(this,w,null);rt(this,G,null);rt(this,et,new Set);rt(this,S,null);rt(this,s,new dt);rt(this,i,!1);rt(this,f,!1);rt(this,k,null);rt(this,F,n.AnnotationEditorType.NONE);rt(this,D,new Set);rt(this,q,null);rt(this,nt,this.blur.bind(this));rt(this,ct,this.focus.bind(this));rt(this,ft,this.copy.bind(this));rt(this,bt,this.cut.bind(this));rt(this,mt,this.paste.bind(this));rt(this,_t,this.keydown.bind(this));rt(this,J,this.onEditingAction.bind(this));rt(this,Q,this.onPageChanging.bind(this));rt(this,_,this.onScaleChanging.bind(this));rt(this,L,this.onRotationChanging.bind(this));rt(this,X,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});rt(this,st,[0,0]);rt(this,pt,null);rt(this,Et,null);rt(this,At,null);ot(this,Et,j),ot(this,At,gt),ot(this,tt,wt),this._eventBus=Dt,this._eventBus._on("editingaction",t(this,J)),this._eventBus._on("pagechanging",t(this,Q)),this._eventBus._on("scalechanging",t(this,_)),this._eventBus._on("rotationchanging",t(this,L)),ot(this,$,Nt.annotationStorage),ot(this,S,Nt.filterFactory),ot(this,q,Ct),this.viewParameters={realScale:d.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const j=zt.prototype,gt=Nt=>{const{activeElement:Ct}=document;return Ct&&t(Nt,Et).contains(Ct)&&Nt.hasSomethingToControl()},wt=this.TRANSLATE_SMALL,Dt=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new p([[["ctrl+a","mac+meta+a"],j.selectAll],[["ctrl+z","mac+meta+z"],j.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],j.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],j.delete],[["Escape","mac+Escape"],j.unselectAll],[["ArrowLeft","mac+ArrowLeft"],j.translateSelectedEditors,{args:[-wt,0],checker:gt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],j.translateSelectedEditors,{args:[-Dt,0],checker:gt}],[["ArrowRight","mac+ArrowRight"],j.translateSelectedEditors,{args:[wt,0],checker:gt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],j.translateSelectedEditors,{args:[Dt,0],checker:gt}],[["ArrowUp","mac+ArrowUp"],j.translateSelectedEditors,{args:[0,-wt],checker:gt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],j.translateSelectedEditors,{args:[0,-Dt],checker:gt}],[["ArrowDown","mac+ArrowDown"],j.translateSelectedEditors,{args:[0,wt],checker:gt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],j.translateSelectedEditors,{args:[0,Dt],checker:gt}]]))}destroy(){Y(this,Z,Ae).call(this),Y(this,Z,Ue).call(this),this._eventBus._off("editingaction",t(this,J)),this._eventBus._off("pagechanging",t(this,Q)),this._eventBus._off("scalechanging",t(this,_)),this._eventBus._off("rotationchanging",t(this,L));for(const j of t(this,C).values())j.destroy();t(this,C).clear(),t(this,v).clear(),t(this,et).clear(),ot(this,r,null),t(this,D).clear(),t(this,K).destroy(),t(this,tt).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,q)?t(this,S).addHCMFilter(t(this,q).foreground,t(this,q).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,Et)).direction)}editAltText(j){var gt;(gt=t(this,tt))==null||gt.editAltText(this,j)}onPageChanging({pageNumber:j}){ot(this,H,j-1)}focusMainContainer(){t(this,Et).focus()}findParent(j,gt){for(const wt of t(this,C).values()){const{x:Dt,y:Nt,width:Ct,height:R}=wt.div.getBoundingClientRect();if(j>=Dt&&j<=Dt+Ct&&gt>=Nt&&gt<=Nt+R)return wt}return null}disableUserSelect(j=!1){t(this,At).classList.toggle("noUserSelect",j)}addShouldRescale(j){t(this,et).add(j)}removeShouldRescale(j){t(this,et).delete(j)}onScaleChanging({scale:j}){this.commitOrRemove(),this.viewParameters.realScale=j*d.PixelsPerInch.PDF_TO_CSS_UNITS;for(const gt of t(this,et))gt.onScaleChanging()}onRotationChanging({pagesRotation:j}){this.commitOrRemove(),this.viewParameters.rotation=j}addToAnnotationStorage(j){!j.isEmpty()&&t(this,$)&&!t(this,$).has(j.id)&&t(this,$).setValue(j.id,j)}blur(){if(!this.hasSelection)return;const{activeElement:j}=document;for(const gt of t(this,D))if(gt.div.contains(j)){ot(this,k,[gt,j]),gt._focusEventsAllowed=!1;break}}focus(){if(!t(this,k))return;const[j,gt]=t(this,k);ot(this,k,null),gt.addEventListener("focusin",()=>{j._focusEventsAllowed=!0},{once:!0}),gt.focus()}addEditListeners(){Y(this,Z,We).call(this),Y(this,Z,He).call(this)}removeEditListeners(){Y(this,Z,Ae).call(this),Y(this,Z,Ge).call(this)}copy(j){var wt;if(j.preventDefault(),(wt=t(this,r))==null||wt.commitOrRemove(),!this.hasSelection)return;const gt=[];for(const Dt of t(this,D)){const Nt=Dt.serialize(!0);Nt&&gt.push(Nt)}gt.length!==0&&j.clipboardData.setData("application/pdfjs",JSON.stringify(gt))}cut(j){this.copy(j),this.delete()}paste(j){j.preventDefault();const{clipboardData:gt}=j;for(const Nt of gt.items)for(const Ct of t(this,G))if(Ct.isHandlingMimeForPasting(Nt.type)){Ct.paste(Nt,this.currentLayer);return}let wt=gt.getData("application/pdfjs");if(!wt)return;try{wt=JSON.parse(wt)}catch(Nt){(0,n.warn)(`paste: "${Nt.message}".`);return}if(!Array.isArray(wt))return;this.unselectAll();const Dt=this.currentLayer;try{const Nt=[];for(const T of wt){const z=Dt.deserialize(T);if(!z)return;Nt.push(z)}const Ct=()=>{for(const T of Nt)Y(this,Z,$e).call(this,T);Y(this,Z,Ve).call(this,Nt)},R=()=>{for(const T of Nt)T.remove()};this.addCommands({cmd:Ct,undo:R,mustExec:!0})}catch(Nt){(0,n.warn)(`paste: "${Nt.message}".`)}}keydown(j){var gt;(gt=this.getActive())!=null&&gt.shouldGetKeyboardEvents()||zt._keyboardManager.exec(this,j)}onEditingAction(j){["undo","redo","delete","selectAll"].includes(j.name)&&this[j.name]()}setEditingState(j){j?(Y(this,Z,En).call(this),Y(this,Z,We).call(this),Y(this,Z,He).call(this),Y(this,Z,Zt).call(this,{isEditing:t(this,F)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,Z,ue).call(this),hasSomethingToUndo:t(this,K).hasSomethingToUndo(),hasSomethingToRedo:t(this,K).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,Z,Ue).call(this),Y(this,Z,Ae).call(this),Y(this,Z,Ge).call(this),Y(this,Z,Zt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(j){if(!t(this,G)){ot(this,G,j);for(const gt of t(this,G))Y(this,Z,de).call(this,gt.defaultPropertiesToUpdate)}}getId(){return t(this,s).getId()}get currentLayer(){return t(this,C).get(t(this,H))}getLayer(j){return t(this,C).get(j)}get currentPageIndex(){return t(this,H)}addLayer(j){t(this,C).set(j.pageIndex,j),t(this,i)?j.enable():j.disable()}removeLayer(j){t(this,C).delete(j.pageIndex)}updateMode(j,gt=null){if(t(this,F)!==j){if(ot(this,F,j),j===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,Z,Tn).call(this);return}this.setEditingState(!0),Y(this,Z,Sn).call(this),this.unselectAll();for(const wt of t(this,C).values())wt.updateMode(j);if(gt){for(const wt of t(this,v).values())if(wt.annotationElementId===gt){this.setSelected(wt),wt.enterInEditMode();break}}}}updateToolbar(j){j!==t(this,F)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:j})}updateParams(j,gt){if(t(this,G)){if(j===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(j);return}for(const wt of t(this,D))wt.updateParams(j,gt);for(const wt of t(this,G))wt.updateDefaultParams(j,gt)}}enableWaiting(j=!1){if(t(this,f)!==j){ot(this,f,j);for(const gt of t(this,C).values())j?gt.disableClick():gt.enableClick(),gt.div.classList.toggle("waiting",j)}}getEditors(j){const gt=[];for(const wt of t(this,v).values())wt.pageIndex===j&&gt.push(wt);return gt}getEditor(j){return t(this,v).get(j)}addEditor(j){t(this,v).set(j.id,j)}removeEditor(j){var gt;t(this,v).delete(j.id),this.unselect(j),(!j.annotationElementId||!t(this,it).has(j.annotationElementId))&&((gt=t(this,$))==null||gt.remove(j.id))}addDeletedAnnotationElement(j){t(this,it).add(j.annotationElementId),j.deleted=!0}isDeletedAnnotationElement(j){return t(this,it).has(j)}removeDeletedAnnotationElement(j){t(this,it).delete(j.annotationElementId),j.deleted=!1}setActiveEditor(j){t(this,r)!==j&&(ot(this,r,j),j&&Y(this,Z,de).call(this,j.propertiesToUpdate))}toggleSelected(j){if(t(this,D).has(j)){t(this,D).delete(j),j.unselect(),Y(this,Z,Zt).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,D).add(j),j.select(),Y(this,Z,de).call(this,j.propertiesToUpdate),Y(this,Z,Zt).call(this,{hasSelectedEditor:!0})}setSelected(j){for(const gt of t(this,D))gt!==j&&gt.unselect();t(this,D).clear(),t(this,D).add(j),j.select(),Y(this,Z,de).call(this,j.propertiesToUpdate),Y(this,Z,Zt).call(this,{hasSelectedEditor:!0})}isSelected(j){return t(this,D).has(j)}unselect(j){j.unselect(),t(this,D).delete(j),Y(this,Z,Zt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,D).size!==0}undo(){t(this,K).undo(),Y(this,Z,Zt).call(this,{hasSomethingToUndo:t(this,K).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,Z,ue).call(this)})}redo(){t(this,K).redo(),Y(this,Z,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,K).hasSomethingToRedo(),isEmpty:Y(this,Z,ue).call(this)})}addCommands(j){t(this,K).add(j),Y(this,Z,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,Z,ue).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const j=[...t(this,D)],gt=()=>{for(const Dt of j)Dt.remove()},wt=()=>{for(const Dt of j)Y(this,Z,$e).call(this,Dt)};this.addCommands({cmd:gt,undo:wt,mustExec:!0})}commitOrRemove(){var j;(j=t(this,r))==null||j.commitOrRemove()}hasSomethingToControl(){return t(this,r)||this.hasSelection}selectAll(){for(const j of t(this,D))j.commit();Y(this,Z,Ve).call(this,t(this,v).values())}unselectAll(){if(t(this,r)){t(this,r).commitOrRemove();return}if(this.hasSelection){for(const j of t(this,D))j.unselect();t(this,D).clear(),Y(this,Z,Zt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(j,gt,wt=!1){if(wt||this.commitOrRemove(),!this.hasSelection)return;t(this,st)[0]+=j,t(this,st)[1]+=gt;const[Dt,Nt]=t(this,st),Ct=[...t(this,D)],R=1e3;t(this,pt)&&clearTimeout(t(this,pt)),ot(this,pt,setTimeout(()=>{ot(this,pt,null),t(this,st)[0]=t(this,st)[1]=0,this.addCommands({cmd:()=>{for(const T of Ct)t(this,v).has(T.id)&&T.translateInPage(Dt,Nt)},undo:()=>{for(const T of Ct)t(this,v).has(T.id)&&T.translateInPage(-Dt,-Nt)},mustExec:!1})},R));for(const T of Ct)T.translateInPage(j,gt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ot(this,w,new Map);for(const j of t(this,D))t(this,w).set(j,{savedX:j.x,savedY:j.y,savedPageIndex:j.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,w))return!1;this.disableUserSelect(!1);const j=t(this,w);ot(this,w,null);let gt=!1;for(const[{x:Dt,y:Nt,pageIndex:Ct},R]of j)R.newX=Dt,R.newY=Nt,R.newPageIndex=Ct,gt||(gt=Dt!==R.savedX||Nt!==R.savedY||Ct!==R.savedPageIndex);if(!gt)return!1;const wt=(Dt,Nt,Ct,R)=>{if(t(this,v).has(Dt.id)){const T=t(this,C).get(R);T?Dt._setParentAndPosition(T,Nt,Ct):(Dt.pageIndex=R,Dt.x=Nt,Dt.y=Ct)}};return this.addCommands({cmd:()=>{for(const[Dt,{newX:Nt,newY:Ct,newPageIndex:R}]of j)wt(Dt,Nt,Ct,R)},undo:()=>{for(const[Dt,{savedX:Nt,savedY:Ct,savedPageIndex:R}]of j)wt(Dt,Nt,Ct,R)},mustExec:!0}),!0}dragSelectedEditors(j,gt){if(t(this,w))for(const wt of t(this,w).keys())wt.drag(j,gt)}rebuild(j){if(j.parent===null){const gt=this.getLayer(j.pageIndex);gt?(gt.changeParent(j),gt.addOrRebuild(j)):(this.addEditor(j),this.addToAnnotationStorage(j),j.rebuild())}else j.parent.addOrRebuild(j)}isActive(j){return t(this,r)===j}getActive(){return t(this,r)}getMode(){return t(this,F)}get imageManager(){return(0,n.shadow)(this,"imageManager",new x)}};r=new WeakMap,v=new WeakMap,C=new WeakMap,tt=new WeakMap,$=new WeakMap,K=new WeakMap,H=new WeakMap,it=new WeakMap,w=new WeakMap,G=new WeakMap,et=new WeakMap,S=new WeakMap,s=new WeakMap,i=new WeakMap,f=new WeakMap,k=new WeakMap,F=new WeakMap,D=new WeakMap,q=new WeakMap,nt=new WeakMap,ct=new WeakMap,ft=new WeakMap,bt=new WeakMap,mt=new WeakMap,_t=new WeakMap,J=new WeakMap,Q=new WeakMap,_=new WeakMap,L=new WeakMap,X=new WeakMap,st=new WeakMap,pt=new WeakMap,Et=new WeakMap,At=new WeakMap,Z=new WeakSet,En=function(){window.addEventListener("focus",t(this,ct)),window.addEventListener("blur",t(this,nt))},Ue=function(){window.removeEventListener("focus",t(this,ct)),window.removeEventListener("blur",t(this,nt))},We=function(){window.addEventListener("keydown",t(this,_t),{capture:!0})},Ae=function(){window.removeEventListener("keydown",t(this,_t),{capture:!0})},He=function(){document.addEventListener("copy",t(this,ft)),document.addEventListener("cut",t(this,bt)),document.addEventListener("paste",t(this,mt))},Ge=function(){document.removeEventListener("copy",t(this,ft)),document.removeEventListener("cut",t(this,bt)),document.removeEventListener("paste",t(this,mt))},Zt=function(j){Object.entries(j).some(([wt,Dt])=>t(this,X)[wt]!==Dt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,X),j)})},de=function(j){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:j})},Sn=function(){if(!t(this,i)){ot(this,i,!0);for(const j of t(this,C).values())j.enable()}},Tn=function(){if(this.unselectAll(),t(this,i)){ot(this,i,!1);for(const j of t(this,C).values())j.disable()}},$e=function(j){const gt=t(this,C).get(j.pageIndex);gt?gt.addOrRebuild(j):this.addEditor(j)},ue=function(){if(t(this,v).size===0)return!0;if(t(this,v).size===1)for(const j of t(this,v).values())return j.isEmpty();return!1},Ve=function(j){t(this,D).clear();for(const gt of j)gt.isEmpty()||(t(this,D).add(gt),gt.select());Y(this,Z,Zt).call(this,{hasSelectedEditor:!0})},Kt(zt,"TRANSLATE_SMALL",1),Kt(zt,"TRANSLATE_BIG",10);let I=zt;e.AnnotationEditorUIManager=I},(B,e,U)=>{var H,it,w,G,et,S,s,i,f,k,F,D,ae,oe,ze,ve,Ee,fe,pe;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=o,e.getColorValues=v,e.getCurrentTransform=C,e.getCurrentTransformInverse=tt,e.getFilenameFromUrl=u,e.getPdfFilenameFromUrl=y,e.getRGB=r,e.getXfaPageViewport=O,e.isDataScheme=E,e.isPdfFile=g,e.isValidFetchUrl=A,e.loadScript=h,e.noContextMenu=a,e.setLayerDimensions=$;var n=U(7),d=U(1);const V="http://www.w3.org/2000/svg",K=class K{};Kt(K,"CSS",96),Kt(K,"PDF",72),Kt(K,"PDF_TO_CSS_UNITS",K.CSS/K.PDF);let W=K;e.PixelsPerInch=W;class dt extends n.BaseFilterFactory{constructor({docId:_,ownerDocument:L=globalThis.document}={}){super();rt(this,D);rt(this,H);rt(this,it);rt(this,w);rt(this,G);rt(this,et);rt(this,S);rt(this,s);rt(this,i);rt(this,f);rt(this,k);rt(this,F,0);ot(this,w,_),ot(this,G,L)}addFilter(_){if(!_)return"none";let L=t(this,D,ae).get(_);if(L)return L;let X,st,pt,Et;if(_.length===1){const Tt=_[0],Ut=new Array(256);for(let Bt=0;Bt<256;Bt++)Ut[Bt]=Tt[Bt]/255;Et=X=st=pt=Ut.join(",")}else{const[Tt,Ut,Bt]=_,Vt=new Array(256),kt=new Array(256),It=new Array(256);for(let Ht=0;Ht<256;Ht++)Vt[Ht]=Tt[Ht]/255,kt[Ht]=Ut[Ht]/255,It[Ht]=Bt[Ht]/255;X=Vt.join(","),st=kt.join(","),pt=It.join(","),Et=`${X}${st}${pt}`}if(L=t(this,D,ae).get(Et),L)return t(this,D,ae).set(_,L),L;const At=`g_${t(this,w)}_transfer_map_${he(this,F)._++}`,Z=`url(#${At})`;t(this,D,ae).set(_,Z),t(this,D,ae).set(Et,Z);const Pt=Y(this,D,ve).call(this,At);return Y(this,D,fe).call(this,X,st,pt,Pt),Z}addHCMFilter(_,L){var Ut;const X=`${_}-${L}`;if(t(this,S)===X)return t(this,s);if(ot(this,S,X),ot(this,s,"none"),(Ut=t(this,et))==null||Ut.remove(),!_||!L)return t(this,s);const st=Y(this,D,pe).call(this,_);_=d.Util.makeHexColor(...st);const pt=Y(this,D,pe).call(this,L);if(L=d.Util.makeHexColor(...pt),t(this,D,oe).style.color="",_==="#000000"&&L==="#ffffff"||_===L)return t(this,s);const Et=new Array(256);for(let Bt=0;Bt<=255;Bt++){const Vt=Bt/255;Et[Bt]=Vt<=.03928?Vt/12.92:((Vt+.055)/1.055)**2.4}const At=Et.join(","),Z=`g_${t(this,w)}_hcm_filter`,Pt=ot(this,i,Y(this,D,ve).call(this,Z));Y(this,D,fe).call(this,At,At,At,Pt),Y(this,D,ze).call(this,Pt);const Tt=(Bt,Vt)=>{const kt=st[Bt]/255,It=pt[Bt]/255,Ht=new Array(Vt+1);for(let qt=0;qt<=Vt;qt++)Ht[qt]=kt+qt/Vt*(It-kt);return Ht.join(",")};return Y(this,D,fe).call(this,Tt(0,5),Tt(1,5),Tt(2,5),Pt),ot(this,s,`url(#${Z})`),t(this,s)}addHighlightHCMFilter(_,L,X,st){var It;const pt=`${_}-${L}-${X}-${st}`;if(t(this,f)===pt)return t(this,k);if(ot(this,f,pt),ot(this,k,"none"),(It=t(this,i))==null||It.remove(),!_||!L)return t(this,k);const[Et,At]=[_,L].map(Y(this,D,pe).bind(this));let Z=Math.round(.2126*Et[0]+.7152*Et[1]+.0722*Et[2]),Pt=Math.round(.2126*At[0]+.7152*At[1]+.0722*At[2]),[Tt,Ut]=[X,st].map(Y(this,D,pe).bind(this));Pt<Z&&([Z,Pt,Tt,Ut]=[Pt,Z,Ut,Tt]),t(this,D,oe).style.color="";const Bt=(Ht,qt,vt)=>{const at=new Array(256),lt=(Pt-Z)/vt,Rt=Ht/255,zt=(qt-Ht)/(255*vt);let $t=0;for(let j=0;j<=vt;j++){const gt=Math.round(Z+j*lt),wt=Rt+j*zt;for(let Dt=$t;Dt<=gt;Dt++)at[Dt]=wt;$t=gt+1}for(let j=$t;j<256;j++)at[j]=at[$t-1];return at.join(",")},Vt=`g_${t(this,w)}_hcm_highlight_filter`,kt=ot(this,i,Y(this,D,ve).call(this,Vt));return Y(this,D,ze).call(this,kt),Y(this,D,fe).call(this,Bt(Tt[0],Ut[0],5),Bt(Tt[1],Ut[1],5),Bt(Tt[2],Ut[2],5),kt),ot(this,k,`url(#${Vt})`),t(this,k)}destroy(_=!1){_&&(t(this,s)||t(this,k))||(t(this,it)&&(t(this,it).parentNode.parentNode.remove(),ot(this,it,null)),t(this,H)&&(t(this,H).clear(),ot(this,H,null)),ot(this,F,0))}}H=new WeakMap,it=new WeakMap,w=new WeakMap,G=new WeakMap,et=new WeakMap,S=new WeakMap,s=new WeakMap,i=new WeakMap,f=new WeakMap,k=new WeakMap,F=new WeakMap,D=new WeakSet,ae=function(){return t(this,H)||ot(this,H,new Map)},oe=function(){if(!t(this,it)){const _=t(this,G).createElement("div"),{style:L}=_;L.visibility="hidden",L.contain="strict",L.width=L.height=0,L.position="absolute",L.top=L.left=0,L.zIndex=-1;const X=t(this,G).createElementNS(V,"svg");X.setAttribute("width",0),X.setAttribute("height",0),ot(this,it,t(this,G).createElementNS(V,"defs")),_.append(X),X.append(t(this,it)),t(this,G).body.append(_)}return t(this,it)},ze=function(_){const L=t(this,G).createElementNS(V,"feColorMatrix");L.setAttribute("type","matrix"),L.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),_.append(L)},ve=function(_){const L=t(this,G).createElementNS(V,"filter");return L.setAttribute("color-interpolation-filters","sRGB"),L.setAttribute("id",_),t(this,D,oe).append(L),L},Ee=function(_,L,X){const st=t(this,G).createElementNS(V,L);st.setAttribute("type","discrete"),st.setAttribute("tableValues",X),_.append(st)},fe=function(_,L,X,st){const pt=t(this,G).createElementNS(V,"feComponentTransfer");st.append(pt),Y(this,D,Ee).call(this,pt,"feFuncR",_),Y(this,D,Ee).call(this,pt,"feFuncG",L),Y(this,D,Ee).call(this,pt,"feFuncB",X)},pe=function(_){return t(this,D,oe).style.color=_,r(getComputedStyle(t(this,D,oe)).getPropertyValue("color"))},e.DOMFilterFactory=dt;class x extends n.BaseCanvasFactory{constructor({ownerDocument:Q=globalThis.document}={}){super(),this._document=Q}_createCanvas(Q,_){const L=this._document.createElement("canvas");return L.width=Q,L.height=_,L}}e.DOMCanvasFactory=x;async function P(J,Q=!1){if(A(J,document.baseURI)){const _=await fetch(J);if(!_.ok)throw new Error(_.statusText);return Q?new Uint8Array(await _.arrayBuffer()):(0,d.stringToBytes)(await _.text())}return new Promise((_,L)=>{const X=new XMLHttpRequest;X.open("GET",J,!0),Q&&(X.responseType="arraybuffer"),X.onreadystatechange=()=>{if(X.readyState===XMLHttpRequest.DONE){if(X.status===200||X.status===0){let st;if(Q&&X.response?st=new Uint8Array(X.response):!Q&&X.responseText&&(st=(0,d.stringToBytes)(X.responseText)),st){_(st);return}}L(new Error(X.statusText))}},X.send(null)})}class p extends n.BaseCMapReaderFactory{_fetchData(Q,_){return P(Q,this.isCompressed).then(L=>({cMapData:L,compressionType:_}))}}e.DOMCMapReaderFactory=p;class N extends n.BaseStandardFontDataFactory{_fetchData(Q){return P(Q,!0)}}e.DOMStandardFontDataFactory=N;class I extends n.BaseSVGFactory{_createSVG(Q){return document.createElementNS(V,Q)}}e.DOMSVGFactory=I;class b{constructor({viewBox:Q,scale:_,rotation:L,offsetX:X=0,offsetY:st=0,dontFlip:pt=!1}){this.viewBox=Q,this.scale=_,this.rotation=L,this.offsetX=X,this.offsetY=st;const Et=(Q[2]+Q[0])/2,At=(Q[3]+Q[1])/2;let Z,Pt,Tt,Ut;switch(L%=360,L<0&&(L+=360),L){case 180:Z=-1,Pt=0,Tt=0,Ut=1;break;case 90:Z=0,Pt=1,Tt=1,Ut=0;break;case 270:Z=0,Pt=-1,Tt=-1,Ut=0;break;case 0:Z=1,Pt=0,Tt=0,Ut=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}pt&&(Tt=-Tt,Ut=-Ut);let Bt,Vt,kt,It;Z===0?(Bt=Math.abs(At-Q[1])*_+X,Vt=Math.abs(Et-Q[0])*_+st,kt=(Q[3]-Q[1])*_,It=(Q[2]-Q[0])*_):(Bt=Math.abs(Et-Q[0])*_+X,Vt=Math.abs(At-Q[1])*_+st,kt=(Q[2]-Q[0])*_,It=(Q[3]-Q[1])*_),this.transform=[Z*_,Pt*_,Tt*_,Ut*_,Bt-Z*_*Et-Tt*_*At,Vt-Pt*_*Et-Ut*_*At],this.width=kt,this.height=It}get rawDims(){const{viewBox:Q}=this;return(0,d.shadow)(this,"rawDims",{pageWidth:Q[2]-Q[0],pageHeight:Q[3]-Q[1],pageX:Q[0],pageY:Q[1]})}clone({scale:Q=this.scale,rotation:_=this.rotation,offsetX:L=this.offsetX,offsetY:X=this.offsetY,dontFlip:st=!1}={}){return new b({viewBox:this.viewBox.slice(),scale:Q,rotation:_,offsetX:L,offsetY:X,dontFlip:st})}convertToViewportPoint(Q,_){return d.Util.applyTransform([Q,_],this.transform)}convertToViewportRectangle(Q){const _=d.Util.applyTransform([Q[0],Q[1]],this.transform),L=d.Util.applyTransform([Q[2],Q[3]],this.transform);return[_[0],_[1],L[0],L[1]]}convertToPdfPoint(Q,_){return d.Util.applyInverseTransform([Q,_],this.transform)}}e.PageViewport=b;class m extends d.BaseException{constructor(Q,_=0){super(Q,"RenderingCancelledException"),this.extraDelay=_}}e.RenderingCancelledException=m;function E(J){const Q=J.length;let _=0;for(;_<Q&&J[_].trim()==="";)_++;return J.substring(_,_+5).toLowerCase()==="data:"}function g(J){return typeof J=="string"&&/\.pdf$/i.test(J)}function u(J,Q=!1){return Q||([J]=J.split(/[#?]/,1)),J.substring(J.lastIndexOf("/")+1)}function y(J,Q="document.pdf"){if(typeof J!="string")return Q;if(E(J))return(0,d.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Q;const _=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,L=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,X=_.exec(J);let st=L.exec(X[1])||L.exec(X[2])||L.exec(X[3]);if(st&&(st=st[0],st.includes("%")))try{st=L.exec(decodeURIComponent(st))[0]}catch{}return st||Q}class M{constructor(){Kt(this,"started",Object.create(null));Kt(this,"times",[])}time(Q){Q in this.started&&(0,d.warn)(`Timer is already running for ${Q}`),this.started[Q]=Date.now()}timeEnd(Q){Q in this.started||(0,d.warn)(`Timer has not been started for ${Q}`),this.times.push({name:Q,start:this.started[Q],end:Date.now()}),delete this.started[Q]}toString(){const Q=[];let _=0;for(const{name:L}of this.times)_=Math.max(L.length,_);for(const{name:L,start:X,end:st}of this.times)Q.push(`${L.padEnd(_)} ${st-X}ms
`);return Q.join("")}}e.StatTimer=M;function A(J,Q){try{const{protocol:_}=Q?new URL(J,Q):new URL(J);return _==="http:"||_==="https:"}catch{return!1}}function a(J){J.preventDefault()}function h(J,Q=!1){return new Promise((_,L)=>{const X=document.createElement("script");X.src=J,X.onload=function(st){Q&&X.remove(),_(st)},X.onerror=function(){L(new Error(`Cannot load script at: ${X.src}`))},(document.head||document.documentElement).append(X)})}function o(J){console.log("Deprecated API usage: "+J)}let l;class c{static toDateObject(Q){if(!Q||typeof Q!="string")return null;l||(l=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const _=l.exec(Q);if(!_)return null;const L=parseInt(_[1],10);let X=parseInt(_[2],10);X=X>=1&&X<=12?X-1:0;let st=parseInt(_[3],10);st=st>=1&&st<=31?st:1;let pt=parseInt(_[4],10);pt=pt>=0&&pt<=23?pt:0;let Et=parseInt(_[5],10);Et=Et>=0&&Et<=59?Et:0;let At=parseInt(_[6],10);At=At>=0&&At<=59?At:0;const Z=_[7]||"Z";let Pt=parseInt(_[8],10);Pt=Pt>=0&&Pt<=23?Pt:0;let Tt=parseInt(_[9],10)||0;return Tt=Tt>=0&&Tt<=59?Tt:0,Z==="-"?(pt+=Pt,Et+=Tt):Z==="+"&&(pt-=Pt,Et-=Tt),new Date(Date.UTC(L,X,st,pt,Et,At))}}e.PDFDateString=c;function O(J,{scale:Q=1,rotation:_=0}){const{width:L,height:X}=J.attributes.style,st=[0,0,parseInt(L),parseInt(X)];return new b({viewBox:st,scale:Q,rotation:_})}function r(J){if(J.startsWith("#")){const Q=parseInt(J.slice(1),16);return[(Q&16711680)>>16,(Q&65280)>>8,Q&255]}return J.startsWith("rgb(")?J.slice(4,-1).split(",").map(Q=>parseInt(Q)):J.startsWith("rgba(")?J.slice(5,-1).split(",").map(Q=>parseInt(Q)).slice(0,3):((0,d.warn)(`Not a valid color format: "${J}"`),[0,0,0])}function v(J){const Q=document.createElement("span");Q.style.visibility="hidden",document.body.append(Q);for(const _ of J.keys()){Q.style.color=_;const L=window.getComputedStyle(Q).color;J.set(_,r(L))}Q.remove()}function C(J){const{a:Q,b:_,c:L,d:X,e:st,f:pt}=J.getTransform();return[Q,_,L,X,st,pt]}function tt(J){const{a:Q,b:_,c:L,d:X,e:st,f:pt}=J.getTransform().invertSelf();return[Q,_,L,X,st,pt]}function $(J,Q,_=!1,L=!0){if(Q instanceof b){const{pageWidth:X,pageHeight:st}=Q.rawDims,{style:pt}=J,Et=d.FeatureTest.isCSSRoundSupported,At=`var(--scale-factor) * ${X}px`,Z=`var(--scale-factor) * ${st}px`,Pt=Et?`round(${At}, 1px)`:`calc(${At})`,Tt=Et?`round(${Z}, 1px)`:`calc(${Z})`;!_||Q.rotation%180===0?(pt.width=Pt,pt.height=Tt):(pt.width=Tt,pt.height=Pt)}L&&J.setAttribute("data-main-rotation",Q.rotation)}},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=U(1);class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(p){return"none"}addHCMFilter(p,N){return"none"}addHighlightHCMFilter(p,N,I,b){return"none"}destroy(p=!1){}}e.BaseFilterFactory=d;class V{constructor(){this.constructor===V&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(p,N){if(p<=0||N<=0)throw new Error("Invalid canvas size");const I=this._createCanvas(p,N);return{canvas:I,context:I.getContext("2d")}}reset(p,N,I){if(!p.canvas)throw new Error("Canvas is not specified");if(N<=0||I<=0)throw new Error("Invalid canvas size");p.canvas.width=N,p.canvas.height=I}destroy(p){if(!p.canvas)throw new Error("Canvas is not specified");p.canvas.width=0,p.canvas.height=0,p.canvas=null,p.context=null}_createCanvas(p,N){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=V;class W{constructor({baseUrl:p=null,isCompressed:N=!0}){this.constructor===W&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=p,this.isCompressed=N}async fetch({name:p}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!p)throw new Error("CMap name must be specified.");const N=this.baseUrl+p+(this.isCompressed?".bcmap":""),I=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(N,I).catch(b=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${N}`)})}_fetchData(p,N){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=W;class dt{constructor({baseUrl:p=null}){this.constructor===dt&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=p}async fetch({filename:p}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!p)throw new Error("Font filename must be specified.");const N=`${this.baseUrl}${p}`;return this._fetchData(N).catch(I=>{throw new Error(`Unable to load font data at: ${N}`)})}_fetchData(p){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=dt;class x{constructor(){this.constructor===x&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(p,N,I=!1){if(p<=0||N<=0)throw new Error("Invalid SVG dimensions");const b=this._createSVG("svg:svg");return b.setAttribute("version","1.1"),I||(b.setAttribute("width",`${p}px`),b.setAttribute("height",`${N}px`)),b.setAttribute("preserveAspectRatio","none"),b.setAttribute("viewBox",`0 0 ${p} ${N}`),b}createElement(p){if(typeof p!="string")throw new Error("Invalid SVG element type");return this._createSVG(p)}_createSVG(p){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=x},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=U(1);const d=3285377520,V=4294901760,W=65535;class dt{constructor(P){this.h1=P?P&4294967295:d,this.h2=P?P&4294967295:d}update(P){let p,N;if(typeof P=="string"){p=new Uint8Array(P.length*2),N=0;for(let o=0,l=P.length;o<l;o++){const c=P.charCodeAt(o);c<=255?p[N++]=c:(p[N++]=c>>>8,p[N++]=c&255)}}else if((0,n.isArrayBuffer)(P))p=P.slice(),N=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const I=N>>2,b=N-I*4,m=new Uint32Array(p.buffer,0,I);let E=0,g=0,u=this.h1,y=this.h2;const M=3432918353,A=461845907,a=M&W,h=A&W;for(let o=0;o<I;o++)o&1?(E=m[o],E=E*M&V|E*a&W,E=E<<15|E>>>17,E=E*A&V|E*h&W,u^=E,u=u<<13|u>>>19,u=u*5+3864292196):(g=m[o],g=g*M&V|g*a&W,g=g<<15|g>>>17,g=g*A&V|g*h&W,y^=g,y=y<<13|y>>>19,y=y*5+3864292196);switch(E=0,b){case 3:E^=p[I*4+2]<<16;case 2:E^=p[I*4+1]<<8;case 1:E^=p[I*4],E=E*M&V|E*a&W,E=E<<15|E>>>17,E=E*A&V|E*h&W,I&1?u^=E:y^=E}this.h1=u,this.h2=y}hexdigest(){let P=this.h1,p=this.h2;return P^=p>>>1,P=P*3981806797&V|P*36045&W,p=p*4283543511&V|((p<<16|P>>>16)*2950163797&V)>>>16,P^=p>>>1,P=P*444984403&V|P*60499&W,p=p*3301882366&V|((p<<16|P>>>16)*3120437893&V)>>>16,P^=p>>>1,(P>>>0).toString(16).padStart(8,"0")+(p>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=dt},(B,e,U)=>{var W;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=U(1);class d{constructor({ownerDocument:x=globalThis.document,styleElement:P=null}){rt(this,W,new Set);this._document=x,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(x){this.nativeFontFaces.add(x),this._document.fonts.add(x)}removeNativeFontFace(x){this.nativeFontFaces.delete(x),this._document.fonts.delete(x)}insertRule(x){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const P=this.styleElement.sheet;P.insertRule(x,P.cssRules.length)}clear(){for(const x of this.nativeFontFaces)this._document.fonts.delete(x);this.nativeFontFaces.clear(),t(this,W).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(x){if(!(!x||t(this,W).has(x.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:P,src:p,style:N}=x,I=new FontFace(P,p,N);this.addNativeFontFace(I);try{await I.load(),t(this,W).add(P)}catch{(0,n.warn)(`Cannot load system font: ${x.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(I)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(x){if(x.attached||x.missingFile&&!x.systemFontInfo)return;if(x.attached=!0,x.systemFontInfo){await this.loadSystemFont(x.systemFontInfo);return}if(this.isFontLoadingAPISupported){const p=x.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(N){throw(0,n.warn)(`Failed to load font '${p.family}': '${N}'.`),x.disableFontFace=!0,N}}return}const P=x.createFontFaceRule();if(P){if(this.insertRule(P),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const N=this._queueLoadingCallback(p);this._prepareFontLoadEvent(x,N)})}}get isFontLoadingAPISupported(){var P;const x=!!((P=this._document)!=null&&P.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",x)}get isSyncFontLoadingSupported(){let x=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(x=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",x)}_queueLoadingCallback(x){function P(){for((0,n.assert)(!N.done,"completeRequest() cannot be called twice."),N.done=!0;p.length>0&&p[0].done;){const I=p.shift();setTimeout(I.callback,0)}}const{loadingRequests:p}=this,N={done:!1,complete:P,callback:x};return p.push(N),N}get _loadTestFont(){const x=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",x)}_prepareFontLoadEvent(x,P){function p(r,v){return r.charCodeAt(v)<<24|r.charCodeAt(v+1)<<16|r.charCodeAt(v+2)<<8|r.charCodeAt(v+3)&255}function N(r,v,C,tt){const $=r.substring(0,v),K=r.substring(v+C);return $+tt+K}let I,b;const m=this._document.createElement("canvas");m.width=1,m.height=1;const E=m.getContext("2d");let g=0;function u(r,v){if(++g>30){(0,n.warn)("Load test font never loaded."),v();return}if(E.font="30px "+r,E.fillText(".",0,20),E.getImageData(0,0,1,1).data[3]>0){v();return}setTimeout(u.bind(null,r,v))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let M=this._loadTestFont;M=N(M,976,y.length,y);const a=16,h=1482184792;let o=p(M,a);for(I=0,b=y.length-3;I<b;I+=4)o=o-h+p(y,I)|0;I<y.length&&(o=o-h+p(y+"XXX",I)|0),M=N(M,a,4,(0,n.string32)(o));const l=`url(data:font/opentype;base64,${btoa(M)});`,c=`@font-face {font-family:"${y}";src:${l}}`;this.insertRule(c);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const r of[x.loadedName,y]){const v=this._document.createElement("span");v.textContent="Hi",v.style.fontFamily=r,O.append(v)}this._document.body.append(O),u(y,()=>{O.remove(),P.complete()})}}W=new WeakMap,e.FontLoader=d;class V{constructor(x,{isEvalSupported:P=!0,disableFontFace:p=!1,ignoreErrors:N=!1,inspectFont:I=null}){this.compiledGlyphs=Object.create(null);for(const b in x)this[b]=x[b];this.isEvalSupported=P!==!1,this.disableFontFace=p===!0,this.ignoreErrors=N===!0,this._inspectFont=I}createNativeFontFace(){var P;if(!this.data||this.disableFontFace)return null;let x;if(!this.cssFontInfo)x=new FontFace(this.loadedName,this.data,{});else{const p={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(p.style=`oblique ${this.cssFontInfo.italicAngle}deg`),x=new FontFace(this.cssFontInfo.fontFamily,this.data,p)}return(P=this._inspectFont)==null||P.call(this,this),x}createFontFaceRule(){var N;if(!this.data||this.disableFontFace)return null;const x=(0,n.bytesToString)(this.data),P=`url(data:${this.mimetype};base64,${btoa(x)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${P}}`;else{let I=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(I+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${I}src:${P}}`}return(N=this._inspectFont)==null||N.call(this,this,P),p}getPathGenerator(x,P){if(this.compiledGlyphs[P]!==void 0)return this.compiledGlyphs[P];let p;try{p=x.get(this.loadedName+"_path_"+P)}catch(N){if(!this.ignoreErrors)throw N;return(0,n.warn)(`getPathGenerator - ignoring character: "${N}".`),this.compiledGlyphs[P]=function(I,b){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const N=[];for(const I of p){const b=I.args!==void 0?I.args.join(","):"";N.push("c.",I.cmd,"(",b,`);
`)}return this.compiledGlyphs[P]=new Function("c","size",N.join(""))}return this.compiledGlyphs[P]=function(N,I){for(const b of p)b.cmd==="scale"&&(b.args=[I,-I]),N[b.cmd].apply(N,b.args)}}}e.FontFaceObject=V},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=U(7);U(1);const d=function(P){return new Promise((p,N)=>{require$$5.readFile(P,(b,m)=>{if(b||!m){N(new Error(b));return}p(new Uint8Array(m))})})};class V extends n.BaseFilterFactory{}e.NodeFilterFactory=V;class W extends n.BaseCanvasFactory{_createCanvas(p,N){return require$$5.createCanvas(p,N)}}e.NodeCanvasFactory=W;class dt extends n.BaseCMapReaderFactory{_fetchData(p,N){return d(p).then(I=>({cMapData:I,compressionType:N}))}}e.NodeCMapReaderFactory=dt;class x extends n.BaseStandardFontDataFactory{_fetchData(p){return d(p)}}e.NodeStandardFontDataFactory=x},(B,e,U)=>{var it,qe,Xe;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=U(1),d=U(6),V=U(12),W=U(13);const dt=16,x=100,P=4096,p=15,N=10,I=1e3,b=16;function m(S,s){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){s.save(),this.__originalSave()},S.restore=function(){s.restore(),this.__originalRestore()},S.translate=function(f,k){s.translate(f,k),this.__originalTranslate(f,k)},S.scale=function(f,k){s.scale(f,k),this.__originalScale(f,k)},S.transform=function(f,k,F,D,q,nt){s.transform(f,k,F,D,q,nt),this.__originalTransform(f,k,F,D,q,nt)},S.setTransform=function(f,k,F,D,q,nt){s.setTransform(f,k,F,D,q,nt),this.__originalSetTransform(f,k,F,D,q,nt)},S.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},S.rotate=function(f){s.rotate(f),this.__originalRotate(f)},S.clip=function(f){s.clip(f),this.__originalClip(f)},S.moveTo=function(i,f){s.moveTo(i,f),this.__originalMoveTo(i,f)},S.lineTo=function(i,f){s.lineTo(i,f),this.__originalLineTo(i,f)},S.bezierCurveTo=function(i,f,k,F,D,q){s.bezierCurveTo(i,f,k,F,D,q),this.__originalBezierCurveTo(i,f,k,F,D,q)},S.rect=function(i,f,k,F){s.rect(i,f,k,F),this.__originalRect(i,f,k,F)},S.closePath=function(){s.closePath(),this.__originalClosePath()},S.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class E{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,i,f){let k;return this.cache[s]!==void 0?(k=this.cache[s],this.canvasFactory.reset(k,i,f)):(k=this.canvasFactory.create(i,f),this.cache[s]=k),k}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const i=this.cache[s];this.canvasFactory.destroy(i),delete this.cache[s]}}}function g(S,s,i,f,k,F,D,q,nt,ct){const[ft,bt,mt,_t,J,Q]=(0,d.getCurrentTransform)(S);if(bt===0&&mt===0){const X=D*ft+J,st=Math.round(X),pt=q*_t+Q,Et=Math.round(pt),At=(D+nt)*ft+J,Z=Math.abs(Math.round(At)-st)||1,Pt=(q+ct)*_t+Q,Tt=Math.abs(Math.round(Pt)-Et)||1;return S.setTransform(Math.sign(ft),0,0,Math.sign(_t),st,Et),S.drawImage(s,i,f,k,F,0,0,Z,Tt),S.setTransform(ft,bt,mt,_t,J,Q),[Z,Tt]}if(ft===0&&_t===0){const X=q*mt+J,st=Math.round(X),pt=D*bt+Q,Et=Math.round(pt),At=(q+ct)*mt+J,Z=Math.abs(Math.round(At)-st)||1,Pt=(D+nt)*bt+Q,Tt=Math.abs(Math.round(Pt)-Et)||1;return S.setTransform(0,Math.sign(bt),Math.sign(mt),0,st,Et),S.drawImage(s,i,f,k,F,0,0,Tt,Z),S.setTransform(ft,bt,mt,_t,J,Q),[Tt,Z]}S.drawImage(s,i,f,k,F,D,q,nt,ct);const _=Math.hypot(ft,bt),L=Math.hypot(mt,_t);return[_*nt,L*ct]}function u(S){const{width:s,height:i}=S;if(s>I||i>I)return null;const f=1e3,k=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),F=s+1;let D=new Uint8Array(F*(i+1)),q,nt,ct;const ft=s+7&-8;let bt=new Uint8Array(ft*i),mt=0;for(const L of S.data){let X=128;for(;X>0;)bt[mt++]=L&X?0:255,X>>=1}let _t=0;for(mt=0,bt[mt]!==0&&(D[0]=1,++_t),nt=1;nt<s;nt++)bt[mt]!==bt[mt+1]&&(D[nt]=bt[mt]?2:1,++_t),mt++;for(bt[mt]!==0&&(D[nt]=2,++_t),q=1;q<i;q++){mt=q*ft,ct=q*F,bt[mt-ft]!==bt[mt]&&(D[ct]=bt[mt]?1:8,++_t);let L=(bt[mt]?4:0)+(bt[mt-ft]?8:0);for(nt=1;nt<s;nt++)L=(L>>2)+(bt[mt+1]?4:0)+(bt[mt-ft+1]?8:0),k[L]&&(D[ct+nt]=k[L],++_t),mt++;if(bt[mt-ft]!==bt[mt]&&(D[ct+nt]=bt[mt]?2:4,++_t),_t>f)return null}for(mt=ft*(i-1),ct=q*F,bt[mt]!==0&&(D[ct]=8,++_t),nt=1;nt<s;nt++)bt[mt]!==bt[mt+1]&&(D[ct+nt]=bt[mt]?4:8,++_t),mt++;if(bt[mt]!==0&&(D[ct+nt]=4,++_t),_t>f)return null;const J=new Int32Array([0,F,-1,0,-F,0,0,0,1]),Q=new Path2D;for(q=0;_t&&q<=i;q++){let L=q*F;const X=L+s;for(;L<X&&!D[L];)L++;if(L===X)continue;Q.moveTo(L%F,q);const st=L;let pt=D[L];do{const Et=J[pt];do L+=Et;while(!D[L]);const At=D[L];At!==5&&At!==10?(pt=At,D[L]=0):(pt=At&51*pt>>4,D[L]&=pt>>2|pt<<2),Q.lineTo(L%F,L/F|0),D[L]||--_t}while(st!==L);--q}return bt=null,D=null,function(L){L.save(),L.scale(1/s,-1/i),L.translate(0,-i),L.fill(Q),L.beginPath(),L.restore()}}class y{constructor(s,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,i])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,i){this.x=s,this.y=i}updatePathMinMax(s,i,f){[i,f]=n.Util.applyTransform([i,f],s),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,f),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,f)}updateRectMinMax(s,i){const f=n.Util.applyTransform(i,s),k=n.Util.applyTransform(i.slice(2),s);this.minX=Math.min(this.minX,f[0],k[0]),this.minY=Math.min(this.minY,f[1],k[1]),this.maxX=Math.max(this.maxX,f[0],k[0]),this.maxY=Math.max(this.maxY,f[1],k[1])}updateScalingPathMinMax(s,i){n.Util.scaleMinMax(s,i),this.minX=Math.min(this.minX,i[0]),this.maxX=Math.max(this.maxX,i[1]),this.minY=Math.min(this.minY,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(s,i,f,k,F,D,q,nt,ct,ft){const bt=n.Util.bezierBoundingBox(i,f,k,F,D,q,nt,ct);if(ft){ft[0]=Math.min(ft[0],bt[0],bt[2]),ft[1]=Math.max(ft[1],bt[0],bt[2]),ft[2]=Math.min(ft[2],bt[1],bt[3]),ft[3]=Math.max(ft[3],bt[1],bt[3]);return}this.updateRectMinMax(s,bt)}getPathBoundingBox(s=V.PathType.FILL,i=null){const f=[this.minX,this.minY,this.maxX,this.maxY];if(s===V.PathType.STROKE){i||(0,n.unreachable)("Stroke bounding box must include transform.");const k=n.Util.singularValueDecompose2dScale(i),F=k[0]*this.lineWidth/2,D=k[1]*this.lineWidth/2;f[0]-=F,f[1]-=D,f[2]+=F,f[3]+=D}return f}updateClipFromPath(){const s=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=V.PathType.FILL,i=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(s,i))}}function M(S,s){if(typeof ImageData<"u"&&s instanceof ImageData){S.putImageData(s,0,0);return}const i=s.height,f=s.width,k=i%b,F=(i-k)/b,D=k===0?F:F+1,q=S.createImageData(f,b);let nt=0,ct;const ft=s.data,bt=q.data;let mt,_t,J,Q;if(s.kind===n.ImageKind.GRAYSCALE_1BPP){const _=ft.byteLength,L=new Uint32Array(bt.buffer,0,bt.byteLength>>2),X=L.length,st=f+7>>3,pt=4294967295,Et=n.FeatureTest.isLittleEndian?4278190080:255;for(mt=0;mt<D;mt++){for(J=mt<F?b:k,ct=0,_t=0;_t<J;_t++){const At=_-nt;let Z=0;const Pt=At>st?f:At*8-7,Tt=Pt&-8;let Ut=0,Bt=0;for(;Z<Tt;Z+=8)Bt=ft[nt++],L[ct++]=Bt&128?pt:Et,L[ct++]=Bt&64?pt:Et,L[ct++]=Bt&32?pt:Et,L[ct++]=Bt&16?pt:Et,L[ct++]=Bt&8?pt:Et,L[ct++]=Bt&4?pt:Et,L[ct++]=Bt&2?pt:Et,L[ct++]=Bt&1?pt:Et;for(;Z<Pt;Z++)Ut===0&&(Bt=ft[nt++],Ut=128),L[ct++]=Bt&Ut?pt:Et,Ut>>=1}for(;ct<X;)L[ct++]=0;S.putImageData(q,0,mt*b)}}else if(s.kind===n.ImageKind.RGBA_32BPP){for(_t=0,Q=f*b*4,mt=0;mt<F;mt++)bt.set(ft.subarray(nt,nt+Q)),nt+=Q,S.putImageData(q,0,_t),_t+=b;mt<D&&(Q=f*k*4,bt.set(ft.subarray(nt,nt+Q)),S.putImageData(q,0,_t))}else if(s.kind===n.ImageKind.RGB_24BPP)for(J=b,Q=f*J,mt=0;mt<D;mt++){for(mt>=F&&(J=k,Q=f*J),ct=0,_t=Q;_t--;)bt[ct++]=ft[nt++],bt[ct++]=ft[nt++],bt[ct++]=ft[nt++],bt[ct++]=255;S.putImageData(q,0,mt*b)}else throw new Error(`bad image kind: ${s.kind}`)}function A(S,s){if(s.bitmap){S.drawImage(s.bitmap,0,0);return}const i=s.height,f=s.width,k=i%b,F=(i-k)/b,D=k===0?F:F+1,q=S.createImageData(f,b);let nt=0;const ct=s.data,ft=q.data;for(let bt=0;bt<D;bt++){const mt=bt<F?b:k;({srcPos:nt}=(0,W.convertBlackAndWhiteToRGBA)({src:ct,srcPos:nt,dest:ft,width:f,height:mt,nonBlackColor:0})),S.putImageData(q,0,bt*b)}}function a(S,s){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const f of i)S[f]!==void 0&&(s[f]=S[f]);S.setLineDash!==void 0&&(s.setLineDash(S.getLineDash()),s.lineDashOffset=S.lineDashOffset)}function h(S){if(S.strokeStyle=S.fillStyle="#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0),!n.isNodeJS){const{filter:s}=S;s!=="none"&&s!==""&&(S.filter="none")}}function o(S,s,i,f){const k=S.length;for(let F=3;F<k;F+=4){const D=S[F];if(D===0)S[F-3]=s,S[F-2]=i,S[F-1]=f;else if(D<255){const q=255-D;S[F-3]=S[F-3]*D+s*q>>8,S[F-2]=S[F-2]*D+i*q>>8,S[F-1]=S[F-1]*D+f*q>>8}}}function l(S,s,i){const f=S.length,k=1/255;for(let F=3;F<f;F+=4){const D=i?i[S[F]]:S[F];s[F]=s[F]*D*k|0}}function c(S,s,i){const f=S.length;for(let k=3;k<f;k+=4){const F=S[k-3]*77+S[k-2]*152+S[k-1]*28;s[k]=i?s[k]*i[F>>8]>>8:s[k]*F>>16}}function O(S,s,i,f,k,F,D,q,nt,ct,ft){const bt=!!F,mt=bt?F[0]:0,_t=bt?F[1]:0,J=bt?F[2]:0,Q=k==="Luminosity"?c:l,L=Math.min(f,Math.ceil(1048576/i));for(let X=0;X<f;X+=L){const st=Math.min(L,f-X),pt=S.getImageData(q-ct,X+(nt-ft),i,st),Et=s.getImageData(q,X+nt,i,st);bt&&o(pt.data,mt,_t,J),Q(pt.data,Et.data,D),s.putImageData(Et,q,X+nt)}}function r(S,s,i,f){const k=f[0],F=f[1],D=f[2]-k,q=f[3]-F;D===0||q===0||(O(s.context,i,D,q,s.subtype,s.backdrop,s.transferMap,k,F,s.offsetX,s.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(i.canvas,0,0),S.restore())}function v(S,s){const i=n.Util.singularValueDecompose2dScale(S);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const f=Math.fround((globalThis.devicePixelRatio||1)*d.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:i[0]<=f||i[1]<=f}const C=["butt","round","square"],tt=["miter","round","bevel"],$={},K={},et=class et{constructor(s,i,f,k,F,{optionalContentConfig:D,markedContentStack:q=null},nt,ct){rt(this,it);this.ctx=s,this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=f,this.canvasFactory=k,this.filterFactory=F,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=q||[],this.optionalContentConfig=D,this.cachedCanvases=new E(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=nt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ct,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,i=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):i}beginDrawing({transform:s,viewport:i,transparency:f=!1,background:k=null}){const F=this.ctx.canvas.width,D=this.ctx.canvas.height,q=this.ctx.fillStyle;if(this.ctx.fillStyle=k||"#ffffff",this.ctx.fillRect(0,0,F,D),this.ctx.fillStyle=q,f){const nt=this.cachedCanvases.getCanvas("transparent",F,D);this.compositeCtx=this.ctx,this.transparentCanvas=nt.canvas,this.ctx=nt.context,this.ctx.save(),this.ctx.transform(...(0,d.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),h(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=(0,d.getCurrentTransform)(this.ctx)}executeOperatorList(s,i,f,k){const F=s.argsArray,D=s.fnArray;let q=i||0;const nt=F.length;if(nt===q)return q;const ct=nt-q>N&&typeof f=="function",ft=ct?Date.now()+p:0;let bt=0;const mt=this.commonObjs,_t=this.objs;let J;for(;;){if(k!==void 0&&q===k.nextBreakPoint)return k.breakIt(q,f),q;if(J=D[q],J!==n.OPS.dependency)this[J].apply(this,F[q]);else for(const Q of F[q]){const _=Q.startsWith("g_")?mt:_t;if(!_.has(Q))return _.get(Q,f),q}if(q++,q===nt)return q;if(ct&&++bt>N){if(Date.now()>ft)return f(),q;bt=0}}}endDrawing(){Y(this,it,qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const i of s.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);s.clear()}this._cachedBitmapsMap.clear(),Y(this,it,Xe).call(this)}_scaleImage(s,i){const f=s.width,k=s.height;let F=Math.max(Math.hypot(i[0],i[1]),1),D=Math.max(Math.hypot(i[2],i[3]),1),q=f,nt=k,ct="prescale1",ft,bt;for(;F>2&&q>1||D>2&&nt>1;){let mt=q,_t=nt;F>2&&q>1&&(mt=q>=16384?Math.floor(q/2)-1||1:Math.ceil(q/2),F/=q/mt),D>2&&nt>1&&(_t=nt>=16384?Math.floor(nt/2)-1||1:Math.ceil(nt)/2,D/=nt/_t),ft=this.cachedCanvases.getCanvas(ct,mt,_t),bt=ft.context,bt.clearRect(0,0,mt,_t),bt.drawImage(s,0,0,q,nt,0,0,mt,_t),s=ft.canvas,q=mt,nt=_t,ct=ct==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:q,paintHeight:nt}}_createMaskCanvas(s){const i=this.ctx,{width:f,height:k}=s,F=this.current.fillColor,D=this.current.patternFill,q=(0,d.getCurrentTransform)(i);let nt,ct,ft,bt;if((s.bitmap||s.data)&&s.count>1){const Z=s.bitmap||s.data.buffer;ct=JSON.stringify(D?q:[q.slice(0,4),F]),nt=this._cachedBitmapsMap.get(Z),nt||(nt=new Map,this._cachedBitmapsMap.set(Z,nt));const Pt=nt.get(ct);if(Pt&&!D){const Tt=Math.round(Math.min(q[0],q[2])+q[4]),Ut=Math.round(Math.min(q[1],q[3])+q[5]);return{canvas:Pt,offsetX:Tt,offsetY:Ut}}ft=Pt}ft||(bt=this.cachedCanvases.getCanvas("maskCanvas",f,k),A(bt.context,s));let mt=n.Util.transform(q,[1/f,0,0,-1/k,0,0]);mt=n.Util.transform(mt,[1,0,0,1,0,-k]);const _t=n.Util.applyTransform([0,0],mt),J=n.Util.applyTransform([f,k],mt),Q=n.Util.normalizeRect([_t[0],_t[1],J[0],J[1]]),_=Math.round(Q[2]-Q[0])||1,L=Math.round(Q[3]-Q[1])||1,X=this.cachedCanvases.getCanvas("fillCanvas",_,L),st=X.context,pt=Math.min(_t[0],J[0]),Et=Math.min(_t[1],J[1]);st.translate(-pt,-Et),st.transform(...mt),ft||(ft=this._scaleImage(bt.canvas,(0,d.getCurrentTransformInverse)(st)),ft=ft.img,nt&&D&&nt.set(ct,ft)),st.imageSmoothingEnabled=v((0,d.getCurrentTransform)(st),s.interpolate),g(st,ft,0,0,ft.width,ft.height,0,0,f,k),st.globalCompositeOperation="source-in";const At=n.Util.transform((0,d.getCurrentTransformInverse)(st),[1,0,0,1,-pt,-Et]);return st.fillStyle=D?F.getPattern(i,this,At,V.PathType.FILL):F,st.fillRect(0,0,f,k),nt&&!D&&(this.cachedCanvases.delete("fillCanvas"),nt.set(ct,X.canvas)),{canvas:X.canvas,offsetX:Math.round(pt),offsetY:Math.round(Et)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=C[s]}setLineJoin(s){this.ctx.lineJoin=tt[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,i){const f=this.ctx;f.setLineDash!==void 0&&(f.setLineDash(s),f.lineDashOffset=i)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[i,f]of s)switch(i){case"LW":this.setLineWidth(f);break;case"LC":this.setLineCap(f);break;case"LJ":this.setLineJoin(f);break;case"ML":this.setMiterLimit(f);break;case"D":this.setDash(f[0],f[1]);break;case"RI":this.setRenderingIntent(f);break;case"FL":this.setFlatness(f);break;case"Font":this.setFont(f[0],f[1]);break;case"CA":this.current.strokeAlpha=f;break;case"ca":this.current.fillAlpha=f,this.ctx.globalAlpha=f;break;case"BM":this.ctx.globalCompositeOperation=f;break;case"SMask":this.current.activeSMask=f?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(f);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,i=this.ctx.canvas.height,f="smaskGroupAt"+this.groupLevel,k=this.cachedCanvases.getCanvas(f,s,i);this.suspendedCtx=this.ctx,this.ctx=k.context;const F=this.ctx;F.setTransform(...(0,d.getCurrentTransform)(this.suspendedCtx)),a(this.suspendedCtx,F),m(F,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),a(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,f=this.suspendedCtx;r(f,i,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(a(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),a(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,i,f,k,F,D){this.ctx.transform(s,i,f,k,F,D),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,i,f){const k=this.ctx,F=this.current;let D=F.x,q=F.y,nt,ct;const ft=(0,d.getCurrentTransform)(k),bt=ft[0]===0&&ft[3]===0||ft[1]===0&&ft[2]===0,mt=bt?f.slice(0):null;for(let _t=0,J=0,Q=s.length;_t<Q;_t++)switch(s[_t]|0){case n.OPS.rectangle:D=i[J++],q=i[J++];const _=i[J++],L=i[J++],X=D+_,st=q+L;k.moveTo(D,q),_===0||L===0?k.lineTo(X,st):(k.lineTo(X,q),k.lineTo(X,st),k.lineTo(D,st)),bt||F.updateRectMinMax(ft,[D,q,X,st]),k.closePath();break;case n.OPS.moveTo:D=i[J++],q=i[J++],k.moveTo(D,q),bt||F.updatePathMinMax(ft,D,q);break;case n.OPS.lineTo:D=i[J++],q=i[J++],k.lineTo(D,q),bt||F.updatePathMinMax(ft,D,q);break;case n.OPS.curveTo:nt=D,ct=q,D=i[J+4],q=i[J+5],k.bezierCurveTo(i[J],i[J+1],i[J+2],i[J+3],D,q),F.updateCurvePathMinMax(ft,nt,ct,i[J],i[J+1],i[J+2],i[J+3],D,q,mt),J+=6;break;case n.OPS.curveTo2:nt=D,ct=q,k.bezierCurveTo(D,q,i[J],i[J+1],i[J+2],i[J+3]),F.updateCurvePathMinMax(ft,nt,ct,D,q,i[J],i[J+1],i[J+2],i[J+3],mt),D=i[J+2],q=i[J+3],J+=4;break;case n.OPS.curveTo3:nt=D,ct=q,D=i[J+2],q=i[J+3],k.bezierCurveTo(i[J],i[J+1],D,q,D,q),F.updateCurvePathMinMax(ft,nt,ct,i[J],i[J+1],D,q,D,q,mt),J+=4;break;case n.OPS.closePath:k.closePath();break}bt&&F.updateScalingPathMinMax(ft,mt),F.setCurrentPoint(D,q)}closePath(){this.ctx.closePath()}stroke(s=!0){const i=this.ctx,f=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof f=="object"&&(f!=null&&f.getPattern)?(i.save(),i.strokeStyle=f.getPattern(i,this,(0,d.getCurrentTransformInverse)(i),V.PathType.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const i=this.ctx,f=this.current.fillColor,k=this.current.patternFill;let F=!1;k&&(i.save(),i.fillStyle=f.getPattern(i,this,(0,d.getCurrentTransformInverse)(i),V.PathType.FILL),F=!0);const D=this.current.getClippedPathBoundingBox();this.contentVisible&&D!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),F&&i.restore(),s&&this.consumePath(D)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=$}eoClip(){this.pendingClip=K}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,i=this.ctx;if(s===void 0){i.beginPath();return}i.save(),i.beginPath();for(const f of s)i.setTransform(...f.transform),i.translate(f.x,f.y),f.addToPath(i,f.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,i){var ft;const f=this.commonObjs.get(s),k=this.current;if(!f)throw new Error(`Can't find font for ${s}`);if(k.fontMatrix=f.fontMatrix||n.FONT_IDENTITY_MATRIX,(k.fontMatrix[0]===0||k.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+s),i<0?(i=-i,k.fontDirection=-1):k.fontDirection=1,this.current.font=f,this.current.fontSize=i,f.isType3Font)return;const F=f.loadedName||"sans-serif",D=((ft=f.systemFontInfo)==null?void 0:ft.css)||`"${F}", ${f.fallbackName}`;let q="normal";f.black?q="900":f.bold&&(q="bold");const nt=f.italic?"italic":"normal";let ct=i;i<dt?ct=dt:i>x&&(ct=x),this.current.fontSizeScale=i/ct,this.ctx.font=`${nt} ${q} ${ct}px ${D}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,i){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=i}setLeadingMoveText(s,i){this.setLeading(-i),this.moveText(s,i)}setTextMatrix(s,i,f,k,F,D){this.current.textMatrix=[s,i,f,k,F,D],this.current.textMatrixScale=Math.hypot(s,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,i,f,k){const F=this.ctx,D=this.current,q=D.font,nt=D.textRenderingMode,ct=D.fontSize/D.fontSizeScale,ft=nt&n.TextRenderingMode.FILL_STROKE_MASK,bt=!!(nt&n.TextRenderingMode.ADD_TO_PATH_FLAG),mt=D.patternFill&&!q.missingFile;let _t;(q.disableFontFace||bt||mt)&&(_t=q.getPathGenerator(this.commonObjs,s)),q.disableFontFace||mt?(F.save(),F.translate(i,f),F.beginPath(),_t(F,ct),k&&F.setTransform(...k),(ft===n.TextRenderingMode.FILL||ft===n.TextRenderingMode.FILL_STROKE)&&F.fill(),(ft===n.TextRenderingMode.STROKE||ft===n.TextRenderingMode.FILL_STROKE)&&F.stroke(),F.restore()):((ft===n.TextRenderingMode.FILL||ft===n.TextRenderingMode.FILL_STROKE)&&F.fillText(s,i,f),(ft===n.TextRenderingMode.STROKE||ft===n.TextRenderingMode.FILL_STROKE)&&F.strokeText(s,i,f)),bt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,d.getCurrentTransform)(F),x:i,y:f,fontSize:ct,addToPath:_t})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const i=s.getImageData(0,0,10,10).data;let f=!1;for(let k=3;k<i.length;k+=4)if(i[k]>0&&i[k]<255){f=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",f)}showText(s){const i=this.current,f=i.font;if(f.isType3Font)return this.showType3Text(s);const k=i.fontSize;if(k===0)return;const F=this.ctx,D=i.fontSizeScale,q=i.charSpacing,nt=i.wordSpacing,ct=i.fontDirection,ft=i.textHScale*ct,bt=s.length,mt=f.vertical,_t=mt?1:-1,J=f.defaultVMetrics,Q=k*i.fontMatrix[0],_=i.textRenderingMode===n.TextRenderingMode.FILL&&!f.disableFontFace&&!i.patternFill;F.save(),F.transform(...i.textMatrix),F.translate(i.x,i.y+i.textRise),ct>0?F.scale(ft,-1):F.scale(ft,1);let L;if(i.patternFill){F.save();const At=i.fillColor.getPattern(F,this,(0,d.getCurrentTransformInverse)(F),V.PathType.FILL);L=(0,d.getCurrentTransform)(F),F.restore(),F.fillStyle=At}let X=i.lineWidth;const st=i.textMatrixScale;if(st===0||X===0){const At=i.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(At===n.TextRenderingMode.STROKE||At===n.TextRenderingMode.FILL_STROKE)&&(X=this.getSinglePixelWidth())}else X/=st;if(D!==1&&(F.scale(D,D),X/=D),F.lineWidth=X,f.isInvalidPDFjsFont){const At=[];let Z=0;for(const Pt of s)At.push(Pt.unicode),Z+=Pt.width;F.fillText(At.join(""),0,0),i.x+=Z*Q*ft,F.restore(),this.compose();return}let pt=0,Et;for(Et=0;Et<bt;++Et){const At=s[Et];if(typeof At=="number"){pt+=_t*At*k/1e3;continue}let Z=!1;const Pt=(At.isSpace?nt:0)+q,Tt=At.fontChar,Ut=At.accent;let Bt,Vt,kt=At.width;if(mt){const Ht=At.vmetric||J,qt=-(At.vmetric?Ht[1]:kt*.5)*Q,vt=Ht[2]*Q;kt=Ht?-Ht[0]:kt,Bt=qt/D,Vt=(pt+vt)/D}else Bt=pt/D,Vt=0;if(f.remeasure&&kt>0){const Ht=F.measureText(Tt).width*1e3/k*D;if(kt<Ht&&this.isFontSubpixelAAEnabled){const qt=kt/Ht;Z=!0,F.save(),F.scale(qt,1),Bt/=qt}else kt!==Ht&&(Bt+=(kt-Ht)/2e3*k/D)}if(this.contentVisible&&(At.isInFont||f.missingFile)){if(_&&!Ut)F.fillText(Tt,Bt,Vt);else if(this.paintChar(Tt,Bt,Vt,L),Ut){const Ht=Bt+k*Ut.offset.x/D,qt=Vt-k*Ut.offset.y/D;this.paintChar(Ut.fontChar,Ht,qt,L)}}const It=mt?kt*Q-Pt*ct:kt*Q+Pt*ct;pt+=It,Z&&F.restore()}mt?i.y-=pt:i.x+=pt*ft,F.restore(),this.compose()}showType3Text(s){const i=this.ctx,f=this.current,k=f.font,F=f.fontSize,D=f.fontDirection,q=k.vertical?1:-1,nt=f.charSpacing,ct=f.wordSpacing,ft=f.textHScale*D,bt=f.fontMatrix||n.FONT_IDENTITY_MATRIX,mt=s.length,_t=f.textRenderingMode===n.TextRenderingMode.INVISIBLE;let J,Q,_,L;if(!(_t||F===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...f.textMatrix),i.translate(f.x,f.y),i.scale(ft,D),J=0;J<mt;++J){if(Q=s[J],typeof Q=="number"){L=q*Q*F/1e3,this.ctx.translate(L,0),f.x+=L*ft;continue}const X=(Q.isSpace?ct:0)+nt,st=k.charProcOperatorList[Q.operatorListId];if(!st){(0,n.warn)(`Type3 character "${Q.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Q,this.save(),i.scale(F,F),i.transform(...bt),this.executeOperatorList(st),this.restore()),_=n.Util.applyTransform([Q.width,0],bt)[0]*F+X,i.translate(_,0),f.x+=_*ft}i.restore(),this.processingType3=null}}setCharWidth(s,i){}setCharWidthAndBounds(s,i,f,k,F,D){this.ctx.rect(f,k,F-f,D-k),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let i;if(s[0]==="TilingPattern"){const f=s[1],k=this.baseTransform||(0,d.getCurrentTransform)(this.ctx),F={createCanvasGraphics:D=>new et(D,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new V.TilingPattern(s,f,this.ctx,F,k)}else i=this._getPattern(s[1],s[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,i,f){const k=n.Util.makeHexColor(s,i,f);this.ctx.strokeStyle=k,this.current.strokeColor=k}setFillRGBColor(s,i,f){const k=n.Util.makeHexColor(s,i,f);this.ctx.fillStyle=k,this.current.fillColor=k,this.current.patternFill=!1}_getPattern(s,i=null){let f;return this.cachedPatterns.has(s)?f=this.cachedPatterns.get(s):(f=(0,V.getShadingPattern)(this.getObject(s)),this.cachedPatterns.set(s,f)),i&&(f.matrix=i),f}shadingFill(s){if(!this.contentVisible)return;const i=this.ctx;this.save();const f=this._getPattern(s);i.fillStyle=f.getPattern(i,this,(0,d.getCurrentTransformInverse)(i),V.PathType.SHADING);const k=(0,d.getCurrentTransformInverse)(i);if(k){const{width:F,height:D}=i.canvas,[q,nt,ct,ft]=n.Util.getAxialAlignedBoundingBox([0,0,F,D],k);this.ctx.fillRect(q,nt,ct-q,ft-nt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,d.getCurrentTransform)(this.ctx),i)){const f=i[2]-i[0],k=i[3]-i[1];this.ctx.rect(i[0],i[1],f,k),this.current.updateRectMinMax((0,d.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;s.isolated||(0,n.info)("TODO: Support non-isolated groups."),s.knockout&&(0,n.warn)("Knockout groups not supported.");const f=(0,d.getCurrentTransform)(i);if(s.matrix&&i.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let k=n.Util.getAxialAlignedBoundingBox(s.bbox,(0,d.getCurrentTransform)(i));const F=[0,0,i.canvas.width,i.canvas.height];k=n.Util.intersect(k,F)||[0,0,0,0];const D=Math.floor(k[0]),q=Math.floor(k[1]);let nt=Math.max(Math.ceil(k[2])-D,1),ct=Math.max(Math.ceil(k[3])-q,1),ft=1,bt=1;nt>P&&(ft=nt/P,nt=P),ct>P&&(bt=ct/P,ct=P),this.current.startNewPathAndClipBox([0,0,nt,ct]);let mt="groupAt"+this.groupLevel;s.smask&&(mt+="_smask_"+this.smaskCounter++%2);const _t=this.cachedCanvases.getCanvas(mt,nt,ct),J=_t.context;J.scale(1/ft,1/bt),J.translate(-D,-q),J.transform(...f),s.smask?this.smaskStack.push({canvas:_t.canvas,context:J,offsetX:D,offsetY:q,scaleX:ft,scaleY:bt,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(D,q),i.scale(ft,bt),i.save()),a(i,J),this.ctx=J,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,f=this.groupStack.pop();if(this.ctx=f,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const k=(0,d.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...k);const F=n.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],k);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(F)}}beginAnnotation(s,i,f,k,F){if(Y(this,it,qe).call(this),h(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const D=i[2]-i[0],q=i[3]-i[1];if(F&&this.annotationCanvasMap){f=f.slice(),f[4]-=i[0],f[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=D,i[3]=q;const[nt,ct]=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(this.ctx)),{viewportScale:ft}=this,bt=Math.ceil(D*this.outputScaleX*ft),mt=Math.ceil(q*this.outputScaleY*ft);this.annotationCanvas=this.canvasFactory.create(bt,mt);const{canvas:_t,context:J}=this.annotationCanvas;this.annotationCanvasMap.set(s,_t),this.annotationCanvas.savedCtx=this.ctx,this.ctx=J,this.ctx.save(),this.ctx.setTransform(nt,0,0,-ct,0,q*ct),h(this.ctx)}else h(this.ctx),this.ctx.rect(i[0],i[1],D,q),this.ctx.clip(),this.endPath()}this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...f),this.transform(...k)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,it,Xe).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const i=s.count;s=this.getObject(s.data,s),s.count=i;const f=this.ctx,k=this.processingType3;if(k&&(k.compiled===void 0&&(k.compiled=u(s)),k.compiled)){k.compiled(f);return}const F=this._createMaskCanvas(s),D=F.canvas;f.save(),f.setTransform(1,0,0,1,0,0),f.drawImage(D,F.offsetX,F.offsetY),f.restore(),this.compose()}paintImageMaskXObjectRepeat(s,i,f=0,k=0,F,D){if(!this.contentVisible)return;s=this.getObject(s.data,s);const q=this.ctx;q.save();const nt=(0,d.getCurrentTransform)(q);q.transform(i,f,k,F,0,0);const ct=this._createMaskCanvas(s);q.setTransform(1,0,0,1,ct.offsetX-nt[4],ct.offsetY-nt[5]);for(let ft=0,bt=D.length;ft<bt;ft+=2){const mt=n.Util.transform(nt,[i,f,k,F,D[ft],D[ft+1]]),[_t,J]=n.Util.applyTransform([0,0],mt);q.drawImage(ct.canvas,_t,J)}q.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const i=this.ctx,f=this.current.fillColor,k=this.current.patternFill;for(const F of s){const{data:D,width:q,height:nt,transform:ct}=F,ft=this.cachedCanvases.getCanvas("maskCanvas",q,nt),bt=ft.context;bt.save();const mt=this.getObject(D,F);A(bt,mt),bt.globalCompositeOperation="source-in",bt.fillStyle=k?f.getPattern(bt,this,(0,d.getCurrentTransformInverse)(i),V.PathType.FILL):f,bt.fillRect(0,0,q,nt),bt.restore(),i.save(),i.transform(...ct),i.scale(1,-1),g(i,ft.canvas,0,0,q,nt,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const i=this.getObject(s);if(!i){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(s,i,f,k){if(!this.contentVisible)return;const F=this.getObject(s);if(!F){(0,n.warn)("Dependent image isn't ready yet");return}const D=F.width,q=F.height,nt=[];for(let ct=0,ft=k.length;ct<ft;ct+=2)nt.push({transform:[i,0,0,f,k[ct],k[ct+1]],x:0,y:0,w:D,h:q});this.paintInlineImageXObjectGroup(F,nt)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:i,width:f,height:k}=s,F=this.cachedCanvases.getCanvas("inlineImage",f,k),D=F.context;return D.filter=this.current.transferMaps,D.drawImage(i,0,0),D.filter="none",F.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const i=s.width,f=s.height,k=this.ctx;if(this.save(),!n.isNodeJS){const{filter:q}=k;q!=="none"&&q!==""&&(k.filter="none")}k.scale(1/i,-1/f);let F;if(s.bitmap)F=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)F=s;else{const nt=this.cachedCanvases.getCanvas("inlineImage",i,f).context;M(nt,s),F=this.applyTransferMapsToCanvas(nt)}const D=this._scaleImage(F,(0,d.getCurrentTransformInverse)(k));k.imageSmoothingEnabled=v((0,d.getCurrentTransform)(k),s.interpolate),g(k,D.img,0,0,D.paintWidth,D.paintHeight,0,-f,i,f),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,i){if(!this.contentVisible)return;const f=this.ctx;let k;if(s.bitmap)k=s.bitmap;else{const F=s.width,D=s.height,nt=this.cachedCanvases.getCanvas("inlineImage",F,D).context;M(nt,s),k=this.applyTransferMapsToCanvas(nt)}for(const F of i)f.save(),f.transform(...F.transform),f.scale(1,-1),g(f,k,F.x,F.y,F.w,F.h,0,-1,1,1),f.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,i){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,i){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const f=this.ctx;this.pendingClip&&(i||(this.pendingClip===K?f.clip("evenodd"):f.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),f.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,d.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const i=Math.abs(s[0]*s[3]-s[2]*s[1]),f=Math.hypot(s[0],s[2]),k=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(f,k)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:i,b:f,c:k,d:F}=this.ctx.getTransform();let D,q;if(f===0&&k===0){const nt=Math.abs(i),ct=Math.abs(F);if(nt===ct)if(s===0)D=q=1/nt;else{const ft=nt*s;D=q=ft<1?1/ft:1}else if(s===0)D=1/nt,q=1/ct;else{const ft=nt*s,bt=ct*s;D=ft<1?1/ft:1,q=bt<1?1/bt:1}}else{const nt=Math.abs(i*F-f*k),ct=Math.hypot(i,f),ft=Math.hypot(k,F);if(s===0)D=ft/nt,q=ct/nt;else{const bt=s*nt;D=ft>bt?ft/bt:1,q=ct>bt?ct/bt:1}}this._cachedScaleForStroking[0]=D,this._cachedScaleForStroking[1]=q}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:i}=this,{lineWidth:f}=this.current,[k,F]=this.getScaleForStroking();if(i.lineWidth=f||1,k===1&&F===1){i.stroke();return}const D=i.getLineDash();if(s&&i.save(),i.scale(k,F),D.length>0){const q=Math.max(k,F);i.setLineDash(D.map(nt=>nt/q)),i.lineDashOffset/=q}i.stroke(),s&&i.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};it=new WeakSet,qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Xe=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const i=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};let H=et;e.CanvasGraphics=H;for(const S in n.OPS)H.prototype[S]!==void 0&&(H.prototype[n.OPS[S]]=H.prototype[S])},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=b;var n=U(1),d=U(6);const V={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=V;function W(u,y){if(!y)return;const M=y[2]-y[0],A=y[3]-y[1],a=new Path2D;a.rect(y[0],y[1],M,A),u.clip(a)}class dt{constructor(){this.constructor===dt&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class x extends dt{constructor(y){super(),this._type=y[1],this._bbox=y[2],this._colorStops=y[3],this._p0=y[4],this._p1=y[5],this._r0=y[6],this._r1=y[7],this.matrix=null}_createGradient(y){let M;this._type==="axial"?M=y.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(M=y.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)M.addColorStop(A[0],A[1]);return M}getPattern(y,M,A,a){let h;if(a===V.STROKE||a===V.FILL){const o=M.current.getClippedPathBoundingBox(a,(0,d.getCurrentTransform)(y))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,O=M.cachedCanvases.getCanvas("pattern",l,c,!0),r=O.context;r.clearRect(0,0,r.canvas.width,r.canvas.height),r.beginPath(),r.rect(0,0,r.canvas.width,r.canvas.height),r.translate(-o[0],-o[1]),A=n.Util.transform(A,[1,0,0,1,o[0],o[1]]),r.transform(...M.baseTransform),this.matrix&&r.transform(...this.matrix),W(r,this._bbox),r.fillStyle=this._createGradient(r),r.fill(),h=y.createPattern(O.canvas,"no-repeat");const v=new DOMMatrix(A);h.setTransform(v)}else W(y,this._bbox),h=this._createGradient(y);return h}}function P(u,y,M,A,a,h,o,l){const c=y.coords,O=y.colors,r=u.data,v=u.width*4;let C;c[M+1]>c[A+1]&&(C=M,M=A,A=C,C=h,h=o,o=C),c[A+1]>c[a+1]&&(C=A,A=a,a=C,C=o,o=l,l=C),c[M+1]>c[A+1]&&(C=M,M=A,A=C,C=h,h=o,o=C);const tt=(c[M]+y.offsetX)*y.scaleX,$=(c[M+1]+y.offsetY)*y.scaleY,K=(c[A]+y.offsetX)*y.scaleX,H=(c[A+1]+y.offsetY)*y.scaleY,it=(c[a]+y.offsetX)*y.scaleX,w=(c[a+1]+y.offsetY)*y.scaleY;if($>=w)return;const G=O[h],et=O[h+1],S=O[h+2],s=O[o],i=O[o+1],f=O[o+2],k=O[l],F=O[l+1],D=O[l+2],q=Math.round($),nt=Math.round(w);let ct,ft,bt,mt,_t,J,Q,_;for(let L=q;L<=nt;L++){if(L<H){const At=L<$?0:($-L)/($-H);ct=tt-(tt-K)*At,ft=G-(G-s)*At,bt=et-(et-i)*At,mt=S-(S-f)*At}else{let At;L>w?At=1:H===w?At=0:At=(H-L)/(H-w),ct=K-(K-it)*At,ft=s-(s-k)*At,bt=i-(i-F)*At,mt=f-(f-D)*At}let X;L<$?X=0:L>w?X=1:X=($-L)/($-w),_t=tt-(tt-it)*X,J=G-(G-k)*X,Q=et-(et-F)*X,_=S-(S-D)*X;const st=Math.round(Math.min(ct,_t)),pt=Math.round(Math.max(ct,_t));let Et=v*L+st*4;for(let At=st;At<=pt;At++)X=(ct-At)/(ct-_t),X<0?X=0:X>1&&(X=1),r[Et++]=ft-(ft-J)*X|0,r[Et++]=bt-(bt-Q)*X|0,r[Et++]=mt-(mt-_)*X|0,r[Et++]=255}}function p(u,y,M){const A=y.coords,a=y.colors;let h,o;switch(y.type){case"lattice":const l=y.verticesPerRow,c=Math.floor(A.length/l)-1,O=l-1;for(h=0;h<c;h++){let r=h*l;for(let v=0;v<O;v++,r++)P(u,M,A[r],A[r+1],A[r+l],a[r],a[r+1],a[r+l]),P(u,M,A[r+l+1],A[r+1],A[r+l],a[r+l+1],a[r+1],a[r+l])}break;case"triangles":for(h=0,o=A.length;h<o;h+=3)P(u,M,A[h],A[h+1],A[h+2],a[h],a[h+1],a[h+2]);break;default:throw new Error("illegal figure")}}class N extends dt{constructor(y){super(),this._coords=y[2],this._colors=y[3],this._figures=y[4],this._bounds=y[5],this._bbox=y[7],this._background=y[8],this.matrix=null}_createMeshCanvas(y,M,A){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),O=Math.ceil(this._bounds[2])-l,r=Math.ceil(this._bounds[3])-c,v=Math.min(Math.ceil(Math.abs(O*y[0]*1.1)),3e3),C=Math.min(Math.ceil(Math.abs(r*y[1]*1.1)),3e3),tt=O/v,$=r/C,K={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/tt,scaleY:1/$},H=v+2*2,it=C+2*2,w=A.getCanvas("mesh",H,it,!1),G=w.context,et=G.createImageData(v,C);if(M){const s=et.data;for(let i=0,f=s.length;i<f;i+=4)s[i]=M[0],s[i+1]=M[1],s[i+2]=M[2],s[i+3]=255}for(const s of this._figures)p(et,s,K);return G.putImageData(et,2,2),{canvas:w.canvas,offsetX:l-2*tt,offsetY:c-2*$,scaleX:tt,scaleY:$}}getPattern(y,M,A,a){W(y,this._bbox);let h;if(a===V.SHADING)h=n.Util.singularValueDecompose2dScale((0,d.getCurrentTransform)(y));else if(h=n.Util.singularValueDecompose2dScale(M.baseTransform),this.matrix){const l=n.Util.singularValueDecompose2dScale(this.matrix);h=[h[0]*l[0],h[1]*l[1]]}const o=this._createMeshCanvas(h,a===V.SHADING?null:this._background,M.cachedCanvases);return a!==V.SHADING&&(y.setTransform(...M.baseTransform),this.matrix&&y.transform(...this.matrix)),y.translate(o.offsetX,o.offsetY),y.scale(o.scaleX,o.scaleY),y.createPattern(o.canvas,"no-repeat")}}class I extends dt{getPattern(){return"hotpink"}}function b(u){switch(u[0]){case"RadialAxial":return new x(u);case"Mesh":return new N(u);case"Dummy":return new I}throw new Error(`Unknown IR type: ${u[0]}`)}const m={COLORED:1,UNCOLORED:2},g=class g{constructor(y,M,A,a,h){this.operatorList=y[2],this.matrix=y[3]||[1,0,0,1,0,0],this.bbox=y[4],this.xstep=y[5],this.ystep=y[6],this.paintType=y[7],this.tilingType=y[8],this.color=M,this.ctx=A,this.canvasGraphicsFactory=a,this.baseTransform=h}createPatternCanvas(y){const M=this.operatorList,A=this.bbox,a=this.xstep,h=this.ystep,o=this.paintType,l=this.tilingType,c=this.color,O=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+l);const r=A[0],v=A[1],C=A[2],tt=A[3],$=n.Util.singularValueDecompose2dScale(this.matrix),K=n.Util.singularValueDecompose2dScale(this.baseTransform),H=[$[0]*K[0],$[1]*K[1]],it=this.getSizeAndScale(a,this.ctx.canvas.width,H[0]),w=this.getSizeAndScale(h,this.ctx.canvas.height,H[1]),G=y.cachedCanvases.getCanvas("pattern",it.size,w.size,!0),et=G.context,S=O.createCanvasGraphics(et);S.groupLevel=y.groupLevel,this.setFillAndStrokeStyleToContext(S,o,c);let s=r,i=v,f=C,k=tt;return r<0&&(s=0,f+=Math.abs(r)),v<0&&(i=0,k+=Math.abs(v)),et.translate(-(it.scale*s),-(w.scale*i)),S.transform(it.scale,0,0,w.scale,0,0),et.save(),this.clipBbox(S,s,i,f,k),S.baseTransform=(0,d.getCurrentTransform)(S.ctx),S.executeOperatorList(M),S.endDrawing(),{canvas:G.canvas,scaleX:it.scale,scaleY:w.scale,offsetX:s,offsetY:i}}getSizeAndScale(y,M,A){y=Math.abs(y);const a=Math.max(g.MAX_PATTERN_SIZE,M);let h=Math.ceil(y*A);return h>=a?h=a:A=h/y,{scale:A,size:h}}clipBbox(y,M,A,a,h){const o=a-M,l=h-A;y.ctx.rect(M,A,o,l),y.current.updateRectMinMax((0,d.getCurrentTransform)(y.ctx),[M,A,a,h]),y.clip(),y.endPath()}setFillAndStrokeStyleToContext(y,M,A){const a=y.ctx,h=y.current;switch(M){case m.COLORED:const o=this.ctx;a.fillStyle=o.fillStyle,a.strokeStyle=o.strokeStyle,h.fillColor=o.fillStyle,h.strokeColor=o.strokeStyle;break;case m.UNCOLORED:const l=n.Util.makeHexColor(A[0],A[1],A[2]);a.fillStyle=l,a.strokeStyle=l,h.fillColor=l,h.strokeColor=l;break;default:throw new n.FormatError(`Unsupported paint type: ${M}`)}}getPattern(y,M,A,a){let h=A;a!==V.SHADING&&(h=n.Util.transform(h,M.baseTransform),this.matrix&&(h=n.Util.transform(h,this.matrix)));const o=this.createPatternCanvas(M);let l=new DOMMatrix(h);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const c=y.createPattern(o.canvas,"repeat");return c.setTransform(l),c}};Kt(g,"MAX_PATTERN_SIZE",3e3);let E=g;e.TilingPattern=E},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=V,e.convertToRGBA=d,e.grayToRGBA=dt;var n=U(1);function d(x){switch(x.kind){case n.ImageKind.GRAYSCALE_1BPP:return V(x);case n.ImageKind.RGB_24BPP:return W(x)}return null}function V({src:x,srcPos:P=0,dest:p,width:N,height:I,nonBlackColor:b=4294967295,inverseDecode:m=!1}){const E=n.FeatureTest.isLittleEndian?4278190080:255,[g,u]=m?[b,E]:[E,b],y=N>>3,M=N&7,A=x.length;p=new Uint32Array(p.buffer);let a=0;for(let h=0;h<I;h++){for(const l=P+y;P<l;P++){const c=P<A?x[P]:255;p[a++]=c&128?u:g,p[a++]=c&64?u:g,p[a++]=c&32?u:g,p[a++]=c&16?u:g,p[a++]=c&8?u:g,p[a++]=c&4?u:g,p[a++]=c&2?u:g,p[a++]=c&1?u:g}if(M===0)continue;const o=P<A?x[P++]:255;for(let l=0;l<M;l++)p[a++]=o&1<<7-l?u:g}return{srcPos:P,destPos:a}}function W({src:x,srcPos:P=0,dest:p,destPos:N=0,width:I,height:b}){let m=0;const E=x.length>>2,g=new Uint32Array(x.buffer,P,E);if(n.FeatureTest.isLittleEndian){for(;m<E-2;m+=3,N+=4){const u=g[m],y=g[m+1],M=g[m+2];p[N]=u|4278190080,p[N+1]=u>>>24|y<<8|4278190080,p[N+2]=y>>>16|M<<16|4278190080,p[N+3]=M>>>8|4278190080}for(let u=m*4,y=x.length;u<y;u+=3)p[N++]=x[u]|x[u+1]<<8|x[u+2]<<16|4278190080}else{for(;m<E-2;m+=3,N+=4){const u=g[m],y=g[m+1],M=g[m+2];p[N]=u|255,p[N+1]=u<<24|y>>>8|255,p[N+2]=y<<16|M>>>16|255,p[N+3]=M<<8|255}for(let u=m*4,y=x.length;u<y;u+=3)p[N++]=x[u]<<24|x[u+1]<<16|x[u+2]<<8|255}return{srcPos:P,destPos:N}}function dt(x,P){if(n.FeatureTest.isLittleEndian)for(let p=0,N=x.length;p<N;p++)P[p]=x[p]*65793|4278190080;else for(let p=0,N=x.length;p<N;p++)P[p]=x[p]*16843008|255}},(B,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const U=Object.create(null);e.GlobalWorkerOptions=U,U.workerPort=null,U.workerSrc=""},(B,e,U)=>{var x,Pn,wn,Se;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=U(1);const d={UNKNOWN:0,DATA:1,ERROR:2},V={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function W(I){switch(I instanceof Error||typeof I=="object"&&I!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),I.name){case"AbortException":return new n.AbortException(I.message);case"MissingPDFException":return new n.MissingPDFException(I.message);case"PasswordException":return new n.PasswordException(I.message,I.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(I.message,I.status);case"UnknownErrorException":return new n.UnknownErrorException(I.message,I.details);default:return new n.UnknownErrorException(I.message,I.toString())}}class dt{constructor(b,m,E){rt(this,x);this.sourceName=b,this.targetName=m,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=g=>{const u=g.data;if(u.targetName!==this.sourceName)return;if(u.stream){Y(this,x,wn).call(this,u);return}if(u.callback){const M=u.callbackId,A=this.callbackCapabilities[M];if(!A)throw new Error(`Cannot resolve callback ${M}`);if(delete this.callbackCapabilities[M],u.callback===d.DATA)A.resolve(u.data);else if(u.callback===d.ERROR)A.reject(W(u.reason));else throw new Error("Unexpected callback case");return}const y=this.actionHandler[u.action];if(!y)throw new Error(`Unknown action from worker: ${u.action}`);if(u.callbackId){const M=this.sourceName,A=u.sourceName;new Promise(function(a){a(y(u.data))}).then(function(a){E.postMessage({sourceName:M,targetName:A,callback:d.DATA,callbackId:u.callbackId,data:a})},function(a){E.postMessage({sourceName:M,targetName:A,callback:d.ERROR,callbackId:u.callbackId,reason:W(a)})});return}if(u.streamId){Y(this,x,Pn).call(this,u);return}y(u.data)},E.addEventListener("message",this._onComObjOnMessage)}on(b,m){const E=this.actionHandler;if(E[b])throw new Error(`There is already an actionName called "${b}"`);E[b]=m}send(b,m,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:b,data:m},E)}sendWithPromise(b,m,E){const g=this.callbackId++,u=new n.PromiseCapability;this.callbackCapabilities[g]=u;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:b,callbackId:g,data:m},E)}catch(y){u.reject(y)}return u.promise}sendWithStream(b,m,E,g){const u=this.streamId++,y=this.sourceName,M=this.targetName,A=this.comObj;return new ReadableStream({start:a=>{const h=new n.PromiseCapability;return this.streamControllers[u]={controller:a,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},A.postMessage({sourceName:y,targetName:M,action:b,streamId:u,data:m,desiredSize:a.desiredSize},g),h.promise},pull:a=>{const h=new n.PromiseCapability;return this.streamControllers[u].pullCall=h,A.postMessage({sourceName:y,targetName:M,stream:V.PULL,streamId:u,desiredSize:a.desiredSize}),h.promise},cancel:a=>{(0,n.assert)(a instanceof Error,"cancel must have a valid reason");const h=new n.PromiseCapability;return this.streamControllers[u].cancelCall=h,this.streamControllers[u].isClosed=!0,A.postMessage({sourceName:y,targetName:M,stream:V.CANCEL,streamId:u,reason:W(a)}),h.promise}},E)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}x=new WeakSet,Pn=function(b){const m=b.streamId,E=this.sourceName,g=b.sourceName,u=this.comObj,y=this,M=this.actionHandler[b.action],A={enqueue(a,h=1,o){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=h,l>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),u.postMessage({sourceName:E,targetName:g,stream:V.ENQUEUE,streamId:m,chunk:a},o)},close(){this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:E,targetName:g,stream:V.CLOSE,streamId:m}),delete y.streamSinks[m])},error(a){(0,n.assert)(a instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,u.postMessage({sourceName:E,targetName:g,stream:V.ERROR,streamId:m,reason:W(a)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:b.desiredSize,ready:null};A.sinkCapability.resolve(),A.ready=A.sinkCapability.promise,this.streamSinks[m]=A,new Promise(function(a){a(M(b.data,A))}).then(function(){u.postMessage({sourceName:E,targetName:g,stream:V.START_COMPLETE,streamId:m,success:!0})},function(a){u.postMessage({sourceName:E,targetName:g,stream:V.START_COMPLETE,streamId:m,reason:W(a)})})},wn=function(b){const m=b.streamId,E=this.sourceName,g=b.sourceName,u=this.comObj,y=this.streamControllers[m],M=this.streamSinks[m];switch(b.stream){case V.START_COMPLETE:b.success?y.startCall.resolve():y.startCall.reject(W(b.reason));break;case V.PULL_COMPLETE:b.success?y.pullCall.resolve():y.pullCall.reject(W(b.reason));break;case V.PULL:if(!M){u.postMessage({sourceName:E,targetName:g,stream:V.PULL_COMPLETE,streamId:m,success:!0});break}M.desiredSize<=0&&b.desiredSize>0&&M.sinkCapability.resolve(),M.desiredSize=b.desiredSize,new Promise(function(A){var a;A((a=M.onPull)==null?void 0:a.call(M))}).then(function(){u.postMessage({sourceName:E,targetName:g,stream:V.PULL_COMPLETE,streamId:m,success:!0})},function(A){u.postMessage({sourceName:E,targetName:g,stream:V.PULL_COMPLETE,streamId:m,reason:W(A)})});break;case V.ENQUEUE:if((0,n.assert)(y,"enqueue should have stream controller"),y.isClosed)break;y.controller.enqueue(b.chunk);break;case V.CLOSE:if((0,n.assert)(y,"close should have stream controller"),y.isClosed)break;y.isClosed=!0,y.controller.close(),Y(this,x,Se).call(this,y,m);break;case V.ERROR:(0,n.assert)(y,"error should have stream controller"),y.controller.error(W(b.reason)),Y(this,x,Se).call(this,y,m);break;case V.CANCEL_COMPLETE:b.success?y.cancelCall.resolve():y.cancelCall.reject(W(b.reason)),Y(this,x,Se).call(this,y,m);break;case V.CANCEL:if(!M)break;new Promise(function(A){var a;A((a=M.onCancel)==null?void 0:a.call(M,W(b.reason)))}).then(function(){u.postMessage({sourceName:E,targetName:g,stream:V.CANCEL_COMPLETE,streamId:m,success:!0})},function(A){u.postMessage({sourceName:E,targetName:g,stream:V.CANCEL_COMPLETE,streamId:m,reason:W(A)})}),M.sinkCapability.reject(W(b.reason)),M.isCancelled=!0,delete this.streamSinks[m];break;default:throw new Error("Unexpected stream case")}},Se=async function(b,m){var E,g,u;await Promise.allSettled([(E=b.startCall)==null?void 0:E.promise,(g=b.pullCall)==null?void 0:g.promise,(u=b.cancelCall)==null?void 0:u.promise]),delete this.streamControllers[m]},e.MessageHandler=dt},(B,e,U)=>{var V,W;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=U(1);class d{constructor({parsedData:x,rawData:P}){rt(this,V);rt(this,W);ot(this,V,x),ot(this,W,P)}getRaw(){return t(this,W)}get(x){return t(this,V).get(x)??null}getAll(){return(0,n.objectFromMap)(t(this,V))}has(x){return t(this,V).has(x)}}V=new WeakMap,W=new WeakMap,e.Metadata=d},(B,e,U)=>{var x,P,p,N,I,b,Ye;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=U(1),d=U(8);const V=Symbol("INTERNAL");class W{constructor(g,u){rt(this,x,!0);this.name=g,this.intent=u}get visible(){return t(this,x)}_setVisible(g,u){g!==V&&(0,n.unreachable)("Internal method `_setVisible` called."),ot(this,x,u)}}x=new WeakMap;class dt{constructor(g){rt(this,b);rt(this,P,null);rt(this,p,new Map);rt(this,N,null);rt(this,I,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,ot(this,I,g.order);for(const u of g.groups)t(this,p).set(u.id,new W(u.name,u.intent));if(g.baseState==="OFF")for(const u of t(this,p).values())u._setVisible(V,!1);for(const u of g.on)t(this,p).get(u)._setVisible(V,!0);for(const u of g.off)t(this,p).get(u)._setVisible(V,!1);ot(this,N,this.getHash())}}isVisible(g){if(t(this,p).size===0)return!0;if(!g)return(0,n.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return t(this,p).has(g.id)?t(this,p).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return Y(this,b,Ye).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const u of g.ids){if(!t(this,p).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(t(this,p).get(u).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const u of g.ids){if(!t(this,p).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,p).get(u).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const u of g.ids){if(!t(this,p).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,p).get(u).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const u of g.ids){if(!t(this,p).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(t(this,p).get(u).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,u=!0){if(!t(this,p).has(g)){(0,n.warn)(`Optional content group not found: ${g}`);return}t(this,p).get(g)._setVisible(V,!!u),ot(this,P,null)}get hasInitialVisibility(){return t(this,N)===null||this.getHash()===t(this,N)}getOrder(){return t(this,p).size?t(this,I)?t(this,I).slice():[...t(this,p).keys()]:null}getGroups(){return t(this,p).size>0?(0,n.objectFromMap)(t(this,p)):null}getGroup(g){return t(this,p).get(g)||null}getHash(){if(t(this,P)!==null)return t(this,P);const g=new d.MurmurHash3_64;for(const[u,y]of t(this,p))g.update(`${u}:${y.visible}`);return ot(this,P,g.hexdigest())}}P=new WeakMap,p=new WeakMap,N=new WeakMap,I=new WeakMap,b=new WeakSet,Ye=function(g){const u=g.length;if(u<2)return!0;const y=g[0];for(let M=1;M<u;M++){const A=g[M];let a;if(Array.isArray(A))a=Y(this,b,Ye).call(this,A);else if(t(this,p).has(A))a=t(this,p).get(A).visible;else return(0,n.warn)(`Optional content group not found: ${A}`),!0;switch(y){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return y==="And"},e.OptionalContentConfig=dt},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=U(1),d=U(6);class V{constructor({length:P,initialData:p,progressiveDone:N=!1,contentDispositionFilename:I=null,disableRange:b=!1,disableStream:m=!1},E){if((0,n.assert)(E,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=N,this._contentDispositionFilename=I,(p==null?void 0:p.length)>0){const g=p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength?p.buffer:new Uint8Array(p).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=E,this._isStreamingSupported=!m,this._isRangeSupported=!b,this._contentLength=P,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,u)=>{this._onReceiveData({begin:g,chunk:u})}),this._pdfDataRangeTransport.addProgressListener((g,u)=>{this._onProgress({loaded:g,total:u})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:P,chunk:p}){const N=p instanceof Uint8Array&&p.byteLength===p.buffer.byteLength?p.buffer:new Uint8Array(p).buffer;if(P===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(N):this._queuedChunks.push(N);else{const I=this._rangeReaders.some(function(b){return b._begin!==P?!1:(b._enqueue(N),!0)});(0,n.assert)(I,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var P;return((P=this._fullRequestReader)==null?void 0:P._loaded)??0}_onProgress(P){var p,N,I,b;P.total===void 0?(N=(p=this._rangeReaders[0])==null?void 0:p.onProgress)==null||N.call(p,{loaded:P.loaded}):(b=(I=this._fullRequestReader)==null?void 0:I.onProgress)==null||b.call(I,{loaded:P.loaded,total:P.total})}_onProgressiveDone(){var P;(P=this._fullRequestReader)==null||P.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(P){const p=this._rangeReaders.indexOf(P);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const P=this._queuedChunks;return this._queuedChunks=null,new W(this,P,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(P,p){if(p<=this._progressiveDataLength)return null;const N=new dt(this,P,p);return this._pdfDataRangeTransport.requestDataRange(P,p),this._rangeReaders.push(N),N}cancelAllRequests(P){var p;(p=this._fullRequestReader)==null||p.cancel(P);for(const N of this._rangeReaders.slice(0))N.cancel(P);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=V;class W{constructor(P,p,N=!1,I=null){this._stream=P,this._done=N||!1,this._filename=(0,d.isPdfFile)(I)?I:null,this._queuedChunks=p||[],this._loaded=0;for(const b of this._queuedChunks)this._loaded+=b.byteLength;this._requests=[],this._headersReady=Promise.resolve(),P._fullRequestReader=this,this.onProgress=null}_enqueue(P){this._done||(this._requests.length>0?this._requests.shift().resolve({value:P,done:!1}):this._queuedChunks.push(P),this._loaded+=P.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const P=new n.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class dt{constructor(P,p,N){this._stream=P,this._begin=p,this._end=N,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(P){if(!this._done){if(this._requests.length===0)this._queuedChunk=P;else{this._requests.shift().resolve({value:P,done:!1});for(const N of this._requests)N.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const P=new n.PromiseCapability;return this._requests.push(P),P.promise}cancel(P){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=U(1),d=U(20);function V(N,I,b){return{method:"GET",headers:N,signal:b.signal,mode:"cors",credentials:I?"include":"same-origin",redirect:"follow"}}function W(N){const I=new Headers;for(const b in N){const m=N[b];m!==void 0&&I.append(b,m)}return I}function dt(N){return N instanceof Uint8Array?N.buffer:N instanceof ArrayBuffer?N:((0,n.warn)(`getArrayBuffer - unexpected data format: ${N}`),new Uint8Array(N).buffer)}class x{constructor(I){this.source=I,this.isHttp=/^https?:/i.test(I.url),this.httpHeaders=this.isHttp&&I.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new P(this),this._fullRequestReader}getRangeReader(I,b){if(b<=this._progressiveDataLength)return null;const m=new p(this,I,b);return this._rangeRequestReaders.push(m),m}cancelAllRequests(I){var b;(b=this._fullRequestReader)==null||b.cancel(I);for(const m of this._rangeRequestReaders.slice(0))m.cancel(I)}}e.PDFFetchStream=x;class P{constructor(I){this._stream=I,this._reader=null,this._loaded=0,this._filename=null;const b=I.source;this._withCredentials=b.withCredentials||!1,this._contentLength=b.length,this._headersCapability=new n.PromiseCapability,this._disableRange=b.disableRange||!1,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!b.disableStream,this._isRangeSupported=!b.disableRange,this._headers=W(this._stream.httpHeaders);const m=b.url;fetch(m,V(this._headers,this._withCredentials,this._abortController)).then(E=>{if(!(0,d.validateResponseStatus)(E.status))throw(0,d.createResponseStatusError)(E.status,m);this._reader=E.body.getReader(),this._headersCapability.resolve();const g=M=>E.headers.get(M),{allowRangeRequests:u,suggestedLength:y}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=y||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._headersCapability.promise;const{value:I,done:b}=await this._reader.read();return b?{value:I,done:b}:(this._loaded+=I.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded,total:this._contentLength}),{value:dt(I),done:!1})}cancel(I){var b;(b=this._reader)==null||b.cancel(I),this._abortController.abort()}}class p{constructor(I,b,m){this._stream=I,this._reader=null,this._loaded=0;const E=I.source;this._withCredentials=E.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!E.disableStream,this._abortController=new AbortController,this._headers=W(this._stream.httpHeaders),this._headers.append("Range",`bytes=${b}-${m-1}`);const g=E.url;fetch(g,V(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,d.validateResponseStatus)(u.status))throw(0,d.createResponseStatusError)(u.status,g);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._readCapability.promise;const{value:I,done:b}=await this._reader.read();return b?{value:I,done:b}:(this._loaded+=I.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded}),{value:dt(I),done:!1})}cancel(I){var b;(b=this._reader)==null||b.cancel(I),this._abortController.abort()}}},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=x,e.extractFilenameFromHeader=dt,e.validateRangeRequestCapabilities=W,e.validateResponseStatus=P;var n=U(1),d=U(21),V=U(6);function W({getResponseHeader:p,isHttp:N,rangeChunkSize:I,disableRange:b}){const m={allowRangeRequests:!1,suggestedLength:void 0},E=parseInt(p("Content-Length"),10);return!Number.isInteger(E)||(m.suggestedLength=E,E<=2*I)||b||!N||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(m.allowRangeRequests=!0),m}function dt(p){const N=p("Content-Disposition");if(N){let I=(0,d.getFilenameFromContentDispositionHeader)(N);if(I.includes("%"))try{I=decodeURIComponent(I)}catch{}if((0,V.isPdfFile)(I))return I}return null}function x(p,N){return p===404||p===0&&N.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+N+'".'):new n.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${N}".`,p)}function P(p){return p===200||p===206}},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=d;var n=U(1);function d(V){let W=!0,dt=x("filename\\*","i").exec(V);if(dt){dt=dt[1];let E=I(dt);return E=unescape(E),E=b(E),E=m(E),p(E)}if(dt=N(V),dt){const E=m(dt);return p(E)}if(dt=x("filename","i").exec(V),dt){dt=dt[1];let E=I(dt);return E=m(E),p(E)}function x(E,g){return new RegExp("(?:^|;)\\s*"+E+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function P(E,g){if(E){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const u=new TextDecoder(E,{fatal:!0}),y=(0,n.stringToBytes)(g);g=u.decode(y),W=!1}catch{}}return g}function p(E){return W&&/[\x80-\xff]/.test(E)&&(E=P("utf-8",E),W&&(E=P("iso-8859-1",E))),E}function N(E){const g=[];let u;const y=x("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=y.exec(E))!==null;){let[,A,a,h]=u;if(A=parseInt(A,10),A in g){if(A===0)break;continue}g[A]=[a,h]}const M=[];for(let A=0;A<g.length&&A in g;++A){let[a,h]=g[A];h=I(h),a&&(h=unescape(h),A===0&&(h=b(h))),M.push(h)}return M.join("")}function I(E){if(E.startsWith('"')){const g=E.slice(1).split('\\"');for(let u=0;u<g.length;++u){const y=g[u].indexOf('"');y!==-1&&(g[u]=g[u].slice(0,y),g.length=u+1),g[u]=g[u].replaceAll(/\\(.)/g,"$1")}E=g.join('"')}return E}function b(E){const g=E.indexOf("'");if(g===-1)return E;const u=E.slice(0,g),M=E.slice(g+1).replace(/^[^']*'/,"");return P(u,M)}function m(E){return!E.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(E)?E:E.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,u,y,M){if(y==="q"||y==="Q")return M=M.replaceAll("_"," "),M=M.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,a){return String.fromCharCode(parseInt(a,16))}),P(u,M);try{M=atob(M)}catch{}return P(u,M)})}return""}},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=U(1),d=U(20);const V=200,W=206;function dt(I){const b=I.response;return typeof b!="string"?b:(0,n.stringToBytes)(b).buffer}class x{constructor(b,m={}){this.url=b,this.isHttp=/^https?:/i.test(b),this.httpHeaders=this.isHttp&&m.httpHeaders||Object.create(null),this.withCredentials=m.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(b,m,E){const g={begin:b,end:m};for(const u in E)g[u]=E[u];return this.request(g)}requestFull(b){return this.request(b)}request(b){const m=new XMLHttpRequest,E=this.currXhrId++,g=this.pendingRequests[E]={xhr:m};m.open("GET",this.url),m.withCredentials=this.withCredentials;for(const u in this.httpHeaders){const y=this.httpHeaders[u];y!==void 0&&m.setRequestHeader(u,y)}return this.isHttp&&"begin"in b&&"end"in b?(m.setRequestHeader("Range",`bytes=${b.begin}-${b.end-1}`),g.expectedStatus=W):g.expectedStatus=V,m.responseType="arraybuffer",b.onError&&(m.onerror=function(u){b.onError(m.status)}),m.onreadystatechange=this.onStateChange.bind(this,E),m.onprogress=this.onProgress.bind(this,E),g.onHeadersReceived=b.onHeadersReceived,g.onDone=b.onDone,g.onError=b.onError,g.onProgress=b.onProgress,m.send(null),E}onProgress(b,m){var g;const E=this.pendingRequests[b];E&&((g=E.onProgress)==null||g.call(E,m))}onStateChange(b,m){var A,a,h;const E=this.pendingRequests[b];if(!E)return;const g=E.xhr;if(g.readyState>=2&&E.onHeadersReceived&&(E.onHeadersReceived(),delete E.onHeadersReceived),g.readyState!==4||!(b in this.pendingRequests))return;if(delete this.pendingRequests[b],g.status===0&&this.isHttp){(A=E.onError)==null||A.call(E,g.status);return}const u=g.status||V;if(!(u===V&&E.expectedStatus===W)&&u!==E.expectedStatus){(a=E.onError)==null||a.call(E,g.status);return}const M=dt(g);if(u===W){const o=g.getResponseHeader("Content-Range"),l=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);E.onDone({begin:parseInt(l[1],10),chunk:M})}else M?E.onDone({begin:0,chunk:M}):(h=E.onError)==null||h.call(E,g.status)}getRequestXhr(b){return this.pendingRequests[b].xhr}isPendingRequest(b){return b in this.pendingRequests}abortRequest(b){const m=this.pendingRequests[b].xhr;delete this.pendingRequests[b],m.abort()}}class P{constructor(b){this._source=b,this._manager=new x(b.url,{httpHeaders:b.httpHeaders,withCredentials:b.withCredentials}),this._rangeChunkSize=b.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(b){const m=this._rangeRequestReaders.indexOf(b);m>=0&&this._rangeRequestReaders.splice(m,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(b,m){const E=new N(this._manager,b,m);return E.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(E),E}cancelAllRequests(b){var m;(m=this._fullRequestReader)==null||m.cancel(b);for(const E of this._rangeRequestReaders.slice(0))E.cancel(b)}}e.PDFNetworkStream=P;class p{constructor(b,m){this._manager=b;const E={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._fullRequestId=b.requestFull(E),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=m.disableRange||!1,this._contentLength=m.length,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const b=this._fullRequestId,m=this._manager.getRequestXhr(b),E=y=>m.getResponseHeader(y),{allowRangeRequests:g,suggestedLength:u}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(E),this._isRangeSupported&&this._manager.abortRequest(b),this._headersReceivedCapability.resolve()}_onDone(b){if(b&&(this._requests.length>0?this._requests.shift().resolve({value:b.chunk,done:!1}):this._cachedChunks.push(b.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(b){this._storedError=(0,d.createResponseStatusError)(b,this._url),this._headersReceivedCapability.reject(this._storedError);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(b){var m;(m=this.onProgress)==null||m.call(this,{loaded:b.loaded,total:b.lengthComputable?b.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const b=new n.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0,this._headersReceivedCapability.reject(b);for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class N{constructor(b,m,E){this._manager=b;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._requestId=b.requestRange(m,E,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var b;(b=this.onClosed)==null||b.call(this,this)}_onDone(b){const m=b.chunk;this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunk=m,this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(b){this._storedError=(0,d.createResponseStatusError)(b,this._url);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(b){var m;this.isStreamingSupported||(m=this.onProgress)==null||m.call(this,{loaded:b.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const b=new n.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=U(1),d=U(20);const V=/^file:\/\/\/[a-zA-Z]:\//;function W(E){const g=require$$5,u=g.parse(E);return u.protocol==="file:"||u.host?u:/^[a-z]:[/\\]/i.test(E)?g.parse(`file:///${E}`):(u.host||(u.protocol="file:"),u)}class dt{constructor(g){this.source=g,this.url=W(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new b(this):new N(this),this._fullRequestReader}getRangeReader(g,u){if(u<=this._progressiveDataLength)return null;const y=this.isFsUrl?new m(this,g,u):new I(this,g,u);return this._rangeRequestReaders.push(y),y}cancelAllRequests(g){var u;(u=this._fullRequestReader)==null||u.cancel(g);for(const y of this._rangeRequestReaders.slice(0))y.cancel(g)}}e.PDFNodeStream=dt;class x{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=g.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class P{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const u=g.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function p(E,g){return{protocol:E.protocol,auth:E.auth,host:E.hostname,port:E.port,path:E.path,method:"GET",headers:g}}class N extends x{constructor(g){super(g);const u=y=>{if(y.statusCode===404){const h=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=h,this._headersCapability.reject(h);return}this._headersCapability.resolve(),this._setReadableStream(y);const M=h=>this._readableStream.headers[h.toLowerCase()],{allowRangeRequests:A,suggestedLength:a}=(0,d.validateRangeRequestCapabilities)({getResponseHeader:M,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=a||this._contentLength,this._filename=(0,d.extractFilenameFromHeader)(M)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(p(this._url,g.httpHeaders),u)}else{const y=require$$5;this._request=y.request(p(this._url,g.httpHeaders),u)}this._request.on("error",y=>{this._storedError=y,this._headersCapability.reject(y)}),this._request.end()}}class I extends P{constructor(g,u,y){super(g),this._httpHeaders={};for(const A in g.httpHeaders){const a=g.httpHeaders[A];a!==void 0&&(this._httpHeaders[A]=a)}this._httpHeaders.Range=`bytes=${u}-${y-1}`;const M=A=>{if(A.statusCode===404){const a=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=a;return}this._setReadableStream(A)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(p(this._url,this._httpHeaders),M)}else{const A=require$$5;this._request=A.request(p(this._url,this._httpHeaders),M)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}}class b extends x{constructor(g){super(g);let u=decodeURIComponent(this._url.path);V.test(this._url.href)&&(u=u.replace(/^\//,""));const y=require$$5;y.lstat(u,(M,A)=>{if(M){M.code==="ENOENT"&&(M=new n.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=M,this._headersCapability.reject(M);return}this._contentLength=A.size,this._setReadableStream(y.createReadStream(u)),this._headersCapability.resolve()})}}class m extends P{constructor(g,u,y){super(g);let M=decodeURIComponent(this._url.path);V.test(this._url.href)&&(M=M.replace(/^\//,""));const A=require$$5;this._setReadableStream(A.createReadStream(M,{start:u,end:y-1}))}}},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=U(6),d=U(1);const V={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},W="http://www.w3.org/XML/1998/namespace",dt="http://www.w3.org/1999/xlink",x=["butt","round","square"],P=["miter","round","bevel"],p=function(A,a="",h=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!h)return URL.createObjectURL(new Blob([A],{type:a}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let l=`data:${a};base64,`;for(let c=0,O=A.length;c<O;c+=3){const r=A[c]&255,v=A[c+1]&255,C=A[c+2]&255,tt=r>>2,$=(r&3)<<4|v>>4,K=c+1<O?(v&15)<<2|C>>6:64,H=c+2<O?C&63:64;l+=o[tt]+o[$]+o[K]+o[H]}return l},N=function(){const A=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,h=new Int32Array(256);for(let C=0;C<256;C++){let tt=C;for(let $=0;$<8;$++)tt=tt&1?3988292384^tt>>1&2147483647:tt>>1&2147483647;h[C]=tt}function o(C,tt,$){let K=-1;for(let H=tt;H<$;H++){const it=(K^C[H])&255,w=h[it];K=K>>>8^w}return K^-1}function l(C,tt,$,K){let H=K;const it=tt.length;$[H]=it>>24&255,$[H+1]=it>>16&255,$[H+2]=it>>8&255,$[H+3]=it&255,H+=4,$[H]=C.charCodeAt(0)&255,$[H+1]=C.charCodeAt(1)&255,$[H+2]=C.charCodeAt(2)&255,$[H+3]=C.charCodeAt(3)&255,H+=4,$.set(tt,H),H+=tt.length;const w=o($,K+4,H);$[H]=w>>24&255,$[H+1]=w>>16&255,$[H+2]=w>>8&255,$[H+3]=w&255}function c(C,tt,$){let K=1,H=0;for(let it=tt;it<$;++it)K=(K+(C[it]&255))%65521,H=(H+K)%65521;return H<<16|K}function O(C){if(!d.isNodeJS)return r(C);try{const tt=parseInt(process.versions.node)>=8?C:Buffer.from(C),$=require$$5.deflateSync(tt,{level:9});return $ instanceof Uint8Array?$:new Uint8Array($)}catch(tt){(0,d.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+tt)}return r(C)}function r(C){let tt=C.length;const $=65535,K=Math.ceil(tt/$),H=new Uint8Array(2+tt+K*5+4);let it=0;H[it++]=120,H[it++]=156;let w=0;for(;tt>$;)H[it++]=0,H[it++]=255,H[it++]=255,H[it++]=0,H[it++]=0,H.set(C.subarray(w,w+$),it),it+=$,w+=$,tt-=$;H[it++]=1,H[it++]=tt&255,H[it++]=tt>>8&255,H[it++]=~tt&65535&255,H[it++]=(~tt&65535)>>8&255,H.set(C.subarray(w),it),it+=C.length-w;const G=c(C,0,C.length);return H[it++]=G>>24&255,H[it++]=G>>16&255,H[it++]=G>>8&255,H[it++]=G&255,H}function v(C,tt,$,K){const H=C.width,it=C.height;let w,G,et;const S=C.data;switch(tt){case d.ImageKind.GRAYSCALE_1BPP:G=0,w=1,et=H+7>>3;break;case d.ImageKind.RGB_24BPP:G=2,w=8,et=H*3;break;case d.ImageKind.RGBA_32BPP:G=6,w=8,et=H*4;break;default:throw new Error("invalid format")}const s=new Uint8Array((1+et)*it);let i=0,f=0;for(let ct=0;ct<it;++ct)s[i++]=0,s.set(S.subarray(f,f+et),i),f+=et,i+=et;if(tt===d.ImageKind.GRAYSCALE_1BPP&&K){i=0;for(let ct=0;ct<it;ct++){i++;for(let ft=0;ft<et;ft++)s[i++]^=255}}const k=new Uint8Array([H>>24&255,H>>16&255,H>>8&255,H&255,it>>24&255,it>>16&255,it>>8&255,it&255,w,G,0,0,0]),F=O(s),D=A.length+a*3+k.length+F.length,q=new Uint8Array(D);let nt=0;return q.set(A,nt),nt+=A.length,l("IHDR",k,q,nt),nt+=a+k.length,l("IDATA",F,q,nt),nt+=a+F.length,l("IEND",new Uint8Array(0),q,nt),p(q,"image/png",$)}return function(tt,$,K){const H=tt.kind===void 0?d.ImageKind.GRAYSCALE_1BPP:tt.kind;return v(tt,H,$,K)}}();class I{constructor(){this.fontSizeScale=1,this.fontWeight=V.fontWeight,this.fontSize=0,this.textMatrix=d.IDENTITY_MATRIX,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=d.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=V.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,h){this.x=a,this.y=h}}function b(A){let a=[];const h=[];for(const o of A){if(o.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),h.push(a),a=a.at(-1).items;continue}o.fn==="restore"?a=h.pop():a.push(o)}return a}function m(A){if(Number.isInteger(A))return A.toString();const a=A.toFixed(10);let h=a.length-1;if(a[h]!=="0")return a;do h--;while(a[h]==="0");return a.substring(0,a[h]==="."?h:h+1)}function E(A){if(A[4]===0&&A[5]===0){if(A[1]===0&&A[2]===0)return A[0]===1&&A[3]===1?"":`scale(${m(A[0])} ${m(A[3])})`;if(A[0]===A[3]&&A[1]===-A[2]){const a=Math.acos(A[0])*180/Math.PI;return`rotate(${m(a)})`}}else if(A[0]===1&&A[1]===0&&A[2]===0&&A[3]===1)return`translate(${m(A[4])} ${m(A[5])})`;return`matrix(${m(A[0])} ${m(A[1])} ${m(A[2])} ${m(A[3])} ${m(A[4])} ${m(A[5])})`}let g=0,u=0,y=0;class M{constructor(a,h,o=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new I,this.transformMatrix=d.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=a,this.objs=h,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const l in d.OPS)this._operatorIdMapping[d.OPS[l]]=l}getObject(a,h=null){return typeof a=="string"?a.startsWith("g_")?this.commonObjs.get(a):this.objs.get(a):h}save(){this.transformStack.push(this.transformMatrix);const a=this.current;this.extraStack.push(a),this.current=a.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(a){this.save(),this.executeOpTree(a),this.restore()}loadDependencies(a){const h=a.fnArray,o=a.argsArray;for(let l=0,c=h.length;l<c;l++)if(h[l]===d.OPS.dependency)for(const O of o[l]){const r=O.startsWith("g_")?this.commonObjs:this.objs,v=new Promise(C=>{r.get(O,C)});this.current.dependencies.push(v)}return Promise.all(this.current.dependencies)}transform(a,h,o,l,c,O){const r=[a,h,o,l,c,O];this.transformMatrix=d.Util.transform(this.transformMatrix,r),this.tgrp=null}getSVG(a,h){this.viewport=h;const o=this._initialize(h);return this.loadDependencies(a).then(()=>(this.transformMatrix=d.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(a)),o))}convertOpList(a){const h=this._operatorIdMapping,o=a.argsArray,l=a.fnArray,c=[];for(let O=0,r=l.length;O<r;O++){const v=l[O];c.push({fnId:v,fn:h[v],args:o[O]})}return b(c)}executeOpTree(a){for(const h of a){const o=h.fn,l=h.fnId,c=h.args;switch(l|0){case d.OPS.beginText:this.beginText();break;case d.OPS.dependency:break;case d.OPS.setLeading:this.setLeading(c);break;case d.OPS.setLeadingMoveText:this.setLeadingMoveText(c[0],c[1]);break;case d.OPS.setFont:this.setFont(c);break;case d.OPS.showText:this.showText(c[0]);break;case d.OPS.showSpacedText:this.showText(c[0]);break;case d.OPS.endText:this.endText();break;case d.OPS.moveText:this.moveText(c[0],c[1]);break;case d.OPS.setCharSpacing:this.setCharSpacing(c[0]);break;case d.OPS.setWordSpacing:this.setWordSpacing(c[0]);break;case d.OPS.setHScale:this.setHScale(c[0]);break;case d.OPS.setTextMatrix:this.setTextMatrix(c[0],c[1],c[2],c[3],c[4],c[5]);break;case d.OPS.setTextRise:this.setTextRise(c[0]);break;case d.OPS.setTextRenderingMode:this.setTextRenderingMode(c[0]);break;case d.OPS.setLineWidth:this.setLineWidth(c[0]);break;case d.OPS.setLineJoin:this.setLineJoin(c[0]);break;case d.OPS.setLineCap:this.setLineCap(c[0]);break;case d.OPS.setMiterLimit:this.setMiterLimit(c[0]);break;case d.OPS.setFillRGBColor:this.setFillRGBColor(c[0],c[1],c[2]);break;case d.OPS.setStrokeRGBColor:this.setStrokeRGBColor(c[0],c[1],c[2]);break;case d.OPS.setStrokeColorN:this.setStrokeColorN(c);break;case d.OPS.setFillColorN:this.setFillColorN(c);break;case d.OPS.shadingFill:this.shadingFill(c[0]);break;case d.OPS.setDash:this.setDash(c[0],c[1]);break;case d.OPS.setRenderingIntent:this.setRenderingIntent(c[0]);break;case d.OPS.setFlatness:this.setFlatness(c[0]);break;case d.OPS.setGState:this.setGState(c[0]);break;case d.OPS.fill:this.fill();break;case d.OPS.eoFill:this.eoFill();break;case d.OPS.stroke:this.stroke();break;case d.OPS.fillStroke:this.fillStroke();break;case d.OPS.eoFillStroke:this.eoFillStroke();break;case d.OPS.clip:this.clip("nonzero");break;case d.OPS.eoClip:this.clip("evenodd");break;case d.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case d.OPS.paintImageXObject:this.paintImageXObject(c[0]);break;case d.OPS.paintInlineImageXObject:this.paintInlineImageXObject(c[0]);break;case d.OPS.paintImageMaskXObject:this.paintImageMaskXObject(c[0]);break;case d.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(c[0],c[1]);break;case d.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case d.OPS.closePath:this.closePath();break;case d.OPS.closeStroke:this.closeStroke();break;case d.OPS.closeFillStroke:this.closeFillStroke();break;case d.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case d.OPS.nextLine:this.nextLine();break;case d.OPS.transform:this.transform(c[0],c[1],c[2],c[3],c[4],c[5]);break;case d.OPS.constructPath:this.constructPath(c[0],c[1]);break;case d.OPS.endPath:this.endPath();break;case 92:this.group(h.items);break;default:(0,d.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(a){this.current.wordSpacing=a}setCharSpacing(a){this.current.charSpacing=a}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(a,h,o,l,c,O){const r=this.current;r.textMatrix=r.lineMatrix=[a,h,o,l,c,O],r.textMatrixScale=Math.hypot(a,h),r.x=r.lineX=0,r.y=r.lineY=0,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${m(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",m(-r.y)),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtElement.append(r.tspan)}beginText(){const a=this.current;a.x=a.lineX=0,a.y=a.lineY=0,a.textMatrix=d.IDENTITY_MATRIX,a.lineMatrix=d.IDENTITY_MATRIX,a.textMatrixScale=1,a.tspan=this.svgFactory.createElement("svg:tspan"),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtgrp=this.svgFactory.createElement("svg:g"),a.xcoords=[],a.ycoords=[]}moveText(a,h){const o=this.current;o.x=o.lineX+=a,o.y=o.lineY+=h,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${m(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",m(-o.y))}showText(a){const h=this.current,o=h.font,l=h.fontSize;if(l===0)return;const c=h.fontSizeScale,O=h.charSpacing,r=h.wordSpacing,v=h.fontDirection,C=h.textHScale*v,tt=o.vertical,$=tt?1:-1,K=o.defaultVMetrics,H=l*h.fontMatrix[0];let it=0;for(const et of a){if(et===null){it+=v*r;continue}else if(typeof et=="number"){it+=$*et*l/1e3;continue}const S=(et.isSpace?r:0)+O,s=et.fontChar;let i,f,k=et.width;if(tt){let D;const q=et.vmetric||K;D=et.vmetric?q[1]:k*.5,D=-D*H;const nt=q[2]*H;k=q?-q[0]:k,i=D/c,f=(it+nt)/c}else i=it/c,f=0;(et.isInFont||o.missingFile)&&(h.xcoords.push(h.x+i),tt&&h.ycoords.push(-h.y+f),h.tspan.textContent+=s);const F=tt?k*H-S*v:k*H+S*v;it+=F}h.tspan.setAttributeNS(null,"x",h.xcoords.map(m).join(" ")),tt?h.tspan.setAttributeNS(null,"y",h.ycoords.map(m).join(" ")):h.tspan.setAttributeNS(null,"y",m(-h.y)),tt?h.y-=it:h.x+=it*C,h.tspan.setAttributeNS(null,"font-family",h.fontFamily),h.tspan.setAttributeNS(null,"font-size",`${m(h.fontSize)}px`),h.fontStyle!==V.fontStyle&&h.tspan.setAttributeNS(null,"font-style",h.fontStyle),h.fontWeight!==V.fontWeight&&h.tspan.setAttributeNS(null,"font-weight",h.fontWeight);const w=h.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;if(w===d.TextRenderingMode.FILL||w===d.TextRenderingMode.FILL_STROKE?(h.fillColor!==V.fillColor&&h.tspan.setAttributeNS(null,"fill",h.fillColor),h.fillAlpha<1&&h.tspan.setAttributeNS(null,"fill-opacity",h.fillAlpha)):h.textRenderingMode===d.TextRenderingMode.ADD_TO_PATH?h.tspan.setAttributeNS(null,"fill","transparent"):h.tspan.setAttributeNS(null,"fill","none"),w===d.TextRenderingMode.STROKE||w===d.TextRenderingMode.FILL_STROKE){const et=1/(h.textMatrixScale||1);this._setStrokeAttributes(h.tspan,et)}let G=h.textMatrix;h.textRise!==0&&(G=G.slice(),G[5]+=h.textRise),h.txtElement.setAttributeNS(null,"transform",`${E(G)} scale(${m(C)}, -1)`),h.txtElement.setAttributeNS(W,"xml:space","preserve"),h.txtElement.append(h.tspan),h.txtgrp.append(h.txtElement),this._ensureTransformGroup().append(h.txtElement)}setLeadingMoveText(a,h){this.setLeading(-h),this.moveText(a,h)}addFontStyle(a){if(!a.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const h=p(a.data,a.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${a.loadedName}"; src: url(${h}); }
`}setFont(a){const h=this.current,o=this.commonObjs.get(a[0]);let l=a[1];h.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),h.fontMatrix=o.fontMatrix||d.FONT_IDENTITY_MATRIX;let c="normal";o.black?c="900":o.bold&&(c="bold");const O=o.italic?"italic":"normal";l<0?(l=-l,h.fontDirection=-1):h.fontDirection=1,h.fontSize=l,h.fontFamily=o.loadedName,h.fontWeight=c,h.fontStyle=O,h.tspan=this.svgFactory.createElement("svg:tspan"),h.tspan.setAttributeNS(null,"y",m(-h.y)),h.xcoords=[],h.ycoords=[]}endText(){var h;const a=this.current;a.textRenderingMode&d.TextRenderingMode.ADD_TO_PATH_FLAG&&((h=a.txtElement)!=null&&h.hasChildNodes())&&(a.element=a.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(a){a>0&&(this.current.lineWidth=a)}setLineCap(a){this.current.lineCap=x[a]}setLineJoin(a){this.current.lineJoin=P[a]}setMiterLimit(a){this.current.miterLimit=a}setStrokeAlpha(a){this.current.strokeAlpha=a}setStrokeRGBColor(a,h,o){this.current.strokeColor=d.Util.makeHexColor(a,h,o)}setFillAlpha(a){this.current.fillAlpha=a}setFillRGBColor(a,h,o){this.current.fillColor=d.Util.makeHexColor(a,h,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(a){this.current.strokeColor=this._makeColorN_Pattern(a)}setFillColorN(a){this.current.fillColor=this._makeColorN_Pattern(a)}shadingFill(a){const{width:h,height:o}=this.viewport,l=d.Util.inverseTransform(this.transformMatrix),[c,O,r,v]=d.Util.getAxialAlignedBoundingBox([0,0,h,o],l),C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x",c),C.setAttributeNS(null,"y",O),C.setAttributeNS(null,"width",r-c),C.setAttributeNS(null,"height",v-O),C.setAttributeNS(null,"fill",this._makeShadingPattern(a)),this.current.fillAlpha<1&&C.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(C)}_makeColorN_Pattern(a){return a[0]==="TilingPattern"?this._makeTilingPattern(a):this._makeShadingPattern(a)}_makeTilingPattern(a){const h=a[1],o=a[2],l=a[3]||d.IDENTITY_MATRIX,[c,O,r,v]=a[4],C=a[5],tt=a[6],$=a[7],K=`shading${y++}`,[H,it,w,G]=d.Util.normalizeRect([...d.Util.applyTransform([c,O],l),...d.Util.applyTransform([r,v],l)]),[et,S]=d.Util.singularValueDecompose2dScale(l),s=C*et,i=tt*S,f=this.svgFactory.createElement("svg:pattern");f.setAttributeNS(null,"id",K),f.setAttributeNS(null,"patternUnits","userSpaceOnUse"),f.setAttributeNS(null,"width",s),f.setAttributeNS(null,"height",i),f.setAttributeNS(null,"x",`${H}`),f.setAttributeNS(null,"y",`${it}`);const k=this.svg,F=this.transformMatrix,D=this.current.fillColor,q=this.current.strokeColor,nt=this.svgFactory.create(w-H,G-it);if(this.svg=nt,this.transformMatrix=l,$===2){const ct=d.Util.makeHexColor(...h);this.current.fillColor=ct,this.current.strokeColor=ct}return this.executeOpTree(this.convertOpList(o)),this.svg=k,this.transformMatrix=F,this.current.fillColor=D,this.current.strokeColor=q,f.append(nt.childNodes[0]),this.defs.append(f),`url(#${K})`}_makeShadingPattern(a){switch(typeof a=="string"&&(a=this.objs.get(a)),a[0]){case"RadialAxial":const h=`shading${y++}`,o=a[3];let l;switch(a[1]){case"axial":const c=a[4],O=a[5];l=this.svgFactory.createElement("svg:linearGradient"),l.setAttributeNS(null,"id",h),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"x1",c[0]),l.setAttributeNS(null,"y1",c[1]),l.setAttributeNS(null,"x2",O[0]),l.setAttributeNS(null,"y2",O[1]);break;case"radial":const r=a[4],v=a[5],C=a[6],tt=a[7];l=this.svgFactory.createElement("svg:radialGradient"),l.setAttributeNS(null,"id",h),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"cx",v[0]),l.setAttributeNS(null,"cy",v[1]),l.setAttributeNS(null,"r",tt),l.setAttributeNS(null,"fx",r[0]),l.setAttributeNS(null,"fy",r[1]),l.setAttributeNS(null,"fr",C);break;default:throw new Error(`Unknown RadialAxial type: ${a[1]}`)}for(const c of o){const O=this.svgFactory.createElement("svg:stop");O.setAttributeNS(null,"offset",c[0]),O.setAttributeNS(null,"stop-color",c[1]),l.append(O)}return this.defs.append(l),`url(#${h})`;case"Mesh":return(0,d.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${a[0]}`)}}setDash(a,h){this.current.dashArray=a,this.current.dashPhase=h}constructPath(a,h){const o=this.current;let l=o.x,c=o.y,O=[],r=0;for(const v of a)switch(v|0){case d.OPS.rectangle:l=h[r++],c=h[r++];const C=h[r++],tt=h[r++],$=l+C,K=c+tt;O.push("M",m(l),m(c),"L",m($),m(c),"L",m($),m(K),"L",m(l),m(K),"Z");break;case d.OPS.moveTo:l=h[r++],c=h[r++],O.push("M",m(l),m(c));break;case d.OPS.lineTo:l=h[r++],c=h[r++],O.push("L",m(l),m(c));break;case d.OPS.curveTo:l=h[r+4],c=h[r+5],O.push("C",m(h[r]),m(h[r+1]),m(h[r+2]),m(h[r+3]),m(l),m(c)),r+=6;break;case d.OPS.curveTo2:O.push("C",m(l),m(c),m(h[r]),m(h[r+1]),m(h[r+2]),m(h[r+3])),l=h[r+2],c=h[r+3],r+=4;break;case d.OPS.curveTo3:l=h[r+2],c=h[r+3],O.push("C",m(h[r]),m(h[r+1]),m(l),m(c),m(l),m(c)),r+=4;break;case d.OPS.closePath:O.push("Z");break}O=O.join(" "),o.path&&a.length>0&&a[0]!==d.OPS.rectangle&&a[0]!==d.OPS.moveTo?O=o.path.getAttributeNS(null,"d")+O:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",O),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(l,c)}endPath(){const a=this.current;if(a.path=null,!this.pendingClip)return;if(!a.element){this.pendingClip=null;return}const h=`clippath${g++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",h),o.setAttributeNS(null,"transform",E(this.transformMatrix));const l=a.element.cloneNode(!0);if(this.pendingClip==="evenodd"?l.setAttributeNS(null,"clip-rule","evenodd"):l.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(l),this.defs.append(o),a.activeClipUrl){a.clipGroup=null;for(const c of this.extraStack)c.clipGroup=null;o.setAttributeNS(null,"clip-path",a.activeClipUrl)}a.activeClipUrl=`url(#${h})`,this.tgrp=null}clip(a){this.pendingClip=a}closePath(){const a=this.current;if(a.path){const h=`${a.path.getAttributeNS(null,"d")}Z`;a.path.setAttributeNS(null,"d",h)}}setLeading(a){this.current.leading=-a}setTextRise(a){this.current.textRise=a}setTextRenderingMode(a){this.current.textRenderingMode=a}setHScale(a){this.current.textHScale=a/100}setRenderingIntent(a){}setFlatness(a){}setGState(a){for(const[h,o]of a)switch(h){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,d.warn)(`Unimplemented graphic state operator ${h}`);break}}fill(){const a=this.current;a.element&&(a.element.setAttributeNS(null,"fill",a.fillColor),a.element.setAttributeNS(null,"fill-opacity",a.fillAlpha),this.endPath())}stroke(){const a=this.current;a.element&&(this._setStrokeAttributes(a.element),a.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(a,h=1){const o=this.current;let l=o.dashArray;h!==1&&l.length>0&&(l=l.map(function(c){return h*c})),a.setAttributeNS(null,"stroke",o.strokeColor),a.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),a.setAttributeNS(null,"stroke-miterlimit",m(o.miterLimit)),a.setAttributeNS(null,"stroke-linecap",o.lineCap),a.setAttributeNS(null,"stroke-linejoin",o.lineJoin),a.setAttributeNS(null,"stroke-width",m(h*o.lineWidth)+"px"),a.setAttributeNS(null,"stroke-dasharray",l.map(m).join(" ")),a.setAttributeNS(null,"stroke-dashoffset",m(h*o.dashPhase)+"px")}eoFill(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var a;(a=this.current.element)==null||a.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width","1px"),a.setAttributeNS(null,"height","1px"),a.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(a)}paintImageXObject(a){const h=this.getObject(a);if(!h){(0,d.warn)(`Dependent image with object ID ${a} is not ready yet`);return}this.paintInlineImageXObject(h)}paintInlineImageXObject(a,h){const o=a.width,l=a.height,c=N(a,this.forceDataSchema,!!h),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",m(o)),O.setAttributeNS(null,"height",m(l)),this.current.element=O,this.clip("nonzero");const r=this.svgFactory.createElement("svg:image");r.setAttributeNS(dt,"xlink:href",c),r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y",m(-l)),r.setAttributeNS(null,"width",m(o)+"px"),r.setAttributeNS(null,"height",m(l)+"px"),r.setAttributeNS(null,"transform",`scale(${m(1/o)} ${m(-1/l)})`),h?h.append(r):this._ensureTransformGroup().append(r)}paintImageMaskXObject(a){const h=this.getObject(a.data,a);if(h.bitmap){(0,d.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const o=this.current,l=h.width,c=h.height,O=o.fillColor;o.maskId=`mask${u++}`;const r=this.svgFactory.createElement("svg:mask");r.setAttributeNS(null,"id",o.maskId);const v=this.svgFactory.createElement("svg:rect");v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y","0"),v.setAttributeNS(null,"width",m(l)),v.setAttributeNS(null,"height",m(c)),v.setAttributeNS(null,"fill",O),v.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(r),this._ensureTransformGroup().append(v),this.paintInlineImageXObject(h,r)}paintFormXObjectBegin(a,h){if(Array.isArray(a)&&a.length===6&&this.transform(a[0],a[1],a[2],a[3],a[4],a[5]),h){const o=h[2]-h[0],l=h[3]-h[1],c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",h[0]),c.setAttributeNS(null,"y",h[1]),c.setAttributeNS(null,"width",m(o)),c.setAttributeNS(null,"height",m(l)),this.current.element=c,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(a){const h=this.svgFactory.create(a.width,a.height),o=this.svgFactory.createElement("svg:defs");h.append(o),this.defs=o;const l=this.svgFactory.createElement("svg:g");return l.setAttributeNS(null,"transform",E(a.transform)),h.append(l),this.svg=l,h}_ensureClipGroup(){if(!this.current.clipGroup){const a=this.svgFactory.createElement("svg:g");a.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(a),this.current.clipGroup=a}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",E(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=M},(B,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class U{static textContent(d){const V=[],W={items:V,styles:Object.create(null)};function dt(x){var N;if(!x)return;let P=null;const p=x.name;if(p==="#text")P=x.value;else if(U.shouldBuildText(p))(N=x==null?void 0:x.attributes)!=null&&N.textContent?P=x.attributes.textContent:x.value&&(P=x.value);else return;if(P!==null&&V.push({str:P}),!!x.children)for(const I of x.children)dt(I)}return dt(d),W}static shouldBuildText(d){return!(d==="textarea"||d==="input"||d==="option"||d==="select")}}e.XfaText=U},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=E,e.updateTextLayer=g;var n=U(1),d=U(6);const V=1e5,W=30,dt=.8,x=new Map;function P(u,y){let M;if(y&&n.FeatureTest.isOffscreenCanvasSupported)M=new OffscreenCanvas(u,u).getContext("2d",{alpha:!1});else{const A=document.createElement("canvas");A.width=A.height=u,M=A.getContext("2d",{alpha:!1})}return M}function p(u,y){const M=x.get(u);if(M)return M;const A=P(W,y);A.font=`${W}px ${u}`;const a=A.measureText("");let h=a.fontBoundingBoxAscent,o=Math.abs(a.fontBoundingBoxDescent);if(h){const c=h/(h+o);return x.set(u,c),A.canvas.width=A.canvas.height=0,c}A.strokeStyle="red",A.clearRect(0,0,W,W),A.strokeText("g",0,0);let l=A.getImageData(0,0,W,W).data;o=0;for(let c=l.length-1-3;c>=0;c-=4)if(l[c]>0){o=Math.ceil(c/4/W);break}A.clearRect(0,0,W,W),A.strokeText("A",0,W),l=A.getImageData(0,0,W,W).data,h=0;for(let c=0,O=l.length;c<O;c+=4)if(l[c]>0){h=W-Math.floor(c/4/W);break}if(A.canvas.width=A.canvas.height=0,h){const c=h/(h+o);return x.set(u,c),c}return x.set(u,dt),dt}function N(u,y,M){const A=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL,fontSize:0};u._textDivs.push(A);const h=n.Util.transform(u._transform,y.transform);let o=Math.atan2(h[1],h[0]);const l=M[y.fontName];l.vertical&&(o+=Math.PI/2);const c=Math.hypot(h[2],h[3]),O=c*p(l.fontFamily,u._isOffscreenCanvasSupported);let r,v;o===0?(r=h[4],v=h[5]-O):(r=h[4]+O*Math.sin(o),v=h[5]-O*Math.cos(o));const C="calc(var(--scale-factor)*",tt=A.style;u._container===u._rootContainer?(tt.left=`${(100*r/u._pageWidth).toFixed(2)}%`,tt.top=`${(100*v/u._pageHeight).toFixed(2)}%`):(tt.left=`${C}${r.toFixed(2)}px)`,tt.top=`${C}${v.toFixed(2)}px)`),tt.fontSize=`${C}${c.toFixed(2)}px)`,tt.fontFamily=l.fontFamily,a.fontSize=c,A.setAttribute("role","presentation"),A.textContent=y.str,A.dir=y.dir,u._fontInspectorEnabled&&(A.dataset.fontName=y.fontName),o!==0&&(a.angle=o*(180/Math.PI));let $=!1;if(y.str.length>1)$=!0;else if(y.str!==" "&&y.transform[0]!==y.transform[3]){const K=Math.abs(y.transform[0]),H=Math.abs(y.transform[3]);K!==H&&Math.max(K,H)/Math.min(K,H)>1.5&&($=!0)}$&&(a.canvasWidth=l.vertical?y.height:y.width),u._textDivProperties.set(A,a),u._isReadableStream&&u._layoutText(A)}function I(u){const{div:y,scale:M,properties:A,ctx:a,prevFontSize:h,prevFontFamily:o}=u,{style:l}=y;let c="";if(A.canvasWidth!==0&&A.hasText){const{fontFamily:O}=l,{canvasWidth:r,fontSize:v}=A;(h!==v||o!==O)&&(a.font=`${v*M}px ${O}`,u.prevFontSize=v,u.prevFontFamily=O);const{width:C}=a.measureText(y.textContent);C>0&&(c=`scaleX(${r*M/C})`)}A.angle!==0&&(c=`rotate(${A.angle}deg) ${c}`),c.length>0&&(l.transform=c)}function b(u){if(u._canceled)return;const y=u._textDivs,M=u._capability;if(y.length>V){M.resolve();return}if(!u._isReadableStream)for(const a of y)u._layoutText(a);M.resolve()}class m{constructor({textContentSource:y,container:M,viewport:A,textDivs:a,textDivProperties:h,textContentItemsStr:o,isOffscreenCanvasSupported:l}){var C;this._textContentSource=y,this._isReadableStream=y instanceof ReadableStream,this._container=this._rootContainer=M,this._textDivs=a||[],this._textContentItemsStr=o||[],this._isOffscreenCanvasSupported=l,this._fontInspectorEnabled=!!((C=globalThis.FontInspector)!=null&&C.enabled),this._reader=null,this._textDivProperties=h||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:P(0,l)};const{pageWidth:c,pageHeight:O,pageX:r,pageY:v}=A.rawDims;this._transform=[1,0,0,-1,-r,v+O],this._pageWidth=c,this._pageHeight=O,(0,d.setLayerDimensions)(M,A),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(y,M){for(const A of y){if(A.str===void 0){if(A.type==="beginMarkedContentProps"||A.type==="beginMarkedContent"){const a=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),A.id!==null&&this._container.setAttribute("id",`${A.id}`),a.append(this._container)}else A.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(A.str),N(this,A,M)}}_layoutText(y){const M=this._layoutTextParams.properties=this._textDivProperties.get(y);if(this._layoutTextParams.div=y,I(this._layoutTextParams),M.hasText&&this._container.append(y),M.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){const y=new n.PromiseCapability;let M=Object.create(null);if(this._isReadableStream){const A=()=>{this._reader.read().then(({value:a,done:h})=>{if(h){y.resolve();return}Object.assign(M,a.styles),this._processItems(a.items,M),A()},y.reject)};this._reader=this._textContentSource.getReader(),A()}else if(this._textContentSource){const{items:A,styles:a}=this._textContentSource;this._processItems(A,a),y.resolve()}else throw new Error('No "textContentSource" parameter specified.');y.promise.then(()=>{M=null,b(this)},this._capability.reject)}}e.TextLayerRenderTask=m;function E(u){!u.textContentSource&&(u.textContent||u.textContentStream)&&((0,d.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),u.textContentSource=u.textContent||u.textContentStream);const{container:y,viewport:M}=u,A=getComputedStyle(y),a=A.getPropertyValue("visibility"),h=parseFloat(A.getPropertyValue("--scale-factor"));a==="visible"&&(!h||Math.abs(h-M.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new m(u);return o._render(),o}function g({container:u,viewport:y,textDivs:M,textDivProperties:A,isOffscreenCanvasSupported:a,mustRotate:h=!0,mustRescale:o=!0}){if(h&&(0,d.setLayerDimensions)(u,{rotation:y.rotation}),o){const l=P(0,a),O={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l};for(const r of M)O.properties=A.get(r),O.div=r,I(O)}}},(B,e,U)=>{var p,N,I,b,m,E,g,u,y,M,A,Ke,Te,Je,Qe;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=U(1),d=U(4),V=U(28),W=U(33),dt=U(6),x=U(34);const c=class c{constructor({uiManager:r,pageIndex:v,div:C,accessibilityManager:tt,annotationLayer:$,viewport:K,l10n:H}){rt(this,A);rt(this,p);rt(this,N,!1);rt(this,I,null);rt(this,b,this.pointerup.bind(this));rt(this,m,this.pointerdown.bind(this));rt(this,E,new Map);rt(this,g,!1);rt(this,u,!1);rt(this,y,!1);rt(this,M);const it=[V.FreeTextEditor,W.InkEditor,x.StampEditor];if(!c._initialized){c._initialized=!0;for(const w of it)w.initialize(H)}r.registerEditorTypes(it),ot(this,M,r),this.pageIndex=v,this.div=C,ot(this,p,tt),ot(this,I,$),this.viewport=K,t(this,M).addLayer(this)}get isEmpty(){return t(this,E).size===0}updateToolbar(r){t(this,M).updateToolbar(r)}updateMode(r=t(this,M).getMode()){Y(this,A,Qe).call(this),r===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),r!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",r===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",r===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",r===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(r){if(!r&&t(this,M).getMode()!==n.AnnotationEditorType.INK)return;if(!r){for(const C of t(this,E).values())if(C.isEmpty()){C.setInBackground();return}}Y(this,A,Te).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(r){t(this,M).setEditingState(r)}addCommands(r){t(this,M).addCommands(r)}enable(){this.div.style.pointerEvents="auto";const r=new Set;for(const C of t(this,E).values())C.enableEditing(),C.annotationElementId&&r.add(C.annotationElementId);if(!t(this,I))return;const v=t(this,I).getEditableAnnotations();for(const C of v){if(C.hide(),t(this,M).isDeletedAnnotationElement(C.data.id)||r.has(C.data.id))continue;const tt=this.deserialize(C);tt&&(this.addOrRebuild(tt),tt.enableEditing())}}disable(){var v;ot(this,y,!0),this.div.style.pointerEvents="none";const r=new Set;for(const C of t(this,E).values()){if(C.disableEditing(),!C.annotationElementId||C.serialize()!==null){r.add(C.annotationElementId);continue}(v=this.getEditableAnnotation(C.annotationElementId))==null||v.show(),C.remove()}if(t(this,I)){const C=t(this,I).getEditableAnnotations();for(const tt of C){const{id:$}=tt.data;r.has($)||t(this,M).isDeletedAnnotationElement($)||tt.show()}}Y(this,A,Qe).call(this),this.isEmpty&&(this.div.hidden=!0),ot(this,y,!1)}getEditableAnnotation(r){var v;return((v=t(this,I))==null?void 0:v.getEditableAnnotation(r))||null}setActiveEditor(r){t(this,M).getActive()!==r&&t(this,M).setActiveEditor(r)}enableClick(){this.div.addEventListener("pointerdown",t(this,m)),this.div.addEventListener("pointerup",t(this,b))}disableClick(){this.div.removeEventListener("pointerdown",t(this,m)),this.div.removeEventListener("pointerup",t(this,b))}attach(r){t(this,E).set(r.id,r);const{annotationElementId:v}=r;v&&t(this,M).isDeletedAnnotationElement(v)&&t(this,M).removeDeletedAnnotationElement(r)}detach(r){var v;t(this,E).delete(r.id),(v=t(this,p))==null||v.removePointerInTextLayer(r.contentDiv),!t(this,y)&&r.annotationElementId&&t(this,M).addDeletedAnnotationElement(r)}remove(r){this.detach(r),t(this,M).removeEditor(r),r.div.contains(document.activeElement)&&setTimeout(()=>{t(this,M).focusMainContainer()},0),r.div.remove(),r.isAttachedToDOM=!1,t(this,u)||this.addInkEditorIfNeeded(!1)}changeParent(r){var v;r.parent!==this&&(r.annotationElementId&&(t(this,M).addDeletedAnnotationElement(r.annotationElementId),d.AnnotationEditor.deleteAnnotationElement(r),r.annotationElementId=null),this.attach(r),(v=r.parent)==null||v.detach(r),r.setParent(this),r.div&&r.isAttachedToDOM&&(r.div.remove(),this.div.append(r.div)))}add(r){if(this.changeParent(r),t(this,M).addEditor(r),this.attach(r),!r.isAttachedToDOM){const v=r.render();this.div.append(v),r.isAttachedToDOM=!0}r.fixAndSetPosition(),r.onceAdded(),t(this,M).addToAnnotationStorage(r)}moveEditorInDOM(r){var C;if(!r.isAttachedToDOM)return;const{activeElement:v}=document;r.div.contains(v)&&(r._focusEventsAllowed=!1,setTimeout(()=>{r.div.contains(document.activeElement)?r._focusEventsAllowed=!0:(r.div.addEventListener("focusin",()=>{r._focusEventsAllowed=!0},{once:!0}),v.focus())},0)),r._structTreeParentId=(C=t(this,p))==null?void 0:C.moveElementInDOM(this.div,r.div,r.contentDiv,!0)}addOrRebuild(r){r.needsToBeRebuilt()?r.rebuild():this.add(r)}addUndoableEditor(r){const v=()=>r._uiManager.rebuild(r),C=()=>{r.remove()};this.addCommands({cmd:v,undo:C,mustExec:!1})}getNextId(){return t(this,M).getId()}pasteEditor(r,v){t(this,M).updateToolbar(r),t(this,M).updateMode(r);const{offsetX:C,offsetY:tt}=Y(this,A,Je).call(this),$=this.getNextId(),K=Y(this,A,Ke).call(this,{parent:this,id:$,x:C,y:tt,uiManager:t(this,M),isCentered:!0,...v});K&&this.add(K)}deserialize(r){switch(r.annotationType??r.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return V.FreeTextEditor.deserialize(r,this,t(this,M));case n.AnnotationEditorType.INK:return W.InkEditor.deserialize(r,this,t(this,M));case n.AnnotationEditorType.STAMP:return x.StampEditor.deserialize(r,this,t(this,M))}return null}addNewEditor(){Y(this,A,Te).call(this,Y(this,A,Je).call(this),!0)}setSelected(r){t(this,M).setSelected(r)}toggleSelected(r){t(this,M).toggleSelected(r)}isSelected(r){return t(this,M).isSelected(r)}unselect(r){t(this,M).unselect(r)}pointerup(r){const{isMac:v}=n.FeatureTest.platform;if(!(r.button!==0||r.ctrlKey&&v)&&r.target===this.div&&t(this,g)){if(ot(this,g,!1),!t(this,N)){ot(this,N,!0);return}if(t(this,M).getMode()===n.AnnotationEditorType.STAMP){t(this,M).unselectAll();return}Y(this,A,Te).call(this,r,!1)}}pointerdown(r){if(t(this,g)){ot(this,g,!1);return}const{isMac:v}=n.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&v||r.target!==this.div)return;ot(this,g,!0);const C=t(this,M).getActive();ot(this,N,!C||C.isEmpty())}findNewParent(r,v,C){const tt=t(this,M).findParent(v,C);return tt===null||tt===this?!1:(tt.changeParent(r),!0)}destroy(){var r,v;((r=t(this,M).getActive())==null?void 0:r.parent)===this&&(t(this,M).commitOrRemove(),t(this,M).setActiveEditor(null));for(const C of t(this,E).values())(v=t(this,p))==null||v.removePointerInTextLayer(C.contentDiv),C.setParent(null),C.isAttachedToDOM=!1,C.div.remove();this.div=null,t(this,E).clear(),t(this,M).removeLayer(this)}render({viewport:r}){this.viewport=r,(0,dt.setLayerDimensions)(this.div,r);for(const v of t(this,M).getEditors(this.pageIndex))this.add(v);this.updateMode()}update({viewport:r}){t(this,M).commitOrRemove(),this.viewport=r,(0,dt.setLayerDimensions)(this.div,{rotation:r.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:r,pageHeight:v}=this.viewport.rawDims;return[r,v]}};p=new WeakMap,N=new WeakMap,I=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,M=new WeakMap,A=new WeakSet,Ke=function(r){switch(t(this,M).getMode()){case n.AnnotationEditorType.FREETEXT:return new V.FreeTextEditor(r);case n.AnnotationEditorType.INK:return new W.InkEditor(r);case n.AnnotationEditorType.STAMP:return new x.StampEditor(r)}return null},Te=function(r,v){const C=this.getNextId(),tt=Y(this,A,Ke).call(this,{parent:this,id:C,x:r.offsetX,y:r.offsetY,uiManager:t(this,M),isCentered:v});return tt&&this.add(tt),tt},Je=function(){const{x:r,y:v,width:C,height:tt}=this.div.getBoundingClientRect(),$=Math.max(0,r),K=Math.max(0,v),H=Math.min(window.innerWidth,r+C),it=Math.min(window.innerHeight,v+tt),w=($+H)/2-r,G=(K+it)/2-v,[et,S]=this.viewport.rotation%180===0?[w,G]:[G,w];return{offsetX:et,offsetY:S}},Qe=function(){ot(this,u,!0);for(const r of t(this,E).values())r.isEmpty()&&r.remove();ot(this,u,!1)},Kt(c,"_initialized",!1);let P=c;e.AnnotationEditorLayer=P},(B,e,U)=>{var x,P,p,N,I,b,m,E,g,u,xn,Cn,Rn,ge,Ze,kn,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=U(1),d=U(5),V=U(4),W=U(29);const c=class c extends V.AnnotationEditor{constructor(v){super({...v,name:"freeTextEditor"});rt(this,u);rt(this,x,this.editorDivBlur.bind(this));rt(this,P,this.editorDivFocus.bind(this));rt(this,p,this.editorDivInput.bind(this));rt(this,N,this.editorDivKeydown.bind(this));rt(this,I);rt(this,b,"");rt(this,m,`${this.id}-editor`);rt(this,E);rt(this,g,null);ot(this,I,v.color||c._defaultColor||V.AnnotationEditor._defaultLineColor),ot(this,E,v.fontSize||c._defaultFontSize)}static get _keyboardManager(){const v=c.prototype,C=K=>K.isEmpty(),tt=d.AnnotationEditorUIManager.TRANSLATE_SMALL,$=d.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new d.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],v.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],v.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],v._translateEmpty,{args:[-tt,0],checker:C}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],v._translateEmpty,{args:[-$,0],checker:C}],[["ArrowRight","mac+ArrowRight"],v._translateEmpty,{args:[tt,0],checker:C}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],v._translateEmpty,{args:[$,0],checker:C}],[["ArrowUp","mac+ArrowUp"],v._translateEmpty,{args:[0,-tt],checker:C}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],v._translateEmpty,{args:[0,-$],checker:C}],[["ArrowDown","mac+ArrowDown"],v._translateEmpty,{args:[0,tt],checker:C}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],v._translateEmpty,{args:[0,$],checker:C}]]))}static initialize(v){V.AnnotationEditor.initialize(v,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const C=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(C.getPropertyValue("--freetext-padding"))}static updateDefaultParams(v,C){switch(v){case n.AnnotationEditorParamsType.FREETEXT_SIZE:c._defaultFontSize=C;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:c._defaultColor=C;break}}updateParams(v,C){switch(v){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,u,xn).call(this,C);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,u,Cn).call(this,C);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,c._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,c._defaultColor||V.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,E)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,I)]]}_translateEmpty(v,C){this._uiManager.translateSelectedEditors(v,C,!0)}getInitialTranslation(){const v=this.parentScale;return[-c._internalPadding*v,-(c._internalPadding+t(this,E))*v]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,N)),this.editorDiv.addEventListener("focus",t(this,P)),this.editorDiv.addEventListener("blur",t(this,x)),this.editorDiv.addEventListener("input",t(this,p)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,m)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,N)),this.editorDiv.removeEventListener("focus",t(this,P)),this.editorDiv.removeEventListener("blur",t(this,x)),this.editorDiv.removeEventListener("input",t(this,p)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(v){this._focusEventsAllowed&&(super.focusin(v),v.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var v;if(this.width){Y(this,u,tn).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(v=this._initialOptions)!=null&&v.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const v=t(this,b),C=ot(this,b,Y(this,u,Rn).call(this).trimEnd());if(v===C)return;const tt=$=>{if(ot(this,b,$),!$){this.remove();return}Y(this,u,Ze).call(this),this._uiManager.rebuild(this),Y(this,u,ge).call(this)};this.addCommands({cmd:()=>{tt(C)},undo:()=>{tt(v)},mustExec:!1}),Y(this,u,ge).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(v){this.enterInEditMode()}keydown(v){v.target===this.div&&v.key==="Enter"&&(this.enterInEditMode(),v.preventDefault())}editorDivKeydown(v){c._keyboardManager.exec(this,v)}editorDivFocus(v){this.isEditing=!0}editorDivBlur(v){this.isEditing=!1}editorDivInput(v){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let v,C;this.width&&(v=this.x,C=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,m)),this.enableEditing(),V.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then($=>{var K;return(K=this.editorDiv)==null?void 0:K.setAttribute("aria-label",$)}),V.AnnotationEditor._l10nPromise.get("free_text2_default_content").then($=>{var K;return(K=this.editorDiv)==null?void 0:K.setAttribute("default-content",$)}),this.editorDiv.contentEditable=!0;const{style:tt}=this.editorDiv;if(tt.fontSize=`calc(${t(this,E)}px * var(--scale-factor))`,tt.color=t(this,I),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,d.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[$,K]=this.parentDimensions;if(this.annotationElementId){const{position:H}=t(this,g);let[it,w]=this.getInitialTranslation();[it,w]=this.pageTranslationToScreen(it,w);const[G,et]=this.pageDimensions,[S,s]=this.pageTranslation;let i,f;switch(this.rotation){case 0:i=v+(H[0]-S)/G,f=C+this.height-(H[1]-s)/et;break;case 90:i=v+(H[0]-S)/G,f=C-(H[1]-s)/et,[it,w]=[w,-it];break;case 180:i=v-this.width+(H[0]-S)/G,f=C-(H[1]-s)/et,[it,w]=[-it,-w];break;case 270:i=v+(H[0]-S-this.height*et)/G,f=C+(H[1]-s-this.width*G)/et,[it,w]=[-w,it];break}this.setAt(i*$,f*K,it,w)}else this.setAt(v*$,C*K,this.width*$,this.height*K);Y(this,u,Ze).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(v,C,tt){let $=null;if(v instanceof W.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:H,fontColor:it},rect:w,rotation:G,id:et},textContent:S,textPosition:s,parent:{page:{pageNumber:i}}}=v;if(!S||S.length===0)return null;$=v={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(it),fontSize:H,value:S.join(`
`),position:s,pageIndex:i-1,rect:w,rotation:G,id:et,deleted:!1}}const K=super.deserialize(v,C,tt);return ot(K,E,v.fontSize),ot(K,I,n.Util.makeHexColor(...v.color)),ot(K,b,v.value),K.annotationElementId=v.id||null,ot(K,g,$),K}serialize(v=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const C=c._internalPadding*this.parentScale,tt=this.getRect(C,C),$=V.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,I)),K={annotationType:n.AnnotationEditorType.FREETEXT,color:$,fontSize:t(this,E),value:t(this,b),pageIndex:this.pageIndex,rect:tt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return v?K:this.annotationElementId&&!Y(this,u,kn).call(this,K)?null:(K.id=this.annotationElementId,K)}};x=new WeakMap,P=new WeakMap,p=new WeakMap,N=new WeakMap,I=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakSet,xn=function(v){const C=$=>{this.editorDiv.style.fontSize=`calc(${$}px * var(--scale-factor))`,this.translate(0,-($-t(this,E))*this.parentScale),ot(this,E,$),Y(this,u,ge).call(this)},tt=t(this,E);this.addCommands({cmd:()=>{C(v)},undo:()=>{C(tt)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Cn=function(v){const C=t(this,I);this.addCommands({cmd:()=>{ot(this,I,this.editorDiv.style.color=v)},undo:()=>{ot(this,I,this.editorDiv.style.color=C)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Rn=function(){const v=this.editorDiv.getElementsByTagName("div");if(v.length===0)return this.editorDiv.innerText;const C=[];for(const tt of v)C.push(tt.innerText.replace(/\r\n?|\n/,""));return C.join(`
`)},ge=function(){const[v,C]=this.parentDimensions;let tt;if(this.isAttachedToDOM)tt=this.div.getBoundingClientRect();else{const{currentLayer:$,div:K}=this,H=K.style.display;K.style.display="hidden",$.div.append(this.div),tt=K.getBoundingClientRect(),K.remove(),K.style.display=H}this.rotation%180===this.parentRotation%180?(this.width=tt.width/v,this.height=tt.height/C):(this.width=tt.height/v,this.height=tt.width/C),this.fixAndSetPosition()},Ze=function(){if(this.editorDiv.replaceChildren(),!!t(this,b))for(const v of t(this,b).split(`
`)){const C=document.createElement("div");C.append(v?document.createTextNode(v):document.createElement("br")),this.editorDiv.append(C)}},kn=function(v){const{value:C,fontSize:tt,color:$,rect:K,pageIndex:H}=t(this,g);return v.value!==C||v.fontSize!==tt||v.rect.some((it,w)=>Math.abs(it-K[w])>=1)||v.color.some((it,w)=>it!==$[w])||v.pageIndex!==H},tn=function(v=!1){if(!this.annotationElementId)return;if(Y(this,u,ge).call(this),!v&&(this.width===0||this.height===0)){setTimeout(()=>Y(this,u,tn).call(this,!0),0);return}const C=c._internalPadding*this.parentScale;t(this,g).rect=this.getRect(C,C)},Kt(c,"_freeTextDefaultContent",""),Kt(c,"_internalPadding",0),Kt(c,"_defaultColor",null),Kt(c,"_defaultFontSize",10),Kt(c,"_type","freetext");let dt=c;e.FreeTextEditor=dt},(B,e,U)=>{var f,F,ie,Fn,nt,ct,ft,bt,mt,_t,J,Q,_,L,X,st,pt,Et,At,Z,Pt,Tt,Mn,Pe,en,nn,It,Ht,qt,vt,at,lt,Rt,sn,$t,j,gt,wt,Dn,rn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=U(1),d=U(6),V=U(3),W=U(30),dt=U(31),x=U(32);const P=1e3,p=9,N=new WeakSet;function I(Ct){return{width:Ct[2]-Ct[0],height:Ct[3]-Ct[1]}}class b{static create(R){switch(R.data.annotationType){case n.AnnotationType.LINK:return new E(R);case n.AnnotationType.TEXT:return new g(R);case n.AnnotationType.WIDGET:switch(R.data.fieldType){case"Tx":return new y(R);case"Btn":return R.data.radioButton?new a(R):R.data.checkBox?new A(R):new h(R);case"Ch":return new o(R);case"Sig":return new M(R)}return new u(R);case n.AnnotationType.POPUP:return new l(R);case n.AnnotationType.FREETEXT:return new O(R);case n.AnnotationType.LINE:return new r(R);case n.AnnotationType.SQUARE:return new v(R);case n.AnnotationType.CIRCLE:return new C(R);case n.AnnotationType.POLYLINE:return new tt(R);case n.AnnotationType.CARET:return new K(R);case n.AnnotationType.INK:return new H(R);case n.AnnotationType.POLYGON:return new $(R);case n.AnnotationType.HIGHLIGHT:return new it(R);case n.AnnotationType.UNDERLINE:return new w(R);case n.AnnotationType.SQUIGGLY:return new G(R);case n.AnnotationType.STRIKEOUT:return new et(R);case n.AnnotationType.STAMP:return new S(R);case n.AnnotationType.FILEATTACHMENT:return new s(R);default:return new m(R)}}}const k=class k{constructor(R,{isRenderable:T=!1,ignoreBorder:z=!1,createQuadrilaterals:ht=!1}={}){rt(this,f,!1);this.isRenderable=T,this.data=R.data,this.layer=R.layer,this.linkService=R.linkService,this.downloadManager=R.downloadManager,this.imageResourcesPath=R.imageResourcesPath,this.renderForms=R.renderForms,this.svgFactory=R.svgFactory,this.annotationStorage=R.annotationStorage,this.enableScripting=R.enableScripting,this.hasJSActions=R.hasJSActions,this._fieldObjects=R.fieldObjects,this.parent=R.parent,T&&(this.container=this._createContainer(z)),ht&&this._createQuadrilaterals()}static _hasPopupData({titleObj:R,contentsObj:T,richText:z}){return!!(R!=null&&R.str||T!=null&&T.str||z!=null&&z.str)}get hasPopupData(){return k._hasPopupData(this.data)}_createContainer(R){const{data:T,parent:{page:z,viewport:ht}}=this,ut=document.createElement("section");ut.setAttribute("data-annotation-id",T.id),this instanceof u||(ut.tabIndex=P),ut.style.zIndex=this.parent.zIndex++,this.data.popupRef&&ut.setAttribute("aria-haspopup","dialog"),T.noRotate&&ut.classList.add("norotate");const{pageWidth:yt,pageHeight:St,pageX:Lt,pageY:Ft}=ht.rawDims;if(!T.rect||this instanceof l){const{rotation:jt}=T;return!T.hasOwnCanvas&&jt!==0&&this.setRotation(jt,ut),ut}const{width:xt,height:Wt}=I(T.rect),Mt=n.Util.normalizeRect([T.rect[0],z.view[3]-T.rect[1]+z.view[1],T.rect[2],z.view[3]-T.rect[3]+z.view[1]]);if(!R&&T.borderStyle.width>0){ut.style.borderWidth=`${T.borderStyle.width}px`;const jt=T.borderStyle.horizontalCornerRadius,Gt=T.borderStyle.verticalCornerRadius;if(jt>0||Gt>0){const Yt=`calc(${jt}px * var(--scale-factor)) / calc(${Gt}px * var(--scale-factor))`;ut.style.borderRadius=Yt}else if(this instanceof a){const Yt=`calc(${xt}px * var(--scale-factor)) / calc(${Wt}px * var(--scale-factor))`;ut.style.borderRadius=Yt}switch(T.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:ut.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:ut.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:ut.style.borderBottomStyle="solid";break}const Xt=T.borderColor||null;Xt?(ot(this,f,!0),ut.style.borderColor=n.Util.makeHexColor(Xt[0]|0,Xt[1]|0,Xt[2]|0)):ut.style.borderWidth=0}ut.style.left=`${100*(Mt[0]-Lt)/yt}%`,ut.style.top=`${100*(Mt[1]-Ft)/St}%`;const{rotation:Ot}=T;return T.hasOwnCanvas||Ot===0?(ut.style.width=`${100*xt/yt}%`,ut.style.height=`${100*Wt/St}%`):this.setRotation(Ot,ut),ut}setRotation(R,T=this.container){if(!this.data.rect)return;const{pageWidth:z,pageHeight:ht}=this.parent.viewport.rawDims,{width:ut,height:yt}=I(this.data.rect);let St,Lt;R%180===0?(St=100*ut/z,Lt=100*yt/ht):(St=100*yt/z,Lt=100*ut/ht),T.style.width=`${St}%`,T.style.height=`${Lt}%`,T.setAttribute("data-main-rotation",(360-R)%360)}get _commonActions(){const R=(T,z,ht)=>{const ut=ht.detail[T],yt=ut[0],St=ut.slice(1);ht.target.style[z]=W.ColorConverters[`${yt}_HTML`](St),this.annotationStorage.setValue(this.data.id,{[z]:W.ColorConverters[`${yt}_rgb`](St)})};return(0,n.shadow)(this,"_commonActions",{display:T=>{const{display:z}=T.detail,ht=z%2===1;this.container.style.visibility=ht?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:ht,noPrint:z===1||z===2})},print:T=>{this.annotationStorage.setValue(this.data.id,{noPrint:!T.detail.print})},hidden:T=>{const{hidden:z}=T.detail;this.container.style.visibility=z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:z,noView:z})},focus:T=>{setTimeout(()=>T.target.focus({preventScroll:!1}),0)},userName:T=>{T.target.title=T.detail.userName},readonly:T=>{T.target.disabled=T.detail.readonly},required:T=>{this._setRequired(T.target,T.detail.required)},bgColor:T=>{R("bgColor","backgroundColor",T)},fillColor:T=>{R("fillColor","backgroundColor",T)},fgColor:T=>{R("fgColor","color",T)},textColor:T=>{R("textColor","color",T)},borderColor:T=>{R("borderColor","borderColor",T)},strokeColor:T=>{R("strokeColor","borderColor",T)},rotation:T=>{const z=T.detail.rotation;this.setRotation(z),this.annotationStorage.setValue(this.data.id,{rotation:z})}})}_dispatchEventFromSandbox(R,T){const z=this._commonActions;for(const ht of Object.keys(T.detail)){const ut=R[ht]||z[ht];ut==null||ut(T)}}_setDefaultPropertiesFromJS(R){if(!this.enableScripting)return;const T=this.annotationStorage.getRawValue(this.data.id);if(!T)return;const z=this._commonActions;for(const[ht,ut]of Object.entries(T)){const yt=z[ht];if(yt){const St={detail:{[ht]:ut},target:R};yt(St),delete T[ht]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:R}=this.data;if(!R)return;const[T,z,ht,ut]=this.data.rect;if(R.length===1){const[,{x:Gt,y:Xt},{x:Yt,y:Qt}]=R[0];if(ht===Gt&&ut===Xt&&T===Yt&&z===Qt)return}const{style:yt}=this.container;let St;if(t(this,f)){const{borderColor:Gt,borderWidth:Xt}=yt;yt.borderWidth=0,St=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Gt}" stroke-width="${Xt}">`],this.container.classList.add("hasBorder")}const Lt=ht-T,Ft=ut-z,{svgFactory:xt}=this,Wt=xt.createElement("svg");Wt.classList.add("quadrilateralsContainer"),Wt.setAttribute("width",0),Wt.setAttribute("height",0);const Mt=xt.createElement("defs");Wt.append(Mt);const Ot=xt.createElement("clipPath"),jt=`clippath_${this.data.id}`;Ot.setAttribute("id",jt),Ot.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(Ot);for(const[,{x:Gt,y:Xt},{x:Yt,y:Qt}]of R){const Jt=xt.createElement("rect"),te=(Yt-T)/Lt,ne=(ut-Xt)/Ft,se=(Gt-Yt)/Lt,pn=(Xt-Qt)/Ft;Jt.setAttribute("x",te),Jt.setAttribute("y",ne),Jt.setAttribute("width",se),Jt.setAttribute("height",pn),Ot.append(Jt),St==null||St.push(`<rect vector-effect="non-scaling-stroke" x="${te}" y="${ne}" width="${se}" height="${pn}"/>`)}t(this,f)&&(St.push("</g></svg>')"),yt.backgroundImage=St.join("")),this.container.append(Wt),this.container.style.clipPath=`url(#${jt})`}_createPopup(){const{container:R,data:T}=this;R.setAttribute("aria-haspopup","dialog");const z=new l({data:{color:T.color,titleObj:T.titleObj,modificationDate:T.modificationDate,contentsObj:T.contentsObj,richText:T.richText,parentRect:T.rect,borderStyle:0,id:`popup_${T.id}`,rotation:T.rotation},parent:this.parent,elements:[this]});this.parent.div.append(z.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(R,T=null){const z=[];if(this._fieldObjects){const ht=this._fieldObjects[R];if(ht)for(const{page:ut,id:yt,exportValues:St}of ht){if(ut===-1||yt===T)continue;const Lt=typeof St=="string"?St:null,Ft=document.querySelector(`[data-element-id="${yt}"]`);if(Ft&&!N.has(Ft)){(0,n.warn)(`_getElementsByName - element not allowed: ${yt}`);continue}z.push({id:yt,exportValue:Lt,domElement:Ft})}return z}for(const ht of document.getElementsByName(R)){const{exportValue:ut}=ht,yt=ht.getAttribute("data-element-id");yt!==T&&N.has(ht)&&z.push({id:yt,exportValue:ut,domElement:ht})}return z}show(){var R;this.container&&(this.container.hidden=!1),(R=this.popup)==null||R.maybeShow()}hide(){var R;this.container&&(this.container.hidden=!0),(R=this.popup)==null||R.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const R=this.getElementsToTriggerPopup();if(Array.isArray(R))for(const T of R)T.classList.add("highlightArea");else R.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:R,data:{id:T}}=this;this.container.addEventListener("dblclick",()=>{var z;(z=this.linkService.eventBus)==null||z.dispatch("switchannotationeditormode",{source:this,mode:R,editId:T})})}};f=new WeakMap;let m=k;class E extends m{constructor(T,z=null){super(T,{isRenderable:!0,ignoreBorder:!!(z!=null&&z.ignoreBorder),createQuadrilaterals:!0});rt(this,F);this.isTooltipOnly=T.data.isTooltipOnly}render(){const{data:T,linkService:z}=this,ht=document.createElement("a");ht.setAttribute("data-element-id",T.id);let ut=!1;return T.url?(z.addLinkAttributes(ht,T.url,T.newWindow),ut=!0):T.action?(this._bindNamedAction(ht,T.action),ut=!0):T.attachment?(this._bindAttachment(ht,T.attachment),ut=!0):T.setOCGState?(Y(this,F,Fn).call(this,ht,T.setOCGState),ut=!0):T.dest?(this._bindLink(ht,T.dest),ut=!0):(T.actions&&(T.actions.Action||T.actions["Mouse Up"]||T.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(ht,T),ut=!0),T.resetForm?(this._bindResetFormAction(ht,T.resetForm),ut=!0):this.isTooltipOnly&&!ut&&(this._bindLink(ht,""),ut=!0)),this.container.classList.add("linkAnnotation"),ut&&this.container.append(ht),this.container}_bindLink(T,z){T.href=this.linkService.getDestinationHash(z),T.onclick=()=>(z&&this.linkService.goToDestination(z),!1),(z||z==="")&&Y(this,F,ie).call(this)}_bindNamedAction(T,z){T.href=this.linkService.getAnchorUrl(""),T.onclick=()=>(this.linkService.executeNamedAction(z),!1),Y(this,F,ie).call(this)}_bindAttachment(T,z){T.href=this.linkService.getAnchorUrl(""),T.onclick=()=>{var ht;return(ht=this.downloadManager)==null||ht.openOrDownloadData(this.container,z.content,z.filename),!1},Y(this,F,ie).call(this)}_bindJSAction(T,z){T.href=this.linkService.getAnchorUrl("");const ht=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const ut of Object.keys(z.actions)){const yt=ht.get(ut);yt&&(T[yt]=()=>{var St;return(St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:z.id,name:ut}}),!1})}T.onclick||(T.onclick=()=>!1),Y(this,F,ie).call(this)}_bindResetFormAction(T,z){const ht=T.onclick;if(ht||(T.href=this.linkService.getAnchorUrl("")),Y(this,F,ie).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),ht||(T.onclick=()=>!1);return}T.onclick=()=>{var Wt;ht==null||ht();const{fields:ut,refs:yt,include:St}=z,Lt=[];if(ut.length!==0||yt.length!==0){const Mt=new Set(yt);for(const Ot of ut){const jt=this._fieldObjects[Ot]||[];for(const{id:Gt}of jt)Mt.add(Gt)}for(const Ot of Object.values(this._fieldObjects))for(const jt of Ot)Mt.has(jt.id)===St&&Lt.push(jt)}else for(const Mt of Object.values(this._fieldObjects))Lt.push(...Mt);const Ft=this.annotationStorage,xt=[];for(const Mt of Lt){const{id:Ot}=Mt;switch(xt.push(Ot),Mt.type){case"text":{const Gt=Mt.defaultValue||"";Ft.setValue(Ot,{value:Gt});break}case"checkbox":case"radiobutton":{const Gt=Mt.defaultValue===Mt.exportValues;Ft.setValue(Ot,{value:Gt});break}case"combobox":case"listbox":{const Gt=Mt.defaultValue||"";Ft.setValue(Ot,{value:Gt});break}default:continue}const jt=document.querySelector(`[data-element-id="${Ot}"]`);if(jt){if(!N.has(jt)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Ot}`);continue}}else continue;jt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Wt=this.linkService.eventBus)==null||Wt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:xt,name:"ResetForm"}})),!1}}}F=new WeakSet,ie=function(){this.container.setAttribute("data-internal-link","")},Fn=function(T,z){T.href=this.linkService.getAnchorUrl(""),T.onclick=()=>(this.linkService.executeSetOCGState(z),!1),Y(this,F,ie).call(this)};class g extends m{constructor(R){super(R,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const R=document.createElement("img");return R.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",R.alt="[{{type}} Annotation]",R.dataset.l10nId="text_annotation_type",R.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(R),this.container}}class u extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(R){var T;this.data.hasOwnCanvas&&(((T=R.previousSibling)==null?void 0:T.nodeName)==="CANVAS"&&(R.previousSibling.hidden=!0),R.hidden=!1)}_getKeyModifier(R){const{isWin:T,isMac:z}=n.FeatureTest.platform;return T&&R.ctrlKey||z&&R.metaKey}_setEventListener(R,T,z,ht,ut){z.includes("mouse")?R.addEventListener(z,yt=>{var St;(St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ht,value:ut(yt),shift:yt.shiftKey,modifier:this._getKeyModifier(yt)}})}):R.addEventListener(z,yt=>{var St;if(z==="blur"){if(!T.focused||!yt.relatedTarget)return;T.focused=!1}else if(z==="focus"){if(T.focused)return;T.focused=!0}ut&&((St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:ht,value:ut(yt)}}))})}_setEventListeners(R,T,z,ht){var ut,yt,St;for(const[Lt,Ft]of z)(Ft==="Action"||(ut=this.data.actions)!=null&&ut[Ft])&&((Ft==="Focus"||Ft==="Blur")&&(T||(T={focused:!1})),this._setEventListener(R,T,Lt,Ft,ht),Ft==="Focus"&&!((yt=this.data.actions)!=null&&yt.Blur)?this._setEventListener(R,T,"blur","Blur",null):Ft==="Blur"&&!((St=this.data.actions)!=null&&St.Focus)&&this._setEventListener(R,T,"focus","Focus",null))}_setBackgroundColor(R){const T=this.data.backgroundColor||null;R.style.backgroundColor=T===null?"transparent":n.Util.makeHexColor(T[0],T[1],T[2])}_setTextStyle(R){const T=["left","center","right"],{fontColor:z}=this.data.defaultAppearanceData,ht=this.data.defaultAppearanceData.fontSize||p,ut=R.style;let yt;const St=2,Lt=Ft=>Math.round(10*Ft)/10;if(this.data.multiLine){const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-St),xt=Math.round(Ft/(n.LINE_FACTOR*ht))||1,Wt=Ft/xt;yt=Math.min(ht,Lt(Wt/n.LINE_FACTOR))}else{const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-St);yt=Math.min(ht,Lt(Ft/n.LINE_FACTOR))}ut.fontSize=`calc(${yt}px * var(--scale-factor))`,ut.color=n.Util.makeHexColor(z[0],z[1],z[2]),this.data.textAlignment!==null&&(ut.textAlign=T[this.data.textAlignment])}_setRequired(R,T){T?R.setAttribute("required",!0):R.removeAttribute("required"),R.setAttribute("aria-required",T)}}class y extends u{constructor(R){const T=R.renderForms||!R.data.hasAppearance&&!!R.data.fieldValue;super(R,{isRenderable:T})}setPropertyOnSiblings(R,T,z,ht){const ut=this.annotationStorage;for(const yt of this._getElementsByName(R.name,R.id))yt.domElement&&(yt.domElement[T]=z),ut.setValue(yt.id,{[ht]:z})}render(){var ht,ut;const R=this.annotationStorage,T=this.data.id;this.container.classList.add("textWidgetAnnotation");let z=null;if(this.renderForms){const yt=R.getValue(T,{value:this.data.fieldValue});let St=yt.value||"";const Lt=R.getValue(T,{charLimit:this.data.maxLen}).charLimit;Lt&&St.length>Lt&&(St=St.slice(0,Lt));let Ft=yt.formattedValue||((ht=this.data.textContent)==null?void 0:ht.join(`
`))||null;Ft&&this.data.comb&&(Ft=Ft.replaceAll(/\s+/g,""));const xt={userValue:St,formattedValue:Ft,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(z=document.createElement("textarea"),z.textContent=Ft??St,this.data.doNotScroll&&(z.style.overflowY="hidden")):(z=document.createElement("input"),z.type="text",z.setAttribute("value",Ft??St),this.data.doNotScroll&&(z.style.overflowX="hidden")),this.data.hasOwnCanvas&&(z.hidden=!0),N.add(z),z.setAttribute("data-element-id",T),z.disabled=this.data.readOnly,z.name=this.data.fieldName,z.tabIndex=P,this._setRequired(z,this.data.required),Lt&&(z.maxLength=Lt),z.addEventListener("input",Mt=>{R.setValue(T,{value:Mt.target.value}),this.setPropertyOnSiblings(z,"value",Mt.target.value,"value"),xt.formattedValue=null}),z.addEventListener("resetform",Mt=>{const Ot=this.data.defaultFieldValue??"";z.value=xt.userValue=Ot,xt.formattedValue=null});let Wt=Mt=>{const{formattedValue:Ot}=xt;Ot!=null&&(Mt.target.value=Ot),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){z.addEventListener("focus",Ot=>{if(xt.focused)return;const{target:jt}=Ot;xt.userValue&&(jt.value=xt.userValue),xt.lastCommittedValue=jt.value,xt.commitKey=1,xt.focused=!0}),z.addEventListener("updatefromsandbox",Ot=>{this.showElementAndHideCanvas(Ot.target);const jt={value(Gt){xt.userValue=Gt.detail.value??"",R.setValue(T,{value:xt.userValue.toString()}),Gt.target.value=xt.userValue},formattedValue(Gt){const{formattedValue:Xt}=Gt.detail;xt.formattedValue=Xt,Xt!=null&&Gt.target!==document.activeElement&&(Gt.target.value=Xt),R.setValue(T,{formattedValue:Xt})},selRange(Gt){Gt.target.setSelectionRange(...Gt.detail.selRange)},charLimit:Gt=>{var Jt;const{charLimit:Xt}=Gt.detail,{target:Yt}=Gt;if(Xt===0){Yt.removeAttribute("maxLength");return}Yt.setAttribute("maxLength",Xt);let Qt=xt.userValue;!Qt||Qt.length<=Xt||(Qt=Qt.slice(0,Xt),Yt.value=xt.userValue=Qt,R.setValue(T,{value:Qt}),(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:Qt,willCommit:!0,commitKey:1,selStart:Yt.selectionStart,selEnd:Yt.selectionEnd}}))}};this._dispatchEventFromSandbox(jt,Ot)}),z.addEventListener("keydown",Ot=>{var Xt;xt.commitKey=1;let jt=-1;if(Ot.key==="Escape"?jt=0:Ot.key==="Enter"&&!this.data.multiLine?jt=2:Ot.key==="Tab"&&(xt.commitKey=3),jt===-1)return;const{value:Gt}=Ot.target;xt.lastCommittedValue!==Gt&&(xt.lastCommittedValue=Gt,xt.userValue=Gt,(Xt=this.linkService.eventBus)==null||Xt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:Gt,willCommit:!0,commitKey:jt,selStart:Ot.target.selectionStart,selEnd:Ot.target.selectionEnd}}))});const Mt=Wt;Wt=null,z.addEventListener("blur",Ot=>{var Gt;if(!xt.focused||!Ot.relatedTarget)return;xt.focused=!1;const{value:jt}=Ot.target;xt.userValue=jt,xt.lastCommittedValue!==jt&&((Gt=this.linkService.eventBus)==null||Gt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:jt,willCommit:!0,commitKey:xt.commitKey,selStart:Ot.target.selectionStart,selEnd:Ot.target.selectionEnd}})),Mt(Ot)}),(ut=this.data.actions)!=null&&ut.Keystroke&&z.addEventListener("beforeinput",Ot=>{var ne;xt.lastCommittedValue=null;const{data:jt,target:Gt}=Ot,{value:Xt,selectionStart:Yt,selectionEnd:Qt}=Gt;let Jt=Yt,te=Qt;switch(Ot.inputType){case"deleteWordBackward":{const se=Xt.substring(0,Yt).match(/\w*[^\w]*$/);se&&(Jt-=se[0].length);break}case"deleteWordForward":{const se=Xt.substring(Yt).match(/^[^\w]*\w*/);se&&(te+=se[0].length);break}case"deleteContentBackward":Yt===Qt&&(Jt-=1);break;case"deleteContentForward":Yt===Qt&&(te+=1);break}Ot.preventDefault(),(ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:Xt,change:jt||"",willCommit:!1,selStart:Jt,selEnd:te}})}),this._setEventListeners(z,xt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ot=>Ot.target.value)}if(Wt&&z.addEventListener("blur",Wt),this.data.comb){const Ot=(this.data.rect[2]-this.data.rect[0])/Lt;z.classList.add("comb"),z.style.letterSpacing=`calc(${Ot}px * var(--scale-factor) - 1ch)`}}else z=document.createElement("div"),z.textContent=this.data.fieldValue,z.style.verticalAlign="middle",z.style.display="table-cell";return this._setTextStyle(z),this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class M extends u{constructor(R){super(R,{isRenderable:!!R.data.hasOwnCanvas})}}class A extends u{constructor(R){super(R,{isRenderable:R.renderForms})}render(){const R=this.annotationStorage,T=this.data,z=T.id;let ht=R.getValue(z,{value:T.exportValue===T.fieldValue}).value;typeof ht=="string"&&(ht=ht!=="Off",R.setValue(z,{value:ht})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ut=document.createElement("input");return N.add(ut),ut.setAttribute("data-element-id",z),ut.disabled=T.readOnly,this._setRequired(ut,this.data.required),ut.type="checkbox",ut.name=T.fieldName,ht&&ut.setAttribute("checked",!0),ut.setAttribute("exportValue",T.exportValue),ut.tabIndex=P,ut.addEventListener("change",yt=>{const{name:St,checked:Lt}=yt.target;for(const Ft of this._getElementsByName(St,z)){const xt=Lt&&Ft.exportValue===T.exportValue;Ft.domElement&&(Ft.domElement.checked=xt),R.setValue(Ft.id,{value:xt})}R.setValue(z,{value:Lt})}),ut.addEventListener("resetform",yt=>{const St=T.defaultFieldValue||"Off";yt.target.checked=St===T.exportValue}),this.enableScripting&&this.hasJSActions&&(ut.addEventListener("updatefromsandbox",yt=>{const St={value(Lt){Lt.target.checked=Lt.detail.value!=="Off",R.setValue(z,{value:Lt.target.checked})}};this._dispatchEventFromSandbox(St,yt)}),this._setEventListeners(ut,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],yt=>yt.target.checked)),this._setBackgroundColor(ut),this._setDefaultPropertiesFromJS(ut),this.container.append(ut),this.container}}class a extends u{constructor(R){super(R,{isRenderable:R.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const R=this.annotationStorage,T=this.data,z=T.id;let ht=R.getValue(z,{value:T.fieldValue===T.buttonValue}).value;typeof ht=="string"&&(ht=ht!==T.buttonValue,R.setValue(z,{value:ht}));const ut=document.createElement("input");if(N.add(ut),ut.setAttribute("data-element-id",z),ut.disabled=T.readOnly,this._setRequired(ut,this.data.required),ut.type="radio",ut.name=T.fieldName,ht&&ut.setAttribute("checked",!0),ut.tabIndex=P,ut.addEventListener("change",yt=>{const{name:St,checked:Lt}=yt.target;for(const Ft of this._getElementsByName(St,z))R.setValue(Ft.id,{value:!1});R.setValue(z,{value:Lt})}),ut.addEventListener("resetform",yt=>{const St=T.defaultFieldValue;yt.target.checked=St!=null&&St===T.buttonValue}),this.enableScripting&&this.hasJSActions){const yt=T.buttonValue;ut.addEventListener("updatefromsandbox",St=>{const Lt={value:Ft=>{const xt=yt===Ft.detail.value;for(const Wt of this._getElementsByName(Ft.target.name)){const Mt=xt&&Wt.id===z;Wt.domElement&&(Wt.domElement.checked=Mt),R.setValue(Wt.id,{value:Mt})}}};this._dispatchEventFromSandbox(Lt,St)}),this._setEventListeners(ut,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],St=>St.target.checked)}return this._setBackgroundColor(ut),this._setDefaultPropertiesFromJS(ut),this.container.append(ut),this.container}}class h extends E{constructor(R){super(R,{ignoreBorder:R.data.hasAppearance})}render(){const R=super.render();R.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(R.title=this.data.alternativeText);const T=R.lastChild;return this.enableScripting&&this.hasJSActions&&T&&(this._setDefaultPropertiesFromJS(T),T.addEventListener("updatefromsandbox",z=>{this._dispatchEventFromSandbox({},z)})),R}}class o extends u{constructor(R){super(R,{isRenderable:R.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const R=this.annotationStorage,T=this.data.id,z=R.getValue(T,{value:this.data.fieldValue}),ht=document.createElement("select");N.add(ht),ht.setAttribute("data-element-id",T),ht.disabled=this.data.readOnly,this._setRequired(ht,this.data.required),ht.name=this.data.fieldName,ht.tabIndex=P;let ut=this.data.combo&&this.data.options.length>0;this.data.combo||(ht.size=this.data.options.length,this.data.multiSelect&&(ht.multiple=!0)),ht.addEventListener("resetform",xt=>{const Wt=this.data.defaultFieldValue;for(const Mt of ht.options)Mt.selected=Mt.value===Wt});for(const xt of this.data.options){const Wt=document.createElement("option");Wt.textContent=xt.displayValue,Wt.value=xt.exportValue,z.value.includes(xt.exportValue)&&(Wt.setAttribute("selected",!0),ut=!1),ht.append(Wt)}let yt=null;if(ut){const xt=document.createElement("option");xt.value=" ",xt.setAttribute("hidden",!0),xt.setAttribute("selected",!0),ht.prepend(xt),yt=()=>{xt.remove(),ht.removeEventListener("input",yt),yt=null},ht.addEventListener("input",yt)}const St=xt=>{const Wt=xt?"value":"textContent",{options:Mt,multiple:Ot}=ht;return Ot?Array.prototype.filter.call(Mt,jt=>jt.selected).map(jt=>jt[Wt]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][Wt]};let Lt=St(!1);const Ft=xt=>{const Wt=xt.target.options;return Array.prototype.map.call(Wt,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(ht.addEventListener("updatefromsandbox",xt=>{const Wt={value(Mt){yt==null||yt();const Ot=Mt.detail.value,jt=new Set(Array.isArray(Ot)?Ot:[Ot]);for(const Gt of ht.options)Gt.selected=jt.has(Gt.value);R.setValue(T,{value:St(!0)}),Lt=St(!1)},multipleSelection(Mt){ht.multiple=!0},remove(Mt){const Ot=ht.options,jt=Mt.detail.remove;Ot[jt].selected=!1,ht.remove(jt),Ot.length>0&&Array.prototype.findIndex.call(Ot,Xt=>Xt.selected)===-1&&(Ot[0].selected=!0),R.setValue(T,{value:St(!0),items:Ft(Mt)}),Lt=St(!1)},clear(Mt){for(;ht.length!==0;)ht.remove(0);R.setValue(T,{value:null,items:[]}),Lt=St(!1)},insert(Mt){const{index:Ot,displayValue:jt,exportValue:Gt}=Mt.detail.insert,Xt=ht.children[Ot],Yt=document.createElement("option");Yt.textContent=jt,Yt.value=Gt,Xt?Xt.before(Yt):ht.append(Yt),R.setValue(T,{value:St(!0),items:Ft(Mt)}),Lt=St(!1)},items(Mt){const{items:Ot}=Mt.detail;for(;ht.length!==0;)ht.remove(0);for(const jt of Ot){const{displayValue:Gt,exportValue:Xt}=jt,Yt=document.createElement("option");Yt.textContent=Gt,Yt.value=Xt,ht.append(Yt)}ht.options.length>0&&(ht.options[0].selected=!0),R.setValue(T,{value:St(!0),items:Ft(Mt)}),Lt=St(!1)},indices(Mt){const Ot=new Set(Mt.detail.indices);for(const jt of Mt.target.options)jt.selected=Ot.has(jt.index);R.setValue(T,{value:St(!0)}),Lt=St(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(Wt,xt)}),ht.addEventListener("input",xt=>{var Mt;const Wt=St(!0);R.setValue(T,{value:Wt}),xt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:T,name:"Keystroke",value:Lt,changeEx:Wt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(ht,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],xt=>xt.target.value)):ht.addEventListener("input",function(xt){R.setValue(T,{value:St(!0)})}),this.data.combo&&this._setTextStyle(ht),this._setBackgroundColor(ht),this._setDefaultPropertiesFromJS(ht),this.container.append(ht),this.container}}class l extends m{constructor(R){const{data:T,elements:z}=R;super(R,{isRenderable:m._hasPopupData(T)}),this.elements=z}render(){this.container.classList.add("popupAnnotation");const R=new c({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),T=[];for(const z of this.elements)z.popup=R,T.push(z.data.id),z.addHighlightArea();return this.container.setAttribute("aria-controls",T.map(z=>`${n.AnnotationPrefix}${z}`).join(",")),this.container}}class c{constructor({container:R,color:T,elements:z,titleObj:ht,modificationDate:ut,contentsObj:yt,richText:St,parent:Lt,rect:Ft,parentRect:xt,open:Wt}){rt(this,Tt);rt(this,nt,null);rt(this,ct,Y(this,Tt,Mn).bind(this));rt(this,ft,Y(this,Tt,nn).bind(this));rt(this,bt,Y(this,Tt,en).bind(this));rt(this,mt,Y(this,Tt,Pe).bind(this));rt(this,_t,null);rt(this,J,null);rt(this,Q,null);rt(this,_,null);rt(this,L,null);rt(this,X,null);rt(this,st,!1);rt(this,pt,null);rt(this,Et,null);rt(this,At,null);rt(this,Z,null);rt(this,Pt,!1);var Ot;ot(this,J,R),ot(this,Z,ht),ot(this,Q,yt),ot(this,At,St),ot(this,L,Lt),ot(this,_t,T),ot(this,Et,Ft),ot(this,X,xt),ot(this,_,z);const Mt=d.PDFDateString.toDateObject(ut);Mt&&ot(this,nt,Lt.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=z.flatMap(jt=>jt.getElementsToTriggerPopup());for(const jt of this.trigger)jt.addEventListener("click",t(this,mt)),jt.addEventListener("mouseenter",t(this,bt)),jt.addEventListener("mouseleave",t(this,ft)),jt.classList.add("popupTriggerArea");for(const jt of z)(Ot=jt.container)==null||Ot.addEventListener("keydown",t(this,ct));t(this,J).hidden=!0,Wt&&Y(this,Tt,Pe).call(this)}render(){if(t(this,pt))return;const{page:{view:R},viewport:{rawDims:{pageWidth:T,pageHeight:z,pageX:ht,pageY:ut}}}=t(this,L),yt=ot(this,pt,document.createElement("div"));if(yt.className="popup",t(this,_t)){const Jt=yt.style.outlineColor=n.Util.makeHexColor(...t(this,_t));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?yt.style.backgroundColor=`color-mix(in srgb, ${Jt} 30%, white)`:yt.style.backgroundColor=n.Util.makeHexColor(...t(this,_t).map(ne=>Math.floor(.7*(255-ne)+ne)))}const St=document.createElement("span");St.className="header";const Lt=document.createElement("h1");if(St.append(Lt),{dir:Lt.dir,str:Lt.textContent}=t(this,Z),yt.append(St),t(this,nt)){const Jt=document.createElement("span");Jt.classList.add("popupDate"),t(this,nt).then(te=>{Jt.textContent=te}),St.append(Jt)}const Ft=t(this,Q),xt=t(this,At);if(xt!=null&&xt.str&&(!(Ft!=null&&Ft.str)||Ft.str===xt.str))x.XfaLayer.render({xfaHtml:xt.html,intent:"richText",div:yt}),yt.lastChild.classList.add("richText","popupContent");else{const Jt=this._formatContents(Ft);yt.append(Jt)}let Wt=!!t(this,X),Mt=Wt?t(this,X):t(this,Et);for(const Jt of t(this,_))if(!Mt||n.Util.intersect(Jt.data.rect,Mt)!==null){Mt=Jt.data.rect,Wt=!0;break}const Ot=n.Util.normalizeRect([Mt[0],R[3]-Mt[1]+R[1],Mt[2],R[3]-Mt[3]+R[1]]),Gt=Wt?Mt[2]-Mt[0]+5:0,Xt=Ot[0]+Gt,Yt=Ot[1],{style:Qt}=t(this,J);Qt.left=`${100*(Xt-ht)/T}%`,Qt.top=`${100*(Yt-ut)/z}%`,t(this,J).append(yt)}_formatContents({str:R,dir:T}){const z=document.createElement("p");z.classList.add("popupContent"),z.dir=T;const ht=R.split(/(?:\r\n?|\n)/);for(let ut=0,yt=ht.length;ut<yt;++ut){const St=ht[ut];z.append(document.createTextNode(St)),ut<yt-1&&z.append(document.createElement("br"))}return z}forceHide(){ot(this,Pt,this.isVisible),t(this,Pt)&&(t(this,J).hidden=!0)}maybeShow(){t(this,Pt)&&(ot(this,Pt,!1),t(this,J).hidden=!1)}get isVisible(){return t(this,J).hidden===!1}}nt=new WeakMap,ct=new WeakMap,ft=new WeakMap,bt=new WeakMap,mt=new WeakMap,_t=new WeakMap,J=new WeakMap,Q=new WeakMap,_=new WeakMap,L=new WeakMap,X=new WeakMap,st=new WeakMap,pt=new WeakMap,Et=new WeakMap,At=new WeakMap,Z=new WeakMap,Pt=new WeakMap,Tt=new WeakSet,Mn=function(R){R.altKey||R.shiftKey||R.ctrlKey||R.metaKey||(R.key==="Enter"||R.key==="Escape"&&t(this,st))&&Y(this,Tt,Pe).call(this)},Pe=function(){ot(this,st,!t(this,st)),t(this,st)?(Y(this,Tt,en).call(this),t(this,J).addEventListener("click",t(this,mt)),t(this,J).addEventListener("keydown",t(this,ct))):(Y(this,Tt,nn).call(this),t(this,J).removeEventListener("click",t(this,mt)),t(this,J).removeEventListener("keydown",t(this,ct)))},en=function(){t(this,pt)||this.render(),this.isVisible?t(this,st)&&t(this,J).classList.add("focused"):(t(this,J).hidden=!1,t(this,J).style.zIndex=parseInt(t(this,J).style.zIndex)+1e3)},nn=function(){t(this,J).classList.remove("focused"),!(t(this,st)||!this.isVisible)&&(t(this,J).hidden=!0,t(this,J).style.zIndex=parseInt(t(this,J).style.zIndex)-1e3)};class O extends m{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0}),this.textContent=R.data.textContent,this.textPosition=R.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const R=document.createElement("div");R.classList.add("annotationTextContent"),R.setAttribute("role","comment");for(const T of this.textContent){const z=document.createElement("span");z.textContent=T,R.append(z)}this.container.append(R)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=O;class r extends m{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,It,null)}render(){this.container.classList.add("lineAnnotation");const T=this.data,{width:z,height:ht}=I(T.rect),ut=this.svgFactory.create(z,ht,!0),yt=ot(this,It,this.svgFactory.createElement("svg:line"));return yt.setAttribute("x1",T.rect[2]-T.lineCoordinates[0]),yt.setAttribute("y1",T.rect[3]-T.lineCoordinates[1]),yt.setAttribute("x2",T.rect[2]-T.lineCoordinates[2]),yt.setAttribute("y2",T.rect[3]-T.lineCoordinates[3]),yt.setAttribute("stroke-width",T.borderStyle.width||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),ut.append(yt),this.container.append(ut),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,It)}addHighlightArea(){this.container.classList.add("highlightArea")}}It=new WeakMap;class v extends m{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,Ht,null)}render(){this.container.classList.add("squareAnnotation");const T=this.data,{width:z,height:ht}=I(T.rect),ut=this.svgFactory.create(z,ht,!0),yt=T.borderStyle.width,St=ot(this,Ht,this.svgFactory.createElement("svg:rect"));return St.setAttribute("x",yt/2),St.setAttribute("y",yt/2),St.setAttribute("width",z-yt),St.setAttribute("height",ht-yt),St.setAttribute("stroke-width",yt||1),St.setAttribute("stroke","transparent"),St.setAttribute("fill","transparent"),ut.append(St),this.container.append(ut),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Ht)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ht=new WeakMap;class C extends m{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,qt,null)}render(){this.container.classList.add("circleAnnotation");const T=this.data,{width:z,height:ht}=I(T.rect),ut=this.svgFactory.create(z,ht,!0),yt=T.borderStyle.width,St=ot(this,qt,this.svgFactory.createElement("svg:ellipse"));return St.setAttribute("cx",z/2),St.setAttribute("cy",ht/2),St.setAttribute("rx",z/2-yt/2),St.setAttribute("ry",ht/2-yt/2),St.setAttribute("stroke-width",yt||1),St.setAttribute("stroke","transparent"),St.setAttribute("fill","transparent"),ut.append(St),this.container.append(ut),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,qt)}addHighlightArea(){this.container.classList.add("highlightArea")}}qt=new WeakMap;class tt extends m{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,vt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const T=this.data,{width:z,height:ht}=I(T.rect),ut=this.svgFactory.create(z,ht,!0);let yt=[];for(const Lt of T.vertices){const Ft=Lt.x-T.rect[0],xt=T.rect[3]-Lt.y;yt.push(Ft+","+xt)}yt=yt.join(" ");const St=ot(this,vt,this.svgFactory.createElement(this.svgElementName));return St.setAttribute("points",yt),St.setAttribute("stroke-width",T.borderStyle.width||1),St.setAttribute("stroke","transparent"),St.setAttribute("fill","transparent"),ut.append(St),this.container.append(ut),!T.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,vt)}addHighlightArea(){this.container.classList.add("highlightArea")}}vt=new WeakMap;class $ extends tt{constructor(R){super(R),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends m{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class H extends m{constructor(T){super(T,{isRenderable:!0,ignoreBorder:!0});rt(this,at,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const T=this.data,{width:z,height:ht}=I(T.rect),ut=this.svgFactory.create(z,ht,!0);for(const yt of T.inkLists){let St=[];for(const Ft of yt){const xt=Ft.x-T.rect[0],Wt=T.rect[3]-Ft.y;St.push(`${xt},${Wt}`)}St=St.join(" ");const Lt=this.svgFactory.createElement(this.svgElementName);t(this,at).push(Lt),Lt.setAttribute("points",St),Lt.setAttribute("stroke-width",T.borderStyle.width||1),Lt.setAttribute("stroke","transparent"),Lt.setAttribute("fill","transparent"),!T.popupRef&&this.hasPopupData&&this._createPopup(),ut.append(Lt)}return this.container.append(ut),this.container}getElementsToTriggerPopup(){return t(this,at)}addHighlightArea(){this.container.classList.add("highlightArea")}}at=new WeakMap,e.InkAnnotationElement=H;class it extends m{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class w extends m{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class G extends m{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class et extends m{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class S extends m{constructor(R){super(R,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=S;class s extends m{constructor(T){var ut;super(T,{isRenderable:!0});rt(this,Rt);rt(this,lt,null);const{filename:z,content:ht}=this.data.file;this.filename=(0,d.getFilenameFromUrl)(z,!0),this.content=ht,(ut=this.linkService.eventBus)==null||ut.dispatch("fileattachmentannotation",{source:this,filename:z,content:ht})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:T,data:z}=this;let ht;z.hasAppearance||z.fillAlpha===0?ht=document.createElement("div"):(ht=document.createElement("img"),ht.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(z.name)?"paperclip":"pushpin"}.svg`,z.fillAlpha&&z.fillAlpha<1&&(ht.style=`filter: opacity(${Math.round(z.fillAlpha*100)}%);`)),ht.addEventListener("dblclick",Y(this,Rt,sn).bind(this)),ot(this,lt,ht);const{isMac:ut}=n.FeatureTest.platform;return T.addEventListener("keydown",yt=>{yt.key==="Enter"&&(ut?yt.metaKey:yt.ctrlKey)&&Y(this,Rt,sn).call(this)}),!z.popupRef&&this.hasPopupData?this._createPopup():ht.classList.add("popupTriggerArea"),T.append(ht),T}getElementsToTriggerPopup(){return t(this,lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}lt=new WeakMap,Rt=new WeakSet,sn=function(){var T;(T=this.downloadManager)==null||T.openOrDownloadData(this.container,this.content,this.filename)};class i{constructor({div:R,accessibilityManager:T,annotationCanvasMap:z,l10n:ht,page:ut,viewport:yt}){rt(this,wt);rt(this,$t,null);rt(this,j,null);rt(this,gt,new Map);this.div=R,ot(this,$t,T),ot(this,j,z),this.l10n=ht,this.page=ut,this.viewport=yt,this.zIndex=0,this.l10n||(this.l10n=dt.NullL10n)}async render(R){const{annotations:T}=R,z=this.div;(0,d.setLayerDimensions)(z,this.viewport);const ht=new Map,ut={data:null,layer:z,linkService:R.linkService,downloadManager:R.downloadManager,imageResourcesPath:R.imageResourcesPath||"",renderForms:R.renderForms!==!1,svgFactory:new d.DOMSVGFactory,annotationStorage:R.annotationStorage||new V.AnnotationStorage,enableScripting:R.enableScripting===!0,hasJSActions:R.hasJSActions,fieldObjects:R.fieldObjects,parent:this,elements:null};for(const yt of T){if(yt.noHTML)continue;const St=yt.annotationType===n.AnnotationType.POPUP;if(St){const xt=ht.get(yt.id);if(!xt)continue;ut.elements=xt}else{const{width:xt,height:Wt}=I(yt.rect);if(xt<=0||Wt<=0)continue}ut.data=yt;const Lt=b.create(ut);if(!Lt.isRenderable)continue;if(!St&&yt.popupRef){const xt=ht.get(yt.popupRef);xt?xt.push(Lt):ht.set(yt.popupRef,[Lt])}Lt.annotationEditorType>0&&t(this,gt).set(Lt.data.id,Lt);const Ft=Lt.render();yt.hidden&&(Ft.style.visibility="hidden"),Y(this,wt,Dn).call(this,Ft,yt.id)}Y(this,wt,rn).call(this),await this.l10n.translate(z)}update({viewport:R}){const T=this.div;this.viewport=R,(0,d.setLayerDimensions)(T,{rotation:R.rotation}),Y(this,wt,rn).call(this),T.hidden=!1}getEditableAnnotations(){return Array.from(t(this,gt).values())}getEditableAnnotation(R){return t(this,gt).get(R)}}$t=new WeakMap,j=new WeakMap,gt=new WeakMap,wt=new WeakSet,Dn=function(R,T){var ht;const z=R.firstChild||R;z.id=`${n.AnnotationPrefix}${T}`,this.div.append(R),(ht=t(this,$t))==null||ht.moveElementInDOM(this.div,R,z,!1)},rn=function(){if(!t(this,j))return;const R=this.div;for(const[T,z]of t(this,j)){const ht=R.querySelector(`[data-annotation-id="${T}"]`);if(!ht)continue;const{firstChild:ut}=ht;ut?ut.nodeName==="CANVAS"?ut.replaceWith(z):ut.before(z):ht.append(z)}t(this,j).clear()},e.AnnotationLayer=i},(B,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function U(V){return Math.floor(Math.max(0,Math.min(1,V))*255).toString(16).padStart(2,"0")}function n(V){return Math.max(0,Math.min(255,255*V))}class d{static CMYK_G([W,dt,x,P]){return["G",1-Math.min(1,.3*W+.59*x+.11*dt+P)]}static G_CMYK([W]){return["CMYK",0,0,0,1-W]}static G_RGB([W]){return["RGB",W,W,W]}static G_rgb([W]){return W=n(W),[W,W,W]}static G_HTML([W]){const dt=U(W);return`#${dt}${dt}${dt}`}static RGB_G([W,dt,x]){return["G",.3*W+.59*dt+.11*x]}static RGB_rgb(W){return W.map(n)}static RGB_HTML(W){return`#${W.map(U).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([W,dt,x,P]){return["RGB",1-Math.min(1,W+P),1-Math.min(1,x+P),1-Math.min(1,dt+P)]}static CMYK_rgb([W,dt,x,P]){return[n(1-Math.min(1,W+P)),n(1-Math.min(1,x+P)),n(1-Math.min(1,dt+P))]}static CMYK_HTML(W){const dt=this.CMYK_RGB(W).slice(1);return this.RGB_HTML(dt)}static RGB_CMYK([W,dt,x]){const P=1-W,p=1-dt,N=1-x,I=Math.min(P,p,N);return["CMYK",P,p,N,I]}}e.ColorConverters=d},(B,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const U={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};U.print_progress_percent="{{progress}}%";function n(W,dt){switch(W){case"find_match_count":W=`find_match_count[${dt.total===1?"one":"other"}]`;break;case"find_match_count_limit":W=`find_match_count_limit[${dt.limit===1?"one":"other"}]`;break}return U[W]||""}function d(W,dt){return dt?W.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(x,P)=>P in dt?dt[P]:"{{"+P+"}}"):W}const V={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(W,dt=null,x=n(W,dt)){return d(x,dt)},async translate(W){}};e.NullL10n=V},(B,e,U)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=U(25);class d{static setupStorage(W,dt,x,P,p){const N=P.getValue(dt,{value:null});switch(x.name){case"textarea":if(N.value!==null&&(W.textContent=N.value),p==="print")break;W.addEventListener("input",I=>{P.setValue(dt,{value:I.target.value})});break;case"input":if(x.attributes.type==="radio"||x.attributes.type==="checkbox"){if(N.value===x.attributes.xfaOn?W.setAttribute("checked",!0):N.value===x.attributes.xfaOff&&W.removeAttribute("checked"),p==="print")break;W.addEventListener("change",I=>{P.setValue(dt,{value:I.target.checked?I.target.getAttribute("xfaOn"):I.target.getAttribute("xfaOff")})})}else{if(N.value!==null&&W.setAttribute("value",N.value),p==="print")break;W.addEventListener("input",I=>{P.setValue(dt,{value:I.target.value})})}break;case"select":if(N.value!==null){W.setAttribute("value",N.value);for(const I of x.children)I.attributes.value===N.value?I.attributes.selected=!0:I.attributes.hasOwnProperty("selected")&&delete I.attributes.selected}W.addEventListener("input",I=>{const b=I.target.options,m=b.selectedIndex===-1?"":b[b.selectedIndex].value;P.setValue(dt,{value:m})});break}}static setAttributes({html:W,element:dt,storage:x=null,intent:P,linkService:p}){const{attributes:N}=dt,I=W instanceof HTMLAnchorElement;N.type==="radio"&&(N.name=`${N.name}-${P}`);for(const[b,m]of Object.entries(N))if(m!=null)switch(b){case"class":m.length&&W.setAttribute(b,m.join(" "));break;case"dataId":break;case"id":W.setAttribute("data-element-id",m);break;case"style":Object.assign(W.style,m);break;case"textContent":W.textContent=m;break;default:(!I||b!=="href"&&b!=="newWindow")&&W.setAttribute(b,m)}I&&p.addLinkAttributes(W,N.href,N.newWindow),x&&N.dataId&&this.setupStorage(W,N.dataId,dt,x)}static render(W){var E;const dt=W.annotationStorage,x=W.linkService,P=W.xfaHtml,p=W.intent||"display",N=document.createElement(P.name);P.attributes&&this.setAttributes({html:N,element:P,intent:p,linkService:x});const I=[[P,-1,N]],b=W.div;if(b.append(N),W.viewport){const g=`matrix(${W.viewport.transform.join(",")})`;b.style.transform=g}p!=="richText"&&b.setAttribute("class","xfaLayer xfaFont");const m=[];for(;I.length>0;){const[g,u,y]=I.at(-1);if(u+1===g.children.length){I.pop();continue}const M=g.children[++I.at(-1)[1]];if(M===null)continue;const{name:A}=M;if(A==="#text"){const h=document.createTextNode(M.value);m.push(h),y.append(h);continue}const a=(E=M==null?void 0:M.attributes)!=null&&E.xmlns?document.createElementNS(M.attributes.xmlns,A):document.createElement(A);if(y.append(a),M.attributes&&this.setAttributes({html:a,element:M,storage:dt,intent:p,linkService:x}),M.children&&M.children.length>0)I.push([M,-1,a]);else if(M.value){const h=document.createTextNode(M.value);n.XfaText.shouldBuildText(A)&&m.push(h),a.append(h)}}for(const g of b.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:m}}static update(W){const dt=`matrix(${W.viewport.transform.join(",")})`;W.div.style.transform=dt,W.div.hidden=!1}}e.XfaLayer=d},(B,e,U)=>{var P,p,N,I,b,m,E,g,u,y,M,A,a,h,o,Ln,In,On,Nn,an,Bn,on,jn,Un,Wn,Hn,Gn,ee,ln,we,xe,le,cn,Ce,F,$n,hn,Vn,zn,dn,Re,ce;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=U(1),d=U(4),V=U(29),W=U(6),dt=U(5);const _t=class _t extends d.AnnotationEditor{constructor(_){super({..._,name:"inkEditor"});rt(this,o);rt(this,P,0);rt(this,p,0);rt(this,N,this.canvasPointermove.bind(this));rt(this,I,this.canvasPointerleave.bind(this));rt(this,b,this.canvasPointerup.bind(this));rt(this,m,this.canvasPointerdown.bind(this));rt(this,E,new Path2D);rt(this,g,!1);rt(this,u,!1);rt(this,y,!1);rt(this,M,null);rt(this,A,0);rt(this,a,0);rt(this,h,null);this.color=_.color||null,this.thickness=_.thickness||null,this.opacity=_.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(_){d.AnnotationEditor.initialize(_,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(_,L){switch(_){case n.AnnotationEditorParamsType.INK_THICKNESS:_t._defaultThickness=L;break;case n.AnnotationEditorParamsType.INK_COLOR:_t._defaultColor=L;break;case n.AnnotationEditorParamsType.INK_OPACITY:_t._defaultOpacity=L/100;break}}updateParams(_,L){switch(_){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,o,Ln).call(this,L);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,o,In).call(this,L);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,o,On).call(this,L);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,_t._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,_t._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(_t._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||_t._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||_t._defaultColor||d.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??_t._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,o,we).call(this),Y(this,o,xe).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,o,le).call(this)),Y(this,o,ce).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,M).disconnect(),ot(this,M,null),super.remove())}setParent(_){!this.parent&&_?this._uiManager.removeShouldRescale(this):this.parent&&_===null&&this._uiManager.addShouldRescale(this),super.setParent(_)}onScaleChanging(){const[_,L]=this.parentDimensions,X=this.width*_,st=this.height*L;this.setDimensions(X,st)}enableEditMode(){t(this,g)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,m)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,m)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,g)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ot(this,g,!0),this.div.classList.add("disabled"),Y(this,o,ce).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(_){this._focusEventsAllowed&&(super.focusin(_),this.enableEditMode())}canvasPointerdown(_){_.button!==0||!this.isInEditMode()||t(this,g)||(this.setInForeground(),_.preventDefault(),_.type!=="mouse"&&this.div.focus(),Y(this,o,Bn).call(this,_.offsetX,_.offsetY))}canvasPointermove(_){_.preventDefault(),Y(this,o,on).call(this,_.offsetX,_.offsetY)}canvasPointerup(_){_.preventDefault(),Y(this,o,ln).call(this,_)}canvasPointerleave(_){Y(this,o,ln).call(this,_)}get isResizable(){return!this.isEmpty()&&t(this,g)}render(){if(this.div)return this.div;let _,L;this.width&&(_=this.x,L=this.y),super.render(),d.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(At=>{var Z;return(Z=this.div)==null?void 0:Z.setAttribute("aria-label",At)});const[X,st,pt,Et]=Y(this,o,Nn).call(this);if(this.setAt(X,st,0,0),this.setDims(pt,Et),Y(this,o,we).call(this),this.width){const[At,Z]=this.parentDimensions;this.setAspectRatio(this.width*At,this.height*Z),this.setAt(_*At,L*Z,this.width*At,this.height*Z),ot(this,y,!0),Y(this,o,le).call(this),this.setDims(this.width*At,this.height*Z),Y(this,o,ee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,o,xe).call(this),this.div}setDimensions(_,L){const X=Math.round(_),st=Math.round(L);if(t(this,A)===X&&t(this,a)===st)return;ot(this,A,X),ot(this,a,st),this.canvas.style.visibility="hidden";const[pt,Et]=this.parentDimensions;this.width=_/pt,this.height=L/Et,this.fixAndSetPosition(),t(this,g)&&Y(this,o,cn).call(this,_,L),Y(this,o,le).call(this),Y(this,o,ee).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(_,L,X){var It,Ht,qt;if(_ instanceof V.InkAnnotationElement)return null;const st=super.deserialize(_,L,X);st.thickness=_.thickness,st.color=n.Util.makeHexColor(..._.color),st.opacity=_.opacity;const[pt,Et]=st.pageDimensions,At=st.width*pt,Z=st.height*Et,Pt=st.parentScale,Tt=_.thickness/2;ot(st,g,!0),ot(st,A,Math.round(At)),ot(st,a,Math.round(Z));const{paths:Ut,rect:Bt,rotation:Vt}=_;for(let{bezier:vt}of Ut){vt=Y(It=_t,F,Vn).call(It,vt,Bt,Vt);const at=[];st.paths.push(at);let lt=Pt*(vt[0]-Tt),Rt=Pt*(vt[1]-Tt);for(let $t=2,j=vt.length;$t<j;$t+=6){const gt=Pt*(vt[$t]-Tt),wt=Pt*(vt[$t+1]-Tt),Dt=Pt*(vt[$t+2]-Tt),Nt=Pt*(vt[$t+3]-Tt),Ct=Pt*(vt[$t+4]-Tt),R=Pt*(vt[$t+5]-Tt);at.push([[lt,Rt],[gt,wt],[Dt,Nt],[Ct,R]]),lt=Ct,Rt=R}const zt=Y(this,F,$n).call(this,at);st.bezierPath2D.push(zt)}const kt=Y(Ht=st,o,dn).call(Ht);return ot(st,p,Math.max(d.AnnotationEditor.MIN_SIZE,kt[2]-kt[0])),ot(st,P,Math.max(d.AnnotationEditor.MIN_SIZE,kt[3]-kt[1])),Y(qt=st,o,cn).call(qt,At,Z),st}serialize(){if(this.isEmpty())return null;const _=this.getRect(0,0),L=d.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:L,thickness:this.thickness,opacity:this.opacity,paths:Y(this,o,zn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,_),pageIndex:this.pageIndex,rect:_,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};P=new WeakMap,p=new WeakMap,N=new WeakMap,I=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,M=new WeakMap,A=new WeakMap,a=new WeakMap,h=new WeakMap,o=new WeakSet,Ln=function(_){const L=this.thickness;this.addCommands({cmd:()=>{this.thickness=_,Y(this,o,ce).call(this)},undo:()=>{this.thickness=L,Y(this,o,ce).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},In=function(_){const L=this.color;this.addCommands({cmd:()=>{this.color=_,Y(this,o,ee).call(this)},undo:()=>{this.color=L,Y(this,o,ee).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},On=function(_){_/=100;const L=this.opacity;this.addCommands({cmd:()=>{this.opacity=_,Y(this,o,ee).call(this)},undo:()=>{this.opacity=L,Y(this,o,ee).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Nn=function(){const{parentRotation:_,parentDimensions:[L,X]}=this;switch(_){case 90:return[0,X,X,L];case 180:return[L,X,L,X];case 270:return[L,0,X,L];default:return[0,0,L,X]}},an=function(){const{ctx:_,color:L,opacity:X,thickness:st,parentScale:pt,scaleFactor:Et}=this;_.lineWidth=st*pt/Et,_.lineCap="round",_.lineJoin="round",_.miterLimit=10,_.strokeStyle=`${L}${(0,dt.opacityToHex)(X)}`},Bn=function(_,L){this.canvas.addEventListener("contextmenu",W.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,I)),this.canvas.addEventListener("pointermove",t(this,N)),this.canvas.addEventListener("pointerup",t(this,b)),this.canvas.removeEventListener("pointerdown",t(this,m)),this.isEditing=!0,t(this,y)||(ot(this,y,!0),Y(this,o,le).call(this),this.thickness||(this.thickness=_t._defaultThickness),this.color||(this.color=_t._defaultColor||d.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=_t._defaultOpacity)),this.currentPath.push([_,L]),ot(this,u,!1),Y(this,o,an).call(this),ot(this,h,()=>{Y(this,o,Wn).call(this),t(this,h)&&window.requestAnimationFrame(t(this,h))}),window.requestAnimationFrame(t(this,h))},on=function(_,L){const[X,st]=this.currentPath.at(-1);if(this.currentPath.length>1&&_===X&&L===st)return;const pt=this.currentPath;let Et=t(this,E);if(pt.push([_,L]),ot(this,u,!0),pt.length<=2){Et.moveTo(...pt[0]),Et.lineTo(_,L);return}pt.length===3&&(ot(this,E,Et=new Path2D),Et.moveTo(...pt[0])),Y(this,o,Hn).call(this,Et,...pt.at(-3),...pt.at(-2),_,L)},jn=function(){if(this.currentPath.length===0)return;const _=this.currentPath.at(-1);t(this,E).lineTo(..._)},Un=function(_,L){ot(this,h,null),_=Math.min(Math.max(_,0),this.canvas.width),L=Math.min(Math.max(L,0),this.canvas.height),Y(this,o,on).call(this,_,L),Y(this,o,jn).call(this);let X;if(this.currentPath.length!==1)X=Y(this,o,Gn).call(this);else{const Z=[_,L];X=[[Z,Z.slice(),Z.slice(),Z]]}const st=t(this,E),pt=this.currentPath;this.currentPath=[],ot(this,E,new Path2D);const Et=()=>{this.allRawPaths.push(pt),this.paths.push(X),this.bezierPath2D.push(st),this.rebuild()},At=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,o,we).call(this),Y(this,o,xe).call(this)),Y(this,o,ce).call(this))};this.addCommands({cmd:Et,undo:At,mustExec:!0})},Wn=function(){if(!t(this,u))return;ot(this,u,!1);const _=Math.ceil(this.thickness*this.parentScale),L=this.currentPath.slice(-3),X=L.map(Et=>Et[0]),st=L.map(Et=>Et[1]);Math.min(...X)-_,Math.max(...X)+_,Math.min(...st)-_,Math.max(...st)+_;const{ctx:pt}=this;pt.save(),pt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Et of this.bezierPath2D)pt.stroke(Et);pt.stroke(t(this,E)),pt.restore()},Hn=function(_,L,X,st,pt,Et,At){const Z=(L+st)/2,Pt=(X+pt)/2,Tt=(st+Et)/2,Ut=(pt+At)/2;_.bezierCurveTo(Z+2*(st-Z)/3,Pt+2*(pt-Pt)/3,Tt+2*(st-Tt)/3,Ut+2*(pt-Ut)/3,Tt,Ut)},Gn=function(){const _=this.currentPath;if(_.length<=2)return[[_[0],_[0],_.at(-1),_.at(-1)]];const L=[];let X,[st,pt]=_[0];for(X=1;X<_.length-2;X++){const[Bt,Vt]=_[X],[kt,It]=_[X+1],Ht=(Bt+kt)/2,qt=(Vt+It)/2,vt=[st+2*(Bt-st)/3,pt+2*(Vt-pt)/3],at=[Ht+2*(Bt-Ht)/3,qt+2*(Vt-qt)/3];L.push([[st,pt],vt,at,[Ht,qt]]),[st,pt]=[Ht,qt]}const[Et,At]=_[X],[Z,Pt]=_[X+1],Tt=[st+2*(Et-st)/3,pt+2*(At-pt)/3],Ut=[Z+2*(Et-Z)/3,Pt+2*(At-Pt)/3];return L.push([[st,pt],Tt,Ut,[Z,Pt]]),L},ee=function(){if(this.isEmpty()){Y(this,o,Ce).call(this);return}Y(this,o,an).call(this);const{canvas:_,ctx:L}=this;L.setTransform(1,0,0,1,0,0),L.clearRect(0,0,_.width,_.height),Y(this,o,Ce).call(this);for(const X of this.bezierPath2D)L.stroke(X)},ln=function(_){this.canvas.removeEventListener("pointerleave",t(this,I)),this.canvas.removeEventListener("pointermove",t(this,N)),this.canvas.removeEventListener("pointerup",t(this,b)),this.canvas.addEventListener("pointerdown",t(this,m)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",W.noContextMenu)},10),Y(this,o,Un).call(this,_.offsetX,_.offsetY),this.addToAnnotationStorage(),this.setInBackground()},we=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",d.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(_=>{var L;return(L=this.canvas)==null?void 0:L.setAttribute("aria-label",_)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},xe=function(){ot(this,M,new ResizeObserver(_=>{const L=_[0].contentRect;L.width&&L.height&&this.setDimensions(L.width,L.height)})),t(this,M).observe(this.div)},le=function(){if(!t(this,y))return;const[_,L]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*_),this.canvas.height=Math.ceil(this.height*L),Y(this,o,Ce).call(this)},cn=function(_,L){const X=Y(this,o,Re).call(this),st=(_-X)/t(this,p),pt=(L-X)/t(this,P);this.scaleFactor=Math.min(st,pt)},Ce=function(){const _=Y(this,o,Re).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+_,this.translationY*this.scaleFactor+_)},F=new WeakSet,$n=function(_){const L=new Path2D;for(let X=0,st=_.length;X<st;X++){const[pt,Et,At,Z]=_[X];X===0&&L.moveTo(...pt),L.bezierCurveTo(Et[0],Et[1],At[0],At[1],Z[0],Z[1])}return L},hn=function(_,L,X){const[st,pt,Et,At]=L;switch(X){case 0:for(let Z=0,Pt=_.length;Z<Pt;Z+=2)_[Z]+=st,_[Z+1]=At-_[Z+1];break;case 90:for(let Z=0,Pt=_.length;Z<Pt;Z+=2){const Tt=_[Z];_[Z]=_[Z+1]+st,_[Z+1]=Tt+pt}break;case 180:for(let Z=0,Pt=_.length;Z<Pt;Z+=2)_[Z]=Et-_[Z],_[Z+1]+=pt;break;case 270:for(let Z=0,Pt=_.length;Z<Pt;Z+=2){const Tt=_[Z];_[Z]=Et-_[Z+1],_[Z+1]=At-Tt}break;default:throw new Error("Invalid rotation")}return _},Vn=function(_,L,X){const[st,pt,Et,At]=L;switch(X){case 0:for(let Z=0,Pt=_.length;Z<Pt;Z+=2)_[Z]-=st,_[Z+1]=At-_[Z+1];break;case 90:for(let Z=0,Pt=_.length;Z<Pt;Z+=2){const Tt=_[Z];_[Z]=_[Z+1]-pt,_[Z+1]=Tt-st}break;case 180:for(let Z=0,Pt=_.length;Z<Pt;Z+=2)_[Z]=Et-_[Z],_[Z+1]-=pt;break;case 270:for(let Z=0,Pt=_.length;Z<Pt;Z+=2){const Tt=_[Z];_[Z]=At-_[Z+1],_[Z+1]=Et-Tt}break;default:throw new Error("Invalid rotation")}return _},zn=function(_,L,X,st){var Pt,Tt;const pt=[],Et=this.thickness/2,At=_*L+Et,Z=_*X+Et;for(const Ut of this.paths){const Bt=[],Vt=[];for(let kt=0,It=Ut.length;kt<It;kt++){const[Ht,qt,vt,at]=Ut[kt],lt=_*Ht[0]+At,Rt=_*Ht[1]+Z,zt=_*qt[0]+At,$t=_*qt[1]+Z,j=_*vt[0]+At,gt=_*vt[1]+Z,wt=_*at[0]+At,Dt=_*at[1]+Z;kt===0&&(Bt.push(lt,Rt),Vt.push(lt,Rt)),Bt.push(zt,$t,j,gt,wt,Dt),Vt.push(zt,$t),kt===It-1&&Vt.push(wt,Dt)}pt.push({bezier:Y(Pt=_t,F,hn).call(Pt,Bt,st,this.rotation),points:Y(Tt=_t,F,hn).call(Tt,Vt,st,this.rotation)})}return pt},dn=function(){let _=1/0,L=-1/0,X=1/0,st=-1/0;for(const pt of this.paths)for(const[Et,At,Z,Pt]of pt){const Tt=n.Util.bezierBoundingBox(...Et,...At,...Z,...Pt);_=Math.min(_,Tt[0]),X=Math.min(X,Tt[1]),L=Math.max(L,Tt[2]),st=Math.max(st,Tt[3])}return[_,X,L,st]},Re=function(){return t(this,g)?Math.ceil(this.thickness*this.parentScale):0},ce=function(_=!1){if(this.isEmpty())return;if(!t(this,g)){Y(this,o,ee).call(this);return}const L=Y(this,o,dn).call(this),X=Y(this,o,Re).call(this);ot(this,p,Math.max(d.AnnotationEditor.MIN_SIZE,L[2]-L[0])),ot(this,P,Math.max(d.AnnotationEditor.MIN_SIZE,L[3]-L[1]));const st=Math.ceil(X+t(this,p)*this.scaleFactor),pt=Math.ceil(X+t(this,P)*this.scaleFactor),[Et,At]=this.parentDimensions;this.width=st/Et,this.height=pt/At,this.setAspectRatio(st,pt);const Z=this.translationX,Pt=this.translationY;this.translationX=-L[0],this.translationY=-L[1],Y(this,o,le).call(this),Y(this,o,ee).call(this),ot(this,A,st),ot(this,a,pt),this.setDims(st,pt);const Tt=_?X/this.scaleFactor/2:0;this.translate(Z-this.translationX-Tt,Pt-this.translationY-Tt)},rt(_t,F),Kt(_t,"_defaultColor",null),Kt(_t,"_defaultOpacity",1),Kt(_t,"_defaultThickness",1),Kt(_t,"_type","ink");let x=_t;e.InkEditor=x},(B,e,U)=>{var x,P,p,N,I,b,m,E,g,u,y,me,be,ke,un,qn,Xn,fn,Fe,Yn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=U(1),d=U(4),V=U(6),W=U(29);const v=class v extends d.AnnotationEditor{constructor($){super({...$,name:"stampEditor"});rt(this,y);rt(this,x,null);rt(this,P,null);rt(this,p,null);rt(this,N,null);rt(this,I,null);rt(this,b,null);rt(this,m,null);rt(this,E,null);rt(this,g,!1);rt(this,u,!1);ot(this,N,$.bitmapUrl),ot(this,I,$.bitmapFile)}static initialize($){d.AnnotationEditor.initialize($)}static get supportedTypes(){const $=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",$.map(K=>`image/${K}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting($){return this.supportedTypes.includes($)}static paste($,K){K.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:$.getAsFile()})}remove(){var $,K;t(this,P)&&(ot(this,x,null),this._uiManager.imageManager.deleteId(t(this,P)),($=t(this,b))==null||$.remove(),ot(this,b,null),(K=t(this,m))==null||K.disconnect(),ot(this,m,null)),super.remove()}rebuild(){if(!this.parent){t(this,P)&&Y(this,y,ke).call(this);return}super.rebuild(),this.div!==null&&(t(this,P)&&Y(this,y,ke).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,p)||t(this,x)||t(this,N)||t(this,I))}get isResizable(){return!0}render(){if(this.div)return this.div;let $,K;if(this.width&&($=this.x,K=this.y),super.render(),this.div.hidden=!0,t(this,x)?Y(this,y,un).call(this):Y(this,y,ke).call(this),this.width){const[H,it]=this.parentDimensions;this.setAt($*H,K*it,this.width*H,this.height*it)}return this.div}static deserialize($,K,H){if($ instanceof W.StampAnnotationElement)return null;const it=super.deserialize($,K,H),{rect:w,bitmapUrl:G,bitmapId:et,isSvg:S,accessibilityData:s}=$;et&&H.imageManager.isValidId(et)?ot(it,P,et):ot(it,N,G),ot(it,g,S);const[i,f]=it.pageDimensions;return it.width=(w[2]-w[0])/i,it.height=(w[3]-w[1])/f,s&&(it.altTextData=s),it}serialize($=!1,K=null){if(this.isEmpty())return null;const H={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,P),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,g),structTreeParentId:this._structTreeParentId};if($)return H.bitmapUrl=Y(this,y,Fe).call(this,!0),H.accessibilityData=this.altTextData,H;const{decorative:it,altText:w}=this.altTextData;if(!it&&w&&(H.accessibilityData={type:"Figure",alt:w}),K===null)return H;K.stamps||(K.stamps=new Map);const G=t(this,g)?(H.rect[2]-H.rect[0])*(H.rect[3]-H.rect[1]):null;if(!K.stamps.has(t(this,P)))K.stamps.set(t(this,P),{area:G,serialized:H}),H.bitmap=Y(this,y,Fe).call(this,!1);else if(t(this,g)){const et=K.stamps.get(t(this,P));G>et.area&&(et.area=G,et.serialized.bitmap.close(),et.serialized.bitmap=Y(this,y,Fe).call(this,!1))}return H}};x=new WeakMap,P=new WeakMap,p=new WeakMap,N=new WeakMap,I=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakSet,me=function($,K=!1){if(!$){this.remove();return}ot(this,x,$.bitmap),K||(ot(this,P,$.id),ot(this,g,$.isSvg)),Y(this,y,un).call(this)},be=function(){ot(this,p,null),this._uiManager.enableWaiting(!1),t(this,b)&&this.div.focus()},ke=function(){if(t(this,P)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,P)).then(K=>Y(this,y,me).call(this,K,!0)).finally(()=>Y(this,y,be).call(this));return}if(t(this,N)){const K=t(this,N);ot(this,N,null),this._uiManager.enableWaiting(!0),ot(this,p,this._uiManager.imageManager.getFromUrl(K).then(H=>Y(this,y,me).call(this,H)).finally(()=>Y(this,y,be).call(this)));return}if(t(this,I)){const K=t(this,I);ot(this,I,null),this._uiManager.enableWaiting(!0),ot(this,p,this._uiManager.imageManager.getFromFile(K).then(H=>Y(this,y,me).call(this,H)).finally(()=>Y(this,y,be).call(this)));return}const $=document.createElement("input");$.type="file",$.accept=v.supportedTypesStr,ot(this,p,new Promise(K=>{$.addEventListener("change",async()=>{if(!$.files||$.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const H=await this._uiManager.imageManager.getFromFile($.files[0]);Y(this,y,me).call(this,H)}K()}),$.addEventListener("cancel",()=>{this.remove(),K()})}).finally(()=>Y(this,y,be).call(this))),$.click()},un=function(){const{div:$}=this;let{width:K,height:H}=t(this,x);const[it,w]=this.pageDimensions,G=.75;if(this.width)K=this.width*it,H=this.height*w;else if(K>G*it||H>G*w){const i=Math.min(G*it/K,G*w/H);K*=i,H*=i}const[et,S]=this.parentDimensions;this.setDims(K*et/it,H*S/w),this._uiManager.enableWaiting(!1);const s=ot(this,b,document.createElement("canvas"));$.append(s),$.hidden=!1,Y(this,y,fn).call(this,K,H),Y(this,y,Yn).call(this),t(this,u)||(this.parent.addUndoableEditor(this),ot(this,u,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},qn=function($,K){var G;const[H,it]=this.parentDimensions;this.width=$/H,this.height=K/it,this.setDims($,K),(G=this._initialOptions)!=null&&G.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,E)!==null&&clearTimeout(t(this,E)),ot(this,E,setTimeout(()=>{ot(this,E,null),Y(this,y,fn).call(this,$,K)},200))},Xn=function($,K){const{width:H,height:it}=t(this,x);let w=H,G=it,et=t(this,x);for(;w>2*$||G>2*K;){const S=w,s=G;w>2*$&&(w=w>=16384?Math.floor(w/2)-1:Math.ceil(w/2)),G>2*K&&(G=G>=16384?Math.floor(G/2)-1:Math.ceil(G/2));const i=new OffscreenCanvas(w,G);i.getContext("2d").drawImage(et,0,0,S,s,0,0,w,G),et=i.transferToImageBitmap()}return et},fn=function($,K){$=Math.ceil($),K=Math.ceil(K);const H=t(this,b);if(!H||H.width===$&&H.height===K)return;H.width=$,H.height=K;const it=t(this,g)?t(this,x):Y(this,y,Xn).call(this,$,K),w=H.getContext("2d");w.filter=this._uiManager.hcmFilter,w.drawImage(it,0,0,it.width,it.height,0,0,$,K)},Fe=function($){if($){if(t(this,g)){const it=this._uiManager.imageManager.getSvgUrl(t(this,P));if(it)return it}const K=document.createElement("canvas");return{width:K.width,height:K.height}=t(this,x),K.getContext("2d").drawImage(t(this,x),0,0),K.toDataURL()}if(t(this,g)){const[K,H]=this.pageDimensions,it=Math.round(this.width*K*V.PixelsPerInch.PDF_TO_CSS_UNITS),w=Math.round(this.height*H*V.PixelsPerInch.PDF_TO_CSS_UNITS),G=new OffscreenCanvas(it,w);return G.getContext("2d").drawImage(t(this,x),0,0,t(this,x).width,t(this,x).height,0,0,it,w),G.transferToImageBitmap()}return structuredClone(t(this,x))},Yn=function(){ot(this,m,new ResizeObserver($=>{const K=$[0].contentRect;K.width&&K.height&&Y(this,y,qn).call(this,K.width,K.height)})),t(this,m).observe(this.div)},Kt(v,"_type","stamp");let dt=v;e.StampEditor=dt}],__webpack_module_cache__={};function __w_pdfjs_require__(B){var e=__webpack_module_cache__[B];if(e!==void 0)return e.exports;var U=__webpack_module_cache__[B]={exports:{}};return __webpack_modules__[B](U,U.exports,__w_pdfjs_require__),U.exports}var __webpack_exports__={};return(()=>{var B=__webpack_exports__;Object.defineProperty(B,"__esModule",{value:!0}),Object.defineProperty(B,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(B,"AnnotationEditorLayer",{enumerable:!0,get:function(){return V.AnnotationEditorLayer}}),Object.defineProperty(B,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(B,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(B,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return W.AnnotationEditorUIManager}}),Object.defineProperty(B,"AnnotationLayer",{enumerable:!0,get:function(){return dt.AnnotationLayer}}),Object.defineProperty(B,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(B,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(B,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(B,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(B,"GlobalWorkerOptions",{enumerable:!0,get:function(){return x.GlobalWorkerOptions}}),Object.defineProperty(B,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(B,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(B,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(B,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(B,"PDFDataRangeTransport",{enumerable:!0,get:function(){return U.PDFDataRangeTransport}}),Object.defineProperty(B,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(B,"PDFWorker",{enumerable:!0,get:function(){return U.PDFWorker}}),Object.defineProperty(B,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(B,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(B,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(B,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(B,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(B,"SVGGraphics",{enumerable:!0,get:function(){return U.SVGGraphics}}),Object.defineProperty(B,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(B,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(B,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(B,"XfaLayer",{enumerable:!0,get:function(){return P.XfaLayer}}),Object.defineProperty(B,"build",{enumerable:!0,get:function(){return U.build}}),Object.defineProperty(B,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(B,"getDocument",{enumerable:!0,get:function(){return U.getDocument}}),Object.defineProperty(B,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(B,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(B,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(B,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(B,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(B,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(B,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(B,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(B,"renderTextLayer",{enumerable:!0,get:function(){return d.renderTextLayer}}),Object.defineProperty(B,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(B,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(B,"updateTextLayer",{enumerable:!0,get:function(){return d.updateTextLayer}}),Object.defineProperty(B,"version",{enumerable:!0,get:function(){return U.version}});var e=__w_pdfjs_require__(1),U=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),d=__w_pdfjs_require__(26),V=__w_pdfjs_require__(27),W=__w_pdfjs_require__(5),dt=__w_pdfjs_require__(29),x=__w_pdfjs_require__(14),P=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule;var __spreadArray=function(B,e,U){if(U||arguments.length===2)for(var n=0,d=e.length,V;n<d;n++)(V||!(n in e))&&(V||(V=Array.prototype.slice.call(e,0,n)),V[n]=e[n]);return B.concat(V||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(B,e){var U={};return allEvents.forEach(function(n){var d=B[n];d&&(e?U[n]=function(V){return d(V,e(n))}:U[n]=d)}),U}function makeCancellablePromise(B){var e=!1,U=new Promise(function(n,d){B.then(function(V){return!e&&n(V)}).catch(function(V){return!e&&d(V)})});return{promise:U,cancel:function(){e=!0}}}var prefix="Invariant failed";function invariant(B,e){if(!B)throw new Error(prefix)}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var has=Object.prototype.hasOwnProperty;function find(B,e,U){for(U of B.keys())if(dequal(U,e))return U}function dequal(B,e){var U,n,d;if(B===e)return!0;if(B&&e&&(U=B.constructor)===e.constructor){if(U===Date)return B.getTime()===e.getTime();if(U===RegExp)return B.toString()===e.toString();if(U===Array){if((n=B.length)===e.length)for(;n--&&dequal(B[n],e[n]););return n===-1}if(U===Set){if(B.size!==e.size)return!1;for(n of B)if(d=n,d&&typeof d=="object"&&(d=find(e,d),!d)||!e.has(d))return!1;return!0}if(U===Map){if(B.size!==e.size)return!1;for(n of B)if(d=n[0],d&&typeof d=="object"&&(d=find(e,d),!d)||!dequal(n[1],e.get(d)))return!1;return!0}if(U===ArrayBuffer)B=new Uint8Array(B),e=new Uint8Array(e);else if(U===DataView){if((n=B.byteLength)===e.byteLength)for(;n--&&B.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(B)){if((n=B.byteLength)===e.byteLength)for(;n--&&B[n]===e[n];);return n===-1}if(!U||typeof B=="object"){n=0;for(U in B)if(has.call(B,U)&&++n&&!has.call(e,U)||!(U in e)||!dequal(B[U],e[U]))return!1;return Object.keys(e).length===n}}return B!==B&&e!==e}const DocumentContext=reactExports.createContext(null);function Message({children:B,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},B)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(U=>{invariant(this.pdfDocument),invariant(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(U):Array.isArray(e)?U(e):e.then(U)}).then(U=>{invariant(Array.isArray(U));const n=U[0];new Promise(d=>{invariant(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(V=>{d(V)}).catch(()=>{invariant(!1)}):typeof n=="number"?d(n):invariant(!1)}).then(d=>{const V=d+1;invariant(this.pdfViewer),invariant(V>=1&&V<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:U,pageIndex:d,pageNumber:V})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const U=e-1;invariant(this.pdfViewer),invariant(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:U,pageNumber:e})}addLinkAttributes(e,U,n){e.href=U,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(B){return typeof B<"u"}function isProvided(B){return isDefined(B)&&B!==null}function isString(B){return typeof B=="string"}function isArrayBuffer(B){return B instanceof ArrayBuffer}function isBlob(B){return invariant(isBrowser),B instanceof Blob}function isDataURI(B){return isString(B)&&/^data:/.test(B)}function dataURItoByteString(B){invariant(isDataURI(B));const[e="",U=""]=B.split(",");return e.split(";").indexOf("base64")!==-1?atob(U):unescape(U)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(B){B&&B.cancel&&B.cancel()}function makePageCallback(B,e){return Object.defineProperty(B,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(B,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(B,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(B,"originalHeight",{get(){return this.view[3]},configurable:!0}),B}function isCancelException(B){return B.name==="RenderingCancelledException"}function loadFromFile(B){return new Promise((e,U)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return U(new Error("Error while reading a file."));e(n.result)},n.onerror=d=>{if(!d.target)return U(new Error("Error while reading a file."));const{error:V}=d.target;if(!V)return U(new Error("Error while reading a file."));switch(V.code){case V.NOT_FOUND_ERR:return U(new Error("Error while reading a file: File not found."));case V.SECURITY_ERR:return U(new Error("Error while reading a file: Security error."));case V.ABORT_ERR:return U(new Error("Error while reading a file: Aborted."));default:return U(new Error("Error while reading a file."))}},n.readAsArrayBuffer(B)})}function reducer(B,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return B}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const B={};return allEvents.forEach(e=>{B[e]=PropTypes.func}),B})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function B(e,U,n){const{[U]:d,pageNumber:V,pdf:W}=e;if(!isDefined(W))return null;if(isDefined(d)){if(typeof d!="number")return new Error(`\`${U}\` of type \`${typeof d}\` supplied to \`${n}\`, expected \`number\`.`);if(d<0)return new Error(`Expected \`${U}\` to be greater or equal to 0.`);const{numPages:dt}=W;if(d+1>dt)return new Error(`Expected \`${U}\` to be less or equal to ${dt-1}.`)}else if(!isDefined(V))return new Error(`\`${U}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPageNumber=function B(e,U,n){const{[U]:d,pageIndex:V,pdf:W}=e;if(!isDefined(W))return null;if(isDefined(d)){if(typeof d!="number")return new Error(`\`${U}\` of type \`${typeof d}\` supplied to \`${n}\`, expected \`number\`.`);if(d<1)return new Error(`Expected \`${U}\` to be greater or equal to 1.`);const{numPages:dt}=W;if(d>dt)return new Error(`Expected \`${U}\` to be less or equal to ${dt}.`)}else if(!isDefined(V))return new Error(`\`${U}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(B,e,U,n){function d(V){return V instanceof U?V:new U(function(W){W(V)})}return new(U||(U=Promise))(function(V,W){function dt(p){try{P(n.next(p))}catch(N){W(N)}}function x(p){try{P(n.throw(p))}catch(N){W(N)}}function P(p){p.done?V(p.value):d(p.value).then(dt,x)}P((n=n.apply(B,e||[])).next())})},__rest$1=function(B,e){var U={};for(var n in B)Object.prototype.hasOwnProperty.call(B,n)&&e.indexOf(n)<0&&(U[n]=B[n]);if(B!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(B);d<n.length;d++)e.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(B,n[d])&&(U[n[d]]=B[n[d]]);return U};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(B,e)=>{switch(e){case PasswordResponses.NEED_PASSWORD:{const U=prompt("Enter the password to open this PDF file.");B(U);break}case PasswordResponses.INCORRECT_PASSWORD:{const U=prompt("Invalid password. Please try again.");B(U);break}}};function isParameterObject(B){return typeof B=="object"&&B!==null&&("data"in B||"range"in B||"url"in B)}const Document=reactExports.forwardRef(function B(e,U){var{children:n,className:d,error:V="Failed to load PDF file.",externalLinkRel:W,externalLinkTarget:dt,file:x,inputRef:P,imageResourcesPath:p,loading:N="Loading PDF…",noData:I="No PDF file specified.",onItemClick:b,onLoadError:m,onLoadProgress:E,onLoadSuccess:g,onPassword:u=defaultOnPassword,onSourceError:y,onSourceSuccess:M,options:A,renderMode:a,rotate:h}=e,o=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[l,c]=useResolver(),{value:O,error:r}=l,[v,C]=useResolver(),{value:tt,error:$}=v,K=reactExports.useRef(new LinkService),H=reactExports.useRef([]),it=reactExports.useRef(),w=reactExports.useRef();reactExports.useEffect(()=>{x&&x!==it.current&&isParameterObject(x)&&(warning$1(!dequal(x,it.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),it.current=x)},[x]),reactExports.useEffect(()=>{A&&A!==w.current&&(warning$1(!dequal(A,w.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),w.current=A)},[A]);const G=reactExports.useRef({scrollPageIntoView:J=>{const{dest:Q,pageNumber:_,pageIndex:L=_-1}=J;if(b){b({dest:Q,pageIndex:L,pageNumber:_});return}const X=H.current[L];if(X){X.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${_} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(U,()=>({linkService:K,pages:H,viewer:G}),[]);function et(){M&&M()}function S(){r&&(warning$1(!1,r.toString()),y&&y(r))}function s(){c({type:"RESET"})}reactExports.useEffect(s,[x,c]);const i=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!x)return null;if(typeof x=="string")return isDataURI(x)?{data:dataURItoByteString(x)}:(displayCORSWarning(),{url:x});if(x instanceof PDFDataRangeTransport)return{range:x};if(isArrayBuffer(x))return{data:x};if(isBrowser&&isBlob(x))return{data:yield loadFromFile(x)};if(invariant(typeof x=="object"),invariant(isParameterObject(x)),"url"in x&&typeof x.url=="string"){if(isDataURI(x.url)){const{url:J}=x,Q=__rest$1(x,["url"]),_=dataURItoByteString(J);return Object.assign({data:_},Q)}displayCORSWarning()}return x}),[x]);reactExports.useEffect(()=>{const J=makeCancellablePromise(i());return J.promise.then(Q=>{c({type:"RESOLVE",value:Q})}).catch(Q=>{c({type:"REJECT",error:Q})}),()=>{cancelRunningTask(J)}},[i,c]),reactExports.useEffect(()=>{if(!(typeof O>"u")){if(O===!1){S();return}et()}},[O]);function f(){tt&&(g&&g(tt),H.current=new Array(tt.numPages),K.current.setDocument(tt))}function k(){$&&(warning$1(!1,$.toString()),m&&m($))}function F(){C({type:"RESET"})}reactExports.useEffect(F,[C,O]);function D(){if(!O)return;const J=Object.assign(Object.assign({},A),{isEvalSupported:!1}),Q=Object.assign(Object.assign({},O),J),_=pdfjs.getDocument(Q);E&&(_.onProgress=E),u&&(_.onPassword=u);const L=_;return L.promise.then(X=>{C({type:"RESOLVE",value:X})}).catch(X=>{L.destroyed||C({type:"REJECT",error:X})}),()=>{L.destroy()}}reactExports.useEffect(D,[A,C,O]),reactExports.useEffect(()=>{if(!(typeof tt>"u")){if(tt===!1){k();return}f()}},[tt]);function q(){K.current.setViewer(G.current),K.current.setExternalLinkRel(W),K.current.setExternalLinkTarget(dt)}reactExports.useEffect(q,[W,dt]);function nt(J,Q){H.current[J]=Q}function ct(J){delete H.current[J]}const ft=reactExports.useMemo(()=>({imageResourcesPath:p,linkService:K.current,onItemClick:b,pdf:tt,registerPage:nt,renderMode:a,rotate:h,unregisterPage:ct}),[p,b,tt,a,h]),bt=reactExports.useMemo(()=>makeEventProps(o,()=>tt),[o,tt]);function mt(){return React.createElement(DocumentContext.Provider,{value:ft},n)}function _t(){return x?tt==null?React.createElement(Message,{type:"loading"},typeof N=="function"?N():N):tt===!1?React.createElement(Message,{type:"error"},typeof V=="function"?V():V):mt():React.createElement(Message,{type:"no-data"},typeof I=="function"?I():I)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",d),ref:P,style:{"--scale-factor":"1"}},bt),_t())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var B=[],e=0;e<arguments.length;e++)B[e]=arguments[e];var U=B.filter(Boolean);if(U.length<=1){var n=U[0];return n||null}return function(V){U.forEach(function(W){typeof W=="function"?W(V):W&&(W.current=V)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(B){return B in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(B){return"children"in B}function isStructTreeNodeWithOnlyContentChild(B){return isStructTreeNode(B)?B.children.length===1&&0 in B.children&&"id"in B.children[0]:!1}function getRoleAttributes(B){const e={};if(isStructTreeNode(B)){const{role:U}=B,n=U.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(U)){const d=PDF_ROLE_TO_HTML_ROLE[U];d&&(e.role=d)}}return e}function getBaseAttributes(B){const e={};if(isStructTreeNode(B)){if(B.alt!==void 0&&(e["aria-label"]=B.alt),B.lang!==void 0&&(e.lang=B.lang),isStructTreeNodeWithOnlyContentChild(B)){const[U]=B.children;if(U){const n=getBaseAttributes(U);return Object.assign(Object.assign({},e),n)}}}else"id"in B&&(e["aria-owns"]=B.id);return e}function getAttributes(B){return B?Object.assign(Object.assign({},getRoleAttributes(B)),getBaseAttributes(B)):null}function StructTreeItem({className:B,node:e}){const U=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((d,V)=>React.createElement(StructTreeItem,{key:V,node:d})),[e]);return React.createElement("span",Object.assign({className:B},U),n)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const B=usePageContext();invariant(B);const{onGetStructTreeError:e,onGetStructTreeSuccess:U}=B,[n,d]=useResolver(),{value:V,error:W}=n,{customTextRenderer:dt,page:x}=B;function P(){V&&U&&U(V)}function p(){W&&(warning$1(!1,W.toString()),e&&e(W))}function N(){d({type:"RESET"})}reactExports.useEffect(N,[d,x]);function I(){if(dt||!x)return;const b=makeCancellablePromise(x.getStructTree()),m=b;return b.promise.then(E=>{d({type:"RESOLVE",value:E})}).catch(E=>{d({type:"REJECT",error:E})}),()=>cancelRunningTask(m)}return reactExports.useEffect(I,[dt,x,d]),reactExports.useEffect(()=>{if(V!==void 0){if(V===!1){p();return}P()}},[V]),V?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:V}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(B){const e=usePageContext();invariant(e);const U=Object.assign(Object.assign({},e),B),{_className:n,canvasBackground:d,devicePixelRatio:V=getDevicePixelRatio(),onRenderError:W,onRenderSuccess:dt,page:x,renderForms:P,renderTextLayer:p,rotate:N,scale:I}=U,{canvasRef:b}=B;invariant(x);const m=reactExports.useRef(null);function E(){x&&dt&&dt(makePageCallback(x,I))}function g(a){isCancelException(a)||(warning$1(!1,a.toString()),W&&W(a))}const u=reactExports.useMemo(()=>x.getViewport({scale:I*V,rotation:N}),[V,x,N,I]),y=reactExports.useMemo(()=>x.getViewport({scale:I,rotation:N}),[x,N,I]);function M(){if(!x)return;x.cleanup();const{current:a}=m;if(!a)return;a.width=u.width,a.height=u.height,a.style.width=`${Math.floor(y.width)}px`,a.style.height=`${Math.floor(y.height)}px`,a.style.visibility="hidden";const h={annotationMode:P?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:a.getContext("2d",{alpha:!1}),viewport:u};d&&(h.background=d);const o=x.render(h),l=o;return o.promise.then(()=>{a.style.visibility="",E()}).catch(g),()=>cancelRunningTask(l)}reactExports.useEffect(M,[d,m,V,x,P,u,y]);const A=reactExports.useCallback(()=>{const{current:a}=m;a&&(a.width=0,a.height=0)},[m]);return reactExports.useEffect(()=>A,[A]),React.createElement("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(b,m),style:{display:"block",userSelect:"none"}},p?React.createElement(StructTree,null):null)}function PageSVG(){const B=usePageContext();invariant(B);const{_className:e,onRenderSuccess:U,onRenderError:n,page:d,rotate:V,scale:W}=B;invariant(d);const[dt,x]=useResolver(),{value:P,error:p}=dt;function N(){d&&U&&U(makePageCallback(d,W))}function I(){p&&(isCancelException(p)||(warning$1(!1,p.toString()),n&&n(p)))}const b=reactExports.useMemo(()=>d.getViewport({scale:W,rotation:V}),[d,V,W]);function m(){x({type:"RESET"})}reactExports.useEffect(m,[d,x,b]);function E(){if(!d)return;const M=makeCancellablePromise(d.getOperatorList());return M.promise.then(A=>{new pdfjs.SVGGraphics(d.commonObjs,d.objs).getSVG(A,b).then(h=>{if(!(h instanceof SVGElement))throw new Error("getSVG returned unexpected result.");x({type:"RESOLVE",value:h})}).catch(h=>{x({type:"REJECT",error:h})})}).catch(A=>{x({type:"REJECT",error:A})}),()=>cancelRunningTask(M)}reactExports.useEffect(E,[d,x,b]),reactExports.useEffect(()=>{if(P!==void 0){if(P===!1){I();return}N()}},[P]);function g(M){if(!M||!P)return;M.firstElementChild||M.appendChild(P);const{width:A,height:a}=b;P.setAttribute("width",`${A}`),P.setAttribute("height",`${a}`)}const{width:u,height:y}=b;return React.createElement("div",{className:`${e}__svg`,ref:M=>g(M),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:u,height:y,userSelect:"none"}})}function isTextItem(B){return"str"in B}function TextLayer(){const B=usePageContext();invariant(B);const{customTextRenderer:e,onGetTextError:U,onGetTextSuccess:n,onRenderTextLayerError:d,onRenderTextLayerSuccess:V,page:W,pageIndex:dt,pageNumber:x,rotate:P,scale:p}=B;invariant(W);const[N,I]=useResolver(),{value:b,error:m}=N,E=reactExports.useRef(null),g=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function u(){b&&n&&n(b)}function y(){m&&(warning$1(!1,m.toString()),U&&U(m))}function M(){I({type:"RESET"})}reactExports.useEffect(M,[W,I]);function A(){if(!W)return;const r=makeCancellablePromise(W.getTextContent()),v=r;return r.promise.then(C=>{I({type:"RESOLVE",value:C})}).catch(C=>{I({type:"REJECT",error:C})}),()=>cancelRunningTask(v)}reactExports.useEffect(A,[W,I]),reactExports.useEffect(()=>{if(b!==void 0){if(b===!1){y();return}u()}},[b]);const a=reactExports.useCallback(()=>{V&&V()},[V]),h=reactExports.useCallback(r=>{warning$1(!1,r.toString()),d&&d(r)},[d]);function o(){const r=g.current;r&&r.classList.add("active")}function l(){const r=g.current;r&&r.classList.remove("active")}const c=reactExports.useMemo(()=>W.getViewport({scale:p,rotation:P}),[W,P,p]);function O(){if(!W||!b)return;const{current:r}=E;if(!r)return;r.innerHTML="";const v=W.streamTextContent({includeMarkedContent:!0}),C={container:r,textContentSource:v,viewport:c},tt=pdfjs.renderTextLayer(C),$=tt;return tt.promise.then(()=>{const K=document.createElement("div");K.className="endOfContent",r.append(K),g.current=K;const H=r.querySelectorAll('[role="presentation"]');if(e){let it=0;b.items.forEach((w,G)=>{if(!isTextItem(w))return;const et=H[it];if(!et)return;const S=e(Object.assign({pageIndex:dt,pageNumber:x,itemIndex:G},w));et.innerHTML=S,it+=w.str&&w.hasEOL?2:1})}a()}).catch(h),()=>cancelRunningTask($)}return reactExports.useLayoutEffect(O,[e,h,a,W,dt,x,b,c]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:l,onMouseDown:o,ref:E})}function AnnotationLayer(){const B=useDocumentContext(),e=usePageContext();invariant(e);const U=Object.assign(Object.assign({},B),e),{imageResourcesPath:n,linkService:d,onGetAnnotationsError:V,onGetAnnotationsSuccess:W,onRenderAnnotationLayerError:dt,onRenderAnnotationLayerSuccess:x,page:P,pdf:p,renderForms:N,rotate:I,scale:b=1}=U;invariant(p),invariant(P),invariant(d);const[m,E]=useResolver(),{value:g,error:u}=m,y=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function M(){g&&W&&W(g)}function A(){u&&(warning$1(!1,u.toString()),V&&V(u))}function a(){E({type:"RESET"})}reactExports.useEffect(a,[E,P]);function h(){if(!P)return;const r=makeCancellablePromise(P.getAnnotations()),v=r;return r.promise.then(C=>{E({type:"RESOLVE",value:C})}).catch(C=>{E({type:"REJECT",error:C})}),()=>{cancelRunningTask(v)}}reactExports.useEffect(h,[E,P,N]),reactExports.useEffect(()=>{if(g!==void 0){if(g===!1){A();return}M()}},[g]);function o(){x&&x()}function l(r){warning$1(!1,`${r}`),dt&&dt(r)}const c=reactExports.useMemo(()=>P.getViewport({scale:b,rotation:I}),[P,I,b]);function O(){if(!p||!P||!d||!g)return;const{current:r}=y;if(!r)return;const v=c.clone({dontFlip:!0}),C={accessibilityManager:null,annotationCanvasMap:null,div:r,l10n:null,page:P,viewport:v},tt={annotations:g,annotationStorage:p.annotationStorage,div:r,downloadManager:null,imageResourcesPath:n,linkService:d,page:P,renderForms:N,viewport:v};r.innerHTML="";try{new pdfjs.AnnotationLayer(C).render(tt),o()}catch($){l($)}return()=>{}}return reactExports.useEffect(O,[g,n,d,P,N,c]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:y})}var __rest=function(B,e){var U={};for(var n in B)Object.prototype.hasOwnProperty.call(B,n)&&e.indexOf(n)<0&&(U[n]=B[n]);if(B!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,n=Object.getOwnPropertySymbols(B);d<n.length;d++)e.indexOf(n[d])<0&&Object.prototype.propertyIsEnumerable.call(B,n[d])&&(U[n[d]]=B[n[d]]);return U};const defaultScale=1,Page=function B(e){const U=useDocumentContext(),n=Object.assign(Object.assign({},U),e),{_className:d="react-pdf__Page",_enableRegisterUnregisterPage:V=!0,canvasBackground:W,canvasRef:dt,children:x,className:P,customRenderer:p,customTextRenderer:N,devicePixelRatio:I,error:b="Failed to load the page.",height:m,inputRef:E,loading:g="Loading page…",noData:u="No page specified.",onGetAnnotationsError:y,onGetAnnotationsSuccess:M,onGetStructTreeError:A,onGetStructTreeSuccess:a,onGetTextError:h,onGetTextSuccess:o,onLoadError:l,onLoadSuccess:c,onRenderAnnotationLayerError:O,onRenderAnnotationLayerSuccess:r,onRenderError:v,onRenderSuccess:C,onRenderTextLayerError:tt,onRenderTextLayerSuccess:$,pageIndex:K,pageNumber:H,pdf:it,registerPage:w,renderAnnotationLayer:G=!0,renderForms:et=!1,renderMode:S="canvas",renderTextLayer:s=!0,rotate:i,scale:f=defaultScale,unregisterPage:k,width:F}=n,D=__rest(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[q,nt]=useResolver(),{value:ct,error:ft}=q,bt=reactExports.useRef(null);invariant(it);const mt=isProvided(H)?H-1:K??null,_t=H??(isProvided(K)?K+1:null),J=i??(ct?ct.rotate:null),Q=reactExports.useMemo(()=>{if(!ct)return null;let It=1;const Ht=f??defaultScale;if(F||m){const qt=ct.getViewport({scale:1,rotation:J});F?It=F/qt.width:m&&(It=m/qt.height)}return Ht*It},[m,ct,J,f,F]);function _(){return()=>{isProvided(mt)&&V&&k&&k(mt)}}reactExports.useEffect(_,[V,it,mt,k]);function L(){if(c){if(!ct||!Q)return;c(makePageCallback(ct,Q))}if(V&&w){if(!isProvided(mt)||!bt.current)return;w(mt,bt.current)}}function X(){ft&&(warning$1(!1,ft.toString()),l&&l(ft))}function st(){nt({type:"RESET"})}reactExports.useEffect(st,[nt,it,mt]);function pt(){if(!it||!_t)return;const It=makeCancellablePromise(it.getPage(_t)),Ht=It;return It.promise.then(qt=>{nt({type:"RESOLVE",value:qt})}).catch(qt=>{nt({type:"REJECT",error:qt})}),()=>cancelRunningTask(Ht)}reactExports.useEffect(pt,[nt,it,mt,_t,w]),reactExports.useEffect(()=>{if(ct!==void 0){if(ct===!1){X();return}L()}},[ct,Q]);const Et=reactExports.useMemo(()=>ct&&isProvided(mt)&&_t&&isProvided(J)&&isProvided(Q)?{_className:d,canvasBackground:W,customTextRenderer:N,devicePixelRatio:I,onGetAnnotationsError:y,onGetAnnotationsSuccess:M,onGetStructTreeError:A,onGetStructTreeSuccess:a,onGetTextError:h,onGetTextSuccess:o,onRenderAnnotationLayerError:O,onRenderAnnotationLayerSuccess:r,onRenderError:v,onRenderSuccess:C,onRenderTextLayerError:tt,onRenderTextLayerSuccess:$,page:ct,pageIndex:mt,pageNumber:_t,renderForms:et,renderTextLayer:s,rotate:J,scale:Q}:null,[d,W,N,I,y,M,A,a,h,o,O,r,v,C,tt,$,ct,mt,_t,et,s,J,Q]),At=reactExports.useMemo(()=>makeEventProps(D,()=>ct&&(Q?makePageCallback(ct,Q):void 0)),[D,ct,Q]),Z=`${mt}@${Q}/${J}`,Pt=`${mt}/${J}`;function Tt(){switch(S){case"custom":return invariant(p),React.createElement(p,{key:`${Z}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${Pt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${Z}_canvas`,canvasRef:dt})}}function Ut(){return s?React.createElement(TextLayer,{key:`${Z}_text`}):null}function Bt(){return G?React.createElement(AnnotationLayer,{key:`${Z}_annotations`}):null}function Vt(){return React.createElement(PageContext.Provider,{value:Et},Tt(),Ut(),Bt(),x)}function kt(){return _t?it===null||ct===void 0||ct===null?React.createElement(Message,{type:"loading"},typeof g=="function"?g():g):it===!1||ct===!1?React.createElement(Message,{type:"error"},typeof b=="function"?b():b):Vt():React.createElement(Message,{type:"no-data"},typeof u=="function"?u():u)}return React.createElement("div",Object.assign({className:clsx(d,P),"data-page-number":_t,ref:mergeRefs(E,bt),style:{"--scale-factor":`${Q}`,backgroundColor:W||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},At),kt())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";var NavigateNext={},_interopRequireDefault$1=interopRequireDefaultExports;Object.defineProperty(NavigateNext,"__esModule",{value:!0});var default_1$1=NavigateNext.default=void 0,_createSvgIcon$1=_interopRequireDefault$1(requireCreateSvgIcon()),_jsxRuntime$1=jsxRuntimeExports;default_1$1=NavigateNext.default=(0,_createSvgIcon$1.default)((0,_jsxRuntime$1.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");var NavigateBefore={},_interopRequireDefault=interopRequireDefaultExports;Object.defineProperty(NavigateBefore,"__esModule",{value:!0});var default_1=NavigateBefore.default=void 0,_createSvgIcon=_interopRequireDefault(requireCreateSvgIcon()),_jsxRuntime=jsxRuntimeExports;default_1=NavigateBefore.default=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore");pdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;const PDFPreview=({open:B,onClose:e,pdfUrl:U,bookTitle:n})=>{const[d,V]=reactExports.useState(null),[W,dt]=reactExports.useState(1),[x,P]=reactExports.useState(null),p=({numPages:b})=>{V(b),P(null)},N=b=>{P("Erreur lors du chargement du PDF"),console.error("Error loading PDF:",b)},I=b=>{dt(m=>{const E=m+b;return Math.min(Math.max(1,E),d)})};return jsxs(Dialog,{open:B,onClose:e,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"90vh",maxHeight:"90vh",display:"flex",flexDirection:"column"}},children:[jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderBottom:1,borderColor:"divider"},children:[jsx(Typography,{variant:"h6",children:n}),jsx(IconButton,{onClick:e,children:jsx(default_1$2,{})})]}),jsx(DialogContent,{sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",overflow:"hidden"},children:x?jsx(Typography,{color:"error",sx:{mt:2},children:x}):jsxs(Fragment,{children:[jsx(Document,{file:U,onLoadSuccess:p,onLoadError:N,loading:jsx(Typography,{children:"Chargement du PDF..."}),children:jsx(Page,{pageNumber:W,width:window.innerWidth*.7,loading:jsx(Typography,{children:"Chargement de la page..."})})}),jsxs(Box,{sx:{mt:2,display:"flex",alignItems:"center",gap:2},children:[jsx(Button,{startIcon:jsx(default_1,{}),onClick:()=>I(-1),disabled:W<=1,children:"Précédent"}),jsxs(Typography,{children:["Page ",W," sur ",d]}),jsx(Button,{endIcon:jsx(default_1$1,{}),onClick:()=>I(1),disabled:W>=d,children:"Suivant"})]})]})})]})};export{PDFPreview as P};
//# sourceMappingURL=PDFPreview-Dq2RCQZ1.js.map
