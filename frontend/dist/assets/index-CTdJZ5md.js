const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-CJ4MZWkS.js","assets/vendor-BBF-xwg4.js","assets/mui-CG_8jc0N.js","assets/mui-deps-DIjIPAY3.js","assets/router-DvyW0KNU.js","assets/index-Cj-O1TBF.js","assets/PDFPreview-Dq2RCQZ1.js","assets/Close-jEuwfnBl.js","assets/index-DizUV-0c.js","assets/index-Em2gnwFu.js","assets/index-B2CO1w2-.js","assets/index-DTB5-YLW.js","assets/BookDetailsPage-2QekouM-.js"])))=>i.map(i=>d[i]);
import{j as h,u as oe,i as y,B as _,a as ne,P as ae,C as T,T as ie,b as g,d as V,e as S,A as se,f as O,g as le,h as ce,k as ue}from"./mui-CG_8jc0N.js";import{h as $,E as N,a as U}from"./mui-deps-DIjIPAY3.js";import{e as de,r as u,b as he,c as K}from"./vendor-BBF-xwg4.js";import{u as me,a as w,O as D,L as x,N as A,c as fe,R as pe}from"./router-DvyW0KNU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const t of i.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&l(t)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();var R=h.Fragment;function e(a,r,o){return $.call(r,"css")?h.jsx(N,U(a,r),o):h.jsx(a,r,o)}function p(a,r,o){return $.call(r,"css")?h.jsxs(N,U(a,r),o):h.jsxs(a,r,o)}var B={},M=de;B.createRoot=M.createRoot,B.hydrateRoot=M.hydrateRoot;const ve=u.createContext(null),F={didCatch:!1,error:null};class ge extends u.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=F}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var o,l,n=arguments.length,i=new Array(n),t=0;t<n;t++)i[t]=arguments[t];(o=(l=this.props).onReset)===null||o===void 0||o.call(l,{args:i,reason:"imperative-api"}),this.setState(F)}}componentDidCatch(r,o){var l,n;(l=(n=this.props).onError)===null||l===void 0||l.call(n,r,o)}componentDidUpdate(r,o){const{didCatch:l}=this.state,{resetKeys:n}=this.props;if(l&&o.error!==null&&ye(r.resetKeys,n)){var i,t;(i=(t=this.props).onReset)===null||i===void 0||i.call(t,{next:n,prev:r.resetKeys,reason:"keys"}),this.setState(F)}}render(){const{children:r,fallbackRender:o,FallbackComponent:l,fallback:n}=this.props,{didCatch:i,error:t}=this.state;let c=r;if(i){const s={error:t,resetErrorBoundary:this.resetErrorBoundary};if(typeof o=="function")c=o(s);else if(l)c=u.createElement(l,s);else if(n!==void 0)c=n;else throw t}return u.createElement(ve.Provider,{value:{didCatch:i,error:t,resetErrorBoundary:this.resetErrorBoundary}},c)}}function ye(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return a.length!==r.length||a.some((o,l)=>!Object.is(o,r[l]))}const be="modulepreload",_e=function(a){return"/"+a},H={},v=function(r,o,l){let n=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),c=(t==null?void 0:t.nonce)||(t==null?void 0:t.getAttribute("nonce"));n=Promise.allSettled(o.map(s=>{if(s=_e(s),s in H)return;H[s]=!0;const d=s.endsWith(".css"),ee=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${ee}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":be,d||(m.as="script"),m.crossOrigin="",m.href=s,c&&m.setAttribute("nonce",c),document.head.appendChild(m),d)return new Promise((re,te)=>{m.addEventListener("load",re),m.addEventListener("error",()=>te(new Error(`Unable to preload CSS for ${s}`)))})}))}function i(t){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=t,window.dispatchEvent(c),!c.defaultPrevented)throw t}return n.then(t=>{for(const c of t||[])c.status==="rejected"&&i(c.reason);return r().catch(i)})};var j={},C={};const xe=he(oe);var W;function b(){return W||(W=1,function(a){"use client";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=xe}(C)),C}var Ee=y;Object.defineProperty(j,"__esModule",{value:!0});var G=j.default=void 0,Fe=Ee(b()),q=h;G=j.default=(0,Fe.default)([(0,q.jsx)("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),(0,q.jsx)("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")],"MenuBook");var k={},Ce=y;Object.defineProperty(k,"__esModule",{value:!0});var J=k.default=void 0,Pe=Ce(b()),Se=h;J=k.default=(0,Pe.default)((0,Se.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");var I={},Ae=y;Object.defineProperty(I,"__esModule",{value:!0});var X=I.default=void 0,Re=Ae(b()),Be=h;X=I.default=(0,Re.default)((0,Be.jsx)("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-1 9H9V9h10zm-4 4H9v-2h6zm4-8H9V5h10z"}),"LibraryBooks");var L={},Oe=y;Object.defineProperty(L,"__esModule",{value:!0});var Q=L.default=void 0,we=Oe(b()),je=h;Q=L.default=(0,we.default)((0,je.jsx)("path",{d:"M12 10.9c-.61 0-1.1.49-1.1 1.1s.49 1.1 1.1 1.1c.61 0 1.1-.49 1.1-1.1s-.49-1.1-1.1-1.1M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m2.19 12.19L6 18l3.81-8.19L18 6z"}),"Explore");var z={},ke=y;Object.defineProperty(z,"__esModule",{value:!0});var Y=z.default=void 0,Ie=ke(b()),Le=h;Y=z.default=(0,Ie.default)((0,Le.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person");const ze=()=>{const a=me(),r=w(),[o,l]=K.useState(()=>{const i=r.pathname;return i==="/"||i==="/home"?"/home":i});return e(ae,{sx:{position:"fixed",bottom:0,left:0,right:0,display:{xs:"block",sm:"none"},zIndex:1e3},elevation:3,children:p(ne,{value:o,onChange:(i,t)=>{l(t),a(t)},children:[e(_,{label:"Accueil",value:"/home",icon:e(J,{})}),e(_,{label:"Bibliothèque",value:"/library",icon:e(X,{})}),e(_,{label:"Parcourir",value:"/browse",icon:e(Q,{})}),e(_,{label:"Profil",value:"/profile",icon:e(Y,{})})]})})},Te=()=>{const r=w().pathname.includes("/reader/");return r?e(R,{children:e(T,{maxWidth:!1,disableGutters:!0,sx:{p:0,m:0,height:"100vh",width:"100vw",overflow:"hidden"},children:e(D,{})})}):p(R,{children:[e(se,{position:"static",children:p(ie,{children:[p(g,{display:"flex",alignItems:"center",sx:{flexGrow:1},children:[e(G,{sx:{mr:1,color:"primary.main"}}),e(V,{variant:"h6",component:x,to:"/",sx:{textDecoration:"none",color:"text.primary",fontWeight:600,"&:hover":{color:"primary.main"}},children:"Casys.AI"})]}),e(S,{color:"primary",component:x,to:"/credits",sx:{fontWeight:500,mr:2,"&:hover":{backgroundColor:"primary.light"}},children:"Acheter des crédits"}),e(S,{color:"primary",component:x,to:"/library",sx:{fontWeight:500,display:{xs:"none",sm:"block"},"&:hover":{backgroundColor:"primary.light"}},children:"Bibliothèque"})]})}),e(T,{maxWidth:r?!1:"xl",disableGutters:r,sx:{mt:r?0:4,minHeight:"calc(100vh - 64px)",backgroundColor:"background.default",py:r?0:3,pb:r?0:{xs:9,sm:3},overflowX:"hidden",...r&&{p:0,maxWidth:"100%",width:"100vw",height:"100vh"}},children:e(u.Suspense,{fallback:e(g,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e(O,{})}),children:e(D,{})})}),!r&&e(ze,{})]})},Z=u.createContext(null);function De({children:a}){const[r,o]=u.useState({user:null,loading:!0,error:null});u.useEffect(()=>{let t=!0;return(async()=>{try{const s=localStorage.getItem("user");o(s&&t?d=>({...d,user:JSON.parse(s),loading:!1}):d=>({...d,loading:!1}))}catch(s){console.error("Auth initialization error:",s),localStorage.removeItem("user"),t&&o(d=>({...d,error:s.message,loading:!1}))}})(),()=>{t=!1}},[]);const l=u.useCallback(async t=>{try{o(d=>({...d,error:null}));const c=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)});if(!c.ok)throw new Error("Login failed");const s=await c.json();return o(d=>({...d,user:s,error:null})),localStorage.setItem("user",JSON.stringify(s)),s}catch(c){throw o(s=>({...s,error:"Invalid credentials"})),c}},[]),n=u.useCallback(()=>{o(t=>({...t,user:null,error:null})),localStorage.removeItem("user")},[]),i=u.useMemo(()=>({user:r.user,loading:r.loading,error:r.error,login:l,logout:n,setError:t=>o(c=>({...c,error:t}))}),[r,l,n]);return r.loading?e(g,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",bgcolor:"background.default",children:e(O,{})}):e(Z.Provider,{value:i,children:a})}function Me(){const a=u.useContext(Z);if(!a)throw new Error("useAuth must be used within an AuthProvider");return a}const He=({children:a})=>{const{user:r}=Me(),o=w();return r?e(R,{children:a}):e(A,{to:"/login",state:{from:o},replace:!0})},We=u.lazy(()=>v(()=>import("./LoginPage-CJ4MZWkS.js"),__vite__mapDeps([0,1,2,3,4]))),qe=u.lazy(()=>v(()=>import("./index-Cj-O1TBF.js"),__vite__mapDeps([5,1,6,7,2,3,4]))),Ve=u.lazy(()=>v(()=>import("./index-DizUV-0c.js"),__vite__mapDeps([8,1,2,3,7,4]))),$e=u.lazy(()=>v(()=>import("./index-Em2gnwFu.js"),__vite__mapDeps([9,1,2,3,4]))),Ne=u.lazy(()=>v(()=>import("./index-B2CO1w2-.js"),__vite__mapDeps([10,1,2,3,4]))),Ue=u.lazy(()=>v(()=>import("./index-DTB5-YLW.js"),__vite__mapDeps([11,1,2,3,4]))),Ke=u.lazy(()=>v(()=>import("./BookDetailsPage-2QekouM-.js"),__vite__mapDeps([12,1,2,3,6,7,4]))),Ge=()=>e(He,{children:e(Te,{})}),f=({children:a})=>e(u.Suspense,{fallback:e("div",{children:"Chargement..."}),children:a}),P=()=>p(g,{sx:{p:3,textAlign:"center"},children:[e(V,{variant:"h6",children:"Une erreur est survenue lors du chargement de la page"}),e(S,{component:x,to:"/",sx:{mt:2},children:"Retourner à l'accueil"})]}),Je={future:{v7_startTransition:!0,v7_normalizeFormMethod:!0,v7_relativeSplatPath:!0,v7_fetcherPersist:!0,v7_partialHydration:!0,v7_skipActionErrorRevalidation:!0}},Xe=fe([{path:"/",element:e(A,{to:"/login",replace:!0})},{path:"/login",element:e(f,{children:e(We,{})}),errorElement:e(P,{})},{path:"/reader/:bookId",element:e(f,{children:e(Ve,{})}),errorElement:e(P,{})},{path:"/",element:e(Ge,{}),errorElement:e(P,{}),children:[{index:!0,element:e(f,{children:e(qe,{})})},{path:"library",element:e(f,{children:e(Ne,{})})},{path:"browse",element:e(f,{children:e($e,{})})},{path:"profile",element:e(f,{children:e(Ue,{})})},{path:"books/:bookId",element:e(f,{children:e(Ke,{})})},{path:"*",element:e(A,{to:"/",replace:!0})}]}],{future:Je.future}),Qe=le({palette:{primary:{main:"#6200EE",light:"#7F39FB",dark:"#4B0082",contrastText:"#FFFFFF"},secondary:{main:"#343A40",light:"#4B545C",dark:"#23272B",contrastText:"#FFFFFF"},background:{default:"#FFFFFF",paper:"#FFFFFF"},text:{primary:"#000000",secondary:"#343A40"}},typography:{fontFamily:"'Arial', 'Helvetica', sans-serif",h1:{fontWeight:700,fontSize:"2.5rem",color:"#343A40",marginBottom:"1rem"},h2:{fontWeight:600,fontSize:"2rem",color:"#343A40",marginBottom:"0.875rem"},h3:{fontWeight:600,fontSize:"1.75rem",color:"#343A40",marginBottom:"0.75rem"},h4:{fontWeight:600,fontSize:"1.5rem",color:"#343A40",marginBottom:"0.625rem"},h5:{fontWeight:500,fontSize:"1.25rem",color:"#343A40",marginBottom:"0.5rem"},h6:{fontWeight:500,fontSize:"1rem",color:"#343A40",marginBottom:"0.5rem"},body1:{fontSize:"1rem",lineHeight:1.6},button:{textTransform:"none",fontWeight:500}},spacing:8,shape:{borderRadius:8},components:{MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"8px 24px",fontWeight:500},contained:{backgroundColor:"#6200EE","&:hover":{backgroundColor:"#4B0082"},boxShadow:"none"},outlined:{borderColor:"#6200EE",color:"#6200EE","&:hover":{borderColor:"#4B0082",color:"#4B0082",backgroundColor:"rgba(98, 0, 238, 0.04)"}}}},MuiCard:{styleOverrides:{root:{backgroundColor:"#FFFFFF",borderRadius:12,boxShadow:"0px 2px 8px rgba(0, 0, 0, 0.1)",padding:"24px"}}},MuiAppBar:{styleOverrides:{root:{backgroundColor:"#FFFFFF",color:"#000000",boxShadow:"0px 1px 4px rgba(0, 0, 0, 0.1)"}}},MuiContainer:{styleOverrides:{root:{backgroundColor:"#FFFFFF",padding:"24px"}}}}}),Ye=()=>e(g,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",bgcolor:"background.default",color:"text.primary",children:e(O,{})}),Ze=({error:a})=>p(g,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",p:3,bgcolor:"background.default",color:"error.main",children:[e("h2",{children:"Une erreur est survenue"}),e("pre",{children:a.message})]});function er(){return e(K.StrictMode,{children:e(ge,{FallbackComponent:Ze,children:p(ue,{theme:Qe,children:[e(ce,{}),e(De,{children:e(pe,{router:Xe,hydrationData:window.__INITIAL_DATA__,HydrateFallback:Ye})})]})})})}let E;if(window.__ROOT__)E=window.__ROOT__;else{const a=document.getElementById("root");E=B.createRoot(a),window.__ROOT__=E}E.render(e(er,{}));export{R as F,p as a,G as d,e as j,b as r,Me as u};
//# sourceMappingURL=index-CTdJZ5md.js.map
