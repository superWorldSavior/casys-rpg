var Kn=Object.defineProperty;var gn=C=>{throw TypeError(C)};var Jn=(C,e,B)=>e in C?Kn(C,e,{enumerable:!0,configurable:!0,writable:!0,value:B}):C[e]=B;var Kt=(C,e,B)=>Jn(C,typeof e!="symbol"?e+"":e,B),Me=(C,e,B)=>e.has(C)||gn("Cannot "+B);var t=(C,e,B)=>(Me(C,e,"read from private field"),B?B.call(C):e.get(C)),rt=(C,e,B)=>e.has(C)?gn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(C):e.set(C,B),ot=(C,e,B,n)=>(Me(C,e,"write to private field"),n?n.call(C,B):e.set(C,B),B),Y=(C,e,B)=>(Me(C,e,"access private method"),B);var he=(C,e,B,n)=>({set _(h){ot(C,e,h,B)},get _(){return t(C,e,n)}});import{i as interopRequireDefaultExports,j as jsxRuntimeExports,r as PropTypes,t as clsx,v as Dialog,B as Box,c as Typography,I as IconButton,w as DialogContent,d as Button,G as Grid,x as Card,S as Skeleton,y as CardContent,z as CardActions,a as useTheme,b as useMediaQuery,l as Container,E as Snackbar,o as Alert,H as CardMedia,J as Tooltip,K as Chip,N as Stack}from"./mui-vendor-BXOFyidm.js";import{b as getAugmentedNamespace,g as getDefaultExportFromCjs,r as reactExports,c as React}from"./react-vendor-BBF-xwg4.js";import{r as requireCreateSvgIcon,E as ErrorBoundary,a as default_1$7}from"./index-CLH9wDgD.js";import{d as default_1$5,a as default_1$6}from"./NavigateBefore-BMkzskJP.js";import{u as useNavigate}from"./router-vendor-BINkVlmP.js";function _mergeNamespaces(C,e){for(var B=0;B<e.length;B++){const n=e[B];if(typeof n!="string"&&!Array.isArray(n)){for(const h in n)if(h!=="default"&&!(h in C)){const G=Object.getOwnPropertyDescriptor(n,h);G&&Object.defineProperty(C,h,G.get?G:{enumerable:!0,get:()=>n[h]})}}}return Object.freeze(Object.defineProperty(C,Symbol.toStringTag,{value:"Module"}))}var CloudUpload={},_interopRequireDefault$4=interopRequireDefaultExports;Object.defineProperty(CloudUpload,"__esModule",{value:!0});var default_1$4=CloudUpload.default=void 0,_createSvgIcon$4=_interopRequireDefault$4(requireCreateSvgIcon()),_jsxRuntime$4=jsxRuntimeExports;default_1$4=CloudUpload.default=(0,_createSvgIcon$4.default)((0,_jsxRuntime$4.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload");var Preview={},_interopRequireDefault$3=interopRequireDefaultExports;Object.defineProperty(Preview,"__esModule",{value:!0});var default_1$3=Preview.default=void 0,_createSvgIcon$3=_interopRequireDefault$3(requireCreateSvgIcon()),_jsxRuntime$3=jsxRuntimeExports;default_1$3=Preview.default=(0,_createSvgIcon$3.default)((0,_jsxRuntime$3.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.89-2-2-2m0 16H5V7h14zm-5.5-6c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5 1.5.67 1.5 1.5M12 9c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Preview");var Image$1={},_interopRequireDefault$2=interopRequireDefaultExports;Object.defineProperty(Image$1,"__esModule",{value:!0});var default_1$2=Image$1.default=void 0,_createSvgIcon$2=_interopRequireDefault$2(requireCreateSvgIcon()),_jsxRuntime$2=jsxRuntimeExports;default_1$2=Image$1.default=(0,_createSvgIcon$2.default)((0,_jsxRuntime$2.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"}),"Image");var Article={},_interopRequireDefault$1=interopRequireDefaultExports;Object.defineProperty(Article,"__esModule",{value:!0});var default_1$1=Article.default=void 0,_createSvgIcon$1=_interopRequireDefault$1(requireCreateSvgIcon()),_jsxRuntime$1=jsxRuntimeExports;default_1$1=Article.default=(0,_createSvgIcon$1.default)((0,_jsxRuntime$1.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-5 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Article");function commonjsRequire(C){throw new Error('Could not dynamically require "'+C+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,B){module.exports=e.pdfjsLib=B()})(globalThis,()=>(()=>{var __webpack_modules__=[,(C,e)=>{var qt;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=w,e.bytesToString=ct,e.createValidAbsoluteUrl=et,e.getModificationDate=xt,e.getUuid=It,e.getVerbosityLevel=V,e.info=K,e.isArrayBuffer=Z,e.isArrayEqual=Tt,e.isNodeJS=void 0,e.normalizeUnicode=kt,e.objectFromMap=_t,e.objectSize=mt,e.setVerbosityLevel=tt,e.shadow=S,e.string32=bt,e.stringToBytes=ft,e.stringToPDFString=pt,e.stringToUTF8String=Et,e.unreachable=it,e.utf8StringToString=At,e.warn=$;const B=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=B;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const h=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=h;const G=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=G;const H=1.35;e.LINE_FACTOR=H;const ht=.35;e.LINE_DESCENT_FACTOR=ht;const P=ht/H;e.BASELINE_FACTOR=P;const T={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=T;const f={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=f;const j="pdfjs_internal_editor_";e.AnnotationEditorPrefix=j;const L={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=L;const b={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=b;const m={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=m;const E={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=E;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=g;const u={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=u;const y={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=y;const M={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=M;const A={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=A;const i={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=i;const d={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=d;const o={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=o;const l={O:"PageOpen",C:"PageClose"};e.PageActionEventType=l;const c={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=c;const I={NONE:0,BINARY:1};e.CMapCompressionType=I;const a={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=a;const v={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=v;let R=c.WARNINGS;function tt(vt){Number.isInteger(vt)&&(R=vt)}function V(){return R}function K(vt){R>=c.INFOS&&console.log(`Info: ${vt}`)}function $(vt){R>=c.WARNINGS&&console.log(`Warning: ${vt}`)}function it(vt){throw new Error(vt)}function w(vt,at){vt||it(at)}function W(vt){switch(vt==null?void 0:vt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function et(vt,at=null,lt=null){if(!vt)return null;try{if(lt&&typeof vt=="string"){if(lt.addDefaultProtocol&&vt.startsWith("www.")){const zt=vt.match(/\./g);(zt==null?void 0:zt.length)>=2&&(vt=`http://${vt}`)}if(lt.tryConvertEncoding)try{vt=Et(vt)}catch{}}const Rt=at?new URL(vt,at):new URL(vt);if(W(Rt))return Rt}catch{}return null}function S(vt,at,lt,Rt=!1){return Object.defineProperty(vt,at,{value:lt,enumerable:!Rt,configurable:!0,writable:!1}),lt}const s=function(){function at(lt,Rt){this.constructor===at&&it("Cannot initialize BaseException."),this.message=lt,this.name=Rt}return at.prototype=new Error,at.constructor=at,at}();e.BaseException=s;class r extends s{constructor(at,lt){super(at,"PasswordException"),this.code=lt}}e.PasswordException=r;class p extends s{constructor(at,lt){super(at,"UnknownErrorException"),this.details=lt}}e.UnknownErrorException=p;class F extends s{constructor(at){super(at,"InvalidPDFException")}}e.InvalidPDFException=F;class D extends s{constructor(at){super(at,"MissingPDFException")}}e.MissingPDFException=D;class O extends s{constructor(at,lt){super(at,"UnexpectedResponseException"),this.status=lt}}e.UnexpectedResponseException=O;class q extends s{constructor(at){super(at,"FormatError")}}e.FormatError=q;class nt extends s{constructor(at){super(at,"AbortException")}}e.AbortException=nt;function ct(vt){(typeof vt!="object"||(vt==null?void 0:vt.length)===void 0)&&it("Invalid argument for bytesToString");const at=vt.length,lt=8192;if(at<lt)return String.fromCharCode.apply(null,vt);const Rt=[];for(let zt=0;zt<at;zt+=lt){const Gt=Math.min(zt+lt,at),U=vt.subarray(zt,Gt);Rt.push(String.fromCharCode.apply(null,U))}return Rt.join("")}function ft(vt){typeof vt!="string"&&it("Invalid argument for stringToBytes");const at=vt.length,lt=new Uint8Array(at);for(let Rt=0;Rt<at;++Rt)lt[Rt]=vt.charCodeAt(Rt)&255;return lt}function bt(vt){return String.fromCharCode(vt>>24&255,vt>>16&255,vt>>8&255,vt&255)}function mt(vt){return Object.keys(vt).length}function _t(vt){const at=Object.create(null);for(const[lt,Rt]of vt)at[lt]=Rt;return at}function J(){const vt=new Uint8Array(4);return vt[0]=1,new Uint32Array(vt.buffer,0,1)[0]===1}function Q(){try{return new Function(""),!0}catch{return!1}}class _{static get isLittleEndian(){return S(this,"isLittleEndian",J())}static get isEvalSupported(){return S(this,"isEvalSupported",Q())}static get isOffscreenCanvasSupported(){return S(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?S(this,"platform",{isWin:!1,isMac:!1}):S(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var at,lt;return S(this,"isCSSRoundSupported",(lt=(at=globalThis.CSS)==null?void 0:at.supports)==null?void 0:lt.call(at,"width: round(1.5px, 1px)"))}}e.FeatureTest=_;const N=[...Array(256).keys()].map(vt=>vt.toString(16).padStart(2,"0"));class X{static makeHexColor(at,lt,Rt){return`#${N[at]}${N[lt]}${N[Rt]}`}static scaleMinMax(at,lt){let Rt;at[0]?(at[0]<0&&(Rt=lt[0],lt[0]=lt[1],lt[1]=Rt),lt[0]*=at[0],lt[1]*=at[0],at[3]<0&&(Rt=lt[2],lt[2]=lt[3],lt[3]=Rt),lt[2]*=at[3],lt[3]*=at[3]):(Rt=lt[0],lt[0]=lt[2],lt[2]=Rt,Rt=lt[1],lt[1]=lt[3],lt[3]=Rt,at[1]<0&&(Rt=lt[2],lt[2]=lt[3],lt[3]=Rt),lt[2]*=at[1],lt[3]*=at[1],at[2]<0&&(Rt=lt[0],lt[0]=lt[1],lt[1]=Rt),lt[0]*=at[2],lt[1]*=at[2]),lt[0]+=at[4],lt[1]+=at[4],lt[2]+=at[5],lt[3]+=at[5]}static transform(at,lt){return[at[0]*lt[0]+at[2]*lt[1],at[1]*lt[0]+at[3]*lt[1],at[0]*lt[2]+at[2]*lt[3],at[1]*lt[2]+at[3]*lt[3],at[0]*lt[4]+at[2]*lt[5]+at[4],at[1]*lt[4]+at[3]*lt[5]+at[5]]}static applyTransform(at,lt){const Rt=at[0]*lt[0]+at[1]*lt[2]+lt[4],zt=at[0]*lt[1]+at[1]*lt[3]+lt[5];return[Rt,zt]}static applyInverseTransform(at,lt){const Rt=lt[0]*lt[3]-lt[1]*lt[2],zt=(at[0]*lt[3]-at[1]*lt[2]+lt[2]*lt[5]-lt[4]*lt[3])/Rt,Gt=(-at[0]*lt[1]+at[1]*lt[0]+lt[4]*lt[1]-lt[5]*lt[0])/Rt;return[zt,Gt]}static getAxialAlignedBoundingBox(at,lt){const Rt=this.applyTransform(at,lt),zt=this.applyTransform(at.slice(2,4),lt),Gt=this.applyTransform([at[0],at[3]],lt),U=this.applyTransform([at[2],at[1]],lt);return[Math.min(Rt[0],zt[0],Gt[0],U[0]),Math.min(Rt[1],zt[1],Gt[1],U[1]),Math.max(Rt[0],zt[0],Gt[0],U[0]),Math.max(Rt[1],zt[1],Gt[1],U[1])]}static inverseTransform(at){const lt=at[0]*at[3]-at[1]*at[2];return[at[3]/lt,-at[1]/lt,-at[2]/lt,at[0]/lt,(at[2]*at[5]-at[4]*at[3])/lt,(at[4]*at[1]-at[5]*at[0])/lt]}static singularValueDecompose2dScale(at){const lt=[at[0],at[2],at[1],at[3]],Rt=at[0]*lt[0]+at[1]*lt[2],zt=at[0]*lt[1]+at[1]*lt[3],Gt=at[2]*lt[0]+at[3]*lt[2],U=at[2]*lt[1]+at[3]*lt[3],gt=(Rt+U)/2,wt=Math.sqrt((Rt+U)**2-4*(Rt*U-Gt*zt))/2,Dt=gt+wt||1,Nt=gt-wt||1;return[Math.sqrt(Dt),Math.sqrt(Nt)]}static normalizeRect(at){const lt=at.slice(0);return at[0]>at[2]&&(lt[0]=at[2],lt[2]=at[0]),at[1]>at[3]&&(lt[1]=at[3],lt[3]=at[1]),lt}static intersect(at,lt){const Rt=Math.max(Math.min(at[0],at[2]),Math.min(lt[0],lt[2])),zt=Math.min(Math.max(at[0],at[2]),Math.max(lt[0],lt[2]));if(Rt>zt)return null;const Gt=Math.max(Math.min(at[1],at[3]),Math.min(lt[1],lt[3])),U=Math.min(Math.max(at[1],at[3]),Math.max(lt[1],lt[3]));return Gt>U?null:[Rt,Gt,zt,U]}static bezierBoundingBox(at,lt,Rt,zt,Gt,U,gt,wt){const Dt=[],Nt=[[],[]];let Ct,k,x,z,dt,ut,yt,St;for(let Ht=0;Ht<2;++Ht){if(Ht===0?(k=6*at-12*Rt+6*Gt,Ct=-3*at+9*Rt-9*Gt+3*gt,x=3*Rt-3*at):(k=6*lt-12*zt+6*U,Ct=-3*lt+9*zt-9*U+3*wt,x=3*zt-3*lt),Math.abs(Ct)<1e-12){if(Math.abs(k)<1e-12)continue;z=-x/k,0<z&&z<1&&Dt.push(z);continue}yt=k*k-4*x*Ct,St=Math.sqrt(yt),!(yt<0)&&(dt=(-k+St)/(2*Ct),0<dt&&dt<1&&Dt.push(dt),ut=(-k-St)/(2*Ct),0<ut&&ut<1&&Dt.push(ut))}let Lt=Dt.length,Ft;const Pt=Lt;for(;Lt--;)z=Dt[Lt],Ft=1-z,Nt[0][Lt]=Ft*Ft*Ft*at+3*Ft*Ft*z*Rt+3*Ft*z*z*Gt+z*z*z*gt,Nt[1][Lt]=Ft*Ft*Ft*lt+3*Ft*Ft*z*zt+3*Ft*z*z*U+z*z*z*wt;return Nt[0][Pt]=at,Nt[1][Pt]=lt,Nt[0][Pt+1]=gt,Nt[1][Pt+1]=wt,Nt[0].length=Nt[1].length=Pt+2,[Math.min(...Nt[0]),Math.min(...Nt[1]),Math.max(...Nt[0]),Math.max(...Nt[1])]}}e.Util=X;const st=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function pt(vt){if(vt[0]>="ï"){let lt;if(vt[0]==="þ"&&vt[1]==="ÿ"?lt="utf-16be":vt[0]==="ÿ"&&vt[1]==="þ"?lt="utf-16le":vt[0]==="ï"&&vt[1]==="»"&&vt[2]==="¿"&&(lt="utf-8"),lt)try{const Rt=new TextDecoder(lt,{fatal:!0}),zt=ft(vt);return Rt.decode(zt)}catch(Rt){$(`stringToPDFString: "${Rt}".`)}}const at=[];for(let lt=0,Rt=vt.length;lt<Rt;lt++){const zt=st[vt.charCodeAt(lt)];at.push(zt?String.fromCharCode(zt):vt.charAt(lt))}return at.join("")}function Et(vt){return decodeURIComponent(escape(vt))}function At(vt){return unescape(encodeURIComponent(vt))}function Z(vt){return typeof vt=="object"&&(vt==null?void 0:vt.byteLength)!==void 0}function Tt(vt,at){if(vt.length!==at.length)return!1;for(let lt=0,Rt=vt.length;lt<Rt;lt++)if(vt[lt]!==at[lt])return!1;return!0}function xt(vt=new Date){return[vt.getUTCFullYear().toString(),(vt.getUTCMonth()+1).toString().padStart(2,"0"),vt.getUTCDate().toString().padStart(2,"0"),vt.getUTCHours().toString().padStart(2,"0"),vt.getUTCMinutes().toString().padStart(2,"0"),vt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ut{constructor(){rt(this,qt,!1);this.promise=new Promise((at,lt)=>{this.resolve=Rt=>{ot(this,qt,!0),at(Rt)},this.reject=Rt=>{ot(this,qt,!0),lt(Rt)}})}get settled(){return t(this,qt)}}qt=new WeakMap,e.PromiseCapability=Ut;let jt=null,Vt=null;function kt(vt){return jt||(jt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Vt=new Map([["ﬅ","ſt"]])),vt.replaceAll(jt,(at,lt,Rt)=>lt?lt.normalize("NFKC"):Vt.get(Rt))}function It(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const vt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(vt);else for(let at=0;at<32;at++)vt[at]=Math.floor(Math.random()*255);return ct(vt)}const $t="pdfjs_internal_id_";e.AnnotationPrefix=$t},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var C,B,n,h,re,_e,ht,P,T,f,j,L,b,m,E,ye,u,y,De,A,i;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(o){if(typeof o=="string"||o instanceof URL?o={url:o}:(0,_util.isArrayBuffer)(o)&&(o={data:o}),typeof o!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!o.url&&!o.data&&!o.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const l=new PDFDocumentLoadingTask,{docId:c}=l,I=o.url?getUrlProp(o.url):null,a=o.data?getDataProp(o.data):null,v=o.httpHeaders||null,R=o.withCredentials===!0,tt=o.password??null,V=o.range instanceof PDFDataRangeTransport?o.range:null,K=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let $=o.worker instanceof PDFWorker?o.worker:null;const it=o.verbosity,w=typeof o.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(o.docBaseUrl)?o.docBaseUrl:null,W=typeof o.cMapUrl=="string"?o.cMapUrl:null,et=o.cMapPacked!==!1,S=o.CMapReaderFactory||DefaultCMapReaderFactory,s=typeof o.standardFontDataUrl=="string"?o.standardFontDataUrl:null,r=o.StandardFontDataFactory||DefaultStandardFontDataFactory,p=o.stopAtErrors!==!0,F=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,D=o.isEvalSupported!==!1,O=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!_util.isNodeJS,q=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,nt=typeof o.disableFontFace=="boolean"?o.disableFontFace:_util.isNodeJS,ct=o.fontExtraProperties===!0,ft=o.enableXfa===!0,bt=o.ownerDocument||globalThis.document,mt=o.disableRange===!0,_t=o.disableStream===!0,J=o.disableAutoFetch===!0,Q=o.pdfBug===!0,_=V?V.length:o.length??NaN,N=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!_util.isNodeJS&&!nt,X=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:S===_display_utils.DOMCMapReaderFactory&&r===_display_utils.DOMStandardFontDataFactory&&W&&s&&(0,_display_utils.isValidFetchUrl)(W,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(s,document.baseURI),st=o.canvasFactory||new DefaultCanvasFactory({ownerDocument:bt}),pt=o.filterFactory||new DefaultFilterFactory({docId:c,ownerDocument:bt}),Et=null;(0,_util.setVerbosityLevel)(it);const At={canvasFactory:st,filterFactory:pt};if(X||(At.cMapReaderFactory=new S({baseUrl:W,isCompressed:et}),At.standardFontDataFactory=new r({baseUrl:s})),!$){const xt={verbosity:it,port:_worker_options.GlobalWorkerOptions.workerPort};$=xt.port?PDFWorker.fromPort(xt):new PDFWorker(xt),l._worker=$}const Z={docId:c,apiVersion:"3.11.174",data:a,password:tt,disableAutoFetch:J,rangeChunkSize:K,length:_,docBaseUrl:w,enableXfa:ft,evaluatorOptions:{maxImageSize:F,disableFontFace:nt,ignoreErrors:p,isEvalSupported:D,isOffscreenCanvasSupported:O,canvasMaxAreaInBytes:q,fontExtraProperties:ct,useSystemFonts:N,cMapUrl:X?W:null,standardFontDataUrl:X?s:null}},Tt={ignoreErrors:p,isEvalSupported:D,disableFontFace:nt,fontExtraProperties:ct,enableXfa:ft,ownerDocument:bt,disableAutoFetch:J,pdfBug:Q,styleElement:Et};return $.promise.then(function(){if(l.destroyed)throw new Error("Loading aborted");const xt=_fetchDocument($,Z),Ut=new Promise(function(jt){let Vt;V?Vt=new _transport_stream.PDFDataTransportStream({length:_,initialData:V.initialData,progressiveDone:V.progressiveDone,contentDispositionFilename:V.contentDispositionFilename,disableRange:mt,disableStream:_t},V):a||(Vt=(It=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(It):(0,_display_utils.isValidFetchUrl)(It.url)?new _displayFetch_stream.PDFFetchStream(It):new _displayNetwork.PDFNetworkStream(It))({url:I,length:_,httpHeaders:v,withCredentials:R,rangeChunkSize:K,disableRange:mt,disableStream:_t})),jt(Vt)});return Promise.all([xt,Ut]).then(function([jt,Vt]){if(l.destroyed)throw new Error("Loading aborted");const kt=new _message_handler.MessageHandler(c,jt,$.port),It=new WorkerTransport(kt,l,Vt,Tt,At);l._transport=It,kt.send("Ready",null)})}).catch(l._capability.reject),l}async function _fetchDocument(o,l){if(o.destroyed)throw new Error("Worker was destroyed");const c=await o.messageHandler.sendWithPromise("GetDocRequest",l,l.data?[l.data.buffer]:null);if(o.destroyed)throw new Error("Worker was destroyed");return c}function getUrlProp(o){if(o instanceof URL)return o.href;try{return new URL(o,window.location).href}catch{if(_util.isNodeJS&&typeof o=="string")return o}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(o){if(_util.isNodeJS&&typeof Buffer<"u"&&o instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return(0,_util.stringToBytes)(o);if(typeof o=="object"&&!isNaN(o==null?void 0:o.length)||(0,_util.isArrayBuffer)(o))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${he(e,C)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var l,c,I;this.destroyed=!0;try{(l=this._worker)!=null&&l.port&&(this._worker._pendingDestroy=!0),await((c=this._transport)==null?void 0:c.destroy())}catch(a){throw(I=this._worker)!=null&&I.port&&delete this._worker._pendingDestroy,a}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};C=new WeakMap,rt(e,C,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(l,c,I=!1,a=null){this.length=l,this.initialData=c,this.progressiveDone=I,this.contentDispositionFilename=a,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(l){this._rangeListeners.push(l)}addProgressListener(l){this._progressListeners.push(l)}addProgressiveReadListener(l){this._progressiveReadListeners.push(l)}addProgressiveDoneListener(l){this._progressiveDoneListeners.push(l)}onDataRange(l,c){for(const I of this._rangeListeners)I(l,c)}onDataProgress(l,c){this._readyCapability.promise.then(()=>{for(const I of this._progressListeners)I(l,c)})}onDataProgressiveRead(l){this._readyCapability.promise.then(()=>{for(const c of this._progressiveReadListeners)c(l)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const l of this._progressiveDoneListeners)l()})}transportReady(){this._readyCapability.resolve()}requestDataRange(l,c){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(l,c){this._pdfInfo=l,this._transport=c,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(I=>{if(!I)return I;const a=[];for(const v in I)a.push(...I[v]);return a}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(l){return this._transport.getPage(l)}getPageIndex(l){return this._transport.getPageIndex(l)}getDestinations(){return this._transport.getDestinations()}getDestination(l){return this._transport.getDestination(l)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(l=!1){return this._transport.startCleanup(l||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(l,c,I,a=!1){rt(this,h);rt(this,B,null);rt(this,n,!1);this._pageIndex=l,this._pageInfo=c,this._transport=I,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=I.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:l,rotation:c=this.rotate,offsetX:I=0,offsetY:a=0,dontFlip:v=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:l,rotation:c,offsetX:I,offsetY:a,dontFlip:v})}getAnnotations({intent:l="display"}={}){const c=this._transport.getRenderingIntent(l);return this._transport.getAnnotations(this._pageIndex,c.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var l;return((l=this._transport._htmlForXfa)==null?void 0:l.children[this._pageIndex])||null}render({canvasContext:l,viewport:c,intent:I="display",annotationMode:a=_util.AnnotationMode.ENABLE,transform:v=null,background:R=null,optionalContentConfigPromise:tt=null,annotationCanvasMap:V=null,pageColors:K=null,printAnnotationStorage:$=null}){var r,p;(r=this._stats)==null||r.time("Overall");const it=this._transport.getRenderingIntent(I,a,$);ot(this,n,!1),Y(this,h,_e).call(this),tt||(tt=this._transport.getOptionalContentConfig());let w=this._intentStates.get(it.cacheKey);w||(w=Object.create(null),this._intentStates.set(it.cacheKey,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const W=!!(it.renderingIntent&_util.RenderingIntentFlag.PRINT);w.displayReadyCapability||(w.displayReadyCapability=new _util.PromiseCapability,w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(p=this._stats)==null||p.time("Page Request"),this._pumpOperatorList(it));const et=F=>{var D,O;w.renderTasks.delete(S),(this._maybeCleanupAfterRender||W)&&ot(this,n,!0),Y(this,h,re).call(this,!W),F?(S.capability.reject(F),this._abortOperatorList({intentState:w,reason:F instanceof Error?F:new Error(F)})):S.capability.resolve(),(D=this._stats)==null||D.timeEnd("Rendering"),(O=this._stats)==null||O.timeEnd("Overall")},S=new InternalRenderTask({callback:et,params:{canvasContext:l,viewport:c,transform:v,background:R},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:V,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!W,pdfBug:this._pdfBug,pageColors:K});(w.renderTasks||(w.renderTasks=new Set)).add(S);const s=S.task;return Promise.all([w.displayReadyCapability.promise,tt]).then(([F,D])=>{var O;if(this.destroyed){et();return}(O=this._stats)==null||O.time("Rendering"),S.initializeGraphics({transparency:F,optionalContentConfig:D}),S.operatorListChanged()}).catch(et),s}getOperatorList({intent:l="display",annotationMode:c=_util.AnnotationMode.ENABLE,printAnnotationStorage:I=null}={}){var V;function a(){R.operatorList.lastChunk&&(R.opListReadCapability.resolve(R.operatorList),R.renderTasks.delete(tt))}const v=this._transport.getRenderingIntent(l,c,I,!0);let R=this._intentStates.get(v.cacheKey);R||(R=Object.create(null),this._intentStates.set(v.cacheKey,R));let tt;return R.opListReadCapability||(tt=Object.create(null),tt.operatorListChanged=a,R.opListReadCapability=new _util.PromiseCapability,(R.renderTasks||(R.renderTasks=new Set)).add(tt),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(V=this._stats)==null||V.time("Page Request"),this._pumpOperatorList(v)),R.opListReadCapability.promise}streamTextContent({includeMarkedContent:l=!1,disableNormalization:c=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:l===!0,disableNormalization:c===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(l={}){if(this._transport._htmlForXfa)return this.getXfa().then(I=>_xfa_text.XfaText.textContent(I));const c=this.streamTextContent(l);return new Promise(function(I,a){function v(){R.read().then(function({value:V,done:K}){if(K){I(tt);return}Object.assign(tt.styles,V.styles),tt.items.push(...V.items),v()},a)}const R=c.getReader(),tt={items:[],styles:Object.create(null)};v()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const l=[];for(const c of this._intentStates.values())if(this._abortOperatorList({intentState:c,reason:new Error("Page was destroyed."),force:!0}),!c.opListReadCapability)for(const I of c.renderTasks)l.push(I.completed),I.cancel();return this.objs.clear(),ot(this,n,!1),Y(this,h,_e).call(this),Promise.all(l)}cleanup(l=!1){ot(this,n,!0);const c=Y(this,h,re).call(this,!1);return l&&c&&this._stats&&(this._stats=new _display_utils.StatTimer),c}_startRenderPage(l,c){var a,v;const I=this._intentStates.get(c);I&&((a=this._stats)==null||a.timeEnd("Page Request"),(v=I.displayReadyCapability)==null||v.resolve(l))}_renderPageChunk(l,c){for(let I=0,a=l.length;I<a;I++)c.operatorList.fnArray.push(l.fnArray[I]),c.operatorList.argsArray.push(l.argsArray[I]);c.operatorList.lastChunk=l.lastChunk,c.operatorList.separateAnnots=l.separateAnnots;for(const I of c.renderTasks)I.operatorListChanged();l.lastChunk&&Y(this,h,re).call(this,!0)}_pumpOperatorList({renderingIntent:l,cacheKey:c,annotationStorageSerializable:I}){const{map:a,transfers:v}=I,tt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:l,cacheKey:c,annotationStorage:a},v).getReader(),V=this._intentStates.get(c);V.streamReader=tt;const K=()=>{tt.read().then(({value:$,done:it})=>{if(it){V.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk($,V),K())},$=>{if(V.streamReader=null,!this._transport.destroyed){if(V.operatorList){V.operatorList.lastChunk=!0;for(const it of V.renderTasks)it.operatorListChanged();Y(this,h,re).call(this,!0)}if(V.displayReadyCapability)V.displayReadyCapability.reject($);else if(V.opListReadCapability)V.opListReadCapability.reject($);else throw $}})};K()}_abortOperatorList({intentState:l,reason:c,force:I=!1}){if(l.streamReader){if(l.streamReaderCancelTimeout&&(clearTimeout(l.streamReaderCancelTimeout),l.streamReaderCancelTimeout=null),!I){if(l.renderTasks.size>0)return;if(c instanceof _display_utils.RenderingCancelledException){let a=RENDERING_CANCELLED_TIMEOUT;c.extraDelay>0&&c.extraDelay<1e3&&(a+=c.extraDelay),l.streamReaderCancelTimeout=setTimeout(()=>{l.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:l,reason:c,force:!0})},a);return}}if(l.streamReader.cancel(new _util.AbortException(c.message)).catch(()=>{}),l.streamReader=null,!this._transport.destroyed){for(const[a,v]of this._intentStates)if(v===l){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}B=new WeakMap,n=new WeakMap,h=new WeakSet,re=function(l=!1){if(Y(this,h,_e).call(this),!t(this,n)||this.destroyed)return!1;if(l)return ot(this,B,setTimeout(()=>{ot(this,B,null),Y(this,h,re).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:c,operatorList:I}of this._intentStates.values())if(c.size>0||!I.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),ot(this,n,!1),!0},_e=function(){t(this,B)&&(clearTimeout(t(this,B)),ot(this,B,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){rt(this,ht,new Set);rt(this,P,Promise.resolve())}postMessage(l,c){const I={data:structuredClone(l,c?{transfer:c}:null)};t(this,P).then(()=>{for(const a of t(this,ht))a.call(this,I)})}addEventListener(l,c){t(this,ht).add(c)}removeEventListener(l,c){t(this,ht).delete(c)}terminate(){t(this,ht).clear()}}ht=new WeakMap,P=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const o=(T=document==null?void 0:document.currentScript)==null?void 0:T.src;o&&(PDFWorkerUtil.fallbackWorkerSrc=o.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(o,l){let c;try{if(c=new URL(o),!c.origin||c.origin==="null")return!1}catch{return!1}const I=new URL(l,c);return c.origin===I.origin},PDFWorkerUtil.createCDNWrapper=function(o){const l=`importScripts("${o}");`;return URL.createObjectURL(new Blob([l]))}}const _PDFWorker=class _PDFWorker{constructor({name:o=null,port:l=null,verbosity:c=(0,_util.getVerbosityLevel)()}={}){var I;if(this.name=o,this.destroyed=!1,this.verbosity=c,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,l){if((I=t(_PDFWorker,f))!=null&&I.has(l))throw new Error("Cannot use more than one PDFWorker per port.");(t(_PDFWorker,f)||ot(_PDFWorker,f,new WeakMap)).set(l,this),this._initializeFromPort(l);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(o){this._port=o,this._messageHandler=new _message_handler.MessageHandler("main","worker",o),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:o}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,o)||(o=PDFWorkerUtil.createCDNWrapper(new URL(o,window.location).href));const l=new Worker(o),c=new _message_handler.MessageHandler("main","worker",l),I=()=>{l.removeEventListener("error",a),c.destroy(),l.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||I()};l.addEventListener("error",a),c.on("test",R=>{if(l.removeEventListener("error",a),this.destroyed){I();return}R?(this._messageHandler=c,this._port=l,this._webWorker=l,this._readyCapability.resolve(),c.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),c.destroy(),l.terminate())}),c.on("ready",R=>{if(l.removeEventListener("error",a),this.destroyed){I();return}try{v()}catch{this._setupFakeWorker()}});const v=()=>{const R=new Uint8Array;c.send("test",R,[R.buffer])};v();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(o=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const l=new LoopbackPort;this._port=l;const c=`fake${PDFWorkerUtil.fakeWorkerId++}`,I=new _message_handler.MessageHandler(c+"_worker",c,l);o.setup(I,l);const a=new _message_handler.MessageHandler(c,c+"_worker",l);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(o=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${o.message}".`))})}destroy(){var o;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(o=t(_PDFWorker,f))==null||o.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(o){var c;if(!(o!=null&&o.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const l=(c=t(this,f))==null?void 0:c.get(o.port);if(l){if(l._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return l}return new _PDFWorker(o)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var o;try{return((o=globalThis.pdfjsWorker)==null?void 0:o.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};f=new WeakMap,rt(_PDFWorker,f);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(l,c,I,a,v){rt(this,E);rt(this,j,new Map);rt(this,L,new Map);rt(this,b,new Map);rt(this,m,null);this.messageHandler=l,this.loadingTask=c,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this._params=a,this.canvasFactory=v.canvasFactory,this.filterFactory=v.filterFactory,this.cMapReaderFactory=v.cMapReaderFactory,this.standardFontDataFactory=v.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=I,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(l,c=_util.AnnotationMode.ENABLE,I=null,a=!1){let v=_util.RenderingIntentFlag.DISPLAY,R=_annotation_storage.SerializableEmpty;switch(l){case"any":v=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":v=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${l}`)}switch(c){case _util.AnnotationMode.DISABLE:v+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:v+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:v+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,R=(v&_util.RenderingIntentFlag.PRINT&&I instanceof _annotation_storage.PrintAnnotationStorage?I:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${c}`)}return a&&(v+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:v,cacheKey:`${v}_${R.hash}`,annotationStorageSerializable:R}}destroy(){var I;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(I=t(this,m))==null||I.reject(new Error("Worker was destroyed during onPassword callback"));const l=[];for(const a of t(this,L).values())l.push(a._destroy());t(this,L).clear(),t(this,b).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const c=this.messageHandler.sendWithPromise("Terminate",null);return l.push(c),Promise.all(l).then(()=>{var a;this.commonObjs.clear(),this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(),(a=this._networkStream)==null||a.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:l,loadingTask:c}=this;l.on("GetReader",(I,a)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=v=>{this._lastProgress={loaded:v.loaded,total:v.total}},a.onPull=()=>{this._fullReader.read().then(function({value:v,done:R}){if(R){a.close();return}(0,_util.assert)(v instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(v),1,[v])}).catch(v=>{a.error(v)})},a.onCancel=v=>{this._fullReader.cancel(v),a.ready.catch(R=>{if(!this.destroyed)throw R})}}),l.on("ReaderHeadersReady",I=>{const a=new _util.PromiseCapability,v=this._fullReader;return v.headersReady.then(()=>{var R;(!v.isStreamingSupported||!v.isRangeSupported)&&(this._lastProgress&&((R=c.onProgress)==null||R.call(c,this._lastProgress)),v.onProgress=tt=>{var V;(V=c.onProgress)==null||V.call(c,{loaded:tt.loaded,total:tt.total})}),a.resolve({isStreamingSupported:v.isStreamingSupported,isRangeSupported:v.isRangeSupported,contentLength:v.contentLength})},a.reject),a.promise}),l.on("GetRangeReader",(I,a)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const v=this._networkStream.getRangeReader(I.begin,I.end);if(!v){a.close();return}a.onPull=()=>{v.read().then(function({value:R,done:tt}){if(tt){a.close();return}(0,_util.assert)(R instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(R),1,[R])}).catch(R=>{a.error(R)})},a.onCancel=R=>{v.cancel(R),a.ready.catch(tt=>{if(!this.destroyed)throw tt})}}),l.on("GetDoc",({pdfInfo:I})=>{this._numPages=I.numPages,this._htmlForXfa=I.htmlForXfa,delete I.htmlForXfa,c._capability.resolve(new PDFDocumentProxy(I,this))}),l.on("DocException",function(I){let a;switch(I.name){case"PasswordException":a=new _util.PasswordException(I.message,I.code);break;case"InvalidPDFException":a=new _util.InvalidPDFException(I.message);break;case"MissingPDFException":a=new _util.MissingPDFException(I.message);break;case"UnexpectedResponseException":a=new _util.UnexpectedResponseException(I.message,I.status);break;case"UnknownErrorException":a=new _util.UnknownErrorException(I.message,I.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}c._capability.reject(a)}),l.on("PasswordRequest",I=>{if(ot(this,m,new _util.PromiseCapability),c.onPassword){const a=v=>{v instanceof Error?t(this,m).reject(v):t(this,m).resolve({password:v})};try{c.onPassword(a,I.code)}catch(v){t(this,m).reject(v)}}else t(this,m).reject(new _util.PasswordException(I.message,I.code));return t(this,m).promise}),l.on("DataLoaded",I=>{var a;(a=c.onProgress)==null||a.call(c,{loaded:I.length,total:I.length}),this.downloadInfoCapability.resolve(I)}),l.on("StartRenderPage",I=>{if(this.destroyed)return;t(this,L).get(I.pageIndex)._startRenderPage(I.transparency,I.cacheKey)}),l.on("commonobj",([I,a,v])=>{var R;if(!this.destroyed&&!this.commonObjs.has(I))switch(a){case"Font":const tt=this._params;if("error"in v){const $=v.error;(0,_util.warn)(`Error during font loading: ${$}`),this.commonObjs.resolve(I,$);break}const V=tt.pdfBug&&((R=globalThis.FontInspector)!=null&&R.enabled)?($,it)=>globalThis.FontInspector.fontAdded($,it):null,K=new _font_loader.FontFaceObject(v,{isEvalSupported:tt.isEvalSupported,disableFontFace:tt.disableFontFace,ignoreErrors:tt.ignoreErrors,inspectFont:V});this.fontLoader.bind(K).catch($=>l.sendWithPromise("FontFallback",{id:I})).finally(()=>{!tt.fontExtraProperties&&K.data&&(K.data=null),this.commonObjs.resolve(I,K)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(I,v);break;default:throw new Error(`Got unknown common object type ${a}`)}}),l.on("obj",([I,a,v,R])=>{var V;if(this.destroyed)return;const tt=t(this,L).get(a);if(!tt.objs.has(I))switch(v){case"Image":if(tt.objs.resolve(I,R),R){let K;if(R.bitmap){const{width:$,height:it}=R;K=$*it*4}else K=((V=R.data)==null?void 0:V.length)||0;K>_util.MAX_IMAGE_SIZE_TO_CACHE&&(tt._maybeCleanupAfterRender=!0)}break;case"Pattern":tt.objs.resolve(I,R);break;default:throw new Error(`Got unknown object type ${v}`)}}),l.on("DocProgress",I=>{var a;this.destroyed||(a=c.onProgress)==null||a.call(c,{loaded:I.loaded,total:I.total})}),l.on("FetchBuiltInCMap",I=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(I):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),l.on("FetchStandardFontData",I=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(I):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var I;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:l,transfers:c}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:l,filename:((I=this._fullReader)==null?void 0:I.filename)??null},c).finally(()=>{this.annotationStorage.resetModified()})}getPage(l){if(!Number.isInteger(l)||l<=0||l>this._numPages)return Promise.reject(new Error("Invalid page request."));const c=l-1,I=t(this,b).get(c);if(I)return I;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:c}).then(v=>{if(this.destroyed)throw new Error("Transport destroyed");const R=new PDFPageProxy(c,v,this,this._params.pdfBug);return t(this,L).set(c,R),R});return t(this,b).set(c,a),a}getPageIndex(l){return typeof l!="object"||l===null||!Number.isInteger(l.num)||l.num<0||!Number.isInteger(l.gen)||l.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:l.num,gen:l.gen})}getAnnotations(l,c){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:l,intent:c})}getFieldObjects(){return Y(this,E,ye).call(this,"GetFieldObjects")}hasJSActions(){return Y(this,E,ye).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(l){return typeof l!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:l})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return Y(this,E,ye).call(this,"GetDocJSActions")}getPageJSActions(l){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:l})}getStructTree(l){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:l})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(l=>new _optional_content_config.OptionalContentConfig(l))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const l="GetMetadata",c=t(this,j).get(l);if(c)return c;const I=this.messageHandler.sendWithPromise(l,null).then(a=>{var v,R;return{info:a[0],metadata:a[1]?new _metadata.Metadata(a[1]):null,contentDispositionFilename:((v=this._fullReader)==null?void 0:v.filename)??null,contentLength:((R=this._fullReader)==null?void 0:R.contentLength)??null}});return t(this,j).set(l,I),I}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(l=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const c of t(this,L).values())if(!c.cleanup())throw new Error(`startCleanup: Page ${c.pageNumber} is currently rendering.`);this.commonObjs.clear(),l||this.fontLoader.clear(),t(this,j).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:l,enableXfa:c}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:l,enableXfa:c})}}j=new WeakMap,L=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakSet,ye=function(l,c=null){const I=t(this,j).get(l);if(I)return I;const a=this.messageHandler.sendWithPromise(l,c);return t(this,j).set(l,a),a};class PDFObjects{constructor(){rt(this,y);rt(this,u,Object.create(null))}get(l,c=null){if(c){const a=Y(this,y,De).call(this,l);return a.capability.promise.then(()=>c(a.data)),null}const I=t(this,u)[l];if(!(I!=null&&I.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${l}.`);return I.data}has(l){const c=t(this,u)[l];return(c==null?void 0:c.capability.settled)||!1}resolve(l,c=null){const I=Y(this,y,De).call(this,l);I.data=c,I.capability.resolve()}clear(){var l;for(const c in t(this,u)){const{data:I}=t(this,u)[c];(l=I==null?void 0:I.bitmap)==null||l.close()}ot(this,u,Object.create(null))}}u=new WeakMap,y=new WeakSet,De=function(l){var c;return(c=t(this,u))[l]||(c[l]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(l){rt(this,A,null);ot(this,A,l),this.onContinue=null}get promise(){return t(this,A).capability.promise}cancel(l=0){t(this,A).cancel(null,l)}get separateAnnots(){const{separateAnnots:l}=t(this,A).operatorList;if(!l)return!1;const{annotationCanvasMap:c}=t(this,A);return l.form||l.canvas&&(c==null?void 0:c.size)>0}}A=new WeakMap,exports.RenderTask=RenderTask;const d=class d{constructor({callback:l,params:c,objs:I,commonObjs:a,annotationCanvasMap:v,operatorList:R,pageIndex:tt,canvasFactory:V,filterFactory:K,useRequestAnimationFrame:$=!1,pdfBug:it=!1,pageColors:w=null}){this.callback=l,this.params=c,this.objs=I,this.commonObjs=a,this.annotationCanvasMap=v,this.operatorListIdx=null,this.operatorList=R,this._pageIndex=tt,this.canvasFactory=V,this.filterFactory=K,this._pdfBug=it,this.pageColors=w,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=$===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=c.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:l=!1,optionalContentConfig:c}){var tt,V;if(this.cancelled)return;if(this._canvas){if(t(d,i).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(d,i).add(this._canvas)}this._pdfBug&&((tt=globalThis.StepperManager)!=null&&tt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:I,viewport:a,transform:v,background:R}=this.params;this.gfx=new _canvas.CanvasGraphics(I,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:c},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:v,viewport:a,transparency:l,background:R}),this.operatorListIdx=0,this.graphicsReady=!0,(V=this.graphicsReadyCallback)==null||V.call(this)}cancel(l=null,c=0){var I;this.running=!1,this.cancelled=!0,(I=this.gfx)==null||I.endDrawing(),t(d,i).delete(this._canvas),this.callback(l||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,c))}operatorListChanged(){var l;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(l=this.stepper)==null||l.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(d,i).delete(this._canvas),this.callback())))}};i=new WeakMap,rt(d,i,new WeakSet);let InternalRenderTask=d;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(C,e,B)=>{var T,f,j,mn,b;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=B(1),h=B(4),G=B(8);const H=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=H;class ht{constructor(){rt(this,j);rt(this,T,!1);rt(this,f,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(E,g){const u=t(this,f).get(E);return u===void 0?g:Object.assign(g,u)}getRawValue(E){return t(this,f).get(E)}remove(E){if(t(this,f).delete(E),t(this,f).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const g of t(this,f).values())if(g instanceof h.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(E,g){const u=t(this,f).get(E);let y=!1;if(u!==void 0)for(const[M,A]of Object.entries(g))u[M]!==A&&(y=!0,u[M]=A);else y=!0,t(this,f).set(E,g);y&&Y(this,j,mn).call(this),g instanceof h.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(g.constructor._type)}has(E){return t(this,f).has(E)}getAll(){return t(this,f).size>0?(0,n.objectFromMap)(t(this,f)):null}setAll(E){for(const[g,u]of Object.entries(E))this.setValue(g,u)}get size(){return t(this,f).size}resetModified(){t(this,T)&&(ot(this,T,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new P(this)}get serializable(){if(t(this,f).size===0)return H;const E=new Map,g=new G.MurmurHash3_64,u=[],y=Object.create(null);let M=!1;for(const[A,i]of t(this,f)){const d=i instanceof h.AnnotationEditor?i.serialize(!1,y):i;d&&(E.set(A,d),g.update(`${A}:${JSON.stringify(d)}`),M||(M=!!d.bitmap))}if(M)for(const A of E.values())A.bitmap&&u.push(A.bitmap);return E.size>0?{map:E,hash:g.hexdigest(),transfers:u}:H}}T=new WeakMap,f=new WeakMap,j=new WeakSet,mn=function(){t(this,T)||(ot(this,T,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=ht;class P extends ht{constructor(g){super();rt(this,b);const{map:u,hash:y,transfers:M}=g.serializable,A=structuredClone(u,M?{transfer:M}:null);ot(this,b,{map:A,hash:y,transfers:M})}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,b)}}b=new WeakMap,e.PrintAnnotationStorage=P},(C,e,B)=>{var P,T,f,j,L,b,m,E,g,u,y,M,A,i,d,Le,Ie,c,Oe,Ne,bn,_n,yn,je,An;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=B(5),h=B(1),G=B(6);const $=class ${constructor(w){rt(this,d);rt(this,P,"");rt(this,T,!1);rt(this,f,null);rt(this,j,null);rt(this,L,null);rt(this,b,!1);rt(this,m,null);rt(this,E,this.focusin.bind(this));rt(this,g,this.focusout.bind(this));rt(this,u,!1);rt(this,y,!1);rt(this,M,!1);Kt(this,"_initialOptions",Object.create(null));Kt(this,"_uiManager",null);Kt(this,"_focusEventsAllowed",!0);Kt(this,"_l10nPromise",null);rt(this,A,!1);rt(this,i,$._zIndex++);this.constructor===$&&(0,h.unreachable)("Cannot initialize AnnotationEditor."),this.parent=w.parent,this.id=w.id,this.width=this.height=null,this.pageIndex=w.parent.pageIndex,this.name=w.name,this.div=null,this._uiManager=w.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=w.isCentered,this._structTreeParentId=null;const{rotation:W,rawDims:{pageWidth:et,pageHeight:S,pageX:s,pageY:r}}=this.parent.viewport;this.rotation=W,this.pageRotation=(360+W-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[et,S],this.pageTranslation=[s,r];const[p,F]=this.parentDimensions;this.x=w.x/p,this.y=w.y/F,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,h.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(w){const W=new ht({id:w.parent.getNextId(),parent:w.parent,uiManager:w._uiManager});W.annotationElementId=w.annotationElementId,W.deleted=!0,W._uiManager.addToAnnotationStorage(W)}static initialize(w,W=null){if($._l10nPromise||($._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(S=>[S,w.get(S)]))),W!=null&&W.strings)for(const S of W.strings)$._l10nPromise.set(S,w.get(S));if($._borderLineWidth!==-1)return;const et=getComputedStyle(document.documentElement);$._borderLineWidth=parseFloat(et.getPropertyValue("--outline-width"))||0}static updateDefaultParams(w,W){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(w){return!1}static paste(w,W){(0,h.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,A)}set _isDraggable(w){var W;ot(this,A,w),(W=this.div)==null||W.classList.toggle("draggable",w)}center(){const[w,W]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*W/(w*2),this.y+=this.width*w/(W*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*W/(w*2),this.y-=this.width*w/(W*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(w){this._uiManager.addCommands(w)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,i)}setParent(w){w!==null&&(this.pageIndex=w.pageIndex,this.pageDimensions=w.pageDimensions),this.parent=w}focusin(w){this._focusEventsAllowed&&(t(this,u)?ot(this,u,!1):this.parent.setSelected(this))}focusout(w){var et;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const W=w.relatedTarget;W!=null&&W.closest(`#${this.id}`)||(w.preventDefault(),(et=this.parent)!=null&&et.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(w,W,et,S){const[s,r]=this.parentDimensions;[et,S]=this.screenToPageTranslation(et,S),this.x=(w+et)/s,this.y=(W+S)/r,this.fixAndSetPosition()}translate(w,W){Y(this,d,Le).call(this,this.parentDimensions,w,W)}translateInPage(w,W){Y(this,d,Le).call(this,this.pageDimensions,w,W),this.div.scrollIntoView({block:"nearest"})}drag(w,W){const[et,S]=this.parentDimensions;if(this.x+=w/et,this.y+=W/S,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:D,y:O}=this.div.getBoundingClientRect();this.parent.findNewParent(this,D,O)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:r}=this;const[p,F]=Y(this,d,Ie).call(this);s+=p,r+=F,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*r).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[w,W]=this.pageDimensions;let{x:et,y:S,width:s,height:r}=this;switch(s*=w,r*=W,et*=w,S*=W,this.rotation){case 0:et=Math.max(0,Math.min(w-s,et)),S=Math.max(0,Math.min(W-r,S));break;case 90:et=Math.max(0,Math.min(w-r,et)),S=Math.min(W,Math.max(s,S));break;case 180:et=Math.min(w,Math.max(s,et)),S=Math.min(W,Math.max(r,S));break;case 270:et=Math.min(w,Math.max(r,et)),S=Math.max(0,Math.min(W-s,S));break}this.x=et/=w,this.y=S/=W;const[p,F]=Y(this,d,Ie).call(this);et+=p,S+=F;const{style:D}=this.div;D.left=`${(100*et).toFixed(2)}%`,D.top=`${(100*S).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(w,W){var et;return Y(et=$,c,Oe).call(et,w,W,this.parentRotation)}pageTranslationToScreen(w,W){var et;return Y(et=$,c,Oe).call(et,w,W,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:w,pageDimensions:[W,et]}=this,S=W*w,s=et*w;return h.FeatureTest.isCSSRoundSupported?[Math.round(S),Math.round(s)]:[S,s]}setDims(w,W){var s;const[et,S]=this.parentDimensions;this.div.style.width=`${(100*w/et).toFixed(2)}%`,t(this,b)||(this.div.style.height=`${(100*W/S).toFixed(2)}%`),(s=t(this,f))==null||s.classList.toggle("small",w<$.SMALL_EDITOR_SIZE||W<$.SMALL_EDITOR_SIZE)}fixDims(){const{style:w}=this.div,{height:W,width:et}=w,S=et.endsWith("%"),s=!t(this,b)&&W.endsWith("%");if(S&&s)return;const[r,p]=this.parentDimensions;S||(w.width=`${(100*parseFloat(et)/r).toFixed(2)}%`),!t(this,b)&&!s&&(w.height=`${(100*parseFloat(W)/p).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(t(this,f))return;const w=ot(this,f,document.createElement("button"));w.className="altText";const W=await $._l10nPromise.get("editor_alt_text_button_label");w.textContent=W,w.setAttribute("aria-label",W),w.tabIndex="0",w.addEventListener("contextmenu",G.noContextMenu),w.addEventListener("pointerdown",et=>et.stopPropagation()),w.addEventListener("click",et=>{et.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),w.addEventListener("keydown",et=>{et.target===w&&et.key==="Enter"&&(et.preventDefault(),this._uiManager.editAltText(this))}),Y(this,d,je).call(this),this.div.append(w),$.SMALL_EDITOR_SIZE||($.SMALL_EDITOR_SIZE=Math.min(128,Math.round(w.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:t(this,P),decorative:t(this,T)}}set altTextData({altText:w,decorative:W}){t(this,P)===w&&t(this,T)===W||(ot(this,P,w),ot(this,T,W),Y(this,d,je).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",t(this,E)),this.div.addEventListener("focusout",t(this,g));const[w,W]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*W/w).toFixed(2)}%`,this.div.style.maxHeight=`${(100*w/W).toFixed(2)}%`);const[et,S]=this.getInitialTranslation();return this.translate(et,S),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(w){const{isMac:W}=h.FeatureTest.platform;if(w.button!==0||w.ctrlKey&&W){w.preventDefault();return}ot(this,u,!0),Y(this,d,An).call(this,w)}moveInDOM(){var w;(w=this.parent)==null||w.moveEditorInDOM(this)}_setParentAndPosition(w,W,et){w.changeParent(this),this.x=W,this.y=et,this.fixAndSetPosition()}getRect(w,W){const et=this.parentScale,[S,s]=this.pageDimensions,[r,p]=this.pageTranslation,F=w/et,D=W/et,O=this.x*S,q=this.y*s,nt=this.width*S,ct=this.height*s;switch(this.rotation){case 0:return[O+F+r,s-q-D-ct+p,O+F+nt+r,s-q-D+p];case 90:return[O+D+r,s-q+F+p,O+D+ct+r,s-q+F+nt+p];case 180:return[O-F-nt+r,s-q+D+p,O-F+r,s-q+D+ct+p];case 270:return[O-D-ct+r,s-q-F-nt+p,O-D+r,s-q-F+p];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(w,W){const[et,S,s,r]=w,p=s-et,F=r-S;switch(this.rotation){case 0:return[et,W-r,p,F];case 90:return[et,W-S,F,p];case 180:return[s,W-S,p,F];case 270:return[s,W-r,F,p];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){ot(this,M,!0)}disableEditMode(){ot(this,M,!1)}isInEditMode(){return t(this,M)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var w,W;(w=this.div)==null||w.addEventListener("focusin",t(this,E)),(W=this.div)==null||W.addEventListener("focusout",t(this,g))}serialize(w=!1,W=null){(0,h.unreachable)("An editor must be serializable")}static deserialize(w,W,et){const S=new this.prototype.constructor({parent:W,id:W.getNextId(),uiManager:et});S.rotation=w.rotation;const[s,r]=S.pageDimensions,[p,F,D,O]=S.getRectInCurrentCoords(w.rect,r);return S.x=p/s,S.y=F/r,S.width=D/s,S.height=O/r,S}remove(){var w;this.div.removeEventListener("focusin",t(this,E)),this.div.removeEventListener("focusout",t(this,g)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(w=t(this,f))==null||w.remove(),ot(this,f,null),ot(this,j,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(Y(this,d,bn).call(this),t(this,m).classList.remove("hidden"))}select(){var w;this.makeResizable(),(w=this.div)==null||w.classList.add("selectedEditor")}unselect(){var w,W,et;(w=t(this,m))==null||w.classList.add("hidden"),(W=this.div)==null||W.classList.remove("selectedEditor"),(et=this.div)!=null&&et.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(w,W){}disableEditing(){t(this,f)&&(t(this,f).hidden=!0)}enableEditing(){t(this,f)&&(t(this,f).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return t(this,y)}set isEditing(w){ot(this,y,w),this.parent&&(w?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(w,W){ot(this,b,!0);const et=w/W,{style:S}=this.div;S.aspectRatio=et,S.height="auto"}static get MIN_SIZE(){return 16}};P=new WeakMap,T=new WeakMap,f=new WeakMap,j=new WeakMap,L=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,M=new WeakMap,A=new WeakMap,i=new WeakMap,d=new WeakSet,Le=function([w,W],et,S){[et,S]=this.screenToPageTranslation(et,S),this.x+=et/w,this.y+=S/W,this.fixAndSetPosition()},Ie=function(){const[w,W]=this.parentDimensions,{_borderLineWidth:et}=$,S=et/w,s=et/W;switch(this.rotation){case 90:return[-S,s];case 180:return[S,s];case 270:return[S,-s];default:return[-S,-s]}},c=new WeakSet,Oe=function(w,W,et){switch(et){case 90:return[W,-w];case 180:return[-w,-W];case 270:return[-W,w];default:return[w,W]}},Ne=function(w){switch(w){case 90:{const[W,et]=this.pageDimensions;return[0,-W/et,et/W,0]}case 180:return[-1,0,0,-1];case 270:{const[W,et]=this.pageDimensions;return[0,W/et,-et/W,0]}default:return[1,0,0,1]}},bn=function(){if(t(this,m))return;ot(this,m,document.createElement("div")),t(this,m).classList.add("resizers");const w=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||w.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const W of w){const et=document.createElement("div");t(this,m).append(et),et.classList.add("resizer",W),et.addEventListener("pointerdown",Y(this,d,_n).bind(this,W)),et.addEventListener("contextmenu",G.noContextMenu)}this.div.prepend(t(this,m))},_n=function(w,W){W.preventDefault();const{isMac:et}=h.FeatureTest.platform;if(W.button!==0||W.ctrlKey&&et)return;const S=Y(this,d,yn).bind(this,w),s=this._isDraggable;this._isDraggable=!1;const r={passive:!0,capture:!0};window.addEventListener("pointermove",S,r);const p=this.x,F=this.y,D=this.width,O=this.height,q=this.parent.div.style.cursor,nt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(W.target).cursor;const ct=()=>{this._isDraggable=s,window.removeEventListener("pointerup",ct),window.removeEventListener("blur",ct),window.removeEventListener("pointermove",S,r),this.parent.div.style.cursor=q,this.div.style.cursor=nt;const ft=this.x,bt=this.y,mt=this.width,_t=this.height;ft===p&&bt===F&&mt===D&&_t===O||this.addCommands({cmd:()=>{this.width=mt,this.height=_t,this.x=ft,this.y=bt;const[J,Q]=this.parentDimensions;this.setDims(J*mt,Q*_t),this.fixAndSetPosition()},undo:()=>{this.width=D,this.height=O,this.x=p,this.y=F;const[J,Q]=this.parentDimensions;this.setDims(J*D,Q*O),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ct),window.addEventListener("blur",ct)},yn=function(w,W){const[et,S]=this.parentDimensions,s=this.x,r=this.y,p=this.width,F=this.height,D=$.MIN_SIZE/et,O=$.MIN_SIZE/S,q=kt=>Math.round(kt*1e4)/1e4,nt=Y(this,d,Ne).call(this,this.rotation),ct=(kt,It)=>[nt[0]*kt+nt[2]*It,nt[1]*kt+nt[3]*It],ft=Y(this,d,Ne).call(this,360-this.rotation),bt=(kt,It)=>[ft[0]*kt+ft[2]*It,ft[1]*kt+ft[3]*It];let mt,_t,J=!1,Q=!1;switch(w){case"topLeft":J=!0,mt=(kt,It)=>[0,0],_t=(kt,It)=>[kt,It];break;case"topMiddle":mt=(kt,It)=>[kt/2,0],_t=(kt,It)=>[kt/2,It];break;case"topRight":J=!0,mt=(kt,It)=>[kt,0],_t=(kt,It)=>[0,It];break;case"middleRight":Q=!0,mt=(kt,It)=>[kt,It/2],_t=(kt,It)=>[0,It/2];break;case"bottomRight":J=!0,mt=(kt,It)=>[kt,It],_t=(kt,It)=>[0,0];break;case"bottomMiddle":mt=(kt,It)=>[kt/2,It],_t=(kt,It)=>[kt/2,0];break;case"bottomLeft":J=!0,mt=(kt,It)=>[0,It],_t=(kt,It)=>[kt,0];break;case"middleLeft":Q=!0,mt=(kt,It)=>[0,It/2],_t=(kt,It)=>[kt,It/2];break}const _=mt(p,F),N=_t(p,F);let X=ct(...N);const st=q(s+X[0]),pt=q(r+X[1]);let Et=1,At=1,[Z,Tt]=this.screenToPageTranslation(W.movementX,W.movementY);if([Z,Tt]=bt(Z/et,Tt/S),J){const kt=Math.hypot(p,F);Et=At=Math.max(Math.min(Math.hypot(N[0]-_[0]-Z,N[1]-_[1]-Tt)/kt,1/p,1/F),D/p,O/F)}else Q?Et=Math.max(D,Math.min(1,Math.abs(N[0]-_[0]-Z)))/p:At=Math.max(O,Math.min(1,Math.abs(N[1]-_[1]-Tt)))/F;const xt=q(p*Et),Ut=q(F*At);X=ct(..._t(xt,Ut));const jt=st-X[0],Vt=pt-X[1];this.width=xt,this.height=Ut,this.x=jt,this.y=Vt,this.setDims(et*xt,S*Ut),this.fixAndSetPosition()},je=async function(){var et;const w=t(this,f);if(!w)return;if(!t(this,P)&&!t(this,T)){w.classList.remove("done"),(et=t(this,j))==null||et.remove();return}$._l10nPromise.get("editor_alt_text_edit_button_label").then(S=>{w.setAttribute("aria-label",S)});let W=t(this,j);if(!W){ot(this,j,W=document.createElement("span")),W.className="tooltip",W.setAttribute("role","tooltip");const S=W.id=`alt-text-tooltip-${this.id}`;w.setAttribute("aria-describedby",S);const s=100;w.addEventListener("mouseenter",()=>{ot(this,L,setTimeout(()=>{ot(this,L,null),t(this,j).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},s))}),w.addEventListener("mouseleave",()=>{var r;clearTimeout(t(this,L)),ot(this,L,null),(r=t(this,j))==null||r.classList.remove("show")})}w.classList.add("done"),W.innerText=t(this,T)?await $._l10nPromise.get("editor_alt_text_decorative_tooltip"):t(this,P),W.parentNode||w.append(W)},An=function(w){if(!this._isDraggable)return;const W=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let et,S;W&&(et={passive:!0,capture:!0},S=r=>{const[p,F]=this.screenToPageTranslation(r.movementX,r.movementY);this._uiManager.dragSelectedEditors(p,F)},window.addEventListener("pointermove",S,et));const s=()=>{if(window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),W&&window.removeEventListener("pointermove",S,et),ot(this,u,!1),!this._uiManager.endDragSession()){const{isMac:r}=h.FeatureTest.platform;w.ctrlKey&&!r||w.shiftKey||w.metaKey&&r?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",s),window.addEventListener("blur",s)},rt($,c),Kt($,"_borderLineWidth",-1),Kt($,"_colorManager",new n.ColorManager),Kt($,"_zIndex",1),Kt($,"SMALL_EDITOR_SIZE",0);let H=$;e.AnnotationEditor=H;class ht extends H{constructor(w){super(w),this.annotationElementId=w.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(C,e,B)=>{var b,m,E,g,u,Be,A,i,d,o,l,vn,a,v,R,tt,V,K,$,it,w,W,et,S,s,r,p,F,D,O,q,nt,ct,ft,bt,mt,_t,J,Q,_,N,X,st,pt,Et,At,Z,En,Ue,He,Ae,$e,We,Zt,de,Sn,xn,Ge,ue,Ve;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=G,e.opacityToHex=H;var n=B(1),h=B(6);function G(Gt,U,gt){for(const wt of gt)U.addEventListener(wt,Gt[wt].bind(Gt))}function H(Gt){return Math.round(Math.min(255,Math.max(1,255*Gt))).toString(16).padStart(2,"0")}class ht{constructor(){rt(this,b,0)}getId(){return`${n.AnnotationEditorPrefix}${he(this,b)._++}`}}b=new WeakMap;const M=class M{constructor(){rt(this,u);rt(this,m,(0,n.getUuid)());rt(this,E,0);rt(this,g,null)}static get _isSVGFittingCanvas(){const U='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',wt=new OffscreenCanvas(1,3).getContext("2d"),Dt=new Image;Dt.src=U;const Nt=Dt.decode().then(()=>(wt.drawImage(Dt,0,0,1,1,0,0,1,3),new Uint32Array(wt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",Nt)}async getFromFile(U){const{lastModified:gt,name:wt,size:Dt,type:Nt}=U;return Y(this,u,Be).call(this,`${gt}_${wt}_${Dt}_${Nt}`,U)}async getFromUrl(U){return Y(this,u,Be).call(this,U,U)}async getFromId(U){t(this,g)||ot(this,g,new Map);const gt=t(this,g).get(U);return gt?gt.bitmap?(gt.refCounter+=1,gt):gt.file?this.getFromFile(gt.file):this.getFromUrl(gt.url):null}getSvgUrl(U){const gt=t(this,g).get(U);return gt!=null&&gt.isSvg?gt.svgUrl:null}deleteId(U){t(this,g)||ot(this,g,new Map);const gt=t(this,g).get(U);gt&&(gt.refCounter-=1,gt.refCounter===0&&(gt.bitmap=null))}isValidId(U){return U.startsWith(`image_${t(this,m)}_`)}};m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakSet,Be=async function(U,gt){t(this,g)||ot(this,g,new Map);let wt=t(this,g).get(U);if(wt===null)return null;if(wt!=null&&wt.bitmap)return wt.refCounter+=1,wt;try{wt||(wt={bitmap:null,id:`image_${t(this,m)}_${he(this,E)._++}`,refCounter:0,isSvg:!1});let Dt;if(typeof gt=="string"){wt.url=gt;const Nt=await fetch(gt);if(!Nt.ok)throw new Error(Nt.statusText);Dt=await Nt.blob()}else Dt=wt.file=gt;if(Dt.type==="image/svg+xml"){const Nt=M._isSVGFittingCanvas,Ct=new FileReader,k=new Image,x=new Promise((z,dt)=>{k.onload=()=>{wt.bitmap=k,wt.isSvg=!0,z()},Ct.onload=async()=>{const ut=wt.svgUrl=Ct.result;k.src=await Nt?`${ut}#svgView(preserveAspectRatio(none))`:ut},k.onerror=Ct.onerror=dt});Ct.readAsDataURL(Dt),await x}else wt.bitmap=await createImageBitmap(Dt);wt.refCounter=1}catch(Dt){console.error(Dt),wt=null}return t(this,g).set(U,wt),wt&&t(this,g).set(wt.id,wt),wt};let P=M;class T{constructor(U=128){rt(this,A,[]);rt(this,i,!1);rt(this,d);rt(this,o,-1);ot(this,d,U)}add({cmd:U,undo:gt,mustExec:wt,type:Dt=NaN,overwriteIfSameType:Nt=!1,keepUndo:Ct=!1}){if(wt&&U(),t(this,i))return;const k={cmd:U,undo:gt,type:Dt};if(t(this,o)===-1){t(this,A).length>0&&(t(this,A).length=0),ot(this,o,0),t(this,A).push(k);return}if(Nt&&t(this,A)[t(this,o)].type===Dt){Ct&&(k.undo=t(this,A)[t(this,o)].undo),t(this,A)[t(this,o)]=k;return}const x=t(this,o)+1;x===t(this,d)?t(this,A).splice(0,1):(ot(this,o,x),x<t(this,A).length&&t(this,A).splice(x)),t(this,A).push(k)}undo(){t(this,o)!==-1&&(ot(this,i,!0),t(this,A)[t(this,o)].undo(),ot(this,i,!1),ot(this,o,t(this,o)-1))}redo(){t(this,o)<t(this,A).length-1&&(ot(this,o,t(this,o)+1),ot(this,i,!0),t(this,A)[t(this,o)].cmd(),ot(this,i,!1))}hasSomethingToUndo(){return t(this,o)!==-1}hasSomethingToRedo(){return t(this,o)<t(this,A).length-1}destroy(){ot(this,A,null)}}A=new WeakMap,i=new WeakMap,d=new WeakMap,o=new WeakMap,e.CommandManager=T;class f{constructor(U){rt(this,l);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:gt}=n.FeatureTest.platform;for(const[wt,Dt,Nt={}]of U)for(const Ct of wt){const k=Ct.startsWith("mac+");gt&&k?(this.callbacks.set(Ct.slice(4),{callback:Dt,options:Nt}),this.allKeys.add(Ct.split("+").at(-1))):!gt&&!k&&(this.callbacks.set(Ct,{callback:Dt,options:Nt}),this.allKeys.add(Ct.split("+").at(-1)))}}exec(U,gt){if(!this.allKeys.has(gt.key))return;const wt=this.callbacks.get(Y(this,l,vn).call(this,gt));if(!wt)return;const{callback:Dt,options:{bubbles:Nt=!1,args:Ct=[],checker:k=null}}=wt;k&&!k(U,gt)||(Dt.bind(U,...Ct)(),Nt||(gt.stopPropagation(),gt.preventDefault()))}}l=new WeakSet,vn=function(U){U.altKey&&this.buffer.push("alt"),U.ctrlKey&&this.buffer.push("ctrl"),U.metaKey&&this.buffer.push("meta"),U.shiftKey&&this.buffer.push("shift"),this.buffer.push(U.key);const gt=this.buffer.join("+");return this.buffer.length=0,gt},e.KeyboardManager=f;const I=class I{get _colors(){const U=new Map([["CanvasText",null],["Canvas",null]]);return(0,h.getColorValues)(U),(0,n.shadow)(this,"_colors",U)}convert(U){const gt=(0,h.getRGB)(U);if(!window.matchMedia("(forced-colors: active)").matches)return gt;for(const[wt,Dt]of this._colors)if(Dt.every((Nt,Ct)=>Nt===gt[Ct]))return I._colorsMapping.get(wt);return gt}getHexCode(U){const gt=this._colors.get(U);return gt?n.Util.makeHexColor(...gt):U}};Kt(I,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let j=I;e.ColorManager=j;const zt=class zt{constructor(U,gt,wt,Dt,Nt,Ct){rt(this,Z);rt(this,a,null);rt(this,v,new Map);rt(this,R,new Map);rt(this,tt,null);rt(this,V,null);rt(this,K,new T);rt(this,$,0);rt(this,it,new Set);rt(this,w,null);rt(this,W,null);rt(this,et,new Set);rt(this,S,null);rt(this,s,new ht);rt(this,r,!1);rt(this,p,!1);rt(this,F,null);rt(this,D,n.AnnotationEditorType.NONE);rt(this,O,new Set);rt(this,q,null);rt(this,nt,this.blur.bind(this));rt(this,ct,this.focus.bind(this));rt(this,ft,this.copy.bind(this));rt(this,bt,this.cut.bind(this));rt(this,mt,this.paste.bind(this));rt(this,_t,this.keydown.bind(this));rt(this,J,this.onEditingAction.bind(this));rt(this,Q,this.onPageChanging.bind(this));rt(this,_,this.onScaleChanging.bind(this));rt(this,N,this.onRotationChanging.bind(this));rt(this,X,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});rt(this,st,[0,0]);rt(this,pt,null);rt(this,Et,null);rt(this,At,null);ot(this,Et,U),ot(this,At,gt),ot(this,tt,wt),this._eventBus=Dt,this._eventBus._on("editingaction",t(this,J)),this._eventBus._on("pagechanging",t(this,Q)),this._eventBus._on("scalechanging",t(this,_)),this._eventBus._on("rotationchanging",t(this,N)),ot(this,V,Nt.annotationStorage),ot(this,S,Nt.filterFactory),ot(this,q,Ct),this.viewParameters={realScale:h.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const U=zt.prototype,gt=Nt=>{const{activeElement:Ct}=document;return Ct&&t(Nt,Et).contains(Ct)&&Nt.hasSomethingToControl()},wt=this.TRANSLATE_SMALL,Dt=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new f([[["ctrl+a","mac+meta+a"],U.selectAll],[["ctrl+z","mac+meta+z"],U.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],U.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],U.delete],[["Escape","mac+Escape"],U.unselectAll],[["ArrowLeft","mac+ArrowLeft"],U.translateSelectedEditors,{args:[-wt,0],checker:gt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],U.translateSelectedEditors,{args:[-Dt,0],checker:gt}],[["ArrowRight","mac+ArrowRight"],U.translateSelectedEditors,{args:[wt,0],checker:gt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],U.translateSelectedEditors,{args:[Dt,0],checker:gt}],[["ArrowUp","mac+ArrowUp"],U.translateSelectedEditors,{args:[0,-wt],checker:gt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],U.translateSelectedEditors,{args:[0,-Dt],checker:gt}],[["ArrowDown","mac+ArrowDown"],U.translateSelectedEditors,{args:[0,wt],checker:gt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],U.translateSelectedEditors,{args:[0,Dt],checker:gt}]]))}destroy(){Y(this,Z,Ae).call(this),Y(this,Z,Ue).call(this),this._eventBus._off("editingaction",t(this,J)),this._eventBus._off("pagechanging",t(this,Q)),this._eventBus._off("scalechanging",t(this,_)),this._eventBus._off("rotationchanging",t(this,N));for(const U of t(this,R).values())U.destroy();t(this,R).clear(),t(this,v).clear(),t(this,et).clear(),ot(this,a,null),t(this,O).clear(),t(this,K).destroy(),t(this,tt).destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",t(this,q)?t(this,S).addHCMFilter(t(this,q).foreground,t(this,q).background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(t(this,Et)).direction)}editAltText(U){var gt;(gt=t(this,tt))==null||gt.editAltText(this,U)}onPageChanging({pageNumber:U}){ot(this,$,U-1)}focusMainContainer(){t(this,Et).focus()}findParent(U,gt){for(const wt of t(this,R).values()){const{x:Dt,y:Nt,width:Ct,height:k}=wt.div.getBoundingClientRect();if(U>=Dt&&U<=Dt+Ct&&gt>=Nt&&gt<=Nt+k)return wt}return null}disableUserSelect(U=!1){t(this,At).classList.toggle("noUserSelect",U)}addShouldRescale(U){t(this,et).add(U)}removeShouldRescale(U){t(this,et).delete(U)}onScaleChanging({scale:U}){this.commitOrRemove(),this.viewParameters.realScale=U*h.PixelsPerInch.PDF_TO_CSS_UNITS;for(const gt of t(this,et))gt.onScaleChanging()}onRotationChanging({pagesRotation:U}){this.commitOrRemove(),this.viewParameters.rotation=U}addToAnnotationStorage(U){!U.isEmpty()&&t(this,V)&&!t(this,V).has(U.id)&&t(this,V).setValue(U.id,U)}blur(){if(!this.hasSelection)return;const{activeElement:U}=document;for(const gt of t(this,O))if(gt.div.contains(U)){ot(this,F,[gt,U]),gt._focusEventsAllowed=!1;break}}focus(){if(!t(this,F))return;const[U,gt]=t(this,F);ot(this,F,null),gt.addEventListener("focusin",()=>{U._focusEventsAllowed=!0},{once:!0}),gt.focus()}addEditListeners(){Y(this,Z,He).call(this),Y(this,Z,$e).call(this)}removeEditListeners(){Y(this,Z,Ae).call(this),Y(this,Z,We).call(this)}copy(U){var wt;if(U.preventDefault(),(wt=t(this,a))==null||wt.commitOrRemove(),!this.hasSelection)return;const gt=[];for(const Dt of t(this,O)){const Nt=Dt.serialize(!0);Nt&&gt.push(Nt)}gt.length!==0&&U.clipboardData.setData("application/pdfjs",JSON.stringify(gt))}cut(U){this.copy(U),this.delete()}paste(U){U.preventDefault();const{clipboardData:gt}=U;for(const Nt of gt.items)for(const Ct of t(this,W))if(Ct.isHandlingMimeForPasting(Nt.type)){Ct.paste(Nt,this.currentLayer);return}let wt=gt.getData("application/pdfjs");if(!wt)return;try{wt=JSON.parse(wt)}catch(Nt){(0,n.warn)(`paste: "${Nt.message}".`);return}if(!Array.isArray(wt))return;this.unselectAll();const Dt=this.currentLayer;try{const Nt=[];for(const x of wt){const z=Dt.deserialize(x);if(!z)return;Nt.push(z)}const Ct=()=>{for(const x of Nt)Y(this,Z,Ge).call(this,x);Y(this,Z,Ve).call(this,Nt)},k=()=>{for(const x of Nt)x.remove()};this.addCommands({cmd:Ct,undo:k,mustExec:!0})}catch(Nt){(0,n.warn)(`paste: "${Nt.message}".`)}}keydown(U){var gt;(gt=this.getActive())!=null&&gt.shouldGetKeyboardEvents()||zt._keyboardManager.exec(this,U)}onEditingAction(U){["undo","redo","delete","selectAll"].includes(U.name)&&this[U.name]()}setEditingState(U){U?(Y(this,Z,En).call(this),Y(this,Z,He).call(this),Y(this,Z,$e).call(this),Y(this,Z,Zt).call(this,{isEditing:t(this,D)!==n.AnnotationEditorType.NONE,isEmpty:Y(this,Z,ue).call(this),hasSomethingToUndo:t(this,K).hasSomethingToUndo(),hasSomethingToRedo:t(this,K).hasSomethingToRedo(),hasSelectedEditor:!1})):(Y(this,Z,Ue).call(this),Y(this,Z,Ae).call(this),Y(this,Z,We).call(this),Y(this,Z,Zt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(U){if(!t(this,W)){ot(this,W,U);for(const gt of t(this,W))Y(this,Z,de).call(this,gt.defaultPropertiesToUpdate)}}getId(){return t(this,s).getId()}get currentLayer(){return t(this,R).get(t(this,$))}getLayer(U){return t(this,R).get(U)}get currentPageIndex(){return t(this,$)}addLayer(U){t(this,R).set(U.pageIndex,U),t(this,r)?U.enable():U.disable()}removeLayer(U){t(this,R).delete(U.pageIndex)}updateMode(U,gt=null){if(t(this,D)!==U){if(ot(this,D,U),U===n.AnnotationEditorType.NONE){this.setEditingState(!1),Y(this,Z,xn).call(this);return}this.setEditingState(!0),Y(this,Z,Sn).call(this),this.unselectAll();for(const wt of t(this,R).values())wt.updateMode(U);if(gt){for(const wt of t(this,v).values())if(wt.annotationElementId===gt){this.setSelected(wt),wt.enterInEditMode();break}}}}updateToolbar(U){U!==t(this,D)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:U})}updateParams(U,gt){if(t(this,W)){if(U===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(U);return}for(const wt of t(this,O))wt.updateParams(U,gt);for(const wt of t(this,W))wt.updateDefaultParams(U,gt)}}enableWaiting(U=!1){if(t(this,p)!==U){ot(this,p,U);for(const gt of t(this,R).values())U?gt.disableClick():gt.enableClick(),gt.div.classList.toggle("waiting",U)}}getEditors(U){const gt=[];for(const wt of t(this,v).values())wt.pageIndex===U&&gt.push(wt);return gt}getEditor(U){return t(this,v).get(U)}addEditor(U){t(this,v).set(U.id,U)}removeEditor(U){var gt;t(this,v).delete(U.id),this.unselect(U),(!U.annotationElementId||!t(this,it).has(U.annotationElementId))&&((gt=t(this,V))==null||gt.remove(U.id))}addDeletedAnnotationElement(U){t(this,it).add(U.annotationElementId),U.deleted=!0}isDeletedAnnotationElement(U){return t(this,it).has(U)}removeDeletedAnnotationElement(U){t(this,it).delete(U.annotationElementId),U.deleted=!1}setActiveEditor(U){t(this,a)!==U&&(ot(this,a,U),U&&Y(this,Z,de).call(this,U.propertiesToUpdate))}toggleSelected(U){if(t(this,O).has(U)){t(this,O).delete(U),U.unselect(),Y(this,Z,Zt).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,O).add(U),U.select(),Y(this,Z,de).call(this,U.propertiesToUpdate),Y(this,Z,Zt).call(this,{hasSelectedEditor:!0})}setSelected(U){for(const gt of t(this,O))gt!==U&&gt.unselect();t(this,O).clear(),t(this,O).add(U),U.select(),Y(this,Z,de).call(this,U.propertiesToUpdate),Y(this,Z,Zt).call(this,{hasSelectedEditor:!0})}isSelected(U){return t(this,O).has(U)}unselect(U){U.unselect(),t(this,O).delete(U),Y(this,Z,Zt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,O).size!==0}undo(){t(this,K).undo(),Y(this,Z,Zt).call(this,{hasSomethingToUndo:t(this,K).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Y(this,Z,ue).call(this)})}redo(){t(this,K).redo(),Y(this,Z,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,K).hasSomethingToRedo(),isEmpty:Y(this,Z,ue).call(this)})}addCommands(U){t(this,K).add(U),Y(this,Z,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Y(this,Z,ue).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const U=[...t(this,O)],gt=()=>{for(const Dt of U)Dt.remove()},wt=()=>{for(const Dt of U)Y(this,Z,Ge).call(this,Dt)};this.addCommands({cmd:gt,undo:wt,mustExec:!0})}commitOrRemove(){var U;(U=t(this,a))==null||U.commitOrRemove()}hasSomethingToControl(){return t(this,a)||this.hasSelection}selectAll(){for(const U of t(this,O))U.commit();Y(this,Z,Ve).call(this,t(this,v).values())}unselectAll(){if(t(this,a)){t(this,a).commitOrRemove();return}if(this.hasSelection){for(const U of t(this,O))U.unselect();t(this,O).clear(),Y(this,Z,Zt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(U,gt,wt=!1){if(wt||this.commitOrRemove(),!this.hasSelection)return;t(this,st)[0]+=U,t(this,st)[1]+=gt;const[Dt,Nt]=t(this,st),Ct=[...t(this,O)],k=1e3;t(this,pt)&&clearTimeout(t(this,pt)),ot(this,pt,setTimeout(()=>{ot(this,pt,null),t(this,st)[0]=t(this,st)[1]=0,this.addCommands({cmd:()=>{for(const x of Ct)t(this,v).has(x.id)&&x.translateInPage(Dt,Nt)},undo:()=>{for(const x of Ct)t(this,v).has(x.id)&&x.translateInPage(-Dt,-Nt)},mustExec:!1})},k));for(const x of Ct)x.translateInPage(U,gt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),ot(this,w,new Map);for(const U of t(this,O))t(this,w).set(U,{savedX:U.x,savedY:U.y,savedPageIndex:U.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,w))return!1;this.disableUserSelect(!1);const U=t(this,w);ot(this,w,null);let gt=!1;for(const[{x:Dt,y:Nt,pageIndex:Ct},k]of U)k.newX=Dt,k.newY=Nt,k.newPageIndex=Ct,gt||(gt=Dt!==k.savedX||Nt!==k.savedY||Ct!==k.savedPageIndex);if(!gt)return!1;const wt=(Dt,Nt,Ct,k)=>{if(t(this,v).has(Dt.id)){const x=t(this,R).get(k);x?Dt._setParentAndPosition(x,Nt,Ct):(Dt.pageIndex=k,Dt.x=Nt,Dt.y=Ct)}};return this.addCommands({cmd:()=>{for(const[Dt,{newX:Nt,newY:Ct,newPageIndex:k}]of U)wt(Dt,Nt,Ct,k)},undo:()=>{for(const[Dt,{savedX:Nt,savedY:Ct,savedPageIndex:k}]of U)wt(Dt,Nt,Ct,k)},mustExec:!0}),!0}dragSelectedEditors(U,gt){if(t(this,w))for(const wt of t(this,w).keys())wt.drag(U,gt)}rebuild(U){if(U.parent===null){const gt=this.getLayer(U.pageIndex);gt?(gt.changeParent(U),gt.addOrRebuild(U)):(this.addEditor(U),this.addToAnnotationStorage(U),U.rebuild())}else U.parent.addOrRebuild(U)}isActive(U){return t(this,a)===U}getActive(){return t(this,a)}getMode(){return t(this,D)}get imageManager(){return(0,n.shadow)(this,"imageManager",new P)}};a=new WeakMap,v=new WeakMap,R=new WeakMap,tt=new WeakMap,V=new WeakMap,K=new WeakMap,$=new WeakMap,it=new WeakMap,w=new WeakMap,W=new WeakMap,et=new WeakMap,S=new WeakMap,s=new WeakMap,r=new WeakMap,p=new WeakMap,F=new WeakMap,D=new WeakMap,O=new WeakMap,q=new WeakMap,nt=new WeakMap,ct=new WeakMap,ft=new WeakMap,bt=new WeakMap,mt=new WeakMap,_t=new WeakMap,J=new WeakMap,Q=new WeakMap,_=new WeakMap,N=new WeakMap,X=new WeakMap,st=new WeakMap,pt=new WeakMap,Et=new WeakMap,At=new WeakMap,Z=new WeakSet,En=function(){window.addEventListener("focus",t(this,ct)),window.addEventListener("blur",t(this,nt))},Ue=function(){window.removeEventListener("focus",t(this,ct)),window.removeEventListener("blur",t(this,nt))},He=function(){window.addEventListener("keydown",t(this,_t),{capture:!0})},Ae=function(){window.removeEventListener("keydown",t(this,_t),{capture:!0})},$e=function(){document.addEventListener("copy",t(this,ft)),document.addEventListener("cut",t(this,bt)),document.addEventListener("paste",t(this,mt))},We=function(){document.removeEventListener("copy",t(this,ft)),document.removeEventListener("cut",t(this,bt)),document.removeEventListener("paste",t(this,mt))},Zt=function(U){Object.entries(U).some(([wt,Dt])=>t(this,X)[wt]!==Dt)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,X),U)})},de=function(U){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:U})},Sn=function(){if(!t(this,r)){ot(this,r,!0);for(const U of t(this,R).values())U.enable()}},xn=function(){if(this.unselectAll(),t(this,r)){ot(this,r,!1);for(const U of t(this,R).values())U.disable()}},Ge=function(U){const gt=t(this,R).get(U.pageIndex);gt?gt.addOrRebuild(U):this.addEditor(U)},ue=function(){if(t(this,v).size===0)return!0;if(t(this,v).size===1)for(const U of t(this,v).values())return U.isEmpty();return!1},Ve=function(U){t(this,O).clear();for(const gt of U)gt.isEmpty()||(t(this,O).add(gt),gt.select());Y(this,Z,Zt).call(this,{hasSelectedEditor:!0})},Kt(zt,"TRANSLATE_SMALL",1),Kt(zt,"TRANSLATE_BIG",10);let L=zt;e.AnnotationEditorUIManager=L},(C,e,B)=>{var $,it,w,W,et,S,s,r,p,F,D,O,ae,oe,ze,ve,Ee,fe,pe;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=o,e.getColorValues=v,e.getCurrentTransform=R,e.getCurrentTransformInverse=tt,e.getFilenameFromUrl=u,e.getPdfFilenameFromUrl=y,e.getRGB=a,e.getXfaPageViewport=I,e.isDataScheme=E,e.isPdfFile=g,e.isValidFetchUrl=A,e.loadScript=d,e.noContextMenu=i,e.setLayerDimensions=V;var n=B(7),h=B(1);const G="http://www.w3.org/2000/svg",K=class K{};Kt(K,"CSS",96),Kt(K,"PDF",72),Kt(K,"PDF_TO_CSS_UNITS",K.CSS/K.PDF);let H=K;e.PixelsPerInch=H;class ht extends n.BaseFilterFactory{constructor({docId:_,ownerDocument:N=globalThis.document}={}){super();rt(this,O);rt(this,$);rt(this,it);rt(this,w);rt(this,W);rt(this,et);rt(this,S);rt(this,s);rt(this,r);rt(this,p);rt(this,F);rt(this,D,0);ot(this,w,_),ot(this,W,N)}addFilter(_){if(!_)return"none";let N=t(this,O,ae).get(_);if(N)return N;let X,st,pt,Et;if(_.length===1){const xt=_[0],Ut=new Array(256);for(let jt=0;jt<256;jt++)Ut[jt]=xt[jt]/255;Et=X=st=pt=Ut.join(",")}else{const[xt,Ut,jt]=_,Vt=new Array(256),kt=new Array(256),It=new Array(256);for(let $t=0;$t<256;$t++)Vt[$t]=xt[$t]/255,kt[$t]=Ut[$t]/255,It[$t]=jt[$t]/255;X=Vt.join(","),st=kt.join(","),pt=It.join(","),Et=`${X}${st}${pt}`}if(N=t(this,O,ae).get(Et),N)return t(this,O,ae).set(_,N),N;const At=`g_${t(this,w)}_transfer_map_${he(this,D)._++}`,Z=`url(#${At})`;t(this,O,ae).set(_,Z),t(this,O,ae).set(Et,Z);const Tt=Y(this,O,ve).call(this,At);return Y(this,O,fe).call(this,X,st,pt,Tt),Z}addHCMFilter(_,N){var Ut;const X=`${_}-${N}`;if(t(this,S)===X)return t(this,s);if(ot(this,S,X),ot(this,s,"none"),(Ut=t(this,et))==null||Ut.remove(),!_||!N)return t(this,s);const st=Y(this,O,pe).call(this,_);_=h.Util.makeHexColor(...st);const pt=Y(this,O,pe).call(this,N);if(N=h.Util.makeHexColor(...pt),t(this,O,oe).style.color="",_==="#000000"&&N==="#ffffff"||_===N)return t(this,s);const Et=new Array(256);for(let jt=0;jt<=255;jt++){const Vt=jt/255;Et[jt]=Vt<=.03928?Vt/12.92:((Vt+.055)/1.055)**2.4}const At=Et.join(","),Z=`g_${t(this,w)}_hcm_filter`,Tt=ot(this,r,Y(this,O,ve).call(this,Z));Y(this,O,fe).call(this,At,At,At,Tt),Y(this,O,ze).call(this,Tt);const xt=(jt,Vt)=>{const kt=st[jt]/255,It=pt[jt]/255,$t=new Array(Vt+1);for(let qt=0;qt<=Vt;qt++)$t[qt]=kt+qt/Vt*(It-kt);return $t.join(",")};return Y(this,O,fe).call(this,xt(0,5),xt(1,5),xt(2,5),Tt),ot(this,s,`url(#${Z})`),t(this,s)}addHighlightHCMFilter(_,N,X,st){var It;const pt=`${_}-${N}-${X}-${st}`;if(t(this,p)===pt)return t(this,F);if(ot(this,p,pt),ot(this,F,"none"),(It=t(this,r))==null||It.remove(),!_||!N)return t(this,F);const[Et,At]=[_,N].map(Y(this,O,pe).bind(this));let Z=Math.round(.2126*Et[0]+.7152*Et[1]+.0722*Et[2]),Tt=Math.round(.2126*At[0]+.7152*At[1]+.0722*At[2]),[xt,Ut]=[X,st].map(Y(this,O,pe).bind(this));Tt<Z&&([Z,Tt,xt,Ut]=[Tt,Z,Ut,xt]),t(this,O,oe).style.color="";const jt=($t,qt,vt)=>{const at=new Array(256),lt=(Tt-Z)/vt,Rt=$t/255,zt=(qt-$t)/(255*vt);let Gt=0;for(let U=0;U<=vt;U++){const gt=Math.round(Z+U*lt),wt=Rt+U*zt;for(let Dt=Gt;Dt<=gt;Dt++)at[Dt]=wt;Gt=gt+1}for(let U=Gt;U<256;U++)at[U]=at[Gt-1];return at.join(",")},Vt=`g_${t(this,w)}_hcm_highlight_filter`,kt=ot(this,r,Y(this,O,ve).call(this,Vt));return Y(this,O,ze).call(this,kt),Y(this,O,fe).call(this,jt(xt[0],Ut[0],5),jt(xt[1],Ut[1],5),jt(xt[2],Ut[2],5),kt),ot(this,F,`url(#${Vt})`),t(this,F)}destroy(_=!1){_&&(t(this,s)||t(this,F))||(t(this,it)&&(t(this,it).parentNode.parentNode.remove(),ot(this,it,null)),t(this,$)&&(t(this,$).clear(),ot(this,$,null)),ot(this,D,0))}}$=new WeakMap,it=new WeakMap,w=new WeakMap,W=new WeakMap,et=new WeakMap,S=new WeakMap,s=new WeakMap,r=new WeakMap,p=new WeakMap,F=new WeakMap,D=new WeakMap,O=new WeakSet,ae=function(){return t(this,$)||ot(this,$,new Map)},oe=function(){if(!t(this,it)){const _=t(this,W).createElement("div"),{style:N}=_;N.visibility="hidden",N.contain="strict",N.width=N.height=0,N.position="absolute",N.top=N.left=0,N.zIndex=-1;const X=t(this,W).createElementNS(G,"svg");X.setAttribute("width",0),X.setAttribute("height",0),ot(this,it,t(this,W).createElementNS(G,"defs")),_.append(X),X.append(t(this,it)),t(this,W).body.append(_)}return t(this,it)},ze=function(_){const N=t(this,W).createElementNS(G,"feColorMatrix");N.setAttribute("type","matrix"),N.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),_.append(N)},ve=function(_){const N=t(this,W).createElementNS(G,"filter");return N.setAttribute("color-interpolation-filters","sRGB"),N.setAttribute("id",_),t(this,O,oe).append(N),N},Ee=function(_,N,X){const st=t(this,W).createElementNS(G,N);st.setAttribute("type","discrete"),st.setAttribute("tableValues",X),_.append(st)},fe=function(_,N,X,st){const pt=t(this,W).createElementNS(G,"feComponentTransfer");st.append(pt),Y(this,O,Ee).call(this,pt,"feFuncR",_),Y(this,O,Ee).call(this,pt,"feFuncG",N),Y(this,O,Ee).call(this,pt,"feFuncB",X)},pe=function(_){return t(this,O,oe).style.color=_,a(getComputedStyle(t(this,O,oe)).getPropertyValue("color"))},e.DOMFilterFactory=ht;class P extends n.BaseCanvasFactory{constructor({ownerDocument:Q=globalThis.document}={}){super(),this._document=Q}_createCanvas(Q,_){const N=this._document.createElement("canvas");return N.width=Q,N.height=_,N}}e.DOMCanvasFactory=P;async function T(J,Q=!1){if(A(J,document.baseURI)){const _=await fetch(J);if(!_.ok)throw new Error(_.statusText);return Q?new Uint8Array(await _.arrayBuffer()):(0,h.stringToBytes)(await _.text())}return new Promise((_,N)=>{const X=new XMLHttpRequest;X.open("GET",J,!0),Q&&(X.responseType="arraybuffer"),X.onreadystatechange=()=>{if(X.readyState===XMLHttpRequest.DONE){if(X.status===200||X.status===0){let st;if(Q&&X.response?st=new Uint8Array(X.response):!Q&&X.responseText&&(st=(0,h.stringToBytes)(X.responseText)),st){_(st);return}}N(new Error(X.statusText))}},X.send(null)})}class f extends n.BaseCMapReaderFactory{_fetchData(Q,_){return T(Q,this.isCompressed).then(N=>({cMapData:N,compressionType:_}))}}e.DOMCMapReaderFactory=f;class j extends n.BaseStandardFontDataFactory{_fetchData(Q){return T(Q,!0)}}e.DOMStandardFontDataFactory=j;class L extends n.BaseSVGFactory{_createSVG(Q){return document.createElementNS(G,Q)}}e.DOMSVGFactory=L;class b{constructor({viewBox:Q,scale:_,rotation:N,offsetX:X=0,offsetY:st=0,dontFlip:pt=!1}){this.viewBox=Q,this.scale=_,this.rotation=N,this.offsetX=X,this.offsetY=st;const Et=(Q[2]+Q[0])/2,At=(Q[3]+Q[1])/2;let Z,Tt,xt,Ut;switch(N%=360,N<0&&(N+=360),N){case 180:Z=-1,Tt=0,xt=0,Ut=1;break;case 90:Z=0,Tt=1,xt=1,Ut=0;break;case 270:Z=0,Tt=-1,xt=-1,Ut=0;break;case 0:Z=1,Tt=0,xt=0,Ut=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}pt&&(xt=-xt,Ut=-Ut);let jt,Vt,kt,It;Z===0?(jt=Math.abs(At-Q[1])*_+X,Vt=Math.abs(Et-Q[0])*_+st,kt=(Q[3]-Q[1])*_,It=(Q[2]-Q[0])*_):(jt=Math.abs(Et-Q[0])*_+X,Vt=Math.abs(At-Q[1])*_+st,kt=(Q[2]-Q[0])*_,It=(Q[3]-Q[1])*_),this.transform=[Z*_,Tt*_,xt*_,Ut*_,jt-Z*_*Et-xt*_*At,Vt-Tt*_*Et-Ut*_*At],this.width=kt,this.height=It}get rawDims(){const{viewBox:Q}=this;return(0,h.shadow)(this,"rawDims",{pageWidth:Q[2]-Q[0],pageHeight:Q[3]-Q[1],pageX:Q[0],pageY:Q[1]})}clone({scale:Q=this.scale,rotation:_=this.rotation,offsetX:N=this.offsetX,offsetY:X=this.offsetY,dontFlip:st=!1}={}){return new b({viewBox:this.viewBox.slice(),scale:Q,rotation:_,offsetX:N,offsetY:X,dontFlip:st})}convertToViewportPoint(Q,_){return h.Util.applyTransform([Q,_],this.transform)}convertToViewportRectangle(Q){const _=h.Util.applyTransform([Q[0],Q[1]],this.transform),N=h.Util.applyTransform([Q[2],Q[3]],this.transform);return[_[0],_[1],N[0],N[1]]}convertToPdfPoint(Q,_){return h.Util.applyInverseTransform([Q,_],this.transform)}}e.PageViewport=b;class m extends h.BaseException{constructor(Q,_=0){super(Q,"RenderingCancelledException"),this.extraDelay=_}}e.RenderingCancelledException=m;function E(J){const Q=J.length;let _=0;for(;_<Q&&J[_].trim()==="";)_++;return J.substring(_,_+5).toLowerCase()==="data:"}function g(J){return typeof J=="string"&&/\.pdf$/i.test(J)}function u(J,Q=!1){return Q||([J]=J.split(/[#?]/,1)),J.substring(J.lastIndexOf("/")+1)}function y(J,Q="document.pdf"){if(typeof J!="string")return Q;if(E(J))return(0,h.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Q;const _=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,N=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,X=_.exec(J);let st=N.exec(X[1])||N.exec(X[2])||N.exec(X[3]);if(st&&(st=st[0],st.includes("%")))try{st=N.exec(decodeURIComponent(st))[0]}catch{}return st||Q}class M{constructor(){Kt(this,"started",Object.create(null));Kt(this,"times",[])}time(Q){Q in this.started&&(0,h.warn)(`Timer is already running for ${Q}`),this.started[Q]=Date.now()}timeEnd(Q){Q in this.started||(0,h.warn)(`Timer has not been started for ${Q}`),this.times.push({name:Q,start:this.started[Q],end:Date.now()}),delete this.started[Q]}toString(){const Q=[];let _=0;for(const{name:N}of this.times)_=Math.max(N.length,_);for(const{name:N,start:X,end:st}of this.times)Q.push(`${N.padEnd(_)} ${st-X}ms
`);return Q.join("")}}e.StatTimer=M;function A(J,Q){try{const{protocol:_}=Q?new URL(J,Q):new URL(J);return _==="http:"||_==="https:"}catch{return!1}}function i(J){J.preventDefault()}function d(J,Q=!1){return new Promise((_,N)=>{const X=document.createElement("script");X.src=J,X.onload=function(st){Q&&X.remove(),_(st)},X.onerror=function(){N(new Error(`Cannot load script at: ${X.src}`))},(document.head||document.documentElement).append(X)})}function o(J){console.log("Deprecated API usage: "+J)}let l;class c{static toDateObject(Q){if(!Q||typeof Q!="string")return null;l||(l=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const _=l.exec(Q);if(!_)return null;const N=parseInt(_[1],10);let X=parseInt(_[2],10);X=X>=1&&X<=12?X-1:0;let st=parseInt(_[3],10);st=st>=1&&st<=31?st:1;let pt=parseInt(_[4],10);pt=pt>=0&&pt<=23?pt:0;let Et=parseInt(_[5],10);Et=Et>=0&&Et<=59?Et:0;let At=parseInt(_[6],10);At=At>=0&&At<=59?At:0;const Z=_[7]||"Z";let Tt=parseInt(_[8],10);Tt=Tt>=0&&Tt<=23?Tt:0;let xt=parseInt(_[9],10)||0;return xt=xt>=0&&xt<=59?xt:0,Z==="-"?(pt+=Tt,Et+=xt):Z==="+"&&(pt-=Tt,Et-=xt),new Date(Date.UTC(N,X,st,pt,Et,At))}}e.PDFDateString=c;function I(J,{scale:Q=1,rotation:_=0}){const{width:N,height:X}=J.attributes.style,st=[0,0,parseInt(N),parseInt(X)];return new b({viewBox:st,scale:Q,rotation:_})}function a(J){if(J.startsWith("#")){const Q=parseInt(J.slice(1),16);return[(Q&16711680)>>16,(Q&65280)>>8,Q&255]}return J.startsWith("rgb(")?J.slice(4,-1).split(",").map(Q=>parseInt(Q)):J.startsWith("rgba(")?J.slice(5,-1).split(",").map(Q=>parseInt(Q)).slice(0,3):((0,h.warn)(`Not a valid color format: "${J}"`),[0,0,0])}function v(J){const Q=document.createElement("span");Q.style.visibility="hidden",document.body.append(Q);for(const _ of J.keys()){Q.style.color=_;const N=window.getComputedStyle(Q).color;J.set(_,a(N))}Q.remove()}function R(J){const{a:Q,b:_,c:N,d:X,e:st,f:pt}=J.getTransform();return[Q,_,N,X,st,pt]}function tt(J){const{a:Q,b:_,c:N,d:X,e:st,f:pt}=J.getTransform().invertSelf();return[Q,_,N,X,st,pt]}function V(J,Q,_=!1,N=!0){if(Q instanceof b){const{pageWidth:X,pageHeight:st}=Q.rawDims,{style:pt}=J,Et=h.FeatureTest.isCSSRoundSupported,At=`var(--scale-factor) * ${X}px`,Z=`var(--scale-factor) * ${st}px`,Tt=Et?`round(${At}, 1px)`:`calc(${At})`,xt=Et?`round(${Z}, 1px)`:`calc(${Z})`;!_||Q.rotation%180===0?(pt.width=Tt,pt.height=xt):(pt.width=xt,pt.height=Tt)}N&&J.setAttribute("data-main-rotation",Q.rotation)}},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=B(1);class h{constructor(){this.constructor===h&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(f){return"none"}addHCMFilter(f,j){return"none"}addHighlightHCMFilter(f,j,L,b){return"none"}destroy(f=!1){}}e.BaseFilterFactory=h;class G{constructor(){this.constructor===G&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,j){if(f<=0||j<=0)throw new Error("Invalid canvas size");const L=this._createCanvas(f,j);return{canvas:L,context:L.getContext("2d")}}reset(f,j,L){if(!f.canvas)throw new Error("Canvas is not specified");if(j<=0||L<=0)throw new Error("Invalid canvas size");f.canvas.width=j,f.canvas.height=L}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,j){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=G;class H{constructor({baseUrl:f=null,isCompressed:j=!0}){this.constructor===H&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=j}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const j=this.baseUrl+f+(this.isCompressed?".bcmap":""),L=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(j,L).catch(b=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(f,j){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=H;class ht{constructor({baseUrl:f=null}){this.constructor===ht&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${f}`;return this._fetchData(j).catch(L=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(f){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=ht;class P{constructor(){this.constructor===P&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,j,L=!1){if(f<=0||j<=0)throw new Error("Invalid SVG dimensions");const b=this._createSVG("svg:svg");return b.setAttribute("version","1.1"),L||(b.setAttribute("width",`${f}px`),b.setAttribute("height",`${j}px`)),b.setAttribute("preserveAspectRatio","none"),b.setAttribute("viewBox",`0 0 ${f} ${j}`),b}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=P},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=B(1);const h=3285377520,G=4294901760,H=65535;class ht{constructor(T){this.h1=T?T&4294967295:h,this.h2=T?T&4294967295:h}update(T){let f,j;if(typeof T=="string"){f=new Uint8Array(T.length*2),j=0;for(let o=0,l=T.length;o<l;o++){const c=T.charCodeAt(o);c<=255?f[j++]=c:(f[j++]=c>>>8,f[j++]=c&255)}}else if((0,n.isArrayBuffer)(T))f=T.slice(),j=f.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const L=j>>2,b=j-L*4,m=new Uint32Array(f.buffer,0,L);let E=0,g=0,u=this.h1,y=this.h2;const M=3432918353,A=461845907,i=M&H,d=A&H;for(let o=0;o<L;o++)o&1?(E=m[o],E=E*M&G|E*i&H,E=E<<15|E>>>17,E=E*A&G|E*d&H,u^=E,u=u<<13|u>>>19,u=u*5+3864292196):(g=m[o],g=g*M&G|g*i&H,g=g<<15|g>>>17,g=g*A&G|g*d&H,y^=g,y=y<<13|y>>>19,y=y*5+3864292196);switch(E=0,b){case 3:E^=f[L*4+2]<<16;case 2:E^=f[L*4+1]<<8;case 1:E^=f[L*4],E=E*M&G|E*i&H,E=E<<15|E>>>17,E=E*A&G|E*d&H,L&1?u^=E:y^=E}this.h1=u,this.h2=y}hexdigest(){let T=this.h1,f=this.h2;return T^=f>>>1,T=T*3981806797&G|T*36045&H,f=f*4283543511&G|((f<<16|T>>>16)*2950163797&G)>>>16,T^=f>>>1,T=T*444984403&G|T*60499&H,f=f*3301882366&G|((f<<16|T>>>16)*3120437893&G)>>>16,T^=f>>>1,(T>>>0).toString(16).padStart(8,"0")+(f>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=ht},(C,e,B)=>{var H;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=B(1);class h{constructor({ownerDocument:P=globalThis.document,styleElement:T=null}){rt(this,H,new Set);this._document=P,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(P){this.nativeFontFaces.add(P),this._document.fonts.add(P)}removeNativeFontFace(P){this.nativeFontFaces.delete(P),this._document.fonts.delete(P)}insertRule(P){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const T=this.styleElement.sheet;T.insertRule(P,T.cssRules.length)}clear(){for(const P of this.nativeFontFaces)this._document.fonts.delete(P);this.nativeFontFaces.clear(),t(this,H).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(P){if(!(!P||t(this,H).has(P.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:T,src:f,style:j}=P,L=new FontFace(T,f,j);this.addNativeFontFace(L);try{await L.load(),t(this,H).add(T)}catch{(0,n.warn)(`Cannot load system font: ${P.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(L)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(P){if(P.attached||P.missingFile&&!P.systemFontInfo)return;if(P.attached=!0,P.systemFontInfo){await this.loadSystemFont(P.systemFontInfo);return}if(this.isFontLoadingAPISupported){const f=P.createNativeFontFace();if(f){this.addNativeFontFace(f);try{await f.loaded}catch(j){throw(0,n.warn)(`Failed to load font '${f.family}': '${j}'.`),P.disableFontFace=!0,j}}return}const T=P.createFontFaceRule();if(T){if(this.insertRule(T),this.isSyncFontLoadingSupported)return;await new Promise(f=>{const j=this._queueLoadingCallback(f);this._prepareFontLoadEvent(P,j)})}}get isFontLoadingAPISupported(){var T;const P=!!((T=this._document)!=null&&T.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",P)}get isSyncFontLoadingSupported(){let P=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(P=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",P)}_queueLoadingCallback(P){function T(){for((0,n.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;f.length>0&&f[0].done;){const L=f.shift();setTimeout(L.callback,0)}}const{loadingRequests:f}=this,j={done:!1,complete:T,callback:P};return f.push(j),j}get _loadTestFont(){const P=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",P)}_prepareFontLoadEvent(P,T){function f(a,v){return a.charCodeAt(v)<<24|a.charCodeAt(v+1)<<16|a.charCodeAt(v+2)<<8|a.charCodeAt(v+3)&255}function j(a,v,R,tt){const V=a.substring(0,v),K=a.substring(v+R);return V+tt+K}let L,b;const m=this._document.createElement("canvas");m.width=1,m.height=1;const E=m.getContext("2d");let g=0;function u(a,v){if(++g>30){(0,n.warn)("Load test font never loaded."),v();return}if(E.font="30px "+a,E.fillText(".",0,20),E.getImageData(0,0,1,1).data[3]>0){v();return}setTimeout(u.bind(null,a,v))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let M=this._loadTestFont;M=j(M,976,y.length,y);const i=16,d=1482184792;let o=f(M,i);for(L=0,b=y.length-3;L<b;L+=4)o=o-d+f(y,L)|0;L<y.length&&(o=o-d+f(y+"XXX",L)|0),M=j(M,i,4,(0,n.string32)(o));const l=`url(data:font/opentype;base64,${btoa(M)});`,c=`@font-face {font-family:"${y}";src:${l}}`;this.insertRule(c);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const a of[P.loadedName,y]){const v=this._document.createElement("span");v.textContent="Hi",v.style.fontFamily=a,I.append(v)}this._document.body.append(I),u(y,()=>{I.remove(),T.complete()})}}H=new WeakMap,e.FontLoader=h;class G{constructor(P,{isEvalSupported:T=!0,disableFontFace:f=!1,ignoreErrors:j=!1,inspectFont:L=null}){this.compiledGlyphs=Object.create(null);for(const b in P)this[b]=P[b];this.isEvalSupported=T!==!1,this.disableFontFace=f===!0,this.ignoreErrors=j===!0,this._inspectFont=L}createNativeFontFace(){var T;if(!this.data||this.disableFontFace)return null;let P;if(!this.cssFontInfo)P=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),P=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return(T=this._inspectFont)==null||T.call(this,this),P}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const P=(0,n.bytesToString)(this.data),T=`url(data:${this.mimetype};base64,${btoa(P)});`;let f;if(!this.cssFontInfo)f=`@font-face {font-family:"${this.loadedName}";src:${T}}`;else{let L=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(L+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),f=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${L}src:${T}}`}return(j=this._inspectFont)==null||j.call(this,this,T),f}getPathGenerator(P,T){if(this.compiledGlyphs[T]!==void 0)return this.compiledGlyphs[T];let f;try{f=P.get(this.loadedName+"_path_"+T)}catch(j){if(!this.ignoreErrors)throw j;return(0,n.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[T]=function(L,b){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const j=[];for(const L of f){const b=L.args!==void 0?L.args.join(","):"";j.push("c.",L.cmd,"(",b,`);
`)}return this.compiledGlyphs[T]=new Function("c","size",j.join(""))}return this.compiledGlyphs[T]=function(j,L){for(const b of f)b.cmd==="scale"&&(b.args=[L,-L]),j[b.cmd].apply(j,b.args)}}}e.FontFaceObject=G},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=B(7);B(1);const h=function(T){return new Promise((f,j)=>{require$$5.readFile(T,(b,m)=>{if(b||!m){j(new Error(b));return}f(new Uint8Array(m))})})};class G extends n.BaseFilterFactory{}e.NodeFilterFactory=G;class H extends n.BaseCanvasFactory{_createCanvas(f,j){return require$$5.createCanvas(f,j)}}e.NodeCanvasFactory=H;class ht extends n.BaseCMapReaderFactory{_fetchData(f,j){return h(f).then(L=>({cMapData:L,compressionType:j}))}}e.NodeCMapReaderFactory=ht;class P extends n.BaseStandardFontDataFactory{_fetchData(f){return h(f)}}e.NodeStandardFontDataFactory=P},(C,e,B)=>{var it,qe,Xe;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=B(1),h=B(6),G=B(12),H=B(13);const ht=16,P=100,T=4096,f=15,j=10,L=1e3,b=16;function m(S,s){if(S._removeMirroring)throw new Error("Context is already forwarding operations.");S.__originalSave=S.save,S.__originalRestore=S.restore,S.__originalRotate=S.rotate,S.__originalScale=S.scale,S.__originalTranslate=S.translate,S.__originalTransform=S.transform,S.__originalSetTransform=S.setTransform,S.__originalResetTransform=S.resetTransform,S.__originalClip=S.clip,S.__originalMoveTo=S.moveTo,S.__originalLineTo=S.lineTo,S.__originalBezierCurveTo=S.bezierCurveTo,S.__originalRect=S.rect,S.__originalClosePath=S.closePath,S.__originalBeginPath=S.beginPath,S._removeMirroring=()=>{S.save=S.__originalSave,S.restore=S.__originalRestore,S.rotate=S.__originalRotate,S.scale=S.__originalScale,S.translate=S.__originalTranslate,S.transform=S.__originalTransform,S.setTransform=S.__originalSetTransform,S.resetTransform=S.__originalResetTransform,S.clip=S.__originalClip,S.moveTo=S.__originalMoveTo,S.lineTo=S.__originalLineTo,S.bezierCurveTo=S.__originalBezierCurveTo,S.rect=S.__originalRect,S.closePath=S.__originalClosePath,S.beginPath=S.__originalBeginPath,delete S._removeMirroring},S.save=function(){s.save(),this.__originalSave()},S.restore=function(){s.restore(),this.__originalRestore()},S.translate=function(p,F){s.translate(p,F),this.__originalTranslate(p,F)},S.scale=function(p,F){s.scale(p,F),this.__originalScale(p,F)},S.transform=function(p,F,D,O,q,nt){s.transform(p,F,D,O,q,nt),this.__originalTransform(p,F,D,O,q,nt)},S.setTransform=function(p,F,D,O,q,nt){s.setTransform(p,F,D,O,q,nt),this.__originalSetTransform(p,F,D,O,q,nt)},S.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},S.rotate=function(p){s.rotate(p),this.__originalRotate(p)},S.clip=function(p){s.clip(p),this.__originalClip(p)},S.moveTo=function(r,p){s.moveTo(r,p),this.__originalMoveTo(r,p)},S.lineTo=function(r,p){s.lineTo(r,p),this.__originalLineTo(r,p)},S.bezierCurveTo=function(r,p,F,D,O,q){s.bezierCurveTo(r,p,F,D,O,q),this.__originalBezierCurveTo(r,p,F,D,O,q)},S.rect=function(r,p,F,D){s.rect(r,p,F,D),this.__originalRect(r,p,F,D)},S.closePath=function(){s.closePath(),this.__originalClosePath()},S.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class E{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,r,p){let F;return this.cache[s]!==void 0?(F=this.cache[s],this.canvasFactory.reset(F,r,p)):(F=this.canvasFactory.create(r,p),this.cache[s]=F),F}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const r=this.cache[s];this.canvasFactory.destroy(r),delete this.cache[s]}}}function g(S,s,r,p,F,D,O,q,nt,ct){const[ft,bt,mt,_t,J,Q]=(0,h.getCurrentTransform)(S);if(bt===0&&mt===0){const X=O*ft+J,st=Math.round(X),pt=q*_t+Q,Et=Math.round(pt),At=(O+nt)*ft+J,Z=Math.abs(Math.round(At)-st)||1,Tt=(q+ct)*_t+Q,xt=Math.abs(Math.round(Tt)-Et)||1;return S.setTransform(Math.sign(ft),0,0,Math.sign(_t),st,Et),S.drawImage(s,r,p,F,D,0,0,Z,xt),S.setTransform(ft,bt,mt,_t,J,Q),[Z,xt]}if(ft===0&&_t===0){const X=q*mt+J,st=Math.round(X),pt=O*bt+Q,Et=Math.round(pt),At=(q+ct)*mt+J,Z=Math.abs(Math.round(At)-st)||1,Tt=(O+nt)*bt+Q,xt=Math.abs(Math.round(Tt)-Et)||1;return S.setTransform(0,Math.sign(bt),Math.sign(mt),0,st,Et),S.drawImage(s,r,p,F,D,0,0,xt,Z),S.setTransform(ft,bt,mt,_t,J,Q),[xt,Z]}S.drawImage(s,r,p,F,D,O,q,nt,ct);const _=Math.hypot(ft,bt),N=Math.hypot(mt,_t);return[_*nt,N*ct]}function u(S){const{width:s,height:r}=S;if(s>L||r>L)return null;const p=1e3,F=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=s+1;let O=new Uint8Array(D*(r+1)),q,nt,ct;const ft=s+7&-8;let bt=new Uint8Array(ft*r),mt=0;for(const N of S.data){let X=128;for(;X>0;)bt[mt++]=N&X?0:255,X>>=1}let _t=0;for(mt=0,bt[mt]!==0&&(O[0]=1,++_t),nt=1;nt<s;nt++)bt[mt]!==bt[mt+1]&&(O[nt]=bt[mt]?2:1,++_t),mt++;for(bt[mt]!==0&&(O[nt]=2,++_t),q=1;q<r;q++){mt=q*ft,ct=q*D,bt[mt-ft]!==bt[mt]&&(O[ct]=bt[mt]?1:8,++_t);let N=(bt[mt]?4:0)+(bt[mt-ft]?8:0);for(nt=1;nt<s;nt++)N=(N>>2)+(bt[mt+1]?4:0)+(bt[mt-ft+1]?8:0),F[N]&&(O[ct+nt]=F[N],++_t),mt++;if(bt[mt-ft]!==bt[mt]&&(O[ct+nt]=bt[mt]?2:4,++_t),_t>p)return null}for(mt=ft*(r-1),ct=q*D,bt[mt]!==0&&(O[ct]=8,++_t),nt=1;nt<s;nt++)bt[mt]!==bt[mt+1]&&(O[ct+nt]=bt[mt]?4:8,++_t),mt++;if(bt[mt]!==0&&(O[ct+nt]=4,++_t),_t>p)return null;const J=new Int32Array([0,D,-1,0,-D,0,0,0,1]),Q=new Path2D;for(q=0;_t&&q<=r;q++){let N=q*D;const X=N+s;for(;N<X&&!O[N];)N++;if(N===X)continue;Q.moveTo(N%D,q);const st=N;let pt=O[N];do{const Et=J[pt];do N+=Et;while(!O[N]);const At=O[N];At!==5&&At!==10?(pt=At,O[N]=0):(pt=At&51*pt>>4,O[N]&=pt>>2|pt<<2),Q.lineTo(N%D,N/D|0),O[N]||--_t}while(st!==N);--q}return bt=null,O=null,function(N){N.save(),N.scale(1/s,-1/r),N.translate(0,-r),N.fill(Q),N.beginPath(),N.restore()}}class y{constructor(s,r){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,r])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,r){this.x=s,this.y=r}updatePathMinMax(s,r,p){[r,p]=n.Util.applyTransform([r,p],s),this.minX=Math.min(this.minX,r),this.minY=Math.min(this.minY,p),this.maxX=Math.max(this.maxX,r),this.maxY=Math.max(this.maxY,p)}updateRectMinMax(s,r){const p=n.Util.applyTransform(r,s),F=n.Util.applyTransform(r.slice(2),s);this.minX=Math.min(this.minX,p[0],F[0]),this.minY=Math.min(this.minY,p[1],F[1]),this.maxX=Math.max(this.maxX,p[0],F[0]),this.maxY=Math.max(this.maxY,p[1],F[1])}updateScalingPathMinMax(s,r){n.Util.scaleMinMax(s,r),this.minX=Math.min(this.minX,r[0]),this.maxX=Math.max(this.maxX,r[1]),this.minY=Math.min(this.minY,r[2]),this.maxY=Math.max(this.maxY,r[3])}updateCurvePathMinMax(s,r,p,F,D,O,q,nt,ct,ft){const bt=n.Util.bezierBoundingBox(r,p,F,D,O,q,nt,ct);if(ft){ft[0]=Math.min(ft[0],bt[0],bt[2]),ft[1]=Math.max(ft[1],bt[0],bt[2]),ft[2]=Math.min(ft[2],bt[1],bt[3]),ft[3]=Math.max(ft[3],bt[1],bt[3]);return}this.updateRectMinMax(s,bt)}getPathBoundingBox(s=G.PathType.FILL,r=null){const p=[this.minX,this.minY,this.maxX,this.maxY];if(s===G.PathType.STROKE){r||(0,n.unreachable)("Stroke bounding box must include transform.");const F=n.Util.singularValueDecompose2dScale(r),D=F[0]*this.lineWidth/2,O=F[1]*this.lineWidth/2;p[0]-=D,p[1]-=O,p[2]+=D,p[3]+=O}return p}updateClipFromPath(){const s=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=G.PathType.FILL,r=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(s,r))}}function M(S,s){if(typeof ImageData<"u"&&s instanceof ImageData){S.putImageData(s,0,0);return}const r=s.height,p=s.width,F=r%b,D=(r-F)/b,O=F===0?D:D+1,q=S.createImageData(p,b);let nt=0,ct;const ft=s.data,bt=q.data;let mt,_t,J,Q;if(s.kind===n.ImageKind.GRAYSCALE_1BPP){const _=ft.byteLength,N=new Uint32Array(bt.buffer,0,bt.byteLength>>2),X=N.length,st=p+7>>3,pt=4294967295,Et=n.FeatureTest.isLittleEndian?4278190080:255;for(mt=0;mt<O;mt++){for(J=mt<D?b:F,ct=0,_t=0;_t<J;_t++){const At=_-nt;let Z=0;const Tt=At>st?p:At*8-7,xt=Tt&-8;let Ut=0,jt=0;for(;Z<xt;Z+=8)jt=ft[nt++],N[ct++]=jt&128?pt:Et,N[ct++]=jt&64?pt:Et,N[ct++]=jt&32?pt:Et,N[ct++]=jt&16?pt:Et,N[ct++]=jt&8?pt:Et,N[ct++]=jt&4?pt:Et,N[ct++]=jt&2?pt:Et,N[ct++]=jt&1?pt:Et;for(;Z<Tt;Z++)Ut===0&&(jt=ft[nt++],Ut=128),N[ct++]=jt&Ut?pt:Et,Ut>>=1}for(;ct<X;)N[ct++]=0;S.putImageData(q,0,mt*b)}}else if(s.kind===n.ImageKind.RGBA_32BPP){for(_t=0,Q=p*b*4,mt=0;mt<D;mt++)bt.set(ft.subarray(nt,nt+Q)),nt+=Q,S.putImageData(q,0,_t),_t+=b;mt<O&&(Q=p*F*4,bt.set(ft.subarray(nt,nt+Q)),S.putImageData(q,0,_t))}else if(s.kind===n.ImageKind.RGB_24BPP)for(J=b,Q=p*J,mt=0;mt<O;mt++){for(mt>=D&&(J=F,Q=p*J),ct=0,_t=Q;_t--;)bt[ct++]=ft[nt++],bt[ct++]=ft[nt++],bt[ct++]=ft[nt++],bt[ct++]=255;S.putImageData(q,0,mt*b)}else throw new Error(`bad image kind: ${s.kind}`)}function A(S,s){if(s.bitmap){S.drawImage(s.bitmap,0,0);return}const r=s.height,p=s.width,F=r%b,D=(r-F)/b,O=F===0?D:D+1,q=S.createImageData(p,b);let nt=0;const ct=s.data,ft=q.data;for(let bt=0;bt<O;bt++){const mt=bt<D?b:F;({srcPos:nt}=(0,H.convertBlackAndWhiteToRGBA)({src:ct,srcPos:nt,dest:ft,width:p,height:mt,nonBlackColor:0})),S.putImageData(q,0,bt*b)}}function i(S,s){const r=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const p of r)S[p]!==void 0&&(s[p]=S[p]);S.setLineDash!==void 0&&(s.setLineDash(S.getLineDash()),s.lineDashOffset=S.lineDashOffset)}function d(S){if(S.strokeStyle=S.fillStyle="#000000",S.fillRule="nonzero",S.globalAlpha=1,S.lineWidth=1,S.lineCap="butt",S.lineJoin="miter",S.miterLimit=10,S.globalCompositeOperation="source-over",S.font="10px sans-serif",S.setLineDash!==void 0&&(S.setLineDash([]),S.lineDashOffset=0),!n.isNodeJS){const{filter:s}=S;s!=="none"&&s!==""&&(S.filter="none")}}function o(S,s,r,p){const F=S.length;for(let D=3;D<F;D+=4){const O=S[D];if(O===0)S[D-3]=s,S[D-2]=r,S[D-1]=p;else if(O<255){const q=255-O;S[D-3]=S[D-3]*O+s*q>>8,S[D-2]=S[D-2]*O+r*q>>8,S[D-1]=S[D-1]*O+p*q>>8}}}function l(S,s,r){const p=S.length,F=1/255;for(let D=3;D<p;D+=4){const O=r?r[S[D]]:S[D];s[D]=s[D]*O*F|0}}function c(S,s,r){const p=S.length;for(let F=3;F<p;F+=4){const D=S[F-3]*77+S[F-2]*152+S[F-1]*28;s[F]=r?s[F]*r[D>>8]>>8:s[F]*D>>16}}function I(S,s,r,p,F,D,O,q,nt,ct,ft){const bt=!!D,mt=bt?D[0]:0,_t=bt?D[1]:0,J=bt?D[2]:0,Q=F==="Luminosity"?c:l,N=Math.min(p,Math.ceil(1048576/r));for(let X=0;X<p;X+=N){const st=Math.min(N,p-X),pt=S.getImageData(q-ct,X+(nt-ft),r,st),Et=s.getImageData(q,X+nt,r,st);bt&&o(pt.data,mt,_t,J),Q(pt.data,Et.data,O),s.putImageData(Et,q,X+nt)}}function a(S,s,r,p){const F=p[0],D=p[1],O=p[2]-F,q=p[3]-D;O===0||q===0||(I(s.context,r,O,q,s.subtype,s.backdrop,s.transferMap,F,D,s.offsetX,s.offsetY),S.save(),S.globalAlpha=1,S.globalCompositeOperation="source-over",S.setTransform(1,0,0,1,0,0),S.drawImage(r.canvas,0,0),S.restore())}function v(S,s){const r=n.Util.singularValueDecompose2dScale(S);r[0]=Math.fround(r[0]),r[1]=Math.fround(r[1]);const p=Math.fround((globalThis.devicePixelRatio||1)*h.PixelsPerInch.PDF_TO_CSS_UNITS);return s!==void 0?s:r[0]<=p||r[1]<=p}const R=["butt","round","square"],tt=["miter","round","bevel"],V={},K={},et=class et{constructor(s,r,p,F,D,{optionalContentConfig:O,markedContentStack:q=null},nt,ct){rt(this,it);this.ctx=s,this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=r,this.objs=p,this.canvasFactory=F,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=q||[],this.optionalContentConfig=O,this.cachedCanvases=new E(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=nt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ct,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,r=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):r}beginDrawing({transform:s,viewport:r,transparency:p=!1,background:F=null}){const D=this.ctx.canvas.width,O=this.ctx.canvas.height,q=this.ctx.fillStyle;if(this.ctx.fillStyle=F||"#ffffff",this.ctx.fillRect(0,0,D,O),this.ctx.fillStyle=q,p){const nt=this.cachedCanvases.getCanvas("transparent",D,O);this.compositeCtx=this.ctx,this.transparentCanvas=nt.canvas,this.ctx=nt.context,this.ctx.save(),this.ctx.transform(...(0,h.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),d(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...r.transform),this.viewportScale=r.scale,this.baseTransform=(0,h.getCurrentTransform)(this.ctx)}executeOperatorList(s,r,p,F){const D=s.argsArray,O=s.fnArray;let q=r||0;const nt=D.length;if(nt===q)return q;const ct=nt-q>j&&typeof p=="function",ft=ct?Date.now()+f:0;let bt=0;const mt=this.commonObjs,_t=this.objs;let J;for(;;){if(F!==void 0&&q===F.nextBreakPoint)return F.breakIt(q,p),q;if(J=O[q],J!==n.OPS.dependency)this[J].apply(this,D[q]);else for(const Q of D[q]){const _=Q.startsWith("g_")?mt:_t;if(!_.has(Q))return _.get(Q,p),q}if(q++,q===nt)return q;if(ct&&++bt>j){if(Date.now()>ft)return p(),q;bt=0}}}endDrawing(){Y(this,it,qe).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const r of s.values())typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&(r.width=r.height=0);s.clear()}this._cachedBitmapsMap.clear(),Y(this,it,Xe).call(this)}_scaleImage(s,r){const p=s.width,F=s.height;let D=Math.max(Math.hypot(r[0],r[1]),1),O=Math.max(Math.hypot(r[2],r[3]),1),q=p,nt=F,ct="prescale1",ft,bt;for(;D>2&&q>1||O>2&&nt>1;){let mt=q,_t=nt;D>2&&q>1&&(mt=q>=16384?Math.floor(q/2)-1||1:Math.ceil(q/2),D/=q/mt),O>2&&nt>1&&(_t=nt>=16384?Math.floor(nt/2)-1||1:Math.ceil(nt)/2,O/=nt/_t),ft=this.cachedCanvases.getCanvas(ct,mt,_t),bt=ft.context,bt.clearRect(0,0,mt,_t),bt.drawImage(s,0,0,q,nt,0,0,mt,_t),s=ft.canvas,q=mt,nt=_t,ct=ct==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:q,paintHeight:nt}}_createMaskCanvas(s){const r=this.ctx,{width:p,height:F}=s,D=this.current.fillColor,O=this.current.patternFill,q=(0,h.getCurrentTransform)(r);let nt,ct,ft,bt;if((s.bitmap||s.data)&&s.count>1){const Z=s.bitmap||s.data.buffer;ct=JSON.stringify(O?q:[q.slice(0,4),D]),nt=this._cachedBitmapsMap.get(Z),nt||(nt=new Map,this._cachedBitmapsMap.set(Z,nt));const Tt=nt.get(ct);if(Tt&&!O){const xt=Math.round(Math.min(q[0],q[2])+q[4]),Ut=Math.round(Math.min(q[1],q[3])+q[5]);return{canvas:Tt,offsetX:xt,offsetY:Ut}}ft=Tt}ft||(bt=this.cachedCanvases.getCanvas("maskCanvas",p,F),A(bt.context,s));let mt=n.Util.transform(q,[1/p,0,0,-1/F,0,0]);mt=n.Util.transform(mt,[1,0,0,1,0,-F]);const _t=n.Util.applyTransform([0,0],mt),J=n.Util.applyTransform([p,F],mt),Q=n.Util.normalizeRect([_t[0],_t[1],J[0],J[1]]),_=Math.round(Q[2]-Q[0])||1,N=Math.round(Q[3]-Q[1])||1,X=this.cachedCanvases.getCanvas("fillCanvas",_,N),st=X.context,pt=Math.min(_t[0],J[0]),Et=Math.min(_t[1],J[1]);st.translate(-pt,-Et),st.transform(...mt),ft||(ft=this._scaleImage(bt.canvas,(0,h.getCurrentTransformInverse)(st)),ft=ft.img,nt&&O&&nt.set(ct,ft)),st.imageSmoothingEnabled=v((0,h.getCurrentTransform)(st),s.interpolate),g(st,ft,0,0,ft.width,ft.height,0,0,p,F),st.globalCompositeOperation="source-in";const At=n.Util.transform((0,h.getCurrentTransformInverse)(st),[1,0,0,1,-pt,-Et]);return st.fillStyle=O?D.getPattern(r,this,At,G.PathType.FILL):D,st.fillRect(0,0,p,F),nt&&!O&&(this.cachedCanvases.delete("fillCanvas"),nt.set(ct,X.canvas)),{canvas:X.canvas,offsetX:Math.round(pt),offsetY:Math.round(Et)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=R[s]}setLineJoin(s){this.ctx.lineJoin=tt[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,r){const p=this.ctx;p.setLineDash!==void 0&&(p.setLineDash(s),p.lineDashOffset=r)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[r,p]of s)switch(r){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p[0],p[1]);break;case"CA":this.current.strokeAlpha=p;break;case"ca":this.current.fillAlpha=p,this.ctx.globalAlpha=p;break;case"BM":this.ctx.globalCompositeOperation=p;break;case"SMask":this.current.activeSMask=p?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(p);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,r=this.ctx.canvas.height,p="smaskGroupAt"+this.groupLevel,F=this.cachedCanvases.getCanvas(p,s,r);this.suspendedCtx=this.ctx,this.ctx=F.context;const D=this.ctx;D.setTransform(...(0,h.getCurrentTransform)(this.suspendedCtx)),i(this.suspendedCtx,D),m(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),i(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const r=this.current.activeSMask,p=this.suspendedCtx;a(p,r,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(i(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),i(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,r,p,F,D,O){this.ctx.transform(s,r,p,F,D,O),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,r,p){const F=this.ctx,D=this.current;let O=D.x,q=D.y,nt,ct;const ft=(0,h.getCurrentTransform)(F),bt=ft[0]===0&&ft[3]===0||ft[1]===0&&ft[2]===0,mt=bt?p.slice(0):null;for(let _t=0,J=0,Q=s.length;_t<Q;_t++)switch(s[_t]|0){case n.OPS.rectangle:O=r[J++],q=r[J++];const _=r[J++],N=r[J++],X=O+_,st=q+N;F.moveTo(O,q),_===0||N===0?F.lineTo(X,st):(F.lineTo(X,q),F.lineTo(X,st),F.lineTo(O,st)),bt||D.updateRectMinMax(ft,[O,q,X,st]),F.closePath();break;case n.OPS.moveTo:O=r[J++],q=r[J++],F.moveTo(O,q),bt||D.updatePathMinMax(ft,O,q);break;case n.OPS.lineTo:O=r[J++],q=r[J++],F.lineTo(O,q),bt||D.updatePathMinMax(ft,O,q);break;case n.OPS.curveTo:nt=O,ct=q,O=r[J+4],q=r[J+5],F.bezierCurveTo(r[J],r[J+1],r[J+2],r[J+3],O,q),D.updateCurvePathMinMax(ft,nt,ct,r[J],r[J+1],r[J+2],r[J+3],O,q,mt),J+=6;break;case n.OPS.curveTo2:nt=O,ct=q,F.bezierCurveTo(O,q,r[J],r[J+1],r[J+2],r[J+3]),D.updateCurvePathMinMax(ft,nt,ct,O,q,r[J],r[J+1],r[J+2],r[J+3],mt),O=r[J+2],q=r[J+3],J+=4;break;case n.OPS.curveTo3:nt=O,ct=q,O=r[J+2],q=r[J+3],F.bezierCurveTo(r[J],r[J+1],O,q,O,q),D.updateCurvePathMinMax(ft,nt,ct,r[J],r[J+1],O,q,O,q,mt),J+=4;break;case n.OPS.closePath:F.closePath();break}bt&&D.updateScalingPathMinMax(ft,mt),D.setCurrentPoint(O,q)}closePath(){this.ctx.closePath()}stroke(s=!0){const r=this.ctx,p=this.current.strokeColor;r.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof p=="object"&&(p!=null&&p.getPattern)?(r.save(),r.strokeStyle=p.getPattern(r,this,(0,h.getCurrentTransformInverse)(r),G.PathType.STROKE),this.rescaleAndStroke(!1),r.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const r=this.ctx,p=this.current.fillColor,F=this.current.patternFill;let D=!1;F&&(r.save(),r.fillStyle=p.getPattern(r,this,(0,h.getCurrentTransformInverse)(r),G.PathType.FILL),D=!0);const O=this.current.getClippedPathBoundingBox();this.contentVisible&&O!==null&&(this.pendingEOFill?(r.fill("evenodd"),this.pendingEOFill=!1):r.fill()),D&&r.restore(),s&&this.consumePath(O)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=V}eoClip(){this.pendingClip=K}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,r=this.ctx;if(s===void 0){r.beginPath();return}r.save(),r.beginPath();for(const p of s)r.setTransform(...p.transform),r.translate(p.x,p.y),p.addToPath(r,p.fontSize);r.restore(),r.clip(),r.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,r){var ft;const p=this.commonObjs.get(s),F=this.current;if(!p)throw new Error(`Can't find font for ${s}`);if(F.fontMatrix=p.fontMatrix||n.FONT_IDENTITY_MATRIX,(F.fontMatrix[0]===0||F.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+s),r<0?(r=-r,F.fontDirection=-1):F.fontDirection=1,this.current.font=p,this.current.fontSize=r,p.isType3Font)return;const D=p.loadedName||"sans-serif",O=((ft=p.systemFontInfo)==null?void 0:ft.css)||`"${D}", ${p.fallbackName}`;let q="normal";p.black?q="900":p.bold&&(q="bold");const nt=p.italic?"italic":"normal";let ct=r;r<ht?ct=ht:r>P&&(ct=P),this.current.fontSizeScale=r/ct,this.ctx.font=`${nt} ${q} ${ct}px ${O}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,r){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=r}setLeadingMoveText(s,r){this.setLeading(-r),this.moveText(s,r)}setTextMatrix(s,r,p,F,D,O){this.current.textMatrix=[s,r,p,F,D,O],this.current.textMatrixScale=Math.hypot(s,r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,r,p,F){const D=this.ctx,O=this.current,q=O.font,nt=O.textRenderingMode,ct=O.fontSize/O.fontSizeScale,ft=nt&n.TextRenderingMode.FILL_STROKE_MASK,bt=!!(nt&n.TextRenderingMode.ADD_TO_PATH_FLAG),mt=O.patternFill&&!q.missingFile;let _t;(q.disableFontFace||bt||mt)&&(_t=q.getPathGenerator(this.commonObjs,s)),q.disableFontFace||mt?(D.save(),D.translate(r,p),D.beginPath(),_t(D,ct),F&&D.setTransform(...F),(ft===n.TextRenderingMode.FILL||ft===n.TextRenderingMode.FILL_STROKE)&&D.fill(),(ft===n.TextRenderingMode.STROKE||ft===n.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((ft===n.TextRenderingMode.FILL||ft===n.TextRenderingMode.FILL_STROKE)&&D.fillText(s,r,p),(ft===n.TextRenderingMode.STROKE||ft===n.TextRenderingMode.FILL_STROKE)&&D.strokeText(s,r,p)),bt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,h.getCurrentTransform)(D),x:r,y:p,fontSize:ct,addToPath:_t})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const r=s.getImageData(0,0,10,10).data;let p=!1;for(let F=3;F<r.length;F+=4)if(r[F]>0&&r[F]<255){p=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",p)}showText(s){const r=this.current,p=r.font;if(p.isType3Font)return this.showType3Text(s);const F=r.fontSize;if(F===0)return;const D=this.ctx,O=r.fontSizeScale,q=r.charSpacing,nt=r.wordSpacing,ct=r.fontDirection,ft=r.textHScale*ct,bt=s.length,mt=p.vertical,_t=mt?1:-1,J=p.defaultVMetrics,Q=F*r.fontMatrix[0],_=r.textRenderingMode===n.TextRenderingMode.FILL&&!p.disableFontFace&&!r.patternFill;D.save(),D.transform(...r.textMatrix),D.translate(r.x,r.y+r.textRise),ct>0?D.scale(ft,-1):D.scale(ft,1);let N;if(r.patternFill){D.save();const At=r.fillColor.getPattern(D,this,(0,h.getCurrentTransformInverse)(D),G.PathType.FILL);N=(0,h.getCurrentTransform)(D),D.restore(),D.fillStyle=At}let X=r.lineWidth;const st=r.textMatrixScale;if(st===0||X===0){const At=r.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(At===n.TextRenderingMode.STROKE||At===n.TextRenderingMode.FILL_STROKE)&&(X=this.getSinglePixelWidth())}else X/=st;if(O!==1&&(D.scale(O,O),X/=O),D.lineWidth=X,p.isInvalidPDFjsFont){const At=[];let Z=0;for(const Tt of s)At.push(Tt.unicode),Z+=Tt.width;D.fillText(At.join(""),0,0),r.x+=Z*Q*ft,D.restore(),this.compose();return}let pt=0,Et;for(Et=0;Et<bt;++Et){const At=s[Et];if(typeof At=="number"){pt+=_t*At*F/1e3;continue}let Z=!1;const Tt=(At.isSpace?nt:0)+q,xt=At.fontChar,Ut=At.accent;let jt,Vt,kt=At.width;if(mt){const $t=At.vmetric||J,qt=-(At.vmetric?$t[1]:kt*.5)*Q,vt=$t[2]*Q;kt=$t?-$t[0]:kt,jt=qt/O,Vt=(pt+vt)/O}else jt=pt/O,Vt=0;if(p.remeasure&&kt>0){const $t=D.measureText(xt).width*1e3/F*O;if(kt<$t&&this.isFontSubpixelAAEnabled){const qt=kt/$t;Z=!0,D.save(),D.scale(qt,1),jt/=qt}else kt!==$t&&(jt+=(kt-$t)/2e3*F/O)}if(this.contentVisible&&(At.isInFont||p.missingFile)){if(_&&!Ut)D.fillText(xt,jt,Vt);else if(this.paintChar(xt,jt,Vt,N),Ut){const $t=jt+F*Ut.offset.x/O,qt=Vt-F*Ut.offset.y/O;this.paintChar(Ut.fontChar,$t,qt,N)}}const It=mt?kt*Q-Tt*ct:kt*Q+Tt*ct;pt+=It,Z&&D.restore()}mt?r.y-=pt:r.x+=pt*ft,D.restore(),this.compose()}showType3Text(s){const r=this.ctx,p=this.current,F=p.font,D=p.fontSize,O=p.fontDirection,q=F.vertical?1:-1,nt=p.charSpacing,ct=p.wordSpacing,ft=p.textHScale*O,bt=p.fontMatrix||n.FONT_IDENTITY_MATRIX,mt=s.length,_t=p.textRenderingMode===n.TextRenderingMode.INVISIBLE;let J,Q,_,N;if(!(_t||D===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),r.transform(...p.textMatrix),r.translate(p.x,p.y),r.scale(ft,O),J=0;J<mt;++J){if(Q=s[J],typeof Q=="number"){N=q*Q*D/1e3,this.ctx.translate(N,0),p.x+=N*ft;continue}const X=(Q.isSpace?ct:0)+nt,st=F.charProcOperatorList[Q.operatorListId];if(!st){(0,n.warn)(`Type3 character "${Q.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Q,this.save(),r.scale(D,D),r.transform(...bt),this.executeOperatorList(st),this.restore()),_=n.Util.applyTransform([Q.width,0],bt)[0]*D+X,r.translate(_,0),p.x+=_*ft}r.restore(),this.processingType3=null}}setCharWidth(s,r){}setCharWidthAndBounds(s,r,p,F,D,O){this.ctx.rect(p,F,D-p,O-F),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let r;if(s[0]==="TilingPattern"){const p=s[1],F=this.baseTransform||(0,h.getCurrentTransform)(this.ctx),D={createCanvasGraphics:O=>new et(O,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};r=new G.TilingPattern(s,p,this.ctx,D,F)}else r=this._getPattern(s[1],s[2]);return r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,r,p){const F=n.Util.makeHexColor(s,r,p);this.ctx.strokeStyle=F,this.current.strokeColor=F}setFillRGBColor(s,r,p){const F=n.Util.makeHexColor(s,r,p);this.ctx.fillStyle=F,this.current.fillColor=F,this.current.patternFill=!1}_getPattern(s,r=null){let p;return this.cachedPatterns.has(s)?p=this.cachedPatterns.get(s):(p=(0,G.getShadingPattern)(this.getObject(s)),this.cachedPatterns.set(s,p)),r&&(p.matrix=r),p}shadingFill(s){if(!this.contentVisible)return;const r=this.ctx;this.save();const p=this._getPattern(s);r.fillStyle=p.getPattern(r,this,(0,h.getCurrentTransformInverse)(r),G.PathType.SHADING);const F=(0,h.getCurrentTransformInverse)(r);if(F){const{width:D,height:O}=r.canvas,[q,nt,ct,ft]=n.Util.getAxialAlignedBoundingBox([0,0,D,O],F);this.ctx.fillRect(q,nt,ct-q,ft-nt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,h.getCurrentTransform)(this.ctx),r)){const p=r[2]-r[0],F=r[3]-r[1];this.ctx.rect(r[0],r[1],p,F),this.current.updateRectMinMax((0,h.getCurrentTransform)(this.ctx),r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;s.isolated||(0,n.info)("TODO: Support non-isolated groups."),s.knockout&&(0,n.warn)("Knockout groups not supported.");const p=(0,h.getCurrentTransform)(r);if(s.matrix&&r.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let F=n.Util.getAxialAlignedBoundingBox(s.bbox,(0,h.getCurrentTransform)(r));const D=[0,0,r.canvas.width,r.canvas.height];F=n.Util.intersect(F,D)||[0,0,0,0];const O=Math.floor(F[0]),q=Math.floor(F[1]);let nt=Math.max(Math.ceil(F[2])-O,1),ct=Math.max(Math.ceil(F[3])-q,1),ft=1,bt=1;nt>T&&(ft=nt/T,nt=T),ct>T&&(bt=ct/T,ct=T),this.current.startNewPathAndClipBox([0,0,nt,ct]);let mt="groupAt"+this.groupLevel;s.smask&&(mt+="_smask_"+this.smaskCounter++%2);const _t=this.cachedCanvases.getCanvas(mt,nt,ct),J=_t.context;J.scale(1/ft,1/bt),J.translate(-O,-q),J.transform(...p),s.smask?this.smaskStack.push({canvas:_t.canvas,context:J,offsetX:O,offsetY:q,scaleX:ft,scaleY:bt,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(r.setTransform(1,0,0,1,0,0),r.translate(O,q),r.scale(ft,bt),r.save()),i(r,J),this.ctx=J,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,p=this.groupStack.pop();if(this.ctx=p,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const F=(0,h.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...F);const D=n.Util.getAxialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],F);this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(s,r,p,F,D){if(Y(this,it,qe).call(this),d(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(r)&&r.length===4){const O=r[2]-r[0],q=r[3]-r[1];if(D&&this.annotationCanvasMap){p=p.slice(),p[4]-=r[0],p[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=O,r[3]=q;const[nt,ct]=n.Util.singularValueDecompose2dScale((0,h.getCurrentTransform)(this.ctx)),{viewportScale:ft}=this,bt=Math.ceil(O*this.outputScaleX*ft),mt=Math.ceil(q*this.outputScaleY*ft);this.annotationCanvas=this.canvasFactory.create(bt,mt);const{canvas:_t,context:J}=this.annotationCanvas;this.annotationCanvasMap.set(s,_t),this.annotationCanvas.savedCtx=this.ctx,this.ctx=J,this.ctx.save(),this.ctx.setTransform(nt,0,0,-ct,0,q*ct),d(this.ctx)}else d(this.ctx),this.ctx.rect(r[0],r[1],O,q),this.ctx.clip(),this.endPath()}this.current=new y(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...p),this.transform(...F)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),Y(this,it,Xe).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const r=s.count;s=this.getObject(s.data,s),s.count=r;const p=this.ctx,F=this.processingType3;if(F&&(F.compiled===void 0&&(F.compiled=u(s)),F.compiled)){F.compiled(p);return}const D=this._createMaskCanvas(s),O=D.canvas;p.save(),p.setTransform(1,0,0,1,0,0),p.drawImage(O,D.offsetX,D.offsetY),p.restore(),this.compose()}paintImageMaskXObjectRepeat(s,r,p=0,F=0,D,O){if(!this.contentVisible)return;s=this.getObject(s.data,s);const q=this.ctx;q.save();const nt=(0,h.getCurrentTransform)(q);q.transform(r,p,F,D,0,0);const ct=this._createMaskCanvas(s);q.setTransform(1,0,0,1,ct.offsetX-nt[4],ct.offsetY-nt[5]);for(let ft=0,bt=O.length;ft<bt;ft+=2){const mt=n.Util.transform(nt,[r,p,F,D,O[ft],O[ft+1]]),[_t,J]=n.Util.applyTransform([0,0],mt);q.drawImage(ct.canvas,_t,J)}q.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const r=this.ctx,p=this.current.fillColor,F=this.current.patternFill;for(const D of s){const{data:O,width:q,height:nt,transform:ct}=D,ft=this.cachedCanvases.getCanvas("maskCanvas",q,nt),bt=ft.context;bt.save();const mt=this.getObject(O,D);A(bt,mt),bt.globalCompositeOperation="source-in",bt.fillStyle=F?p.getPattern(bt,this,(0,h.getCurrentTransformInverse)(r),G.PathType.FILL):p,bt.fillRect(0,0,q,nt),bt.restore(),r.save(),r.transform(...ct),r.scale(1,-1),g(r,ft.canvas,0,0,q,nt,0,-1,1,1),r.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const r=this.getObject(s);if(!r){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(r)}paintImageXObjectRepeat(s,r,p,F){if(!this.contentVisible)return;const D=this.getObject(s);if(!D){(0,n.warn)("Dependent image isn't ready yet");return}const O=D.width,q=D.height,nt=[];for(let ct=0,ft=F.length;ct<ft;ct+=2)nt.push({transform:[r,0,0,p,F[ct],F[ct+1]],x:0,y:0,w:O,h:q});this.paintInlineImageXObjectGroup(D,nt)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:r,width:p,height:F}=s,D=this.cachedCanvases.getCanvas("inlineImage",p,F),O=D.context;return O.filter=this.current.transferMaps,O.drawImage(r,0,0),O.filter="none",D.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const r=s.width,p=s.height,F=this.ctx;if(this.save(),!n.isNodeJS){const{filter:q}=F;q!=="none"&&q!==""&&(F.filter="none")}F.scale(1/r,-1/p);let D;if(s.bitmap)D=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)D=s;else{const nt=this.cachedCanvases.getCanvas("inlineImage",r,p).context;M(nt,s),D=this.applyTransferMapsToCanvas(nt)}const O=this._scaleImage(D,(0,h.getCurrentTransformInverse)(F));F.imageSmoothingEnabled=v((0,h.getCurrentTransform)(F),s.interpolate),g(F,O.img,0,0,O.paintWidth,O.paintHeight,0,-p,r,p),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,r){if(!this.contentVisible)return;const p=this.ctx;let F;if(s.bitmap)F=s.bitmap;else{const D=s.width,O=s.height,nt=this.cachedCanvases.getCanvas("inlineImage",D,O).context;M(nt,s),F=this.applyTransferMapsToCanvas(nt)}for(const D of r)p.save(),p.transform(...D.transform),p.scale(1,-1),g(p,F,D.x,D.y,D.w,D.h,0,-1,1,1),p.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,r){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,r){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const p=this.ctx;this.pendingClip&&(r||(this.pendingClip===K?p.clip("evenodd"):p.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),p.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,h.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const r=Math.abs(s[0]*s[3]-s[2]*s[1]),p=Math.hypot(s[0],s[2]),F=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(p,F)/r}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:r,b:p,c:F,d:D}=this.ctx.getTransform();let O,q;if(p===0&&F===0){const nt=Math.abs(r),ct=Math.abs(D);if(nt===ct)if(s===0)O=q=1/nt;else{const ft=nt*s;O=q=ft<1?1/ft:1}else if(s===0)O=1/nt,q=1/ct;else{const ft=nt*s,bt=ct*s;O=ft<1?1/ft:1,q=bt<1?1/bt:1}}else{const nt=Math.abs(r*D-p*F),ct=Math.hypot(r,p),ft=Math.hypot(F,D);if(s===0)O=ft/nt,q=ct/nt;else{const bt=s*nt;O=ft>bt?ft/bt:1,q=ct>bt?ct/bt:1}}this._cachedScaleForStroking[0]=O,this._cachedScaleForStroking[1]=q}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:r}=this,{lineWidth:p}=this.current,[F,D]=this.getScaleForStroking();if(r.lineWidth=p||1,F===1&&D===1){r.stroke();return}const O=r.getLineDash();if(s&&r.save(),r.scale(F,D),O.length>0){const q=Math.max(F,D);r.setLineDash(O.map(nt=>nt/q)),r.lineDashOffset/=q}r.stroke(),s&&r.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};it=new WeakSet,qe=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Xe=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const r=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=r}}};let $=et;e.CanvasGraphics=$;for(const S in n.OPS)$.prototype[S]!==void 0&&($.prototype[n.OPS[S]]=$.prototype[S])},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=b;var n=B(1),h=B(6);const G={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=G;function H(u,y){if(!y)return;const M=y[2]-y[0],A=y[3]-y[1],i=new Path2D;i.rect(y[0],y[1],M,A),u.clip(i)}class ht{constructor(){this.constructor===ht&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class P extends ht{constructor(y){super(),this._type=y[1],this._bbox=y[2],this._colorStops=y[3],this._p0=y[4],this._p1=y[5],this._r0=y[6],this._r1=y[7],this.matrix=null}_createGradient(y){let M;this._type==="axial"?M=y.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(M=y.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const A of this._colorStops)M.addColorStop(A[0],A[1]);return M}getPattern(y,M,A,i){let d;if(i===G.STROKE||i===G.FILL){const o=M.current.getClippedPathBoundingBox(i,(0,h.getCurrentTransform)(y))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,I=M.cachedCanvases.getCanvas("pattern",l,c,!0),a=I.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.translate(-o[0],-o[1]),A=n.Util.transform(A,[1,0,0,1,o[0],o[1]]),a.transform(...M.baseTransform),this.matrix&&a.transform(...this.matrix),H(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),d=y.createPattern(I.canvas,"no-repeat");const v=new DOMMatrix(A);d.setTransform(v)}else H(y,this._bbox),d=this._createGradient(y);return d}}function T(u,y,M,A,i,d,o,l){const c=y.coords,I=y.colors,a=u.data,v=u.width*4;let R;c[M+1]>c[A+1]&&(R=M,M=A,A=R,R=d,d=o,o=R),c[A+1]>c[i+1]&&(R=A,A=i,i=R,R=o,o=l,l=R),c[M+1]>c[A+1]&&(R=M,M=A,A=R,R=d,d=o,o=R);const tt=(c[M]+y.offsetX)*y.scaleX,V=(c[M+1]+y.offsetY)*y.scaleY,K=(c[A]+y.offsetX)*y.scaleX,$=(c[A+1]+y.offsetY)*y.scaleY,it=(c[i]+y.offsetX)*y.scaleX,w=(c[i+1]+y.offsetY)*y.scaleY;if(V>=w)return;const W=I[d],et=I[d+1],S=I[d+2],s=I[o],r=I[o+1],p=I[o+2],F=I[l],D=I[l+1],O=I[l+2],q=Math.round(V),nt=Math.round(w);let ct,ft,bt,mt,_t,J,Q,_;for(let N=q;N<=nt;N++){if(N<$){const At=N<V?0:(V-N)/(V-$);ct=tt-(tt-K)*At,ft=W-(W-s)*At,bt=et-(et-r)*At,mt=S-(S-p)*At}else{let At;N>w?At=1:$===w?At=0:At=($-N)/($-w),ct=K-(K-it)*At,ft=s-(s-F)*At,bt=r-(r-D)*At,mt=p-(p-O)*At}let X;N<V?X=0:N>w?X=1:X=(V-N)/(V-w),_t=tt-(tt-it)*X,J=W-(W-F)*X,Q=et-(et-D)*X,_=S-(S-O)*X;const st=Math.round(Math.min(ct,_t)),pt=Math.round(Math.max(ct,_t));let Et=v*N+st*4;for(let At=st;At<=pt;At++)X=(ct-At)/(ct-_t),X<0?X=0:X>1&&(X=1),a[Et++]=ft-(ft-J)*X|0,a[Et++]=bt-(bt-Q)*X|0,a[Et++]=mt-(mt-_)*X|0,a[Et++]=255}}function f(u,y,M){const A=y.coords,i=y.colors;let d,o;switch(y.type){case"lattice":const l=y.verticesPerRow,c=Math.floor(A.length/l)-1,I=l-1;for(d=0;d<c;d++){let a=d*l;for(let v=0;v<I;v++,a++)T(u,M,A[a],A[a+1],A[a+l],i[a],i[a+1],i[a+l]),T(u,M,A[a+l+1],A[a+1],A[a+l],i[a+l+1],i[a+1],i[a+l])}break;case"triangles":for(d=0,o=A.length;d<o;d+=3)T(u,M,A[d],A[d+1],A[d+2],i[d],i[d+1],i[d+2]);break;default:throw new Error("illegal figure")}}class j extends ht{constructor(y){super(),this._coords=y[2],this._colors=y[3],this._figures=y[4],this._bounds=y[5],this._bbox=y[7],this._background=y[8],this.matrix=null}_createMeshCanvas(y,M,A){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),I=Math.ceil(this._bounds[2])-l,a=Math.ceil(this._bounds[3])-c,v=Math.min(Math.ceil(Math.abs(I*y[0]*1.1)),3e3),R=Math.min(Math.ceil(Math.abs(a*y[1]*1.1)),3e3),tt=I/v,V=a/R,K={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/tt,scaleY:1/V},$=v+2*2,it=R+2*2,w=A.getCanvas("mesh",$,it,!1),W=w.context,et=W.createImageData(v,R);if(M){const s=et.data;for(let r=0,p=s.length;r<p;r+=4)s[r]=M[0],s[r+1]=M[1],s[r+2]=M[2],s[r+3]=255}for(const s of this._figures)f(et,s,K);return W.putImageData(et,2,2),{canvas:w.canvas,offsetX:l-2*tt,offsetY:c-2*V,scaleX:tt,scaleY:V}}getPattern(y,M,A,i){H(y,this._bbox);let d;if(i===G.SHADING)d=n.Util.singularValueDecompose2dScale((0,h.getCurrentTransform)(y));else if(d=n.Util.singularValueDecompose2dScale(M.baseTransform),this.matrix){const l=n.Util.singularValueDecompose2dScale(this.matrix);d=[d[0]*l[0],d[1]*l[1]]}const o=this._createMeshCanvas(d,i===G.SHADING?null:this._background,M.cachedCanvases);return i!==G.SHADING&&(y.setTransform(...M.baseTransform),this.matrix&&y.transform(...this.matrix)),y.translate(o.offsetX,o.offsetY),y.scale(o.scaleX,o.scaleY),y.createPattern(o.canvas,"no-repeat")}}class L extends ht{getPattern(){return"hotpink"}}function b(u){switch(u[0]){case"RadialAxial":return new P(u);case"Mesh":return new j(u);case"Dummy":return new L}throw new Error(`Unknown IR type: ${u[0]}`)}const m={COLORED:1,UNCOLORED:2},g=class g{constructor(y,M,A,i,d){this.operatorList=y[2],this.matrix=y[3]||[1,0,0,1,0,0],this.bbox=y[4],this.xstep=y[5],this.ystep=y[6],this.paintType=y[7],this.tilingType=y[8],this.color=M,this.ctx=A,this.canvasGraphicsFactory=i,this.baseTransform=d}createPatternCanvas(y){const M=this.operatorList,A=this.bbox,i=this.xstep,d=this.ystep,o=this.paintType,l=this.tilingType,c=this.color,I=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+l);const a=A[0],v=A[1],R=A[2],tt=A[3],V=n.Util.singularValueDecompose2dScale(this.matrix),K=n.Util.singularValueDecompose2dScale(this.baseTransform),$=[V[0]*K[0],V[1]*K[1]],it=this.getSizeAndScale(i,this.ctx.canvas.width,$[0]),w=this.getSizeAndScale(d,this.ctx.canvas.height,$[1]),W=y.cachedCanvases.getCanvas("pattern",it.size,w.size,!0),et=W.context,S=I.createCanvasGraphics(et);S.groupLevel=y.groupLevel,this.setFillAndStrokeStyleToContext(S,o,c);let s=a,r=v,p=R,F=tt;return a<0&&(s=0,p+=Math.abs(a)),v<0&&(r=0,F+=Math.abs(v)),et.translate(-(it.scale*s),-(w.scale*r)),S.transform(it.scale,0,0,w.scale,0,0),et.save(),this.clipBbox(S,s,r,p,F),S.baseTransform=(0,h.getCurrentTransform)(S.ctx),S.executeOperatorList(M),S.endDrawing(),{canvas:W.canvas,scaleX:it.scale,scaleY:w.scale,offsetX:s,offsetY:r}}getSizeAndScale(y,M,A){y=Math.abs(y);const i=Math.max(g.MAX_PATTERN_SIZE,M);let d=Math.ceil(y*A);return d>=i?d=i:A=d/y,{scale:A,size:d}}clipBbox(y,M,A,i,d){const o=i-M,l=d-A;y.ctx.rect(M,A,o,l),y.current.updateRectMinMax((0,h.getCurrentTransform)(y.ctx),[M,A,i,d]),y.clip(),y.endPath()}setFillAndStrokeStyleToContext(y,M,A){const i=y.ctx,d=y.current;switch(M){case m.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,d.fillColor=o.fillStyle,d.strokeColor=o.strokeStyle;break;case m.UNCOLORED:const l=n.Util.makeHexColor(A[0],A[1],A[2]);i.fillStyle=l,i.strokeStyle=l,d.fillColor=l,d.strokeColor=l;break;default:throw new n.FormatError(`Unsupported paint type: ${M}`)}}getPattern(y,M,A,i){let d=A;i!==G.SHADING&&(d=n.Util.transform(d,M.baseTransform),this.matrix&&(d=n.Util.transform(d,this.matrix)));const o=this.createPatternCanvas(M);let l=new DOMMatrix(d);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const c=y.createPattern(o.canvas,"repeat");return c.setTransform(l),c}};Kt(g,"MAX_PATTERN_SIZE",3e3);let E=g;e.TilingPattern=E},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=G,e.convertToRGBA=h,e.grayToRGBA=ht;var n=B(1);function h(P){switch(P.kind){case n.ImageKind.GRAYSCALE_1BPP:return G(P);case n.ImageKind.RGB_24BPP:return H(P)}return null}function G({src:P,srcPos:T=0,dest:f,width:j,height:L,nonBlackColor:b=4294967295,inverseDecode:m=!1}){const E=n.FeatureTest.isLittleEndian?4278190080:255,[g,u]=m?[b,E]:[E,b],y=j>>3,M=j&7,A=P.length;f=new Uint32Array(f.buffer);let i=0;for(let d=0;d<L;d++){for(const l=T+y;T<l;T++){const c=T<A?P[T]:255;f[i++]=c&128?u:g,f[i++]=c&64?u:g,f[i++]=c&32?u:g,f[i++]=c&16?u:g,f[i++]=c&8?u:g,f[i++]=c&4?u:g,f[i++]=c&2?u:g,f[i++]=c&1?u:g}if(M===0)continue;const o=T<A?P[T++]:255;for(let l=0;l<M;l++)f[i++]=o&1<<7-l?u:g}return{srcPos:T,destPos:i}}function H({src:P,srcPos:T=0,dest:f,destPos:j=0,width:L,height:b}){let m=0;const E=P.length>>2,g=new Uint32Array(P.buffer,T,E);if(n.FeatureTest.isLittleEndian){for(;m<E-2;m+=3,j+=4){const u=g[m],y=g[m+1],M=g[m+2];f[j]=u|4278190080,f[j+1]=u>>>24|y<<8|4278190080,f[j+2]=y>>>16|M<<16|4278190080,f[j+3]=M>>>8|4278190080}for(let u=m*4,y=P.length;u<y;u+=3)f[j++]=P[u]|P[u+1]<<8|P[u+2]<<16|4278190080}else{for(;m<E-2;m+=3,j+=4){const u=g[m],y=g[m+1],M=g[m+2];f[j]=u|255,f[j+1]=u<<24|y>>>8|255,f[j+2]=y<<16|M>>>16|255,f[j+3]=M<<8|255}for(let u=m*4,y=P.length;u<y;u+=3)f[j++]=P[u]<<24|P[u+1]<<16|P[u+2]<<8|255}return{srcPos:T,destPos:j}}function ht(P,T){if(n.FeatureTest.isLittleEndian)for(let f=0,j=P.length;f<j;f++)T[f]=P[f]*65793|4278190080;else for(let f=0,j=P.length;f<j;f++)T[f]=P[f]*16843008|255}},(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const B=Object.create(null);e.GlobalWorkerOptions=B,B.workerPort=null,B.workerSrc=""},(C,e,B)=>{var P,Tn,wn,Se;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=B(1);const h={DATA:1,ERROR:2},G={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function H(L){switch(L instanceof Error||typeof L=="object"&&L!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),L.name){case"AbortException":return new n.AbortException(L.message);case"MissingPDFException":return new n.MissingPDFException(L.message);case"PasswordException":return new n.PasswordException(L.message,L.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(L.message,L.status);case"UnknownErrorException":return new n.UnknownErrorException(L.message,L.details);default:return new n.UnknownErrorException(L.message,L.toString())}}class ht{constructor(b,m,E){rt(this,P);this.sourceName=b,this.targetName=m,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=g=>{const u=g.data;if(u.targetName!==this.sourceName)return;if(u.stream){Y(this,P,wn).call(this,u);return}if(u.callback){const M=u.callbackId,A=this.callbackCapabilities[M];if(!A)throw new Error(`Cannot resolve callback ${M}`);if(delete this.callbackCapabilities[M],u.callback===h.DATA)A.resolve(u.data);else if(u.callback===h.ERROR)A.reject(H(u.reason));else throw new Error("Unexpected callback case");return}const y=this.actionHandler[u.action];if(!y)throw new Error(`Unknown action from worker: ${u.action}`);if(u.callbackId){const M=this.sourceName,A=u.sourceName;new Promise(function(i){i(y(u.data))}).then(function(i){E.postMessage({sourceName:M,targetName:A,callback:h.DATA,callbackId:u.callbackId,data:i})},function(i){E.postMessage({sourceName:M,targetName:A,callback:h.ERROR,callbackId:u.callbackId,reason:H(i)})});return}if(u.streamId){Y(this,P,Tn).call(this,u);return}y(u.data)},E.addEventListener("message",this._onComObjOnMessage)}on(b,m){const E=this.actionHandler;if(E[b])throw new Error(`There is already an actionName called "${b}"`);E[b]=m}send(b,m,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:b,data:m},E)}sendWithPromise(b,m,E){const g=this.callbackId++,u=new n.PromiseCapability;this.callbackCapabilities[g]=u;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:b,callbackId:g,data:m},E)}catch(y){u.reject(y)}return u.promise}sendWithStream(b,m,E,g){const u=this.streamId++,y=this.sourceName,M=this.targetName,A=this.comObj;return new ReadableStream({start:i=>{const d=new n.PromiseCapability;return this.streamControllers[u]={controller:i,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},A.postMessage({sourceName:y,targetName:M,action:b,streamId:u,data:m,desiredSize:i.desiredSize},g),d.promise},pull:i=>{const d=new n.PromiseCapability;return this.streamControllers[u].pullCall=d,A.postMessage({sourceName:y,targetName:M,stream:G.PULL,streamId:u,desiredSize:i.desiredSize}),d.promise},cancel:i=>{(0,n.assert)(i instanceof Error,"cancel must have a valid reason");const d=new n.PromiseCapability;return this.streamControllers[u].cancelCall=d,this.streamControllers[u].isClosed=!0,A.postMessage({sourceName:y,targetName:M,stream:G.CANCEL,streamId:u,reason:H(i)}),d.promise}},E)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}P=new WeakSet,Tn=function(b){const m=b.streamId,E=this.sourceName,g=b.sourceName,u=this.comObj,y=this,M=this.actionHandler[b.action],A={enqueue(i,d=1,o){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=d,l>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),u.postMessage({sourceName:E,targetName:g,stream:G.ENQUEUE,streamId:m,chunk:i},o)},close(){this.isCancelled||(this.isCancelled=!0,u.postMessage({sourceName:E,targetName:g,stream:G.CLOSE,streamId:m}),delete y.streamSinks[m])},error(i){(0,n.assert)(i instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,u.postMessage({sourceName:E,targetName:g,stream:G.ERROR,streamId:m,reason:H(i)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:b.desiredSize,ready:null};A.sinkCapability.resolve(),A.ready=A.sinkCapability.promise,this.streamSinks[m]=A,new Promise(function(i){i(M(b.data,A))}).then(function(){u.postMessage({sourceName:E,targetName:g,stream:G.START_COMPLETE,streamId:m,success:!0})},function(i){u.postMessage({sourceName:E,targetName:g,stream:G.START_COMPLETE,streamId:m,reason:H(i)})})},wn=function(b){const m=b.streamId,E=this.sourceName,g=b.sourceName,u=this.comObj,y=this.streamControllers[m],M=this.streamSinks[m];switch(b.stream){case G.START_COMPLETE:b.success?y.startCall.resolve():y.startCall.reject(H(b.reason));break;case G.PULL_COMPLETE:b.success?y.pullCall.resolve():y.pullCall.reject(H(b.reason));break;case G.PULL:if(!M){u.postMessage({sourceName:E,targetName:g,stream:G.PULL_COMPLETE,streamId:m,success:!0});break}M.desiredSize<=0&&b.desiredSize>0&&M.sinkCapability.resolve(),M.desiredSize=b.desiredSize,new Promise(function(A){var i;A((i=M.onPull)==null?void 0:i.call(M))}).then(function(){u.postMessage({sourceName:E,targetName:g,stream:G.PULL_COMPLETE,streamId:m,success:!0})},function(A){u.postMessage({sourceName:E,targetName:g,stream:G.PULL_COMPLETE,streamId:m,reason:H(A)})});break;case G.ENQUEUE:if((0,n.assert)(y,"enqueue should have stream controller"),y.isClosed)break;y.controller.enqueue(b.chunk);break;case G.CLOSE:if((0,n.assert)(y,"close should have stream controller"),y.isClosed)break;y.isClosed=!0,y.controller.close(),Y(this,P,Se).call(this,y,m);break;case G.ERROR:(0,n.assert)(y,"error should have stream controller"),y.controller.error(H(b.reason)),Y(this,P,Se).call(this,y,m);break;case G.CANCEL_COMPLETE:b.success?y.cancelCall.resolve():y.cancelCall.reject(H(b.reason)),Y(this,P,Se).call(this,y,m);break;case G.CANCEL:if(!M)break;new Promise(function(A){var i;A((i=M.onCancel)==null?void 0:i.call(M,H(b.reason)))}).then(function(){u.postMessage({sourceName:E,targetName:g,stream:G.CANCEL_COMPLETE,streamId:m,success:!0})},function(A){u.postMessage({sourceName:E,targetName:g,stream:G.CANCEL_COMPLETE,streamId:m,reason:H(A)})}),M.sinkCapability.reject(H(b.reason)),M.isCancelled=!0,delete this.streamSinks[m];break;default:throw new Error("Unexpected stream case")}},Se=async function(b,m){var E,g,u;await Promise.allSettled([(E=b.startCall)==null?void 0:E.promise,(g=b.pullCall)==null?void 0:g.promise,(u=b.cancelCall)==null?void 0:u.promise]),delete this.streamControllers[m]},e.MessageHandler=ht},(C,e,B)=>{var G,H;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=B(1);class h{constructor({parsedData:P,rawData:T}){rt(this,G);rt(this,H);ot(this,G,P),ot(this,H,T)}getRaw(){return t(this,H)}get(P){return t(this,G).get(P)??null}getAll(){return(0,n.objectFromMap)(t(this,G))}has(P){return t(this,G).has(P)}}G=new WeakMap,H=new WeakMap,e.Metadata=h},(C,e,B)=>{var P,T,f,j,L,b,Ye;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=B(1),h=B(8);const G=Symbol("INTERNAL");class H{constructor(g,u){rt(this,P,!0);this.name=g,this.intent=u}get visible(){return t(this,P)}_setVisible(g,u){g!==G&&(0,n.unreachable)("Internal method `_setVisible` called."),ot(this,P,u)}}P=new WeakMap;class ht{constructor(g){rt(this,b);rt(this,T,null);rt(this,f,new Map);rt(this,j,null);rt(this,L,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,ot(this,L,g.order);for(const u of g.groups)t(this,f).set(u.id,new H(u.name,u.intent));if(g.baseState==="OFF")for(const u of t(this,f).values())u._setVisible(G,!1);for(const u of g.on)t(this,f).get(u)._setVisible(G,!0);for(const u of g.off)t(this,f).get(u)._setVisible(G,!1);ot(this,j,this.getHash())}}isVisible(g){if(t(this,f).size===0)return!0;if(!g)return(0,n.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return t(this,f).has(g.id)?t(this,f).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return Y(this,b,Ye).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const u of g.ids){if(!t(this,f).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(t(this,f).get(u).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const u of g.ids){if(!t(this,f).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,f).get(u).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const u of g.ids){if(!t(this,f).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!t(this,f).get(u).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const u of g.ids){if(!t(this,f).has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(t(this,f).get(u).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,u=!0){if(!t(this,f).has(g)){(0,n.warn)(`Optional content group not found: ${g}`);return}t(this,f).get(g)._setVisible(G,!!u),ot(this,T,null)}get hasInitialVisibility(){return t(this,j)===null||this.getHash()===t(this,j)}getOrder(){return t(this,f).size?t(this,L)?t(this,L).slice():[...t(this,f).keys()]:null}getGroups(){return t(this,f).size>0?(0,n.objectFromMap)(t(this,f)):null}getGroup(g){return t(this,f).get(g)||null}getHash(){if(t(this,T)!==null)return t(this,T);const g=new h.MurmurHash3_64;for(const[u,y]of t(this,f))g.update(`${u}:${y.visible}`);return ot(this,T,g.hexdigest())}}T=new WeakMap,f=new WeakMap,j=new WeakMap,L=new WeakMap,b=new WeakSet,Ye=function(g){const u=g.length;if(u<2)return!0;const y=g[0];for(let M=1;M<u;M++){const A=g[M];let i;if(Array.isArray(A))i=Y(this,b,Ye).call(this,A);else if(t(this,f).has(A))i=t(this,f).get(A).visible;else return(0,n.warn)(`Optional content group not found: ${A}`),!0;switch(y){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return y==="And"},e.OptionalContentConfig=ht},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=B(1),h=B(6);class G{constructor({length:T,initialData:f,progressiveDone:j=!1,contentDispositionFilename:L=null,disableRange:b=!1,disableStream:m=!1},E){if((0,n.assert)(E,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=j,this._contentDispositionFilename=L,(f==null?void 0:f.length)>0){const g=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=E,this._isStreamingSupported=!m,this._isRangeSupported=!b,this._contentLength=T,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,u)=>{this._onReceiveData({begin:g,chunk:u})}),this._pdfDataRangeTransport.addProgressListener((g,u)=>{this._onProgress({loaded:g,total:u})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:T,chunk:f}){const j=f instanceof Uint8Array&&f.byteLength===f.buffer.byteLength?f.buffer:new Uint8Array(f).buffer;if(T===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const L=this._rangeReaders.some(function(b){return b._begin!==T?!1:(b._enqueue(j),!0)});(0,n.assert)(L,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var T;return((T=this._fullRequestReader)==null?void 0:T._loaded)??0}_onProgress(T){var f,j,L,b;T.total===void 0?(j=(f=this._rangeReaders[0])==null?void 0:f.onProgress)==null||j.call(f,{loaded:T.loaded}):(b=(L=this._fullRequestReader)==null?void 0:L.onProgress)==null||b.call(L,{loaded:T.loaded,total:T.total})}_onProgressiveDone(){var T;(T=this._fullRequestReader)==null||T.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(T){const f=this._rangeReaders.indexOf(T);f>=0&&this._rangeReaders.splice(f,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const T=this._queuedChunks;return this._queuedChunks=null,new H(this,T,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(T,f){if(f<=this._progressiveDataLength)return null;const j=new ht(this,T,f);return this._pdfDataRangeTransport.requestDataRange(T,f),this._rangeReaders.push(j),j}cancelAllRequests(T){var f;(f=this._fullRequestReader)==null||f.cancel(T);for(const j of this._rangeReaders.slice(0))j.cancel(T);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=G;class H{constructor(T,f,j=!1,L=null){this._stream=T,this._done=j||!1,this._filename=(0,h.isPdfFile)(L)?L:null,this._queuedChunks=f||[],this._loaded=0;for(const b of this._queuedChunks)this._loaded+=b.byteLength;this._requests=[],this._headersReady=Promise.resolve(),T._fullRequestReader=this,this.onProgress=null}_enqueue(T){this._done||(this._requests.length>0?this._requests.shift().resolve({value:T,done:!1}):this._queuedChunks.push(T),this._loaded+=T.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=new n.PromiseCapability;return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ht{constructor(T,f,j){this._stream=T,this._begin=f,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(T){if(!this._done){if(this._requests.length===0)this._queuedChunk=T;else{this._requests.shift().resolve({value:T,done:!1});for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const f=this._queuedChunk;return this._queuedChunk=null,{value:f,done:!1}}if(this._done)return{value:void 0,done:!0};const T=new n.PromiseCapability;return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=B(1),h=B(20);function G(j,L,b){return{method:"GET",headers:j,signal:b.signal,mode:"cors",credentials:L?"include":"same-origin",redirect:"follow"}}function H(j){const L=new Headers;for(const b in j){const m=j[b];m!==void 0&&L.append(b,m)}return L}function ht(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,n.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class P{constructor(L){this.source=L,this.isHttp=/^https?:/i.test(L.url),this.httpHeaders=this.isHttp&&L.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var L;return((L=this._fullRequestReader)==null?void 0:L._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new T(this),this._fullRequestReader}getRangeReader(L,b){if(b<=this._progressiveDataLength)return null;const m=new f(this,L,b);return this._rangeRequestReaders.push(m),m}cancelAllRequests(L){var b;(b=this._fullRequestReader)==null||b.cancel(L);for(const m of this._rangeRequestReaders.slice(0))m.cancel(L)}}e.PDFFetchStream=P;class T{constructor(L){this._stream=L,this._reader=null,this._loaded=0,this._filename=null;const b=L.source;this._withCredentials=b.withCredentials||!1,this._contentLength=b.length,this._headersCapability=new n.PromiseCapability,this._disableRange=b.disableRange||!1,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!b.disableStream,this._isRangeSupported=!b.disableRange,this._headers=H(this._stream.httpHeaders);const m=b.url;fetch(m,G(this._headers,this._withCredentials,this._abortController)).then(E=>{if(!(0,h.validateResponseStatus)(E.status))throw(0,h.createResponseStatusError)(E.status,m);this._reader=E.body.getReader(),this._headersCapability.resolve();const g=M=>E.headers.get(M),{allowRangeRequests:u,suggestedLength:y}=(0,h.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=y||this._contentLength,this._filename=(0,h.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._headersCapability.promise;const{value:L,done:b}=await this._reader.read();return b?{value:L,done:b}:(this._loaded+=L.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded,total:this._contentLength}),{value:ht(L),done:!1})}cancel(L){var b;(b=this._reader)==null||b.cancel(L),this._abortController.abort()}}class f{constructor(L,b,m){this._stream=L,this._reader=null,this._loaded=0;const E=L.source;this._withCredentials=E.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!E.disableStream,this._abortController=new AbortController,this._headers=H(this._stream.httpHeaders),this._headers.append("Range",`bytes=${b}-${m-1}`);const g=E.url;fetch(g,G(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,h.validateResponseStatus)(u.status))throw(0,h.createResponseStatusError)(u.status,g);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var m;await this._readCapability.promise;const{value:L,done:b}=await this._reader.read();return b?{value:L,done:b}:(this._loaded+=L.byteLength,(m=this.onProgress)==null||m.call(this,{loaded:this._loaded}),{value:ht(L),done:!1})}cancel(L){var b;(b=this._reader)==null||b.cancel(L),this._abortController.abort()}}},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=P,e.extractFilenameFromHeader=ht,e.validateRangeRequestCapabilities=H,e.validateResponseStatus=T;var n=B(1),h=B(21),G=B(6);function H({getResponseHeader:f,isHttp:j,rangeChunkSize:L,disableRange:b}){const m={allowRangeRequests:!1,suggestedLength:void 0},E=parseInt(f("Content-Length"),10);return!Number.isInteger(E)||(m.suggestedLength=E,E<=2*L)||b||!j||f("Accept-Ranges")!=="bytes"||(f("Content-Encoding")||"identity")!=="identity"||(m.allowRangeRequests=!0),m}function ht(f){const j=f("Content-Disposition");if(j){let L=(0,h.getFilenameFromContentDispositionHeader)(j);if(L.includes("%"))try{L=decodeURIComponent(L)}catch{}if((0,G.isPdfFile)(L))return L}return null}function P(f,j){return f===404||f===0&&j.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+j+'".'):new n.UnexpectedResponseException(`Unexpected server response (${f}) while retrieving PDF "${j}".`,f)}function T(f){return f===200||f===206}},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=h;var n=B(1);function h(G){let H=!0,ht=P("filename\\*","i").exec(G);if(ht){ht=ht[1];let E=L(ht);return E=unescape(E),E=b(E),E=m(E),f(E)}if(ht=j(G),ht){const E=m(ht);return f(E)}if(ht=P("filename","i").exec(G),ht){ht=ht[1];let E=L(ht);return E=m(E),f(E)}function P(E,g){return new RegExp("(?:^|;)\\s*"+E+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function T(E,g){if(E){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const u=new TextDecoder(E,{fatal:!0}),y=(0,n.stringToBytes)(g);g=u.decode(y),H=!1}catch{}}return g}function f(E){return H&&/[\x80-\xff]/.test(E)&&(E=T("utf-8",E),H&&(E=T("iso-8859-1",E))),E}function j(E){const g=[];let u;const y=P("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(u=y.exec(E))!==null;){let[,A,i,d]=u;if(A=parseInt(A,10),A in g){if(A===0)break;continue}g[A]=[i,d]}const M=[];for(let A=0;A<g.length&&A in g;++A){let[i,d]=g[A];d=L(d),i&&(d=unescape(d),A===0&&(d=b(d))),M.push(d)}return M.join("")}function L(E){if(E.startsWith('"')){const g=E.slice(1).split('\\"');for(let u=0;u<g.length;++u){const y=g[u].indexOf('"');y!==-1&&(g[u]=g[u].slice(0,y),g.length=u+1),g[u]=g[u].replaceAll(/\\(.)/g,"$1")}E=g.join('"')}return E}function b(E){const g=E.indexOf("'");if(g===-1)return E;const u=E.slice(0,g),M=E.slice(g+1).replace(/^[^']*'/,"");return T(u,M)}function m(E){return!E.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(E)?E:E.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,u,y,M){if(y==="q"||y==="Q")return M=M.replaceAll("_"," "),M=M.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,i){return String.fromCharCode(parseInt(i,16))}),T(u,M);try{M=atob(M)}catch{}return T(u,M)})}return""}},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=B(1),h=B(20);const G=200,H=206;function ht(L){const b=L.response;return typeof b!="string"?b:(0,n.stringToBytes)(b).buffer}class P{constructor(b,m={}){this.url=b,this.isHttp=/^https?:/i.test(b),this.httpHeaders=this.isHttp&&m.httpHeaders||Object.create(null),this.withCredentials=m.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(b,m,E){const g={begin:b,end:m};for(const u in E)g[u]=E[u];return this.request(g)}requestFull(b){return this.request(b)}request(b){const m=new XMLHttpRequest,E=this.currXhrId++,g=this.pendingRequests[E]={xhr:m};m.open("GET",this.url),m.withCredentials=this.withCredentials;for(const u in this.httpHeaders){const y=this.httpHeaders[u];y!==void 0&&m.setRequestHeader(u,y)}return this.isHttp&&"begin"in b&&"end"in b?(m.setRequestHeader("Range",`bytes=${b.begin}-${b.end-1}`),g.expectedStatus=H):g.expectedStatus=G,m.responseType="arraybuffer",b.onError&&(m.onerror=function(u){b.onError(m.status)}),m.onreadystatechange=this.onStateChange.bind(this,E),m.onprogress=this.onProgress.bind(this,E),g.onHeadersReceived=b.onHeadersReceived,g.onDone=b.onDone,g.onError=b.onError,g.onProgress=b.onProgress,m.send(null),E}onProgress(b,m){var g;const E=this.pendingRequests[b];E&&((g=E.onProgress)==null||g.call(E,m))}onStateChange(b,m){var A,i,d;const E=this.pendingRequests[b];if(!E)return;const g=E.xhr;if(g.readyState>=2&&E.onHeadersReceived&&(E.onHeadersReceived(),delete E.onHeadersReceived),g.readyState!==4||!(b in this.pendingRequests))return;if(delete this.pendingRequests[b],g.status===0&&this.isHttp){(A=E.onError)==null||A.call(E,g.status);return}const u=g.status||G;if(!(u===G&&E.expectedStatus===H)&&u!==E.expectedStatus){(i=E.onError)==null||i.call(E,g.status);return}const M=ht(g);if(u===H){const o=g.getResponseHeader("Content-Range"),l=/bytes (\d+)-(\d+)\/(\d+)/.exec(o);E.onDone({begin:parseInt(l[1],10),chunk:M})}else M?E.onDone({begin:0,chunk:M}):(d=E.onError)==null||d.call(E,g.status)}getRequestXhr(b){return this.pendingRequests[b].xhr}isPendingRequest(b){return b in this.pendingRequests}abortRequest(b){const m=this.pendingRequests[b].xhr;delete this.pendingRequests[b],m.abort()}}class T{constructor(b){this._source=b,this._manager=new P(b.url,{httpHeaders:b.httpHeaders,withCredentials:b.withCredentials}),this._rangeChunkSize=b.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(b){const m=this._rangeRequestReaders.indexOf(b);m>=0&&this._rangeRequestReaders.splice(m,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f(this._manager,this._source),this._fullRequestReader}getRangeReader(b,m){const E=new j(this._manager,b,m);return E.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(E),E}cancelAllRequests(b){var m;(m=this._fullRequestReader)==null||m.cancel(b);for(const E of this._rangeRequestReaders.slice(0))E.cancel(b)}}e.PDFNetworkStream=T;class f{constructor(b,m){this._manager=b;const E={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=m.url,this._fullRequestId=b.requestFull(E),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=m.disableRange||!1,this._contentLength=m.length,this._rangeChunkSize=m.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const b=this._fullRequestId,m=this._manager.getRequestXhr(b),E=y=>m.getResponseHeader(y),{allowRangeRequests:g,suggestedLength:u}=(0,h.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=u||this._contentLength,this._filename=(0,h.extractFilenameFromHeader)(E),this._isRangeSupported&&this._manager.abortRequest(b),this._headersReceivedCapability.resolve()}_onDone(b){if(b&&(this._requests.length>0?this._requests.shift().resolve({value:b.chunk,done:!1}):this._cachedChunks.push(b.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(b){this._storedError=(0,h.createResponseStatusError)(b,this._url),this._headersReceivedCapability.reject(this._storedError);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(b){var m;(m=this.onProgress)==null||m.call(this,{loaded:b.loaded,total:b.lengthComputable?b.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const b=new n.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0,this._headersReceivedCapability.reject(b);for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(b,m,E){this._manager=b;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._requestId=b.requestRange(m,E,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var b;(b=this.onClosed)==null||b.call(this,this)}_onDone(b){const m=b.chunk;this._requests.length>0?this._requests.shift().resolve({value:m,done:!1}):this._queuedChunk=m,this._done=!0;for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(b){this._storedError=(0,h.createResponseStatusError)(b,this._url);for(const m of this._requests)m.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(b){var m;this.isStreamingSupported||(m=this.onProgress)==null||m.call(this,{loaded:b.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const b=new n.PromiseCapability;return this._requests.push(b),b.promise}cancel(b){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=B(1),h=B(20);const G=/^file:\/\/\/[a-zA-Z]:\//;function H(E){const g=require$$5,u=g.parse(E);return u.protocol==="file:"||u.host?u:/^[a-z]:[/\\]/i.test(E)?g.parse(`file:///${E}`):(u.host||(u.protocol="file:"),u)}class ht{constructor(g){this.source=g,this.url=H(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var g;return((g=this._fullRequestReader)==null?void 0:g._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new b(this):new j(this),this._fullRequestReader}getRangeReader(g,u){if(u<=this._progressiveDataLength)return null;const y=this.isFsUrl?new m(this,g,u):new L(this,g,u);return this._rangeRequestReaders.push(y),y}cancelAllRequests(g){var u;(u=this._fullRequestReader)==null||u.cancel(g);for(const y of this._rangeRequestReaders.slice(0))y.cancel(g)}}e.PDFNodeStream=ht;class P{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const u=g.source;this._contentLength=u.length,this._loaded=0,this._filename=null,this._disableRange=u.disableRange||!1,this._rangeChunkSize=u.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",u=>{this._error(u)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class T{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const u=g.source;this._isStreamingSupported=!u.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var y;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=g.length,(y=this.onProgress)==null||y.call(this,{loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",u=>{this._error(u)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function f(E,g){return{protocol:E.protocol,auth:E.auth,host:E.hostname,port:E.port,path:E.path,method:"GET",headers:g}}class j extends P{constructor(g){super(g);const u=y=>{if(y.statusCode===404){const d=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=d,this._headersCapability.reject(d);return}this._headersCapability.resolve(),this._setReadableStream(y);const M=d=>this._readableStream.headers[d.toLowerCase()],{allowRangeRequests:A,suggestedLength:i}=(0,h.validateRangeRequestCapabilities)({getResponseHeader:M,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=i||this._contentLength,this._filename=(0,h.extractFilenameFromHeader)(M)};if(this._request=null,this._url.protocol==="http:"){const y=require$$5;this._request=y.request(f(this._url,g.httpHeaders),u)}else{const y=require$$5;this._request=y.request(f(this._url,g.httpHeaders),u)}this._request.on("error",y=>{this._storedError=y,this._headersCapability.reject(y)}),this._request.end()}}class L extends T{constructor(g,u,y){super(g),this._httpHeaders={};for(const A in g.httpHeaders){const i=g.httpHeaders[A];i!==void 0&&(this._httpHeaders[A]=i)}this._httpHeaders.Range=`bytes=${u}-${y-1}`;const M=A=>{if(A.statusCode===404){const i=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=i;return}this._setReadableStream(A)};if(this._request=null,this._url.protocol==="http:"){const A=require$$5;this._request=A.request(f(this._url,this._httpHeaders),M)}else{const A=require$$5;this._request=A.request(f(this._url,this._httpHeaders),M)}this._request.on("error",A=>{this._storedError=A}),this._request.end()}}class b extends P{constructor(g){super(g);let u=decodeURIComponent(this._url.path);G.test(this._url.href)&&(u=u.replace(/^\//,""));const y=require$$5;y.lstat(u,(M,A)=>{if(M){M.code==="ENOENT"&&(M=new n.MissingPDFException(`Missing PDF "${u}".`)),this._storedError=M,this._headersCapability.reject(M);return}this._contentLength=A.size,this._setReadableStream(y.createReadStream(u)),this._headersCapability.resolve()})}}class m extends T{constructor(g,u,y){super(g);let M=decodeURIComponent(this._url.path);G.test(this._url.href)&&(M=M.replace(/^\//,""));const A=require$$5;this._setReadableStream(A.createReadStream(M,{start:u,end:y-1}))}}},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=B(6),h=B(1);const G={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},H="http://www.w3.org/XML/1998/namespace",ht="http://www.w3.org/1999/xlink",P=["butt","round","square"],T=["miter","round","bevel"],f=function(A,i="",d=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!d)return URL.createObjectURL(new Blob([A],{type:i}));const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let l=`data:${i};base64,`;for(let c=0,I=A.length;c<I;c+=3){const a=A[c]&255,v=A[c+1]&255,R=A[c+2]&255,tt=a>>2,V=(a&3)<<4|v>>4,K=c+1<I?(v&15)<<2|R>>6:64,$=c+2<I?R&63:64;l+=o[tt]+o[V]+o[K]+o[$]}return l},j=function(){const A=new Uint8Array([137,80,78,71,13,10,26,10]),i=12,d=new Int32Array(256);for(let R=0;R<256;R++){let tt=R;for(let V=0;V<8;V++)tt=tt&1?3988292384^tt>>1&2147483647:tt>>1&2147483647;d[R]=tt}function o(R,tt,V){let K=-1;for(let $=tt;$<V;$++){const it=(K^R[$])&255,w=d[it];K=K>>>8^w}return K^-1}function l(R,tt,V,K){let $=K;const it=tt.length;V[$]=it>>24&255,V[$+1]=it>>16&255,V[$+2]=it>>8&255,V[$+3]=it&255,$+=4,V[$]=R.charCodeAt(0)&255,V[$+1]=R.charCodeAt(1)&255,V[$+2]=R.charCodeAt(2)&255,V[$+3]=R.charCodeAt(3)&255,$+=4,V.set(tt,$),$+=tt.length;const w=o(V,K+4,$);V[$]=w>>24&255,V[$+1]=w>>16&255,V[$+2]=w>>8&255,V[$+3]=w&255}function c(R,tt,V){let K=1,$=0;for(let it=tt;it<V;++it)K=(K+(R[it]&255))%65521,$=($+K)%65521;return $<<16|K}function I(R){if(!h.isNodeJS)return a(R);try{const tt=parseInt(process.versions.node)>=8?R:Buffer.from(R),V=require$$5.deflateSync(tt,{level:9});return V instanceof Uint8Array?V:new Uint8Array(V)}catch(tt){(0,h.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+tt)}return a(R)}function a(R){let tt=R.length;const V=65535,K=Math.ceil(tt/V),$=new Uint8Array(2+tt+K*5+4);let it=0;$[it++]=120,$[it++]=156;let w=0;for(;tt>V;)$[it++]=0,$[it++]=255,$[it++]=255,$[it++]=0,$[it++]=0,$.set(R.subarray(w,w+V),it),it+=V,w+=V,tt-=V;$[it++]=1,$[it++]=tt&255,$[it++]=tt>>8&255,$[it++]=~tt&65535&255,$[it++]=(~tt&65535)>>8&255,$.set(R.subarray(w),it),it+=R.length-w;const W=c(R,0,R.length);return $[it++]=W>>24&255,$[it++]=W>>16&255,$[it++]=W>>8&255,$[it++]=W&255,$}function v(R,tt,V,K){const $=R.width,it=R.height;let w,W,et;const S=R.data;switch(tt){case h.ImageKind.GRAYSCALE_1BPP:W=0,w=1,et=$+7>>3;break;case h.ImageKind.RGB_24BPP:W=2,w=8,et=$*3;break;case h.ImageKind.RGBA_32BPP:W=6,w=8,et=$*4;break;default:throw new Error("invalid format")}const s=new Uint8Array((1+et)*it);let r=0,p=0;for(let ct=0;ct<it;++ct)s[r++]=0,s.set(S.subarray(p,p+et),r),p+=et,r+=et;if(tt===h.ImageKind.GRAYSCALE_1BPP&&K){r=0;for(let ct=0;ct<it;ct++){r++;for(let ft=0;ft<et;ft++)s[r++]^=255}}const F=new Uint8Array([$>>24&255,$>>16&255,$>>8&255,$&255,it>>24&255,it>>16&255,it>>8&255,it&255,w,W,0,0,0]),D=I(s),O=A.length+i*3+F.length+D.length,q=new Uint8Array(O);let nt=0;return q.set(A,nt),nt+=A.length,l("IHDR",F,q,nt),nt+=i+F.length,l("IDATA",D,q,nt),nt+=i+D.length,l("IEND",new Uint8Array(0),q,nt),f(q,"image/png",V)}return function(tt,V,K){const $=tt.kind===void 0?h.ImageKind.GRAYSCALE_1BPP:tt.kind;return v(tt,$,V,K)}}();class L{constructor(){this.fontSizeScale=1,this.fontWeight=G.fontWeight,this.fontSize=0,this.textMatrix=h.IDENTITY_MATRIX,this.fontMatrix=h.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=h.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=G.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(i,d){this.x=i,this.y=d}}function b(A){let i=[];const d=[];for(const o of A){if(o.fn==="save"){i.push({fnId:92,fn:"group",items:[]}),d.push(i),i=i.at(-1).items;continue}o.fn==="restore"?i=d.pop():i.push(o)}return i}function m(A){if(Number.isInteger(A))return A.toString();const i=A.toFixed(10);let d=i.length-1;if(i[d]!=="0")return i;do d--;while(i[d]==="0");return i.substring(0,i[d]==="."?d:d+1)}function E(A){if(A[4]===0&&A[5]===0){if(A[1]===0&&A[2]===0)return A[0]===1&&A[3]===1?"":`scale(${m(A[0])} ${m(A[3])})`;if(A[0]===A[3]&&A[1]===-A[2]){const i=Math.acos(A[0])*180/Math.PI;return`rotate(${m(i)})`}}else if(A[0]===1&&A[1]===0&&A[2]===0&&A[3]===1)return`translate(${m(A[4])} ${m(A[5])})`;return`matrix(${m(A[0])} ${m(A[1])} ${m(A[2])} ${m(A[3])} ${m(A[4])} ${m(A[5])})`}let g=0,u=0,y=0;class M{constructor(i,d,o=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new L,this.transformMatrix=h.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=i,this.objs=d,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[];for(const l in h.OPS)this._operatorIdMapping[h.OPS[l]]=l}getObject(i,d=null){return typeof i=="string"?i.startsWith("g_")?this.commonObjs.get(i):this.objs.get(i):d}save(){this.transformStack.push(this.transformMatrix);const i=this.current;this.extraStack.push(i),this.current=i.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(i){this.save(),this.executeOpTree(i),this.restore()}loadDependencies(i){const d=i.fnArray,o=i.argsArray;for(let l=0,c=d.length;l<c;l++)if(d[l]===h.OPS.dependency)for(const I of o[l]){const a=I.startsWith("g_")?this.commonObjs:this.objs,v=new Promise(R=>{a.get(I,R)});this.current.dependencies.push(v)}return Promise.all(this.current.dependencies)}transform(i,d,o,l,c,I){const a=[i,d,o,l,c,I];this.transformMatrix=h.Util.transform(this.transformMatrix,a),this.tgrp=null}getSVG(i,d){this.viewport=d;const o=this._initialize(d);return this.loadDependencies(i).then(()=>(this.transformMatrix=h.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(i)),o))}convertOpList(i){const d=this._operatorIdMapping,o=i.argsArray,l=i.fnArray,c=[];for(let I=0,a=l.length;I<a;I++){const v=l[I];c.push({fnId:v,fn:d[v],args:o[I]})}return b(c)}executeOpTree(i){for(const d of i){const o=d.fn,l=d.fnId,c=d.args;switch(l|0){case h.OPS.beginText:this.beginText();break;case h.OPS.dependency:break;case h.OPS.setLeading:this.setLeading(c);break;case h.OPS.setLeadingMoveText:this.setLeadingMoveText(c[0],c[1]);break;case h.OPS.setFont:this.setFont(c);break;case h.OPS.showText:this.showText(c[0]);break;case h.OPS.showSpacedText:this.showText(c[0]);break;case h.OPS.endText:this.endText();break;case h.OPS.moveText:this.moveText(c[0],c[1]);break;case h.OPS.setCharSpacing:this.setCharSpacing(c[0]);break;case h.OPS.setWordSpacing:this.setWordSpacing(c[0]);break;case h.OPS.setHScale:this.setHScale(c[0]);break;case h.OPS.setTextMatrix:this.setTextMatrix(c[0],c[1],c[2],c[3],c[4],c[5]);break;case h.OPS.setTextRise:this.setTextRise(c[0]);break;case h.OPS.setTextRenderingMode:this.setTextRenderingMode(c[0]);break;case h.OPS.setLineWidth:this.setLineWidth(c[0]);break;case h.OPS.setLineJoin:this.setLineJoin(c[0]);break;case h.OPS.setLineCap:this.setLineCap(c[0]);break;case h.OPS.setMiterLimit:this.setMiterLimit(c[0]);break;case h.OPS.setFillRGBColor:this.setFillRGBColor(c[0],c[1],c[2]);break;case h.OPS.setStrokeRGBColor:this.setStrokeRGBColor(c[0],c[1],c[2]);break;case h.OPS.setStrokeColorN:this.setStrokeColorN(c);break;case h.OPS.setFillColorN:this.setFillColorN(c);break;case h.OPS.shadingFill:this.shadingFill(c[0]);break;case h.OPS.setDash:this.setDash(c[0],c[1]);break;case h.OPS.setRenderingIntent:this.setRenderingIntent(c[0]);break;case h.OPS.setFlatness:this.setFlatness(c[0]);break;case h.OPS.setGState:this.setGState(c[0]);break;case h.OPS.fill:this.fill();break;case h.OPS.eoFill:this.eoFill();break;case h.OPS.stroke:this.stroke();break;case h.OPS.fillStroke:this.fillStroke();break;case h.OPS.eoFillStroke:this.eoFillStroke();break;case h.OPS.clip:this.clip("nonzero");break;case h.OPS.eoClip:this.clip("evenodd");break;case h.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case h.OPS.paintImageXObject:this.paintImageXObject(c[0]);break;case h.OPS.paintInlineImageXObject:this.paintInlineImageXObject(c[0]);break;case h.OPS.paintImageMaskXObject:this.paintImageMaskXObject(c[0]);break;case h.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(c[0],c[1]);break;case h.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case h.OPS.closePath:this.closePath();break;case h.OPS.closeStroke:this.closeStroke();break;case h.OPS.closeFillStroke:this.closeFillStroke();break;case h.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case h.OPS.nextLine:this.nextLine();break;case h.OPS.transform:this.transform(c[0],c[1],c[2],c[3],c[4],c[5]);break;case h.OPS.constructPath:this.constructPath(c[0],c[1]);break;case h.OPS.endPath:this.endPath();break;case 92:this.group(d.items);break;default:(0,h.warn)(`Unimplemented operator ${o}`);break}}}setWordSpacing(i){this.current.wordSpacing=i}setCharSpacing(i){this.current.charSpacing=i}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(i,d,o,l,c,I){const a=this.current;a.textMatrix=a.lineMatrix=[i,d,o,l,c,I],a.textMatrixScale=Math.hypot(i,d),a.x=a.lineX=0,a.y=a.lineY=0,a.xcoords=[],a.ycoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${m(a.fontSize)}px`),a.tspan.setAttributeNS(null,"y",m(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.append(a.tspan)}beginText(){const i=this.current;i.x=i.lineX=0,i.y=i.lineY=0,i.textMatrix=h.IDENTITY_MATRIX,i.lineMatrix=h.IDENTITY_MATRIX,i.textMatrixScale=1,i.tspan=this.svgFactory.createElement("svg:tspan"),i.txtElement=this.svgFactory.createElement("svg:text"),i.txtgrp=this.svgFactory.createElement("svg:g"),i.xcoords=[],i.ycoords=[]}moveText(i,d){const o=this.current;o.x=o.lineX+=i,o.y=o.lineY+=d,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${m(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",m(-o.y))}showText(i){const d=this.current,o=d.font,l=d.fontSize;if(l===0)return;const c=d.fontSizeScale,I=d.charSpacing,a=d.wordSpacing,v=d.fontDirection,R=d.textHScale*v,tt=o.vertical,V=tt?1:-1,K=o.defaultVMetrics,$=l*d.fontMatrix[0];let it=0;for(const et of i){if(et===null){it+=v*a;continue}else if(typeof et=="number"){it+=V*et*l/1e3;continue}const S=(et.isSpace?a:0)+I,s=et.fontChar;let r,p,F=et.width;if(tt){let O;const q=et.vmetric||K;O=et.vmetric?q[1]:F*.5,O=-O*$;const nt=q[2]*$;F=q?-q[0]:F,r=O/c,p=(it+nt)/c}else r=it/c,p=0;(et.isInFont||o.missingFile)&&(d.xcoords.push(d.x+r),tt&&d.ycoords.push(-d.y+p),d.tspan.textContent+=s);const D=tt?F*$-S*v:F*$+S*v;it+=D}d.tspan.setAttributeNS(null,"x",d.xcoords.map(m).join(" ")),tt?d.tspan.setAttributeNS(null,"y",d.ycoords.map(m).join(" ")):d.tspan.setAttributeNS(null,"y",m(-d.y)),tt?d.y-=it:d.x+=it*R,d.tspan.setAttributeNS(null,"font-family",d.fontFamily),d.tspan.setAttributeNS(null,"font-size",`${m(d.fontSize)}px`),d.fontStyle!==G.fontStyle&&d.tspan.setAttributeNS(null,"font-style",d.fontStyle),d.fontWeight!==G.fontWeight&&d.tspan.setAttributeNS(null,"font-weight",d.fontWeight);const w=d.textRenderingMode&h.TextRenderingMode.FILL_STROKE_MASK;if(w===h.TextRenderingMode.FILL||w===h.TextRenderingMode.FILL_STROKE?(d.fillColor!==G.fillColor&&d.tspan.setAttributeNS(null,"fill",d.fillColor),d.fillAlpha<1&&d.tspan.setAttributeNS(null,"fill-opacity",d.fillAlpha)):d.textRenderingMode===h.TextRenderingMode.ADD_TO_PATH?d.tspan.setAttributeNS(null,"fill","transparent"):d.tspan.setAttributeNS(null,"fill","none"),w===h.TextRenderingMode.STROKE||w===h.TextRenderingMode.FILL_STROKE){const et=1/(d.textMatrixScale||1);this._setStrokeAttributes(d.tspan,et)}let W=d.textMatrix;d.textRise!==0&&(W=W.slice(),W[5]+=d.textRise),d.txtElement.setAttributeNS(null,"transform",`${E(W)} scale(${m(R)}, -1)`),d.txtElement.setAttributeNS(H,"xml:space","preserve"),d.txtElement.append(d.tspan),d.txtgrp.append(d.txtElement),this._ensureTransformGroup().append(d.txtElement)}setLeadingMoveText(i,d){this.setLeading(-d),this.moveText(i,d)}addFontStyle(i){if(!i.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const d=f(i.data,i.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${i.loadedName}"; src: url(${d}); }
`}setFont(i){const d=this.current,o=this.commonObjs.get(i[0]);let l=i[1];d.font=o,this.embedFonts&&!o.missingFile&&!this.embeddedFonts[o.loadedName]&&(this.addFontStyle(o),this.embeddedFonts[o.loadedName]=o),d.fontMatrix=o.fontMatrix||h.FONT_IDENTITY_MATRIX;let c="normal";o.black?c="900":o.bold&&(c="bold");const I=o.italic?"italic":"normal";l<0?(l=-l,d.fontDirection=-1):d.fontDirection=1,d.fontSize=l,d.fontFamily=o.loadedName,d.fontWeight=c,d.fontStyle=I,d.tspan=this.svgFactory.createElement("svg:tspan"),d.tspan.setAttributeNS(null,"y",m(-d.y)),d.xcoords=[],d.ycoords=[]}endText(){var d;const i=this.current;i.textRenderingMode&h.TextRenderingMode.ADD_TO_PATH_FLAG&&((d=i.txtElement)!=null&&d.hasChildNodes())&&(i.element=i.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(i){i>0&&(this.current.lineWidth=i)}setLineCap(i){this.current.lineCap=P[i]}setLineJoin(i){this.current.lineJoin=T[i]}setMiterLimit(i){this.current.miterLimit=i}setStrokeAlpha(i){this.current.strokeAlpha=i}setStrokeRGBColor(i,d,o){this.current.strokeColor=h.Util.makeHexColor(i,d,o)}setFillAlpha(i){this.current.fillAlpha=i}setFillRGBColor(i,d,o){this.current.fillColor=h.Util.makeHexColor(i,d,o),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(i){this.current.strokeColor=this._makeColorN_Pattern(i)}setFillColorN(i){this.current.fillColor=this._makeColorN_Pattern(i)}shadingFill(i){const{width:d,height:o}=this.viewport,l=h.Util.inverseTransform(this.transformMatrix),[c,I,a,v]=h.Util.getAxialAlignedBoundingBox([0,0,d,o],l),R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x",c),R.setAttributeNS(null,"y",I),R.setAttributeNS(null,"width",a-c),R.setAttributeNS(null,"height",v-I),R.setAttributeNS(null,"fill",this._makeShadingPattern(i)),this.current.fillAlpha<1&&R.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(R)}_makeColorN_Pattern(i){return i[0]==="TilingPattern"?this._makeTilingPattern(i):this._makeShadingPattern(i)}_makeTilingPattern(i){const d=i[1],o=i[2],l=i[3]||h.IDENTITY_MATRIX,[c,I,a,v]=i[4],R=i[5],tt=i[6],V=i[7],K=`shading${y++}`,[$,it,w,W]=h.Util.normalizeRect([...h.Util.applyTransform([c,I],l),...h.Util.applyTransform([a,v],l)]),[et,S]=h.Util.singularValueDecompose2dScale(l),s=R*et,r=tt*S,p=this.svgFactory.createElement("svg:pattern");p.setAttributeNS(null,"id",K),p.setAttributeNS(null,"patternUnits","userSpaceOnUse"),p.setAttributeNS(null,"width",s),p.setAttributeNS(null,"height",r),p.setAttributeNS(null,"x",`${$}`),p.setAttributeNS(null,"y",`${it}`);const F=this.svg,D=this.transformMatrix,O=this.current.fillColor,q=this.current.strokeColor,nt=this.svgFactory.create(w-$,W-it);if(this.svg=nt,this.transformMatrix=l,V===2){const ct=h.Util.makeHexColor(...d);this.current.fillColor=ct,this.current.strokeColor=ct}return this.executeOpTree(this.convertOpList(o)),this.svg=F,this.transformMatrix=D,this.current.fillColor=O,this.current.strokeColor=q,p.append(nt.childNodes[0]),this.defs.append(p),`url(#${K})`}_makeShadingPattern(i){switch(typeof i=="string"&&(i=this.objs.get(i)),i[0]){case"RadialAxial":const d=`shading${y++}`,o=i[3];let l;switch(i[1]){case"axial":const c=i[4],I=i[5];l=this.svgFactory.createElement("svg:linearGradient"),l.setAttributeNS(null,"id",d),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"x1",c[0]),l.setAttributeNS(null,"y1",c[1]),l.setAttributeNS(null,"x2",I[0]),l.setAttributeNS(null,"y2",I[1]);break;case"radial":const a=i[4],v=i[5],R=i[6],tt=i[7];l=this.svgFactory.createElement("svg:radialGradient"),l.setAttributeNS(null,"id",d),l.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),l.setAttributeNS(null,"cx",v[0]),l.setAttributeNS(null,"cy",v[1]),l.setAttributeNS(null,"r",tt),l.setAttributeNS(null,"fx",a[0]),l.setAttributeNS(null,"fy",a[1]),l.setAttributeNS(null,"fr",R);break;default:throw new Error(`Unknown RadialAxial type: ${i[1]}`)}for(const c of o){const I=this.svgFactory.createElement("svg:stop");I.setAttributeNS(null,"offset",c[0]),I.setAttributeNS(null,"stop-color",c[1]),l.append(I)}return this.defs.append(l),`url(#${d})`;case"Mesh":return(0,h.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${i[0]}`)}}setDash(i,d){this.current.dashArray=i,this.current.dashPhase=d}constructPath(i,d){const o=this.current;let l=o.x,c=o.y,I=[],a=0;for(const v of i)switch(v|0){case h.OPS.rectangle:l=d[a++],c=d[a++];const R=d[a++],tt=d[a++],V=l+R,K=c+tt;I.push("M",m(l),m(c),"L",m(V),m(c),"L",m(V),m(K),"L",m(l),m(K),"Z");break;case h.OPS.moveTo:l=d[a++],c=d[a++],I.push("M",m(l),m(c));break;case h.OPS.lineTo:l=d[a++],c=d[a++],I.push("L",m(l),m(c));break;case h.OPS.curveTo:l=d[a+4],c=d[a+5],I.push("C",m(d[a]),m(d[a+1]),m(d[a+2]),m(d[a+3]),m(l),m(c)),a+=6;break;case h.OPS.curveTo2:I.push("C",m(l),m(c),m(d[a]),m(d[a+1]),m(d[a+2]),m(d[a+3])),l=d[a+2],c=d[a+3],a+=4;break;case h.OPS.curveTo3:l=d[a+2],c=d[a+3],I.push("C",m(d[a]),m(d[a+1]),m(l),m(c),m(l),m(c)),a+=4;break;case h.OPS.closePath:I.push("Z");break}I=I.join(" "),o.path&&i.length>0&&i[0]!==h.OPS.rectangle&&i[0]!==h.OPS.moveTo?I=o.path.getAttributeNS(null,"d")+I:(o.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(o.path)),o.path.setAttributeNS(null,"d",I),o.path.setAttributeNS(null,"fill","none"),o.element=o.path,o.setCurrentPoint(l,c)}endPath(){const i=this.current;if(i.path=null,!this.pendingClip)return;if(!i.element){this.pendingClip=null;return}const d=`clippath${g++}`,o=this.svgFactory.createElement("svg:clipPath");o.setAttributeNS(null,"id",d),o.setAttributeNS(null,"transform",E(this.transformMatrix));const l=i.element.cloneNode(!0);if(this.pendingClip==="evenodd"?l.setAttributeNS(null,"clip-rule","evenodd"):l.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,o.append(l),this.defs.append(o),i.activeClipUrl){i.clipGroup=null;for(const c of this.extraStack)c.clipGroup=null;o.setAttributeNS(null,"clip-path",i.activeClipUrl)}i.activeClipUrl=`url(#${d})`,this.tgrp=null}clip(i){this.pendingClip=i}closePath(){const i=this.current;if(i.path){const d=`${i.path.getAttributeNS(null,"d")}Z`;i.path.setAttributeNS(null,"d",d)}}setLeading(i){this.current.leading=-i}setTextRise(i){this.current.textRise=i}setTextRenderingMode(i){this.current.textRenderingMode=i}setHScale(i){this.current.textHScale=i/100}setRenderingIntent(i){}setFlatness(i){}setGState(i){for(const[d,o]of i)switch(d){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,h.warn)(`Unimplemented graphic state operator ${d}`);break}}fill(){const i=this.current;i.element&&(i.element.setAttributeNS(null,"fill",i.fillColor),i.element.setAttributeNS(null,"fill-opacity",i.fillAlpha),this.endPath())}stroke(){const i=this.current;i.element&&(this._setStrokeAttributes(i.element),i.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(i,d=1){const o=this.current;let l=o.dashArray;d!==1&&l.length>0&&(l=l.map(function(c){return d*c})),i.setAttributeNS(null,"stroke",o.strokeColor),i.setAttributeNS(null,"stroke-opacity",o.strokeAlpha),i.setAttributeNS(null,"stroke-miterlimit",m(o.miterLimit)),i.setAttributeNS(null,"stroke-linecap",o.lineCap),i.setAttributeNS(null,"stroke-linejoin",o.lineJoin),i.setAttributeNS(null,"stroke-width",m(d*o.lineWidth)+"px"),i.setAttributeNS(null,"stroke-dasharray",l.map(m).join(" ")),i.setAttributeNS(null,"stroke-dashoffset",m(d*o.dashPhase)+"px")}eoFill(){var i;(i=this.current.element)==null||i.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var i;(i=this.current.element)==null||i.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y","0"),i.setAttributeNS(null,"width","1px"),i.setAttributeNS(null,"height","1px"),i.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(i)}paintImageXObject(i){const d=this.getObject(i);if(!d){(0,h.warn)(`Dependent image with object ID ${i} is not ready yet`);return}this.paintInlineImageXObject(d)}paintInlineImageXObject(i,d){const o=i.width,l=i.height,c=j(i,this.forceDataSchema,!!d),I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x","0"),I.setAttributeNS(null,"y","0"),I.setAttributeNS(null,"width",m(o)),I.setAttributeNS(null,"height",m(l)),this.current.element=I,this.clip("nonzero");const a=this.svgFactory.createElement("svg:image");a.setAttributeNS(ht,"xlink:href",c),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",m(-l)),a.setAttributeNS(null,"width",m(o)+"px"),a.setAttributeNS(null,"height",m(l)+"px"),a.setAttributeNS(null,"transform",`scale(${m(1/o)} ${m(-1/l)})`),d?d.append(a):this._ensureTransformGroup().append(a)}paintImageMaskXObject(i){const d=this.getObject(i.data,i);if(d.bitmap){(0,h.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const o=this.current,l=d.width,c=d.height,I=o.fillColor;o.maskId=`mask${u++}`;const a=this.svgFactory.createElement("svg:mask");a.setAttributeNS(null,"id",o.maskId);const v=this.svgFactory.createElement("svg:rect");v.setAttributeNS(null,"x","0"),v.setAttributeNS(null,"y","0"),v.setAttributeNS(null,"width",m(l)),v.setAttributeNS(null,"height",m(c)),v.setAttributeNS(null,"fill",I),v.setAttributeNS(null,"mask",`url(#${o.maskId})`),this.defs.append(a),this._ensureTransformGroup().append(v),this.paintInlineImageXObject(d,a)}paintFormXObjectBegin(i,d){if(Array.isArray(i)&&i.length===6&&this.transform(i[0],i[1],i[2],i[3],i[4],i[5]),d){const o=d[2]-d[0],l=d[3]-d[1],c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",d[0]),c.setAttributeNS(null,"y",d[1]),c.setAttributeNS(null,"width",m(o)),c.setAttributeNS(null,"height",m(l)),this.current.element=c,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(i){const d=this.svgFactory.create(i.width,i.height),o=this.svgFactory.createElement("svg:defs");d.append(o),this.defs=o;const l=this.svgFactory.createElement("svg:g");return l.setAttributeNS(null,"transform",E(i.transform)),d.append(l),this.svg=l,d}_ensureClipGroup(){if(!this.current.clipGroup){const i=this.svgFactory.createElement("svg:g");i.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(i),this.current.clipGroup=i}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",E(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=M},(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class B{static textContent(h){const G=[],H={items:G,styles:Object.create(null)};function ht(P){var j;if(!P)return;let T=null;const f=P.name;if(f==="#text")T=P.value;else if(B.shouldBuildText(f))(j=P==null?void 0:P.attributes)!=null&&j.textContent?T=P.attributes.textContent:P.value&&(T=P.value);else return;if(T!==null&&G.push({str:T}),!!P.children)for(const L of P.children)ht(L)}return ht(h),H}static shouldBuildText(h){return!(h==="textarea"||h==="input"||h==="option"||h==="select")}}e.XfaText=B},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=E,e.updateTextLayer=g;var n=B(1),h=B(6);const G=1e5,H=30,ht=.8,P=new Map;function T(u,y){let M;if(y&&n.FeatureTest.isOffscreenCanvasSupported)M=new OffscreenCanvas(u,u).getContext("2d",{alpha:!1});else{const A=document.createElement("canvas");A.width=A.height=u,M=A.getContext("2d",{alpha:!1})}return M}function f(u,y){const M=P.get(u);if(M)return M;const A=T(H,y);A.font=`${H}px ${u}`;const i=A.measureText("");let d=i.fontBoundingBoxAscent,o=Math.abs(i.fontBoundingBoxDescent);if(d){const c=d/(d+o);return P.set(u,c),A.canvas.width=A.canvas.height=0,c}A.strokeStyle="red",A.clearRect(0,0,H,H),A.strokeText("g",0,0);let l=A.getImageData(0,0,H,H).data;o=0;for(let c=l.length-1-3;c>=0;c-=4)if(l[c]>0){o=Math.ceil(c/4/H);break}A.clearRect(0,0,H,H),A.strokeText("A",0,H),l=A.getImageData(0,0,H,H).data,d=0;for(let c=0,I=l.length;c<I;c+=4)if(l[c]>0){d=H-Math.floor(c/4/H);break}if(A.canvas.width=A.canvas.height=0,d){const c=d/(d+o);return P.set(u,c),c}return P.set(u,ht),ht}function j(u,y,M){const A=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:y.str!=="",hasEOL:y.hasEOL,fontSize:0};u._textDivs.push(A);const d=n.Util.transform(u._transform,y.transform);let o=Math.atan2(d[1],d[0]);const l=M[y.fontName];l.vertical&&(o+=Math.PI/2);const c=Math.hypot(d[2],d[3]),I=c*f(l.fontFamily,u._isOffscreenCanvasSupported);let a,v;o===0?(a=d[4],v=d[5]-I):(a=d[4]+I*Math.sin(o),v=d[5]-I*Math.cos(o));const R="calc(var(--scale-factor)*",tt=A.style;u._container===u._rootContainer?(tt.left=`${(100*a/u._pageWidth).toFixed(2)}%`,tt.top=`${(100*v/u._pageHeight).toFixed(2)}%`):(tt.left=`${R}${a.toFixed(2)}px)`,tt.top=`${R}${v.toFixed(2)}px)`),tt.fontSize=`${R}${c.toFixed(2)}px)`,tt.fontFamily=l.fontFamily,i.fontSize=c,A.setAttribute("role","presentation"),A.textContent=y.str,A.dir=y.dir,u._fontInspectorEnabled&&(A.dataset.fontName=y.fontName),o!==0&&(i.angle=o*(180/Math.PI));let V=!1;if(y.str.length>1)V=!0;else if(y.str!==" "&&y.transform[0]!==y.transform[3]){const K=Math.abs(y.transform[0]),$=Math.abs(y.transform[3]);K!==$&&Math.max(K,$)/Math.min(K,$)>1.5&&(V=!0)}V&&(i.canvasWidth=l.vertical?y.height:y.width),u._textDivProperties.set(A,i),u._isReadableStream&&u._layoutText(A)}function L(u){const{div:y,scale:M,properties:A,ctx:i,prevFontSize:d,prevFontFamily:o}=u,{style:l}=y;let c="";if(A.canvasWidth!==0&&A.hasText){const{fontFamily:I}=l,{canvasWidth:a,fontSize:v}=A;(d!==v||o!==I)&&(i.font=`${v*M}px ${I}`,u.prevFontSize=v,u.prevFontFamily=I);const{width:R}=i.measureText(y.textContent);R>0&&(c=`scaleX(${a*M/R})`)}A.angle!==0&&(c=`rotate(${A.angle}deg) ${c}`),c.length>0&&(l.transform=c)}function b(u){if(u._canceled)return;const y=u._textDivs,M=u._capability;if(y.length>G){M.resolve();return}if(!u._isReadableStream)for(const i of y)u._layoutText(i);M.resolve()}class m{constructor({textContentSource:y,container:M,viewport:A,textDivs:i,textDivProperties:d,textContentItemsStr:o,isOffscreenCanvasSupported:l}){var R;this._textContentSource=y,this._isReadableStream=y instanceof ReadableStream,this._container=this._rootContainer=M,this._textDivs=i||[],this._textContentItemsStr=o||[],this._isOffscreenCanvasSupported=l,this._fontInspectorEnabled=!!((R=globalThis.FontInspector)!=null&&R.enabled),this._reader=null,this._textDivProperties=d||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:A.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:T(0,l)};const{pageWidth:c,pageHeight:I,pageX:a,pageY:v}=A.rawDims;this._transform=[1,0,0,-1,-a,v+I],this._pageWidth=c,this._pageHeight=I,(0,h.setLayerDimensions)(M,A),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(y,M){for(const A of y){if(A.str===void 0){if(A.type==="beginMarkedContentProps"||A.type==="beginMarkedContent"){const i=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),A.id!==null&&this._container.setAttribute("id",`${A.id}`),i.append(this._container)}else A.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(A.str),j(this,A,M)}}_layoutText(y){const M=this._layoutTextParams.properties=this._textDivProperties.get(y);if(this._layoutTextParams.div=y,L(this._layoutTextParams),M.hasText&&this._container.append(y),M.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this._container.append(A)}}_render(){const y=new n.PromiseCapability;let M=Object.create(null);if(this._isReadableStream){const A=()=>{this._reader.read().then(({value:i,done:d})=>{if(d){y.resolve();return}Object.assign(M,i.styles),this._processItems(i.items,M),A()},y.reject)};this._reader=this._textContentSource.getReader(),A()}else if(this._textContentSource){const{items:A,styles:i}=this._textContentSource;this._processItems(A,i),y.resolve()}else throw new Error('No "textContentSource" parameter specified.');y.promise.then(()=>{M=null,b(this)},this._capability.reject)}}e.TextLayerRenderTask=m;function E(u){!u.textContentSource&&(u.textContent||u.textContentStream)&&((0,h.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),u.textContentSource=u.textContent||u.textContentStream);const{container:y,viewport:M}=u,A=getComputedStyle(y),i=A.getPropertyValue("visibility"),d=parseFloat(A.getPropertyValue("--scale-factor"));i==="visible"&&(!d||Math.abs(d-M.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const o=new m(u);return o._render(),o}function g({container:u,viewport:y,textDivs:M,textDivProperties:A,isOffscreenCanvasSupported:i,mustRotate:d=!0,mustRescale:o=!0}){if(d&&(0,h.setLayerDimensions)(u,{rotation:y.rotation}),o){const l=T(0,i),I={prevFontSize:null,prevFontFamily:null,div:null,scale:y.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l};for(const a of M)I.properties=A.get(a),I.div=a,L(I)}}},(C,e,B)=>{var f,j,L,b,m,E,g,u,y,M,A,Ke,xe,Je,Qe;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=B(1),h=B(4),G=B(28),H=B(33),ht=B(6),P=B(34);const c=class c{constructor({uiManager:a,pageIndex:v,div:R,accessibilityManager:tt,annotationLayer:V,viewport:K,l10n:$}){rt(this,A);rt(this,f);rt(this,j,!1);rt(this,L,null);rt(this,b,this.pointerup.bind(this));rt(this,m,this.pointerdown.bind(this));rt(this,E,new Map);rt(this,g,!1);rt(this,u,!1);rt(this,y,!1);rt(this,M);const it=[G.FreeTextEditor,H.InkEditor,P.StampEditor];if(!c._initialized){c._initialized=!0;for(const w of it)w.initialize($)}a.registerEditorTypes(it),ot(this,M,a),this.pageIndex=v,this.div=R,ot(this,f,tt),ot(this,L,V),this.viewport=K,t(this,M).addLayer(this)}get isEmpty(){return t(this,E).size===0}updateToolbar(a){t(this,M).updateToolbar(a)}updateMode(a=t(this,M).getMode()){Y(this,A,Qe).call(this),a===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),a!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",a===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",a===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",a===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(a){if(!a&&t(this,M).getMode()!==n.AnnotationEditorType.INK)return;if(!a){for(const R of t(this,E).values())if(R.isEmpty()){R.setInBackground();return}}Y(this,A,xe).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(a){t(this,M).setEditingState(a)}addCommands(a){t(this,M).addCommands(a)}enable(){this.div.style.pointerEvents="auto";const a=new Set;for(const R of t(this,E).values())R.enableEditing(),R.annotationElementId&&a.add(R.annotationElementId);if(!t(this,L))return;const v=t(this,L).getEditableAnnotations();for(const R of v){if(R.hide(),t(this,M).isDeletedAnnotationElement(R.data.id)||a.has(R.data.id))continue;const tt=this.deserialize(R);tt&&(this.addOrRebuild(tt),tt.enableEditing())}}disable(){var v;ot(this,y,!0),this.div.style.pointerEvents="none";const a=new Set;for(const R of t(this,E).values()){if(R.disableEditing(),!R.annotationElementId||R.serialize()!==null){a.add(R.annotationElementId);continue}(v=this.getEditableAnnotation(R.annotationElementId))==null||v.show(),R.remove()}if(t(this,L)){const R=t(this,L).getEditableAnnotations();for(const tt of R){const{id:V}=tt.data;a.has(V)||t(this,M).isDeletedAnnotationElement(V)||tt.show()}}Y(this,A,Qe).call(this),this.isEmpty&&(this.div.hidden=!0),ot(this,y,!1)}getEditableAnnotation(a){var v;return((v=t(this,L))==null?void 0:v.getEditableAnnotation(a))||null}setActiveEditor(a){t(this,M).getActive()!==a&&t(this,M).setActiveEditor(a)}enableClick(){this.div.addEventListener("pointerdown",t(this,m)),this.div.addEventListener("pointerup",t(this,b))}disableClick(){this.div.removeEventListener("pointerdown",t(this,m)),this.div.removeEventListener("pointerup",t(this,b))}attach(a){t(this,E).set(a.id,a);const{annotationElementId:v}=a;v&&t(this,M).isDeletedAnnotationElement(v)&&t(this,M).removeDeletedAnnotationElement(a)}detach(a){var v;t(this,E).delete(a.id),(v=t(this,f))==null||v.removePointerInTextLayer(a.contentDiv),!t(this,y)&&a.annotationElementId&&t(this,M).addDeletedAnnotationElement(a)}remove(a){this.detach(a),t(this,M).removeEditor(a),a.div.contains(document.activeElement)&&setTimeout(()=>{t(this,M).focusMainContainer()},0),a.div.remove(),a.isAttachedToDOM=!1,t(this,u)||this.addInkEditorIfNeeded(!1)}changeParent(a){var v;a.parent!==this&&(a.annotationElementId&&(t(this,M).addDeletedAnnotationElement(a.annotationElementId),h.AnnotationEditor.deleteAnnotationElement(a),a.annotationElementId=null),this.attach(a),(v=a.parent)==null||v.detach(a),a.setParent(this),a.div&&a.isAttachedToDOM&&(a.div.remove(),this.div.append(a.div)))}add(a){if(this.changeParent(a),t(this,M).addEditor(a),this.attach(a),!a.isAttachedToDOM){const v=a.render();this.div.append(v),a.isAttachedToDOM=!0}a.fixAndSetPosition(),a.onceAdded(),t(this,M).addToAnnotationStorage(a)}moveEditorInDOM(a){var R;if(!a.isAttachedToDOM)return;const{activeElement:v}=document;a.div.contains(v)&&(a._focusEventsAllowed=!1,setTimeout(()=>{a.div.contains(document.activeElement)?a._focusEventsAllowed=!0:(a.div.addEventListener("focusin",()=>{a._focusEventsAllowed=!0},{once:!0}),v.focus())},0)),a._structTreeParentId=(R=t(this,f))==null?void 0:R.moveElementInDOM(this.div,a.div,a.contentDiv,!0)}addOrRebuild(a){a.needsToBeRebuilt()?a.rebuild():this.add(a)}addUndoableEditor(a){const v=()=>a._uiManager.rebuild(a),R=()=>{a.remove()};this.addCommands({cmd:v,undo:R,mustExec:!1})}getNextId(){return t(this,M).getId()}pasteEditor(a,v){t(this,M).updateToolbar(a),t(this,M).updateMode(a);const{offsetX:R,offsetY:tt}=Y(this,A,Je).call(this),V=this.getNextId(),K=Y(this,A,Ke).call(this,{parent:this,id:V,x:R,y:tt,uiManager:t(this,M),isCentered:!0,...v});K&&this.add(K)}deserialize(a){switch(a.annotationType??a.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return G.FreeTextEditor.deserialize(a,this,t(this,M));case n.AnnotationEditorType.INK:return H.InkEditor.deserialize(a,this,t(this,M));case n.AnnotationEditorType.STAMP:return P.StampEditor.deserialize(a,this,t(this,M))}return null}addNewEditor(){Y(this,A,xe).call(this,Y(this,A,Je).call(this),!0)}setSelected(a){t(this,M).setSelected(a)}toggleSelected(a){t(this,M).toggleSelected(a)}isSelected(a){return t(this,M).isSelected(a)}unselect(a){t(this,M).unselect(a)}pointerup(a){const{isMac:v}=n.FeatureTest.platform;if(!(a.button!==0||a.ctrlKey&&v)&&a.target===this.div&&t(this,g)){if(ot(this,g,!1),!t(this,j)){ot(this,j,!0);return}if(t(this,M).getMode()===n.AnnotationEditorType.STAMP){t(this,M).unselectAll();return}Y(this,A,xe).call(this,a,!1)}}pointerdown(a){if(t(this,g)){ot(this,g,!1);return}const{isMac:v}=n.FeatureTest.platform;if(a.button!==0||a.ctrlKey&&v||a.target!==this.div)return;ot(this,g,!0);const R=t(this,M).getActive();ot(this,j,!R||R.isEmpty())}findNewParent(a,v,R){const tt=t(this,M).findParent(v,R);return tt===null||tt===this?!1:(tt.changeParent(a),!0)}destroy(){var a,v;((a=t(this,M).getActive())==null?void 0:a.parent)===this&&(t(this,M).commitOrRemove(),t(this,M).setActiveEditor(null));for(const R of t(this,E).values())(v=t(this,f))==null||v.removePointerInTextLayer(R.contentDiv),R.setParent(null),R.isAttachedToDOM=!1,R.div.remove();this.div=null,t(this,E).clear(),t(this,M).removeLayer(this)}render({viewport:a}){this.viewport=a,(0,ht.setLayerDimensions)(this.div,a);for(const v of t(this,M).getEditors(this.pageIndex))this.add(v);this.updateMode()}update({viewport:a}){t(this,M).commitOrRemove(),this.viewport=a,(0,ht.setLayerDimensions)(this.div,{rotation:a.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:a,pageHeight:v}=this.viewport.rawDims;return[a,v]}};f=new WeakMap,j=new WeakMap,L=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,M=new WeakMap,A=new WeakSet,Ke=function(a){switch(t(this,M).getMode()){case n.AnnotationEditorType.FREETEXT:return new G.FreeTextEditor(a);case n.AnnotationEditorType.INK:return new H.InkEditor(a);case n.AnnotationEditorType.STAMP:return new P.StampEditor(a)}return null},xe=function(a,v){const R=this.getNextId(),tt=Y(this,A,Ke).call(this,{parent:this,id:R,x:a.offsetX,y:a.offsetY,uiManager:t(this,M),isCentered:v});return tt&&this.add(tt),tt},Je=function(){const{x:a,y:v,width:R,height:tt}=this.div.getBoundingClientRect(),V=Math.max(0,a),K=Math.max(0,v),$=Math.min(window.innerWidth,a+R),it=Math.min(window.innerHeight,v+tt),w=(V+$)/2-a,W=(K+it)/2-v,[et,S]=this.viewport.rotation%180===0?[w,W]:[W,w];return{offsetX:et,offsetY:S}},Qe=function(){ot(this,u,!0);for(const a of t(this,E).values())a.isEmpty()&&a.remove();ot(this,u,!1)},Kt(c,"_initialized",!1);let T=c;e.AnnotationEditorLayer=T},(C,e,B)=>{var P,T,f,j,L,b,m,E,g,u,Pn,Cn,Rn,ge,Ze,kn,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=B(1),h=B(5),G=B(4),H=B(29);const c=class c extends G.AnnotationEditor{constructor(v){super({...v,name:"freeTextEditor"});rt(this,u);rt(this,P,this.editorDivBlur.bind(this));rt(this,T,this.editorDivFocus.bind(this));rt(this,f,this.editorDivInput.bind(this));rt(this,j,this.editorDivKeydown.bind(this));rt(this,L);rt(this,b,"");rt(this,m,`${this.id}-editor`);rt(this,E);rt(this,g,null);ot(this,L,v.color||c._defaultColor||G.AnnotationEditor._defaultLineColor),ot(this,E,v.fontSize||c._defaultFontSize)}static get _keyboardManager(){const v=c.prototype,R=K=>K.isEmpty(),tt=h.AnnotationEditorUIManager.TRANSLATE_SMALL,V=h.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new h.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],v.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],v.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],v._translateEmpty,{args:[-tt,0],checker:R}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],v._translateEmpty,{args:[-V,0],checker:R}],[["ArrowRight","mac+ArrowRight"],v._translateEmpty,{args:[tt,0],checker:R}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],v._translateEmpty,{args:[V,0],checker:R}],[["ArrowUp","mac+ArrowUp"],v._translateEmpty,{args:[0,-tt],checker:R}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],v._translateEmpty,{args:[0,-V],checker:R}],[["ArrowDown","mac+ArrowDown"],v._translateEmpty,{args:[0,tt],checker:R}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],v._translateEmpty,{args:[0,V],checker:R}]]))}static initialize(v){G.AnnotationEditor.initialize(v,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const R=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(R.getPropertyValue("--freetext-padding"))}static updateDefaultParams(v,R){switch(v){case n.AnnotationEditorParamsType.FREETEXT_SIZE:c._defaultFontSize=R;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:c._defaultColor=R;break}}updateParams(v,R){switch(v){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Y(this,u,Pn).call(this,R);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Y(this,u,Cn).call(this,R);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,c._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,c._defaultColor||G.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,E)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,L)]]}_translateEmpty(v,R){this._uiManager.translateSelectedEditors(v,R,!0)}getInitialTranslation(){const v=this.parentScale;return[-c._internalPadding*v,-(c._internalPadding+t(this,E))*v]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,j)),this.editorDiv.addEventListener("focus",t(this,T)),this.editorDiv.addEventListener("blur",t(this,P)),this.editorDiv.addEventListener("input",t(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,m)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,j)),this.editorDiv.removeEventListener("focus",t(this,T)),this.editorDiv.removeEventListener("blur",t(this,P)),this.editorDiv.removeEventListener("input",t(this,f)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(v){this._focusEventsAllowed&&(super.focusin(v),v.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var v;if(this.width){Y(this,u,tn).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(v=this._initialOptions)!=null&&v.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const v=t(this,b),R=ot(this,b,Y(this,u,Rn).call(this).trimEnd());if(v===R)return;const tt=V=>{if(ot(this,b,V),!V){this.remove();return}Y(this,u,Ze).call(this),this._uiManager.rebuild(this),Y(this,u,ge).call(this)};this.addCommands({cmd:()=>{tt(R)},undo:()=>{tt(v)},mustExec:!1}),Y(this,u,ge).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(v){this.enterInEditMode()}keydown(v){v.target===this.div&&v.key==="Enter"&&(this.enterInEditMode(),v.preventDefault())}editorDivKeydown(v){c._keyboardManager.exec(this,v)}editorDivFocus(v){this.isEditing=!0}editorDivBlur(v){this.isEditing=!1}editorDivInput(v){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let v,R;this.width&&(v=this.x,R=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,m)),this.enableEditing(),G.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(V=>{var K;return(K=this.editorDiv)==null?void 0:K.setAttribute("aria-label",V)}),G.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(V=>{var K;return(K=this.editorDiv)==null?void 0:K.setAttribute("default-content",V)}),this.editorDiv.contentEditable=!0;const{style:tt}=this.editorDiv;if(tt.fontSize=`calc(${t(this,E)}px * var(--scale-factor))`,tt.color=t(this,L),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,h.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[V,K]=this.parentDimensions;if(this.annotationElementId){const{position:$}=t(this,g);let[it,w]=this.getInitialTranslation();[it,w]=this.pageTranslationToScreen(it,w);const[W,et]=this.pageDimensions,[S,s]=this.pageTranslation;let r,p;switch(this.rotation){case 0:r=v+($[0]-S)/W,p=R+this.height-($[1]-s)/et;break;case 90:r=v+($[0]-S)/W,p=R-($[1]-s)/et,[it,w]=[w,-it];break;case 180:r=v-this.width+($[0]-S)/W,p=R-($[1]-s)/et,[it,w]=[-it,-w];break;case 270:r=v+($[0]-S-this.height*et)/W,p=R+($[1]-s-this.width*W)/et,[it,w]=[-w,it];break}this.setAt(r*V,p*K,it,w)}else this.setAt(v*V,R*K,this.width*V,this.height*K);Y(this,u,Ze).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(v,R,tt){let V=null;if(v instanceof H.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:$,fontColor:it},rect:w,rotation:W,id:et},textContent:S,textPosition:s,parent:{page:{pageNumber:r}}}=v;if(!S||S.length===0)return null;V=v={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(it),fontSize:$,value:S.join(`
`),position:s,pageIndex:r-1,rect:w,rotation:W,id:et,deleted:!1}}const K=super.deserialize(v,R,tt);return ot(K,E,v.fontSize),ot(K,L,n.Util.makeHexColor(...v.color)),ot(K,b,v.value),K.annotationElementId=v.id||null,ot(K,g,V),K}serialize(v=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const R=c._internalPadding*this.parentScale,tt=this.getRect(R,R),V=G.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,L)),K={annotationType:n.AnnotationEditorType.FREETEXT,color:V,fontSize:t(this,E),value:t(this,b),pageIndex:this.pageIndex,rect:tt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return v?K:this.annotationElementId&&!Y(this,u,kn).call(this,K)?null:(K.id=this.annotationElementId,K)}};P=new WeakMap,T=new WeakMap,f=new WeakMap,j=new WeakMap,L=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakSet,Pn=function(v){const R=V=>{this.editorDiv.style.fontSize=`calc(${V}px * var(--scale-factor))`,this.translate(0,-(V-t(this,E))*this.parentScale),ot(this,E,V),Y(this,u,ge).call(this)},tt=t(this,E);this.addCommands({cmd:()=>{R(v)},undo:()=>{R(tt)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Cn=function(v){const R=t(this,L);this.addCommands({cmd:()=>{ot(this,L,this.editorDiv.style.color=v)},undo:()=>{ot(this,L,this.editorDiv.style.color=R)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Rn=function(){const v=this.editorDiv.getElementsByTagName("div");if(v.length===0)return this.editorDiv.innerText;const R=[];for(const tt of v)R.push(tt.innerText.replace(/\r\n?|\n/,""));return R.join(`
`)},ge=function(){const[v,R]=this.parentDimensions;let tt;if(this.isAttachedToDOM)tt=this.div.getBoundingClientRect();else{const{currentLayer:V,div:K}=this,$=K.style.display;K.style.display="hidden",V.div.append(this.div),tt=K.getBoundingClientRect(),K.remove(),K.style.display=$}this.rotation%180===this.parentRotation%180?(this.width=tt.width/v,this.height=tt.height/R):(this.width=tt.height/v,this.height=tt.width/R),this.fixAndSetPosition()},Ze=function(){if(this.editorDiv.replaceChildren(),!!t(this,b))for(const v of t(this,b).split(`
`)){const R=document.createElement("div");R.append(v?document.createTextNode(v):document.createElement("br")),this.editorDiv.append(R)}},kn=function(v){const{value:R,fontSize:tt,color:V,rect:K,pageIndex:$}=t(this,g);return v.value!==R||v.fontSize!==tt||v.rect.some((it,w)=>Math.abs(it-K[w])>=1)||v.color.some((it,w)=>it!==V[w])||v.pageIndex!==$},tn=function(v=!1){if(!this.annotationElementId)return;if(Y(this,u,ge).call(this),!v&&(this.width===0||this.height===0)){setTimeout(()=>Y(this,u,tn).call(this,!0),0);return}const R=c._internalPadding*this.parentScale;t(this,g).rect=this.getRect(R,R)},Kt(c,"_freeTextDefaultContent",""),Kt(c,"_internalPadding",0),Kt(c,"_defaultColor",null),Kt(c,"_defaultFontSize",10),Kt(c,"_type","freetext");let ht=c;e.FreeTextEditor=ht},(C,e,B)=>{var p,D,ie,Fn,nt,ct,ft,bt,mt,_t,J,Q,_,N,X,st,pt,Et,At,Z,Tt,xt,Mn,Te,en,nn,It,$t,qt,vt,at,lt,Rt,sn,Gt,U,gt,wt,Dn,rn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=B(1),h=B(6),G=B(3),H=B(30),ht=B(31),P=B(32);const T=1e3,f=9,j=new WeakSet;function L(Ct){return{width:Ct[2]-Ct[0],height:Ct[3]-Ct[1]}}class b{static create(k){switch(k.data.annotationType){case n.AnnotationType.LINK:return new E(k);case n.AnnotationType.TEXT:return new g(k);case n.AnnotationType.WIDGET:switch(k.data.fieldType){case"Tx":return new y(k);case"Btn":return k.data.radioButton?new i(k):k.data.checkBox?new A(k):new d(k);case"Ch":return new o(k);case"Sig":return new M(k)}return new u(k);case n.AnnotationType.POPUP:return new l(k);case n.AnnotationType.FREETEXT:return new I(k);case n.AnnotationType.LINE:return new a(k);case n.AnnotationType.SQUARE:return new v(k);case n.AnnotationType.CIRCLE:return new R(k);case n.AnnotationType.POLYLINE:return new tt(k);case n.AnnotationType.CARET:return new K(k);case n.AnnotationType.INK:return new $(k);case n.AnnotationType.POLYGON:return new V(k);case n.AnnotationType.HIGHLIGHT:return new it(k);case n.AnnotationType.UNDERLINE:return new w(k);case n.AnnotationType.SQUIGGLY:return new W(k);case n.AnnotationType.STRIKEOUT:return new et(k);case n.AnnotationType.STAMP:return new S(k);case n.AnnotationType.FILEATTACHMENT:return new s(k);default:return new m(k)}}}const F=class F{constructor(k,{isRenderable:x=!1,ignoreBorder:z=!1,createQuadrilaterals:dt=!1}={}){rt(this,p,!1);this.isRenderable=x,this.data=k.data,this.layer=k.layer,this.linkService=k.linkService,this.downloadManager=k.downloadManager,this.imageResourcesPath=k.imageResourcesPath,this.renderForms=k.renderForms,this.svgFactory=k.svgFactory,this.annotationStorage=k.annotationStorage,this.enableScripting=k.enableScripting,this.hasJSActions=k.hasJSActions,this._fieldObjects=k.fieldObjects,this.parent=k.parent,x&&(this.container=this._createContainer(z)),dt&&this._createQuadrilaterals()}static _hasPopupData({titleObj:k,contentsObj:x,richText:z}){return!!(k!=null&&k.str||x!=null&&x.str||z!=null&&z.str)}get hasPopupData(){return F._hasPopupData(this.data)}_createContainer(k){const{data:x,parent:{page:z,viewport:dt}}=this,ut=document.createElement("section");ut.setAttribute("data-annotation-id",x.id),this instanceof u||(ut.tabIndex=T),ut.style.zIndex=this.parent.zIndex++,this.data.popupRef&&ut.setAttribute("aria-haspopup","dialog"),x.noRotate&&ut.classList.add("norotate");const{pageWidth:yt,pageHeight:St,pageX:Lt,pageY:Ft}=dt.rawDims;if(!x.rect||this instanceof l){const{rotation:Bt}=x;return!x.hasOwnCanvas&&Bt!==0&&this.setRotation(Bt,ut),ut}const{width:Pt,height:Ht}=L(x.rect),Mt=n.Util.normalizeRect([x.rect[0],z.view[3]-x.rect[1]+z.view[1],x.rect[2],z.view[3]-x.rect[3]+z.view[1]]);if(!k&&x.borderStyle.width>0){ut.style.borderWidth=`${x.borderStyle.width}px`;const Bt=x.borderStyle.horizontalCornerRadius,Wt=x.borderStyle.verticalCornerRadius;if(Bt>0||Wt>0){const Yt=`calc(${Bt}px * var(--scale-factor)) / calc(${Wt}px * var(--scale-factor))`;ut.style.borderRadius=Yt}else if(this instanceof i){const Yt=`calc(${Pt}px * var(--scale-factor)) / calc(${Ht}px * var(--scale-factor))`;ut.style.borderRadius=Yt}switch(x.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:ut.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:ut.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:ut.style.borderBottomStyle="solid";break}const Xt=x.borderColor||null;Xt?(ot(this,p,!0),ut.style.borderColor=n.Util.makeHexColor(Xt[0]|0,Xt[1]|0,Xt[2]|0)):ut.style.borderWidth=0}ut.style.left=`${100*(Mt[0]-Lt)/yt}%`,ut.style.top=`${100*(Mt[1]-Ft)/St}%`;const{rotation:Ot}=x;return x.hasOwnCanvas||Ot===0?(ut.style.width=`${100*Pt/yt}%`,ut.style.height=`${100*Ht/St}%`):this.setRotation(Ot,ut),ut}setRotation(k,x=this.container){if(!this.data.rect)return;const{pageWidth:z,pageHeight:dt}=this.parent.viewport.rawDims,{width:ut,height:yt}=L(this.data.rect);let St,Lt;k%180===0?(St=100*ut/z,Lt=100*yt/dt):(St=100*yt/z,Lt=100*ut/dt),x.style.width=`${St}%`,x.style.height=`${Lt}%`,x.setAttribute("data-main-rotation",(360-k)%360)}get _commonActions(){const k=(x,z,dt)=>{const ut=dt.detail[x],yt=ut[0],St=ut.slice(1);dt.target.style[z]=H.ColorConverters[`${yt}_HTML`](St),this.annotationStorage.setValue(this.data.id,{[z]:H.ColorConverters[`${yt}_rgb`](St)})};return(0,n.shadow)(this,"_commonActions",{display:x=>{const{display:z}=x.detail,dt=z%2===1;this.container.style.visibility=dt?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:dt,noPrint:z===1||z===2})},print:x=>{this.annotationStorage.setValue(this.data.id,{noPrint:!x.detail.print})},hidden:x=>{const{hidden:z}=x.detail;this.container.style.visibility=z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:z,noView:z})},focus:x=>{setTimeout(()=>x.target.focus({preventScroll:!1}),0)},userName:x=>{x.target.title=x.detail.userName},readonly:x=>{x.target.disabled=x.detail.readonly},required:x=>{this._setRequired(x.target,x.detail.required)},bgColor:x=>{k("bgColor","backgroundColor",x)},fillColor:x=>{k("fillColor","backgroundColor",x)},fgColor:x=>{k("fgColor","color",x)},textColor:x=>{k("textColor","color",x)},borderColor:x=>{k("borderColor","borderColor",x)},strokeColor:x=>{k("strokeColor","borderColor",x)},rotation:x=>{const z=x.detail.rotation;this.setRotation(z),this.annotationStorage.setValue(this.data.id,{rotation:z})}})}_dispatchEventFromSandbox(k,x){const z=this._commonActions;for(const dt of Object.keys(x.detail)){const ut=k[dt]||z[dt];ut==null||ut(x)}}_setDefaultPropertiesFromJS(k){if(!this.enableScripting)return;const x=this.annotationStorage.getRawValue(this.data.id);if(!x)return;const z=this._commonActions;for(const[dt,ut]of Object.entries(x)){const yt=z[dt];if(yt){const St={detail:{[dt]:ut},target:k};yt(St),delete x[dt]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:k}=this.data;if(!k)return;const[x,z,dt,ut]=this.data.rect;if(k.length===1){const[,{x:Wt,y:Xt},{x:Yt,y:Qt}]=k[0];if(dt===Wt&&ut===Xt&&x===Yt&&z===Qt)return}const{style:yt}=this.container;let St;if(t(this,p)){const{borderColor:Wt,borderWidth:Xt}=yt;yt.borderWidth=0,St=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Wt}" stroke-width="${Xt}">`],this.container.classList.add("hasBorder")}const Lt=dt-x,Ft=ut-z,{svgFactory:Pt}=this,Ht=Pt.createElement("svg");Ht.classList.add("quadrilateralsContainer"),Ht.setAttribute("width",0),Ht.setAttribute("height",0);const Mt=Pt.createElement("defs");Ht.append(Mt);const Ot=Pt.createElement("clipPath"),Bt=`clippath_${this.data.id}`;Ot.setAttribute("id",Bt),Ot.setAttribute("clipPathUnits","objectBoundingBox"),Mt.append(Ot);for(const[,{x:Wt,y:Xt},{x:Yt,y:Qt}]of k){const Jt=Pt.createElement("rect"),te=(Yt-x)/Lt,ne=(ut-Xt)/Ft,se=(Wt-Yt)/Lt,pn=(Xt-Qt)/Ft;Jt.setAttribute("x",te),Jt.setAttribute("y",ne),Jt.setAttribute("width",se),Jt.setAttribute("height",pn),Ot.append(Jt),St==null||St.push(`<rect vector-effect="non-scaling-stroke" x="${te}" y="${ne}" width="${se}" height="${pn}"/>`)}t(this,p)&&(St.push("</g></svg>')"),yt.backgroundImage=St.join("")),this.container.append(Ht),this.container.style.clipPath=`url(#${Bt})`}_createPopup(){const{container:k,data:x}=this;k.setAttribute("aria-haspopup","dialog");const z=new l({data:{color:x.color,titleObj:x.titleObj,modificationDate:x.modificationDate,contentsObj:x.contentsObj,richText:x.richText,parentRect:x.rect,borderStyle:0,id:`popup_${x.id}`,rotation:x.rotation},parent:this.parent,elements:[this]});this.parent.div.append(z.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(k,x=null){const z=[];if(this._fieldObjects){const dt=this._fieldObjects[k];if(dt)for(const{page:ut,id:yt,exportValues:St}of dt){if(ut===-1||yt===x)continue;const Lt=typeof St=="string"?St:null,Ft=document.querySelector(`[data-element-id="${yt}"]`);if(Ft&&!j.has(Ft)){(0,n.warn)(`_getElementsByName - element not allowed: ${yt}`);continue}z.push({id:yt,exportValue:Lt,domElement:Ft})}return z}for(const dt of document.getElementsByName(k)){const{exportValue:ut}=dt,yt=dt.getAttribute("data-element-id");yt!==x&&j.has(dt)&&z.push({id:yt,exportValue:ut,domElement:dt})}return z}show(){var k;this.container&&(this.container.hidden=!1),(k=this.popup)==null||k.maybeShow()}hide(){var k;this.container&&(this.container.hidden=!0),(k=this.popup)==null||k.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const k=this.getElementsToTriggerPopup();if(Array.isArray(k))for(const x of k)x.classList.add("highlightArea");else k.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:k,data:{id:x}}=this;this.container.addEventListener("dblclick",()=>{var z;(z=this.linkService.eventBus)==null||z.dispatch("switchannotationeditormode",{source:this,mode:k,editId:x})})}};p=new WeakMap;let m=F;class E extends m{constructor(x,z=null){super(x,{isRenderable:!0,ignoreBorder:!!(z!=null&&z.ignoreBorder),createQuadrilaterals:!0});rt(this,D);this.isTooltipOnly=x.data.isTooltipOnly}render(){const{data:x,linkService:z}=this,dt=document.createElement("a");dt.setAttribute("data-element-id",x.id);let ut=!1;return x.url?(z.addLinkAttributes(dt,x.url,x.newWindow),ut=!0):x.action?(this._bindNamedAction(dt,x.action),ut=!0):x.attachment?(this._bindAttachment(dt,x.attachment),ut=!0):x.setOCGState?(Y(this,D,Fn).call(this,dt,x.setOCGState),ut=!0):x.dest?(this._bindLink(dt,x.dest),ut=!0):(x.actions&&(x.actions.Action||x.actions["Mouse Up"]||x.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(dt,x),ut=!0),x.resetForm?(this._bindResetFormAction(dt,x.resetForm),ut=!0):this.isTooltipOnly&&!ut&&(this._bindLink(dt,""),ut=!0)),this.container.classList.add("linkAnnotation"),ut&&this.container.append(dt),this.container}_bindLink(x,z){x.href=this.linkService.getDestinationHash(z),x.onclick=()=>(z&&this.linkService.goToDestination(z),!1),(z||z==="")&&Y(this,D,ie).call(this)}_bindNamedAction(x,z){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeNamedAction(z),!1),Y(this,D,ie).call(this)}_bindAttachment(x,z){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>{var dt;return(dt=this.downloadManager)==null||dt.openOrDownloadData(this.container,z.content,z.filename),!1},Y(this,D,ie).call(this)}_bindJSAction(x,z){x.href=this.linkService.getAnchorUrl("");const dt=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const ut of Object.keys(z.actions)){const yt=dt.get(ut);yt&&(x[yt]=()=>{var St;return(St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:z.id,name:ut}}),!1})}x.onclick||(x.onclick=()=>!1),Y(this,D,ie).call(this)}_bindResetFormAction(x,z){const dt=x.onclick;if(dt||(x.href=this.linkService.getAnchorUrl("")),Y(this,D,ie).call(this),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),dt||(x.onclick=()=>!1);return}x.onclick=()=>{var Ht;dt==null||dt();const{fields:ut,refs:yt,include:St}=z,Lt=[];if(ut.length!==0||yt.length!==0){const Mt=new Set(yt);for(const Ot of ut){const Bt=this._fieldObjects[Ot]||[];for(const{id:Wt}of Bt)Mt.add(Wt)}for(const Ot of Object.values(this._fieldObjects))for(const Bt of Ot)Mt.has(Bt.id)===St&&Lt.push(Bt)}else for(const Mt of Object.values(this._fieldObjects))Lt.push(...Mt);const Ft=this.annotationStorage,Pt=[];for(const Mt of Lt){const{id:Ot}=Mt;switch(Pt.push(Ot),Mt.type){case"text":{const Wt=Mt.defaultValue||"";Ft.setValue(Ot,{value:Wt});break}case"checkbox":case"radiobutton":{const Wt=Mt.defaultValue===Mt.exportValues;Ft.setValue(Ot,{value:Wt});break}case"combobox":case"listbox":{const Wt=Mt.defaultValue||"";Ft.setValue(Ot,{value:Wt});break}default:continue}const Bt=document.querySelector(`[data-element-id="${Ot}"]`);if(Bt){if(!j.has(Bt)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Ot}`);continue}}else continue;Bt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Pt,name:"ResetForm"}})),!1}}}D=new WeakSet,ie=function(){this.container.setAttribute("data-internal-link","")},Fn=function(x,z){x.href=this.linkService.getAnchorUrl(""),x.onclick=()=>(this.linkService.executeSetOCGState(z),!1),Y(this,D,ie).call(this)};class g extends m{constructor(k){super(k,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const k=document.createElement("img");return k.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",k.alt="[{{type}} Annotation]",k.dataset.l10nId="text_annotation_type",k.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(k),this.container}}class u extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(k){var x;this.data.hasOwnCanvas&&(((x=k.previousSibling)==null?void 0:x.nodeName)==="CANVAS"&&(k.previousSibling.hidden=!0),k.hidden=!1)}_getKeyModifier(k){const{isWin:x,isMac:z}=n.FeatureTest.platform;return x&&k.ctrlKey||z&&k.metaKey}_setEventListener(k,x,z,dt,ut){z.includes("mouse")?k.addEventListener(z,yt=>{var St;(St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:dt,value:ut(yt),shift:yt.shiftKey,modifier:this._getKeyModifier(yt)}})}):k.addEventListener(z,yt=>{var St;if(z==="blur"){if(!x.focused||!yt.relatedTarget)return;x.focused=!1}else if(z==="focus"){if(x.focused)return;x.focused=!0}ut&&((St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:dt,value:ut(yt)}}))})}_setEventListeners(k,x,z,dt){var ut,yt,St;for(const[Lt,Ft]of z)(Ft==="Action"||(ut=this.data.actions)!=null&&ut[Ft])&&((Ft==="Focus"||Ft==="Blur")&&(x||(x={focused:!1})),this._setEventListener(k,x,Lt,Ft,dt),Ft==="Focus"&&!((yt=this.data.actions)!=null&&yt.Blur)?this._setEventListener(k,x,"blur","Blur",null):Ft==="Blur"&&!((St=this.data.actions)!=null&&St.Focus)&&this._setEventListener(k,x,"focus","Focus",null))}_setBackgroundColor(k){const x=this.data.backgroundColor||null;k.style.backgroundColor=x===null?"transparent":n.Util.makeHexColor(x[0],x[1],x[2])}_setTextStyle(k){const x=["left","center","right"],{fontColor:z}=this.data.defaultAppearanceData,dt=this.data.defaultAppearanceData.fontSize||f,ut=k.style;let yt;const St=2,Lt=Ft=>Math.round(10*Ft)/10;if(this.data.multiLine){const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-St),Pt=Math.round(Ft/(n.LINE_FACTOR*dt))||1,Ht=Ft/Pt;yt=Math.min(dt,Lt(Ht/n.LINE_FACTOR))}else{const Ft=Math.abs(this.data.rect[3]-this.data.rect[1]-St);yt=Math.min(dt,Lt(Ft/n.LINE_FACTOR))}ut.fontSize=`calc(${yt}px * var(--scale-factor))`,ut.color=n.Util.makeHexColor(z[0],z[1],z[2]),this.data.textAlignment!==null&&(ut.textAlign=x[this.data.textAlignment])}_setRequired(k,x){x?k.setAttribute("required",!0):k.removeAttribute("required"),k.setAttribute("aria-required",x)}}class y extends u{constructor(k){const x=k.renderForms||!k.data.hasAppearance&&!!k.data.fieldValue;super(k,{isRenderable:x})}setPropertyOnSiblings(k,x,z,dt){const ut=this.annotationStorage;for(const yt of this._getElementsByName(k.name,k.id))yt.domElement&&(yt.domElement[x]=z),ut.setValue(yt.id,{[dt]:z})}render(){var dt,ut;const k=this.annotationStorage,x=this.data.id;this.container.classList.add("textWidgetAnnotation");let z=null;if(this.renderForms){const yt=k.getValue(x,{value:this.data.fieldValue});let St=yt.value||"";const Lt=k.getValue(x,{charLimit:this.data.maxLen}).charLimit;Lt&&St.length>Lt&&(St=St.slice(0,Lt));let Ft=yt.formattedValue||((dt=this.data.textContent)==null?void 0:dt.join(`
`))||null;Ft&&this.data.comb&&(Ft=Ft.replaceAll(/\s+/g,""));const Pt={userValue:St,formattedValue:Ft,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(z=document.createElement("textarea"),z.textContent=Ft??St,this.data.doNotScroll&&(z.style.overflowY="hidden")):(z=document.createElement("input"),z.type="text",z.setAttribute("value",Ft??St),this.data.doNotScroll&&(z.style.overflowX="hidden")),this.data.hasOwnCanvas&&(z.hidden=!0),j.add(z),z.setAttribute("data-element-id",x),z.disabled=this.data.readOnly,z.name=this.data.fieldName,z.tabIndex=T,this._setRequired(z,this.data.required),Lt&&(z.maxLength=Lt),z.addEventListener("input",Mt=>{k.setValue(x,{value:Mt.target.value}),this.setPropertyOnSiblings(z,"value",Mt.target.value,"value"),Pt.formattedValue=null}),z.addEventListener("resetform",Mt=>{const Ot=this.data.defaultFieldValue??"";z.value=Pt.userValue=Ot,Pt.formattedValue=null});let Ht=Mt=>{const{formattedValue:Ot}=Pt;Ot!=null&&(Mt.target.value=Ot),Mt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){z.addEventListener("focus",Ot=>{if(Pt.focused)return;const{target:Bt}=Ot;Pt.userValue&&(Bt.value=Pt.userValue),Pt.lastCommittedValue=Bt.value,Pt.commitKey=1,Pt.focused=!0}),z.addEventListener("updatefromsandbox",Ot=>{this.showElementAndHideCanvas(Ot.target);const Bt={value(Wt){Pt.userValue=Wt.detail.value??"",k.setValue(x,{value:Pt.userValue.toString()}),Wt.target.value=Pt.userValue},formattedValue(Wt){const{formattedValue:Xt}=Wt.detail;Pt.formattedValue=Xt,Xt!=null&&Wt.target!==document.activeElement&&(Wt.target.value=Xt),k.setValue(x,{formattedValue:Xt})},selRange(Wt){Wt.target.setSelectionRange(...Wt.detail.selRange)},charLimit:Wt=>{var Jt;const{charLimit:Xt}=Wt.detail,{target:Yt}=Wt;if(Xt===0){Yt.removeAttribute("maxLength");return}Yt.setAttribute("maxLength",Xt);let Qt=Pt.userValue;!Qt||Qt.length<=Xt||(Qt=Qt.slice(0,Xt),Yt.value=Pt.userValue=Qt,k.setValue(x,{value:Qt}),(Jt=this.linkService.eventBus)==null||Jt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Qt,willCommit:!0,commitKey:1,selStart:Yt.selectionStart,selEnd:Yt.selectionEnd}}))}};this._dispatchEventFromSandbox(Bt,Ot)}),z.addEventListener("keydown",Ot=>{var Xt;Pt.commitKey=1;let Bt=-1;if(Ot.key==="Escape"?Bt=0:Ot.key==="Enter"&&!this.data.multiLine?Bt=2:Ot.key==="Tab"&&(Pt.commitKey=3),Bt===-1)return;const{value:Wt}=Ot.target;Pt.lastCommittedValue!==Wt&&(Pt.lastCommittedValue=Wt,Pt.userValue=Wt,(Xt=this.linkService.eventBus)==null||Xt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Wt,willCommit:!0,commitKey:Bt,selStart:Ot.target.selectionStart,selEnd:Ot.target.selectionEnd}}))});const Mt=Ht;Ht=null,z.addEventListener("blur",Ot=>{var Wt;if(!Pt.focused||!Ot.relatedTarget)return;Pt.focused=!1;const{value:Bt}=Ot.target;Pt.userValue=Bt,Pt.lastCommittedValue!==Bt&&((Wt=this.linkService.eventBus)==null||Wt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Bt,willCommit:!0,commitKey:Pt.commitKey,selStart:Ot.target.selectionStart,selEnd:Ot.target.selectionEnd}})),Mt(Ot)}),(ut=this.data.actions)!=null&&ut.Keystroke&&z.addEventListener("beforeinput",Ot=>{var ne;Pt.lastCommittedValue=null;const{data:Bt,target:Wt}=Ot,{value:Xt,selectionStart:Yt,selectionEnd:Qt}=Wt;let Jt=Yt,te=Qt;switch(Ot.inputType){case"deleteWordBackward":{const se=Xt.substring(0,Yt).match(/\w*[^\w]*$/);se&&(Jt-=se[0].length);break}case"deleteWordForward":{const se=Xt.substring(Yt).match(/^[^\w]*\w*/);se&&(te+=se[0].length);break}case"deleteContentBackward":Yt===Qt&&(Jt-=1);break;case"deleteContentForward":Yt===Qt&&(te+=1);break}Ot.preventDefault(),(ne=this.linkService.eventBus)==null||ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Xt,change:Bt||"",willCommit:!1,selStart:Jt,selEnd:te}})}),this._setEventListeners(z,Pt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ot=>Ot.target.value)}if(Ht&&z.addEventListener("blur",Ht),this.data.comb){const Ot=(this.data.rect[2]-this.data.rect[0])/Lt;z.classList.add("comb"),z.style.letterSpacing=`calc(${Ot}px * var(--scale-factor) - 1ch)`}}else z=document.createElement("div"),z.textContent=this.data.fieldValue,z.style.verticalAlign="middle",z.style.display="table-cell";return this._setTextStyle(z),this._setBackgroundColor(z),this._setDefaultPropertiesFromJS(z),this.container.append(z),this.container}}class M extends u{constructor(k){super(k,{isRenderable:!!k.data.hasOwnCanvas})}}class A extends u{constructor(k){super(k,{isRenderable:k.renderForms})}render(){const k=this.annotationStorage,x=this.data,z=x.id;let dt=k.getValue(z,{value:x.exportValue===x.fieldValue}).value;typeof dt=="string"&&(dt=dt!=="Off",k.setValue(z,{value:dt})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const ut=document.createElement("input");return j.add(ut),ut.setAttribute("data-element-id",z),ut.disabled=x.readOnly,this._setRequired(ut,this.data.required),ut.type="checkbox",ut.name=x.fieldName,dt&&ut.setAttribute("checked",!0),ut.setAttribute("exportValue",x.exportValue),ut.tabIndex=T,ut.addEventListener("change",yt=>{const{name:St,checked:Lt}=yt.target;for(const Ft of this._getElementsByName(St,z)){const Pt=Lt&&Ft.exportValue===x.exportValue;Ft.domElement&&(Ft.domElement.checked=Pt),k.setValue(Ft.id,{value:Pt})}k.setValue(z,{value:Lt})}),ut.addEventListener("resetform",yt=>{const St=x.defaultFieldValue||"Off";yt.target.checked=St===x.exportValue}),this.enableScripting&&this.hasJSActions&&(ut.addEventListener("updatefromsandbox",yt=>{const St={value(Lt){Lt.target.checked=Lt.detail.value!=="Off",k.setValue(z,{value:Lt.target.checked})}};this._dispatchEventFromSandbox(St,yt)}),this._setEventListeners(ut,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],yt=>yt.target.checked)),this._setBackgroundColor(ut),this._setDefaultPropertiesFromJS(ut),this.container.append(ut),this.container}}class i extends u{constructor(k){super(k,{isRenderable:k.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const k=this.annotationStorage,x=this.data,z=x.id;let dt=k.getValue(z,{value:x.fieldValue===x.buttonValue}).value;typeof dt=="string"&&(dt=dt!==x.buttonValue,k.setValue(z,{value:dt}));const ut=document.createElement("input");if(j.add(ut),ut.setAttribute("data-element-id",z),ut.disabled=x.readOnly,this._setRequired(ut,this.data.required),ut.type="radio",ut.name=x.fieldName,dt&&ut.setAttribute("checked",!0),ut.tabIndex=T,ut.addEventListener("change",yt=>{const{name:St,checked:Lt}=yt.target;for(const Ft of this._getElementsByName(St,z))k.setValue(Ft.id,{value:!1});k.setValue(z,{value:Lt})}),ut.addEventListener("resetform",yt=>{const St=x.defaultFieldValue;yt.target.checked=St!=null&&St===x.buttonValue}),this.enableScripting&&this.hasJSActions){const yt=x.buttonValue;ut.addEventListener("updatefromsandbox",St=>{const Lt={value:Ft=>{const Pt=yt===Ft.detail.value;for(const Ht of this._getElementsByName(Ft.target.name)){const Mt=Pt&&Ht.id===z;Ht.domElement&&(Ht.domElement.checked=Mt),k.setValue(Ht.id,{value:Mt})}}};this._dispatchEventFromSandbox(Lt,St)}),this._setEventListeners(ut,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],St=>St.target.checked)}return this._setBackgroundColor(ut),this._setDefaultPropertiesFromJS(ut),this.container.append(ut),this.container}}class d extends E{constructor(k){super(k,{ignoreBorder:k.data.hasAppearance})}render(){const k=super.render();k.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(k.title=this.data.alternativeText);const x=k.lastChild;return this.enableScripting&&this.hasJSActions&&x&&(this._setDefaultPropertiesFromJS(x),x.addEventListener("updatefromsandbox",z=>{this._dispatchEventFromSandbox({},z)})),k}}class o extends u{constructor(k){super(k,{isRenderable:k.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const k=this.annotationStorage,x=this.data.id,z=k.getValue(x,{value:this.data.fieldValue}),dt=document.createElement("select");j.add(dt),dt.setAttribute("data-element-id",x),dt.disabled=this.data.readOnly,this._setRequired(dt,this.data.required),dt.name=this.data.fieldName,dt.tabIndex=T;let ut=this.data.combo&&this.data.options.length>0;this.data.combo||(dt.size=this.data.options.length,this.data.multiSelect&&(dt.multiple=!0)),dt.addEventListener("resetform",Pt=>{const Ht=this.data.defaultFieldValue;for(const Mt of dt.options)Mt.selected=Mt.value===Ht});for(const Pt of this.data.options){const Ht=document.createElement("option");Ht.textContent=Pt.displayValue,Ht.value=Pt.exportValue,z.value.includes(Pt.exportValue)&&(Ht.setAttribute("selected",!0),ut=!1),dt.append(Ht)}let yt=null;if(ut){const Pt=document.createElement("option");Pt.value=" ",Pt.setAttribute("hidden",!0),Pt.setAttribute("selected",!0),dt.prepend(Pt),yt=()=>{Pt.remove(),dt.removeEventListener("input",yt),yt=null},dt.addEventListener("input",yt)}const St=Pt=>{const Ht=Pt?"value":"textContent",{options:Mt,multiple:Ot}=dt;return Ot?Array.prototype.filter.call(Mt,Bt=>Bt.selected).map(Bt=>Bt[Ht]):Mt.selectedIndex===-1?null:Mt[Mt.selectedIndex][Ht]};let Lt=St(!1);const Ft=Pt=>{const Ht=Pt.target.options;return Array.prototype.map.call(Ht,Mt=>({displayValue:Mt.textContent,exportValue:Mt.value}))};return this.enableScripting&&this.hasJSActions?(dt.addEventListener("updatefromsandbox",Pt=>{const Ht={value(Mt){yt==null||yt();const Ot=Mt.detail.value,Bt=new Set(Array.isArray(Ot)?Ot:[Ot]);for(const Wt of dt.options)Wt.selected=Bt.has(Wt.value);k.setValue(x,{value:St(!0)}),Lt=St(!1)},multipleSelection(Mt){dt.multiple=!0},remove(Mt){const Ot=dt.options,Bt=Mt.detail.remove;Ot[Bt].selected=!1,dt.remove(Bt),Ot.length>0&&Array.prototype.findIndex.call(Ot,Xt=>Xt.selected)===-1&&(Ot[0].selected=!0),k.setValue(x,{value:St(!0),items:Ft(Mt)}),Lt=St(!1)},clear(Mt){for(;dt.length!==0;)dt.remove(0);k.setValue(x,{value:null,items:[]}),Lt=St(!1)},insert(Mt){const{index:Ot,displayValue:Bt,exportValue:Wt}=Mt.detail.insert,Xt=dt.children[Ot],Yt=document.createElement("option");Yt.textContent=Bt,Yt.value=Wt,Xt?Xt.before(Yt):dt.append(Yt),k.setValue(x,{value:St(!0),items:Ft(Mt)}),Lt=St(!1)},items(Mt){const{items:Ot}=Mt.detail;for(;dt.length!==0;)dt.remove(0);for(const Bt of Ot){const{displayValue:Wt,exportValue:Xt}=Bt,Yt=document.createElement("option");Yt.textContent=Wt,Yt.value=Xt,dt.append(Yt)}dt.options.length>0&&(dt.options[0].selected=!0),k.setValue(x,{value:St(!0),items:Ft(Mt)}),Lt=St(!1)},indices(Mt){const Ot=new Set(Mt.detail.indices);for(const Bt of Mt.target.options)Bt.selected=Ot.has(Bt.index);k.setValue(x,{value:St(!0)}),Lt=St(!1)},editable(Mt){Mt.target.disabled=!Mt.detail.editable}};this._dispatchEventFromSandbox(Ht,Pt)}),dt.addEventListener("input",Pt=>{var Mt;const Ht=St(!0);k.setValue(x,{value:Ht}),Pt.preventDefault(),(Mt=this.linkService.eventBus)==null||Mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:x,name:"Keystroke",value:Lt,changeEx:Ht,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(dt,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Pt=>Pt.target.value)):dt.addEventListener("input",function(Pt){k.setValue(x,{value:St(!0)})}),this.data.combo&&this._setTextStyle(dt),this._setBackgroundColor(dt),this._setDefaultPropertiesFromJS(dt),this.container.append(dt),this.container}}class l extends m{constructor(k){const{data:x,elements:z}=k;super(k,{isRenderable:m._hasPopupData(x)}),this.elements=z}render(){this.container.classList.add("popupAnnotation");const k=new c({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),x=[];for(const z of this.elements)z.popup=k,x.push(z.data.id),z.addHighlightArea();return this.container.setAttribute("aria-controls",x.map(z=>`${n.AnnotationPrefix}${z}`).join(",")),this.container}}class c{constructor({container:k,color:x,elements:z,titleObj:dt,modificationDate:ut,contentsObj:yt,richText:St,parent:Lt,rect:Ft,parentRect:Pt,open:Ht}){rt(this,xt);rt(this,nt,null);rt(this,ct,Y(this,xt,Mn).bind(this));rt(this,ft,Y(this,xt,nn).bind(this));rt(this,bt,Y(this,xt,en).bind(this));rt(this,mt,Y(this,xt,Te).bind(this));rt(this,_t,null);rt(this,J,null);rt(this,Q,null);rt(this,_,null);rt(this,N,null);rt(this,X,null);rt(this,st,!1);rt(this,pt,null);rt(this,Et,null);rt(this,At,null);rt(this,Z,null);rt(this,Tt,!1);var Ot;ot(this,J,k),ot(this,Z,dt),ot(this,Q,yt),ot(this,At,St),ot(this,N,Lt),ot(this,_t,x),ot(this,Et,Ft),ot(this,X,Pt),ot(this,_,z);const Mt=h.PDFDateString.toDateObject(ut);Mt&&ot(this,nt,Lt.l10n.get("annotation_date_string",{date:Mt.toLocaleDateString(),time:Mt.toLocaleTimeString()})),this.trigger=z.flatMap(Bt=>Bt.getElementsToTriggerPopup());for(const Bt of this.trigger)Bt.addEventListener("click",t(this,mt)),Bt.addEventListener("mouseenter",t(this,bt)),Bt.addEventListener("mouseleave",t(this,ft)),Bt.classList.add("popupTriggerArea");for(const Bt of z)(Ot=Bt.container)==null||Ot.addEventListener("keydown",t(this,ct));t(this,J).hidden=!0,Ht&&Y(this,xt,Te).call(this)}render(){if(t(this,pt))return;const{page:{view:k},viewport:{rawDims:{pageWidth:x,pageHeight:z,pageX:dt,pageY:ut}}}=t(this,N),yt=ot(this,pt,document.createElement("div"));if(yt.className="popup",t(this,_t)){const Jt=yt.style.outlineColor=n.Util.makeHexColor(...t(this,_t));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?yt.style.backgroundColor=`color-mix(in srgb, ${Jt} 30%, white)`:yt.style.backgroundColor=n.Util.makeHexColor(...t(this,_t).map(ne=>Math.floor(.7*(255-ne)+ne)))}const St=document.createElement("span");St.className="header";const Lt=document.createElement("h1");if(St.append(Lt),{dir:Lt.dir,str:Lt.textContent}=t(this,Z),yt.append(St),t(this,nt)){const Jt=document.createElement("span");Jt.classList.add("popupDate"),t(this,nt).then(te=>{Jt.textContent=te}),St.append(Jt)}const Ft=t(this,Q),Pt=t(this,At);if(Pt!=null&&Pt.str&&(!(Ft!=null&&Ft.str)||Ft.str===Pt.str))P.XfaLayer.render({xfaHtml:Pt.html,intent:"richText",div:yt}),yt.lastChild.classList.add("richText","popupContent");else{const Jt=this._formatContents(Ft);yt.append(Jt)}let Ht=!!t(this,X),Mt=Ht?t(this,X):t(this,Et);for(const Jt of t(this,_))if(!Mt||n.Util.intersect(Jt.data.rect,Mt)!==null){Mt=Jt.data.rect,Ht=!0;break}const Ot=n.Util.normalizeRect([Mt[0],k[3]-Mt[1]+k[1],Mt[2],k[3]-Mt[3]+k[1]]),Wt=Ht?Mt[2]-Mt[0]+5:0,Xt=Ot[0]+Wt,Yt=Ot[1],{style:Qt}=t(this,J);Qt.left=`${100*(Xt-dt)/x}%`,Qt.top=`${100*(Yt-ut)/z}%`,t(this,J).append(yt)}_formatContents({str:k,dir:x}){const z=document.createElement("p");z.classList.add("popupContent"),z.dir=x;const dt=k.split(/(?:\r\n?|\n)/);for(let ut=0,yt=dt.length;ut<yt;++ut){const St=dt[ut];z.append(document.createTextNode(St)),ut<yt-1&&z.append(document.createElement("br"))}return z}forceHide(){ot(this,Tt,this.isVisible),t(this,Tt)&&(t(this,J).hidden=!0)}maybeShow(){t(this,Tt)&&(ot(this,Tt,!1),t(this,J).hidden=!1)}get isVisible(){return t(this,J).hidden===!1}}nt=new WeakMap,ct=new WeakMap,ft=new WeakMap,bt=new WeakMap,mt=new WeakMap,_t=new WeakMap,J=new WeakMap,Q=new WeakMap,_=new WeakMap,N=new WeakMap,X=new WeakMap,st=new WeakMap,pt=new WeakMap,Et=new WeakMap,At=new WeakMap,Z=new WeakMap,Tt=new WeakMap,xt=new WeakSet,Mn=function(k){k.altKey||k.shiftKey||k.ctrlKey||k.metaKey||(k.key==="Enter"||k.key==="Escape"&&t(this,st))&&Y(this,xt,Te).call(this)},Te=function(){ot(this,st,!t(this,st)),t(this,st)?(Y(this,xt,en).call(this),t(this,J).addEventListener("click",t(this,mt)),t(this,J).addEventListener("keydown",t(this,ct))):(Y(this,xt,nn).call(this),t(this,J).removeEventListener("click",t(this,mt)),t(this,J).removeEventListener("keydown",t(this,ct)))},en=function(){t(this,pt)||this.render(),this.isVisible?t(this,st)&&t(this,J).classList.add("focused"):(t(this,J).hidden=!1,t(this,J).style.zIndex=parseInt(t(this,J).style.zIndex)+1e3)},nn=function(){t(this,J).classList.remove("focused"),!(t(this,st)||!this.isVisible)&&(t(this,J).hidden=!0,t(this,J).style.zIndex=parseInt(t(this,J).style.zIndex)-1e3)};class I extends m{constructor(k){super(k,{isRenderable:!0,ignoreBorder:!0}),this.textContent=k.data.textContent,this.textPosition=k.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const k=document.createElement("div");k.classList.add("annotationTextContent"),k.setAttribute("role","comment");for(const x of this.textContent){const z=document.createElement("span");z.textContent=x,k.append(z)}this.container.append(k)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=I;class a extends m{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});rt(this,It,null)}render(){this.container.classList.add("lineAnnotation");const x=this.data,{width:z,height:dt}=L(x.rect),ut=this.svgFactory.create(z,dt,!0),yt=ot(this,It,this.svgFactory.createElement("svg:line"));return yt.setAttribute("x1",x.rect[2]-x.lineCoordinates[0]),yt.setAttribute("y1",x.rect[3]-x.lineCoordinates[1]),yt.setAttribute("x2",x.rect[2]-x.lineCoordinates[2]),yt.setAttribute("y2",x.rect[3]-x.lineCoordinates[3]),yt.setAttribute("stroke-width",x.borderStyle.width||1),yt.setAttribute("stroke","transparent"),yt.setAttribute("fill","transparent"),ut.append(yt),this.container.append(ut),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,It)}addHighlightArea(){this.container.classList.add("highlightArea")}}It=new WeakMap;class v extends m{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});rt(this,$t,null)}render(){this.container.classList.add("squareAnnotation");const x=this.data,{width:z,height:dt}=L(x.rect),ut=this.svgFactory.create(z,dt,!0),yt=x.borderStyle.width,St=ot(this,$t,this.svgFactory.createElement("svg:rect"));return St.setAttribute("x",yt/2),St.setAttribute("y",yt/2),St.setAttribute("width",z-yt),St.setAttribute("height",dt-yt),St.setAttribute("stroke-width",yt||1),St.setAttribute("stroke","transparent"),St.setAttribute("fill","transparent"),ut.append(St),this.container.append(ut),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,$t)}addHighlightArea(){this.container.classList.add("highlightArea")}}$t=new WeakMap;class R extends m{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});rt(this,qt,null)}render(){this.container.classList.add("circleAnnotation");const x=this.data,{width:z,height:dt}=L(x.rect),ut=this.svgFactory.create(z,dt,!0),yt=x.borderStyle.width,St=ot(this,qt,this.svgFactory.createElement("svg:ellipse"));return St.setAttribute("cx",z/2),St.setAttribute("cy",dt/2),St.setAttribute("rx",z/2-yt/2),St.setAttribute("ry",dt/2-yt/2),St.setAttribute("stroke-width",yt||1),St.setAttribute("stroke","transparent"),St.setAttribute("fill","transparent"),ut.append(St),this.container.append(ut),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,qt)}addHighlightArea(){this.container.classList.add("highlightArea")}}qt=new WeakMap;class tt extends m{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});rt(this,vt,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:z,height:dt}=L(x.rect),ut=this.svgFactory.create(z,dt,!0);let yt=[];for(const Lt of x.vertices){const Ft=Lt.x-x.rect[0],Pt=x.rect[3]-Lt.y;yt.push(Ft+","+Pt)}yt=yt.join(" ");const St=ot(this,vt,this.svgFactory.createElement(this.svgElementName));return St.setAttribute("points",yt),St.setAttribute("stroke-width",x.borderStyle.width||1),St.setAttribute("stroke","transparent"),St.setAttribute("fill","transparent"),ut.append(St),this.container.append(ut),!x.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,vt)}addHighlightArea(){this.container.classList.add("highlightArea")}}vt=new WeakMap;class V extends tt{constructor(k){super(k),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends m{constructor(k){super(k,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class $ extends m{constructor(x){super(x,{isRenderable:!0,ignoreBorder:!0});rt(this,at,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const x=this.data,{width:z,height:dt}=L(x.rect),ut=this.svgFactory.create(z,dt,!0);for(const yt of x.inkLists){let St=[];for(const Ft of yt){const Pt=Ft.x-x.rect[0],Ht=x.rect[3]-Ft.y;St.push(`${Pt},${Ht}`)}St=St.join(" ");const Lt=this.svgFactory.createElement(this.svgElementName);t(this,at).push(Lt),Lt.setAttribute("points",St),Lt.setAttribute("stroke-width",x.borderStyle.width||1),Lt.setAttribute("stroke","transparent"),Lt.setAttribute("fill","transparent"),!x.popupRef&&this.hasPopupData&&this._createPopup(),ut.append(Lt)}return this.container.append(ut),this.container}getElementsToTriggerPopup(){return t(this,at)}addHighlightArea(){this.container.classList.add("highlightArea")}}at=new WeakMap,e.InkAnnotationElement=$;class it extends m{constructor(k){super(k,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class w extends m{constructor(k){super(k,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class W extends m{constructor(k){super(k,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class et extends m{constructor(k){super(k,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class S extends m{constructor(k){super(k,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=S;class s extends m{constructor(x){var ut;super(x,{isRenderable:!0});rt(this,Rt);rt(this,lt,null);const{filename:z,content:dt}=this.data.file;this.filename=(0,h.getFilenameFromUrl)(z,!0),this.content=dt,(ut=this.linkService.eventBus)==null||ut.dispatch("fileattachmentannotation",{source:this,filename:z,content:dt})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:x,data:z}=this;let dt;z.hasAppearance||z.fillAlpha===0?dt=document.createElement("div"):(dt=document.createElement("img"),dt.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(z.name)?"paperclip":"pushpin"}.svg`,z.fillAlpha&&z.fillAlpha<1&&(dt.style=`filter: opacity(${Math.round(z.fillAlpha*100)}%);`)),dt.addEventListener("dblclick",Y(this,Rt,sn).bind(this)),ot(this,lt,dt);const{isMac:ut}=n.FeatureTest.platform;return x.addEventListener("keydown",yt=>{yt.key==="Enter"&&(ut?yt.metaKey:yt.ctrlKey)&&Y(this,Rt,sn).call(this)}),!z.popupRef&&this.hasPopupData?this._createPopup():dt.classList.add("popupTriggerArea"),x.append(dt),x}getElementsToTriggerPopup(){return t(this,lt)}addHighlightArea(){this.container.classList.add("highlightArea")}}lt=new WeakMap,Rt=new WeakSet,sn=function(){var x;(x=this.downloadManager)==null||x.openOrDownloadData(this.container,this.content,this.filename)};class r{constructor({div:k,accessibilityManager:x,annotationCanvasMap:z,l10n:dt,page:ut,viewport:yt}){rt(this,wt);rt(this,Gt,null);rt(this,U,null);rt(this,gt,new Map);this.div=k,ot(this,Gt,x),ot(this,U,z),this.l10n=dt,this.page=ut,this.viewport=yt,this.zIndex=0,this.l10n||(this.l10n=ht.NullL10n)}async render(k){const{annotations:x}=k,z=this.div;(0,h.setLayerDimensions)(z,this.viewport);const dt=new Map,ut={data:null,layer:z,linkService:k.linkService,downloadManager:k.downloadManager,imageResourcesPath:k.imageResourcesPath||"",renderForms:k.renderForms!==!1,svgFactory:new h.DOMSVGFactory,annotationStorage:k.annotationStorage||new G.AnnotationStorage,enableScripting:k.enableScripting===!0,hasJSActions:k.hasJSActions,fieldObjects:k.fieldObjects,parent:this,elements:null};for(const yt of x){if(yt.noHTML)continue;const St=yt.annotationType===n.AnnotationType.POPUP;if(St){const Pt=dt.get(yt.id);if(!Pt)continue;ut.elements=Pt}else{const{width:Pt,height:Ht}=L(yt.rect);if(Pt<=0||Ht<=0)continue}ut.data=yt;const Lt=b.create(ut);if(!Lt.isRenderable)continue;if(!St&&yt.popupRef){const Pt=dt.get(yt.popupRef);Pt?Pt.push(Lt):dt.set(yt.popupRef,[Lt])}Lt.annotationEditorType>0&&t(this,gt).set(Lt.data.id,Lt);const Ft=Lt.render();yt.hidden&&(Ft.style.visibility="hidden"),Y(this,wt,Dn).call(this,Ft,yt.id)}Y(this,wt,rn).call(this),await this.l10n.translate(z)}update({viewport:k}){const x=this.div;this.viewport=k,(0,h.setLayerDimensions)(x,{rotation:k.rotation}),Y(this,wt,rn).call(this),x.hidden=!1}getEditableAnnotations(){return Array.from(t(this,gt).values())}getEditableAnnotation(k){return t(this,gt).get(k)}}Gt=new WeakMap,U=new WeakMap,gt=new WeakMap,wt=new WeakSet,Dn=function(k,x){var dt;const z=k.firstChild||k;z.id=`${n.AnnotationPrefix}${x}`,this.div.append(k),(dt=t(this,Gt))==null||dt.moveElementInDOM(this.div,k,z,!1)},rn=function(){if(!t(this,U))return;const k=this.div;for(const[x,z]of t(this,U)){const dt=k.querySelector(`[data-annotation-id="${x}"]`);if(!dt)continue;const{firstChild:ut}=dt;ut?ut.nodeName==="CANVAS"?ut.replaceWith(z):ut.before(z):dt.append(z)}t(this,U).clear()},e.AnnotationLayer=r},(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function B(G){return Math.floor(Math.max(0,Math.min(1,G))*255).toString(16).padStart(2,"0")}function n(G){return Math.max(0,Math.min(255,255*G))}class h{static CMYK_G([H,ht,P,T]){return["G",1-Math.min(1,.3*H+.59*P+.11*ht+T)]}static G_CMYK([H]){return["CMYK",0,0,0,1-H]}static G_RGB([H]){return["RGB",H,H,H]}static G_rgb([H]){return H=n(H),[H,H,H]}static G_HTML([H]){const ht=B(H);return`#${ht}${ht}${ht}`}static RGB_G([H,ht,P]){return["G",.3*H+.59*ht+.11*P]}static RGB_rgb(H){return H.map(n)}static RGB_HTML(H){return`#${H.map(B).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([H,ht,P,T]){return["RGB",1-Math.min(1,H+T),1-Math.min(1,P+T),1-Math.min(1,ht+T)]}static CMYK_rgb([H,ht,P,T]){return[n(1-Math.min(1,H+T)),n(1-Math.min(1,P+T)),n(1-Math.min(1,ht+T))]}static CMYK_HTML(H){const ht=this.CMYK_RGB(H).slice(1);return this.RGB_HTML(ht)}static RGB_CMYK([H,ht,P]){const T=1-H,f=1-ht,j=1-P,L=Math.min(T,f,j);return["CMYK",T,f,j,L]}}e.ColorConverters=h},(C,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const B={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};B.print_progress_percent="{{progress}}%";function n(H,ht){switch(H){case"find_match_count":H=`find_match_count[${ht.total===1?"one":"other"}]`;break;case"find_match_count_limit":H=`find_match_count_limit[${ht.limit===1?"one":"other"}]`;break}return B[H]||""}function h(H,ht){return ht?H.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(P,T)=>T in ht?ht[T]:"{{"+T+"}}"):H}const G={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(H,ht=null,P=n(H,ht)){return h(P,ht)},async translate(H){}};e.NullL10n=G},(C,e,B)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=B(25);class h{static setupStorage(H,ht,P,T,f){const j=T.getValue(ht,{value:null});switch(P.name){case"textarea":if(j.value!==null&&(H.textContent=j.value),f==="print")break;H.addEventListener("input",L=>{T.setValue(ht,{value:L.target.value})});break;case"input":if(P.attributes.type==="radio"||P.attributes.type==="checkbox"){if(j.value===P.attributes.xfaOn?H.setAttribute("checked",!0):j.value===P.attributes.xfaOff&&H.removeAttribute("checked"),f==="print")break;H.addEventListener("change",L=>{T.setValue(ht,{value:L.target.checked?L.target.getAttribute("xfaOn"):L.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&H.setAttribute("value",j.value),f==="print")break;H.addEventListener("input",L=>{T.setValue(ht,{value:L.target.value})})}break;case"select":if(j.value!==null){H.setAttribute("value",j.value);for(const L of P.children)L.attributes.value===j.value?L.attributes.selected=!0:L.attributes.hasOwnProperty("selected")&&delete L.attributes.selected}H.addEventListener("input",L=>{const b=L.target.options,m=b.selectedIndex===-1?"":b[b.selectedIndex].value;T.setValue(ht,{value:m})});break}}static setAttributes({html:H,element:ht,storage:P=null,intent:T,linkService:f}){const{attributes:j}=ht,L=H instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${T}`);for(const[b,m]of Object.entries(j))if(m!=null)switch(b){case"class":m.length&&H.setAttribute(b,m.join(" "));break;case"dataId":break;case"id":H.setAttribute("data-element-id",m);break;case"style":Object.assign(H.style,m);break;case"textContent":H.textContent=m;break;default:(!L||b!=="href"&&b!=="newWindow")&&H.setAttribute(b,m)}L&&f.addLinkAttributes(H,j.href,j.newWindow),P&&j.dataId&&this.setupStorage(H,j.dataId,ht,P)}static render(H){var E;const ht=H.annotationStorage,P=H.linkService,T=H.xfaHtml,f=H.intent||"display",j=document.createElement(T.name);T.attributes&&this.setAttributes({html:j,element:T,intent:f,linkService:P});const L=[[T,-1,j]],b=H.div;if(b.append(j),H.viewport){const g=`matrix(${H.viewport.transform.join(",")})`;b.style.transform=g}f!=="richText"&&b.setAttribute("class","xfaLayer xfaFont");const m=[];for(;L.length>0;){const[g,u,y]=L.at(-1);if(u+1===g.children.length){L.pop();continue}const M=g.children[++L.at(-1)[1]];if(M===null)continue;const{name:A}=M;if(A==="#text"){const d=document.createTextNode(M.value);m.push(d),y.append(d);continue}const i=(E=M==null?void 0:M.attributes)!=null&&E.xmlns?document.createElementNS(M.attributes.xmlns,A):document.createElement(A);if(y.append(i),M.attributes&&this.setAttributes({html:i,element:M,storage:ht,intent:f,linkService:P}),M.children&&M.children.length>0)L.push([M,-1,i]);else if(M.value){const d=document.createTextNode(M.value);n.XfaText.shouldBuildText(A)&&m.push(d),i.append(d)}}for(const g of b.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:m}}static update(H){const ht=`matrix(${H.viewport.transform.join(",")})`;H.div.style.transform=ht,H.div.hidden=!1}}e.XfaLayer=h},(C,e,B)=>{var T,f,j,L,b,m,E,g,u,y,M,A,i,d,o,Ln,In,On,Nn,an,jn,on,Bn,Un,Hn,$n,Wn,ee,ln,we,Pe,le,cn,Ce,D,Gn,hn,Vn,zn,dn,Re,ce;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=B(1),h=B(4),G=B(29),H=B(6),ht=B(5);const _t=class _t extends h.AnnotationEditor{constructor(_){super({..._,name:"inkEditor"});rt(this,o);rt(this,T,0);rt(this,f,0);rt(this,j,this.canvasPointermove.bind(this));rt(this,L,this.canvasPointerleave.bind(this));rt(this,b,this.canvasPointerup.bind(this));rt(this,m,this.canvasPointerdown.bind(this));rt(this,E,new Path2D);rt(this,g,!1);rt(this,u,!1);rt(this,y,!1);rt(this,M,null);rt(this,A,0);rt(this,i,0);rt(this,d,null);this.color=_.color||null,this.thickness=_.thickness||null,this.opacity=_.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(_){h.AnnotationEditor.initialize(_,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(_,N){switch(_){case n.AnnotationEditorParamsType.INK_THICKNESS:_t._defaultThickness=N;break;case n.AnnotationEditorParamsType.INK_COLOR:_t._defaultColor=N;break;case n.AnnotationEditorParamsType.INK_OPACITY:_t._defaultOpacity=N/100;break}}updateParams(_,N){switch(_){case n.AnnotationEditorParamsType.INK_THICKNESS:Y(this,o,Ln).call(this,N);break;case n.AnnotationEditorParamsType.INK_COLOR:Y(this,o,In).call(this,N);break;case n.AnnotationEditorParamsType.INK_OPACITY:Y(this,o,On).call(this,N);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,_t._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,_t._defaultColor||h.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(_t._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||_t._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||_t._defaultColor||h.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??_t._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(Y(this,o,we).call(this),Y(this,o,Pe).call(this)),this.isAttachedToDOM||(this.parent.add(this),Y(this,o,le).call(this)),Y(this,o,ce).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,M).disconnect(),ot(this,M,null),super.remove())}setParent(_){!this.parent&&_?this._uiManager.removeShouldRescale(this):this.parent&&_===null&&this._uiManager.addShouldRescale(this),super.setParent(_)}onScaleChanging(){const[_,N]=this.parentDimensions,X=this.width*_,st=this.height*N;this.setDimensions(X,st)}enableEditMode(){t(this,g)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,m)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,m)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,g)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),ot(this,g,!0),this.div.classList.add("disabled"),Y(this,o,ce).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(_){this._focusEventsAllowed&&(super.focusin(_),this.enableEditMode())}canvasPointerdown(_){_.button!==0||!this.isInEditMode()||t(this,g)||(this.setInForeground(),_.preventDefault(),_.type!=="mouse"&&this.div.focus(),Y(this,o,jn).call(this,_.offsetX,_.offsetY))}canvasPointermove(_){_.preventDefault(),Y(this,o,on).call(this,_.offsetX,_.offsetY)}canvasPointerup(_){_.preventDefault(),Y(this,o,ln).call(this,_)}canvasPointerleave(_){Y(this,o,ln).call(this,_)}get isResizable(){return!this.isEmpty()&&t(this,g)}render(){if(this.div)return this.div;let _,N;this.width&&(_=this.x,N=this.y),super.render(),h.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(At=>{var Z;return(Z=this.div)==null?void 0:Z.setAttribute("aria-label",At)});const[X,st,pt,Et]=Y(this,o,Nn).call(this);if(this.setAt(X,st,0,0),this.setDims(pt,Et),Y(this,o,we).call(this),this.width){const[At,Z]=this.parentDimensions;this.setAspectRatio(this.width*At,this.height*Z),this.setAt(_*At,N*Z,this.width*At,this.height*Z),ot(this,y,!0),Y(this,o,le).call(this),this.setDims(this.width*At,this.height*Z),Y(this,o,ee).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Y(this,o,Pe).call(this),this.div}setDimensions(_,N){const X=Math.round(_),st=Math.round(N);if(t(this,A)===X&&t(this,i)===st)return;ot(this,A,X),ot(this,i,st),this.canvas.style.visibility="hidden";const[pt,Et]=this.parentDimensions;this.width=_/pt,this.height=N/Et,this.fixAndSetPosition(),t(this,g)&&Y(this,o,cn).call(this,_,N),Y(this,o,le).call(this),Y(this,o,ee).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(_,N,X){var It,$t,qt;if(_ instanceof G.InkAnnotationElement)return null;const st=super.deserialize(_,N,X);st.thickness=_.thickness,st.color=n.Util.makeHexColor(..._.color),st.opacity=_.opacity;const[pt,Et]=st.pageDimensions,At=st.width*pt,Z=st.height*Et,Tt=st.parentScale,xt=_.thickness/2;ot(st,g,!0),ot(st,A,Math.round(At)),ot(st,i,Math.round(Z));const{paths:Ut,rect:jt,rotation:Vt}=_;for(let{bezier:vt}of Ut){vt=Y(It=_t,D,Vn).call(It,vt,jt,Vt);const at=[];st.paths.push(at);let lt=Tt*(vt[0]-xt),Rt=Tt*(vt[1]-xt);for(let Gt=2,U=vt.length;Gt<U;Gt+=6){const gt=Tt*(vt[Gt]-xt),wt=Tt*(vt[Gt+1]-xt),Dt=Tt*(vt[Gt+2]-xt),Nt=Tt*(vt[Gt+3]-xt),Ct=Tt*(vt[Gt+4]-xt),k=Tt*(vt[Gt+5]-xt);at.push([[lt,Rt],[gt,wt],[Dt,Nt],[Ct,k]]),lt=Ct,Rt=k}const zt=Y(this,D,Gn).call(this,at);st.bezierPath2D.push(zt)}const kt=Y($t=st,o,dn).call($t);return ot(st,f,Math.max(h.AnnotationEditor.MIN_SIZE,kt[2]-kt[0])),ot(st,T,Math.max(h.AnnotationEditor.MIN_SIZE,kt[3]-kt[1])),Y(qt=st,o,cn).call(qt,At,Z),st}serialize(){if(this.isEmpty())return null;const _=this.getRect(0,0),N=h.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:N,thickness:this.thickness,opacity:this.opacity,paths:Y(this,o,zn).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,_),pageIndex:this.pageIndex,rect:_,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};T=new WeakMap,f=new WeakMap,j=new WeakMap,L=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakMap,M=new WeakMap,A=new WeakMap,i=new WeakMap,d=new WeakMap,o=new WeakSet,Ln=function(_){const N=this.thickness;this.addCommands({cmd:()=>{this.thickness=_,Y(this,o,ce).call(this)},undo:()=>{this.thickness=N,Y(this,o,ce).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},In=function(_){const N=this.color;this.addCommands({cmd:()=>{this.color=_,Y(this,o,ee).call(this)},undo:()=>{this.color=N,Y(this,o,ee).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},On=function(_){_/=100;const N=this.opacity;this.addCommands({cmd:()=>{this.opacity=_,Y(this,o,ee).call(this)},undo:()=>{this.opacity=N,Y(this,o,ee).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Nn=function(){const{parentRotation:_,parentDimensions:[N,X]}=this;switch(_){case 90:return[0,X,X,N];case 180:return[N,X,N,X];case 270:return[N,0,X,N];default:return[0,0,N,X]}},an=function(){const{ctx:_,color:N,opacity:X,thickness:st,parentScale:pt,scaleFactor:Et}=this;_.lineWidth=st*pt/Et,_.lineCap="round",_.lineJoin="round",_.miterLimit=10,_.strokeStyle=`${N}${(0,ht.opacityToHex)(X)}`},jn=function(_,N){this.canvas.addEventListener("contextmenu",H.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,L)),this.canvas.addEventListener("pointermove",t(this,j)),this.canvas.addEventListener("pointerup",t(this,b)),this.canvas.removeEventListener("pointerdown",t(this,m)),this.isEditing=!0,t(this,y)||(ot(this,y,!0),Y(this,o,le).call(this),this.thickness||(this.thickness=_t._defaultThickness),this.color||(this.color=_t._defaultColor||h.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=_t._defaultOpacity)),this.currentPath.push([_,N]),ot(this,u,!1),Y(this,o,an).call(this),ot(this,d,()=>{Y(this,o,Hn).call(this),t(this,d)&&window.requestAnimationFrame(t(this,d))}),window.requestAnimationFrame(t(this,d))},on=function(_,N){const[X,st]=this.currentPath.at(-1);if(this.currentPath.length>1&&_===X&&N===st)return;const pt=this.currentPath;let Et=t(this,E);if(pt.push([_,N]),ot(this,u,!0),pt.length<=2){Et.moveTo(...pt[0]),Et.lineTo(_,N);return}pt.length===3&&(ot(this,E,Et=new Path2D),Et.moveTo(...pt[0])),Y(this,o,$n).call(this,Et,...pt.at(-3),...pt.at(-2),_,N)},Bn=function(){if(this.currentPath.length===0)return;const _=this.currentPath.at(-1);t(this,E).lineTo(..._)},Un=function(_,N){ot(this,d,null),_=Math.min(Math.max(_,0),this.canvas.width),N=Math.min(Math.max(N,0),this.canvas.height),Y(this,o,on).call(this,_,N),Y(this,o,Bn).call(this);let X;if(this.currentPath.length!==1)X=Y(this,o,Wn).call(this);else{const Z=[_,N];X=[[Z,Z.slice(),Z.slice(),Z]]}const st=t(this,E),pt=this.currentPath;this.currentPath=[],ot(this,E,new Path2D);const Et=()=>{this.allRawPaths.push(pt),this.paths.push(X),this.bezierPath2D.push(st),this.rebuild()},At=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Y(this,o,we).call(this),Y(this,o,Pe).call(this)),Y(this,o,ce).call(this))};this.addCommands({cmd:Et,undo:At,mustExec:!0})},Hn=function(){if(!t(this,u))return;ot(this,u,!1);const _=Math.ceil(this.thickness*this.parentScale),N=this.currentPath.slice(-3),X=N.map(Et=>Et[0]),st=N.map(Et=>Et[1]);Math.min(...X)-_,Math.max(...X)+_,Math.min(...st)-_,Math.max(...st)+_;const{ctx:pt}=this;pt.save(),pt.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Et of this.bezierPath2D)pt.stroke(Et);pt.stroke(t(this,E)),pt.restore()},$n=function(_,N,X,st,pt,Et,At){const Z=(N+st)/2,Tt=(X+pt)/2,xt=(st+Et)/2,Ut=(pt+At)/2;_.bezierCurveTo(Z+2*(st-Z)/3,Tt+2*(pt-Tt)/3,xt+2*(st-xt)/3,Ut+2*(pt-Ut)/3,xt,Ut)},Wn=function(){const _=this.currentPath;if(_.length<=2)return[[_[0],_[0],_.at(-1),_.at(-1)]];const N=[];let X,[st,pt]=_[0];for(X=1;X<_.length-2;X++){const[jt,Vt]=_[X],[kt,It]=_[X+1],$t=(jt+kt)/2,qt=(Vt+It)/2,vt=[st+2*(jt-st)/3,pt+2*(Vt-pt)/3],at=[$t+2*(jt-$t)/3,qt+2*(Vt-qt)/3];N.push([[st,pt],vt,at,[$t,qt]]),[st,pt]=[$t,qt]}const[Et,At]=_[X],[Z,Tt]=_[X+1],xt=[st+2*(Et-st)/3,pt+2*(At-pt)/3],Ut=[Z+2*(Et-Z)/3,Tt+2*(At-Tt)/3];return N.push([[st,pt],xt,Ut,[Z,Tt]]),N},ee=function(){if(this.isEmpty()){Y(this,o,Ce).call(this);return}Y(this,o,an).call(this);const{canvas:_,ctx:N}=this;N.setTransform(1,0,0,1,0,0),N.clearRect(0,0,_.width,_.height),Y(this,o,Ce).call(this);for(const X of this.bezierPath2D)N.stroke(X)},ln=function(_){this.canvas.removeEventListener("pointerleave",t(this,L)),this.canvas.removeEventListener("pointermove",t(this,j)),this.canvas.removeEventListener("pointerup",t(this,b)),this.canvas.addEventListener("pointerdown",t(this,m)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",H.noContextMenu)},10),Y(this,o,Un).call(this,_.offsetX,_.offsetY),this.addToAnnotationStorage(),this.setInBackground()},we=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",h.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(_=>{var N;return(N=this.canvas)==null?void 0:N.setAttribute("aria-label",_)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Pe=function(){ot(this,M,new ResizeObserver(_=>{const N=_[0].contentRect;N.width&&N.height&&this.setDimensions(N.width,N.height)})),t(this,M).observe(this.div)},le=function(){if(!t(this,y))return;const[_,N]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*_),this.canvas.height=Math.ceil(this.height*N),Y(this,o,Ce).call(this)},cn=function(_,N){const X=Y(this,o,Re).call(this),st=(_-X)/t(this,f),pt=(N-X)/t(this,T);this.scaleFactor=Math.min(st,pt)},Ce=function(){const _=Y(this,o,Re).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+_,this.translationY*this.scaleFactor+_)},D=new WeakSet,Gn=function(_){const N=new Path2D;for(let X=0,st=_.length;X<st;X++){const[pt,Et,At,Z]=_[X];X===0&&N.moveTo(...pt),N.bezierCurveTo(Et[0],Et[1],At[0],At[1],Z[0],Z[1])}return N},hn=function(_,N,X){const[st,pt,Et,At]=N;switch(X){case 0:for(let Z=0,Tt=_.length;Z<Tt;Z+=2)_[Z]+=st,_[Z+1]=At-_[Z+1];break;case 90:for(let Z=0,Tt=_.length;Z<Tt;Z+=2){const xt=_[Z];_[Z]=_[Z+1]+st,_[Z+1]=xt+pt}break;case 180:for(let Z=0,Tt=_.length;Z<Tt;Z+=2)_[Z]=Et-_[Z],_[Z+1]+=pt;break;case 270:for(let Z=0,Tt=_.length;Z<Tt;Z+=2){const xt=_[Z];_[Z]=Et-_[Z+1],_[Z+1]=At-xt}break;default:throw new Error("Invalid rotation")}return _},Vn=function(_,N,X){const[st,pt,Et,At]=N;switch(X){case 0:for(let Z=0,Tt=_.length;Z<Tt;Z+=2)_[Z]-=st,_[Z+1]=At-_[Z+1];break;case 90:for(let Z=0,Tt=_.length;Z<Tt;Z+=2){const xt=_[Z];_[Z]=_[Z+1]-pt,_[Z+1]=xt-st}break;case 180:for(let Z=0,Tt=_.length;Z<Tt;Z+=2)_[Z]=Et-_[Z],_[Z+1]-=pt;break;case 270:for(let Z=0,Tt=_.length;Z<Tt;Z+=2){const xt=_[Z];_[Z]=At-_[Z+1],_[Z+1]=Et-xt}break;default:throw new Error("Invalid rotation")}return _},zn=function(_,N,X,st){var Tt,xt;const pt=[],Et=this.thickness/2,At=_*N+Et,Z=_*X+Et;for(const Ut of this.paths){const jt=[],Vt=[];for(let kt=0,It=Ut.length;kt<It;kt++){const[$t,qt,vt,at]=Ut[kt],lt=_*$t[0]+At,Rt=_*$t[1]+Z,zt=_*qt[0]+At,Gt=_*qt[1]+Z,U=_*vt[0]+At,gt=_*vt[1]+Z,wt=_*at[0]+At,Dt=_*at[1]+Z;kt===0&&(jt.push(lt,Rt),Vt.push(lt,Rt)),jt.push(zt,Gt,U,gt,wt,Dt),Vt.push(zt,Gt),kt===It-1&&Vt.push(wt,Dt)}pt.push({bezier:Y(Tt=_t,D,hn).call(Tt,jt,st,this.rotation),points:Y(xt=_t,D,hn).call(xt,Vt,st,this.rotation)})}return pt},dn=function(){let _=1/0,N=-1/0,X=1/0,st=-1/0;for(const pt of this.paths)for(const[Et,At,Z,Tt]of pt){const xt=n.Util.bezierBoundingBox(...Et,...At,...Z,...Tt);_=Math.min(_,xt[0]),X=Math.min(X,xt[1]),N=Math.max(N,xt[2]),st=Math.max(st,xt[3])}return[_,X,N,st]},Re=function(){return t(this,g)?Math.ceil(this.thickness*this.parentScale):0},ce=function(_=!1){if(this.isEmpty())return;if(!t(this,g)){Y(this,o,ee).call(this);return}const N=Y(this,o,dn).call(this),X=Y(this,o,Re).call(this);ot(this,f,Math.max(h.AnnotationEditor.MIN_SIZE,N[2]-N[0])),ot(this,T,Math.max(h.AnnotationEditor.MIN_SIZE,N[3]-N[1]));const st=Math.ceil(X+t(this,f)*this.scaleFactor),pt=Math.ceil(X+t(this,T)*this.scaleFactor),[Et,At]=this.parentDimensions;this.width=st/Et,this.height=pt/At,this.setAspectRatio(st,pt);const Z=this.translationX,Tt=this.translationY;this.translationX=-N[0],this.translationY=-N[1],Y(this,o,le).call(this),Y(this,o,ee).call(this),ot(this,A,st),ot(this,i,pt),this.setDims(st,pt);const xt=_?X/this.scaleFactor/2:0;this.translate(Z-this.translationX-xt,Tt-this.translationY-xt)},rt(_t,D),Kt(_t,"_defaultColor",null),Kt(_t,"_defaultOpacity",1),Kt(_t,"_defaultThickness",1),Kt(_t,"_type","ink");let P=_t;e.InkEditor=P},(C,e,B)=>{var P,T,f,j,L,b,m,E,g,u,y,me,be,ke,un,qn,Xn,fn,Fe,Yn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=B(1),h=B(4),G=B(6),H=B(29);const v=class v extends h.AnnotationEditor{constructor(V){super({...V,name:"stampEditor"});rt(this,y);rt(this,P,null);rt(this,T,null);rt(this,f,null);rt(this,j,null);rt(this,L,null);rt(this,b,null);rt(this,m,null);rt(this,E,null);rt(this,g,!1);rt(this,u,!1);ot(this,j,V.bitmapUrl),ot(this,L,V.bitmapFile)}static initialize(V){h.AnnotationEditor.initialize(V)}static get supportedTypes(){const V=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",V.map(K=>`image/${K}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(V){return this.supportedTypes.includes(V)}static paste(V,K){K.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:V.getAsFile()})}remove(){var V,K;t(this,T)&&(ot(this,P,null),this._uiManager.imageManager.deleteId(t(this,T)),(V=t(this,b))==null||V.remove(),ot(this,b,null),(K=t(this,m))==null||K.disconnect(),ot(this,m,null)),super.remove()}rebuild(){if(!this.parent){t(this,T)&&Y(this,y,ke).call(this);return}super.rebuild(),this.div!==null&&(t(this,T)&&Y(this,y,ke).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,f)||t(this,P)||t(this,j)||t(this,L))}get isResizable(){return!0}render(){if(this.div)return this.div;let V,K;if(this.width&&(V=this.x,K=this.y),super.render(),this.div.hidden=!0,t(this,P)?Y(this,y,un).call(this):Y(this,y,ke).call(this),this.width){const[$,it]=this.parentDimensions;this.setAt(V*$,K*it,this.width*$,this.height*it)}return this.div}static deserialize(V,K,$){if(V instanceof H.StampAnnotationElement)return null;const it=super.deserialize(V,K,$),{rect:w,bitmapUrl:W,bitmapId:et,isSvg:S,accessibilityData:s}=V;et&&$.imageManager.isValidId(et)?ot(it,T,et):ot(it,j,W),ot(it,g,S);const[r,p]=it.pageDimensions;return it.width=(w[2]-w[0])/r,it.height=(w[3]-w[1])/p,s&&(it.altTextData=s),it}serialize(V=!1,K=null){if(this.isEmpty())return null;const $={annotationType:n.AnnotationEditorType.STAMP,bitmapId:t(this,T),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,g),structTreeParentId:this._structTreeParentId};if(V)return $.bitmapUrl=Y(this,y,Fe).call(this,!0),$.accessibilityData=this.altTextData,$;const{decorative:it,altText:w}=this.altTextData;if(!it&&w&&($.accessibilityData={type:"Figure",alt:w}),K===null)return $;K.stamps||(K.stamps=new Map);const W=t(this,g)?($.rect[2]-$.rect[0])*($.rect[3]-$.rect[1]):null;if(!K.stamps.has(t(this,T)))K.stamps.set(t(this,T),{area:W,serialized:$}),$.bitmap=Y(this,y,Fe).call(this,!1);else if(t(this,g)){const et=K.stamps.get(t(this,T));W>et.area&&(et.area=W,et.serialized.bitmap.close(),et.serialized.bitmap=Y(this,y,Fe).call(this,!1))}return $}};P=new WeakMap,T=new WeakMap,f=new WeakMap,j=new WeakMap,L=new WeakMap,b=new WeakMap,m=new WeakMap,E=new WeakMap,g=new WeakMap,u=new WeakMap,y=new WeakSet,me=function(V,K=!1){if(!V){this.remove();return}ot(this,P,V.bitmap),K||(ot(this,T,V.id),ot(this,g,V.isSvg)),Y(this,y,un).call(this)},be=function(){ot(this,f,null),this._uiManager.enableWaiting(!1),t(this,b)&&this.div.focus()},ke=function(){if(t(this,T)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,T)).then(K=>Y(this,y,me).call(this,K,!0)).finally(()=>Y(this,y,be).call(this));return}if(t(this,j)){const K=t(this,j);ot(this,j,null),this._uiManager.enableWaiting(!0),ot(this,f,this._uiManager.imageManager.getFromUrl(K).then($=>Y(this,y,me).call(this,$)).finally(()=>Y(this,y,be).call(this)));return}if(t(this,L)){const K=t(this,L);ot(this,L,null),this._uiManager.enableWaiting(!0),ot(this,f,this._uiManager.imageManager.getFromFile(K).then($=>Y(this,y,me).call(this,$)).finally(()=>Y(this,y,be).call(this)));return}const V=document.createElement("input");V.type="file",V.accept=v.supportedTypesStr,ot(this,f,new Promise(K=>{V.addEventListener("change",async()=>{if(!V.files||V.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const $=await this._uiManager.imageManager.getFromFile(V.files[0]);Y(this,y,me).call(this,$)}K()}),V.addEventListener("cancel",()=>{this.remove(),K()})}).finally(()=>Y(this,y,be).call(this))),V.click()},un=function(){const{div:V}=this;let{width:K,height:$}=t(this,P);const[it,w]=this.pageDimensions,W=.75;if(this.width)K=this.width*it,$=this.height*w;else if(K>W*it||$>W*w){const r=Math.min(W*it/K,W*w/$);K*=r,$*=r}const[et,S]=this.parentDimensions;this.setDims(K*et/it,$*S/w),this._uiManager.enableWaiting(!1);const s=ot(this,b,document.createElement("canvas"));V.append(s),V.hidden=!1,Y(this,y,fn).call(this,K,$),Y(this,y,Yn).call(this),t(this,u)||(this.parent.addUndoableEditor(this),ot(this,u,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},qn=function(V,K){var W;const[$,it]=this.parentDimensions;this.width=V/$,this.height=K/it,this.setDims(V,K),(W=this._initialOptions)!=null&&W.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,E)!==null&&clearTimeout(t(this,E)),ot(this,E,setTimeout(()=>{ot(this,E,null),Y(this,y,fn).call(this,V,K)},200))},Xn=function(V,K){const{width:$,height:it}=t(this,P);let w=$,W=it,et=t(this,P);for(;w>2*V||W>2*K;){const S=w,s=W;w>2*V&&(w=w>=16384?Math.floor(w/2)-1:Math.ceil(w/2)),W>2*K&&(W=W>=16384?Math.floor(W/2)-1:Math.ceil(W/2));const r=new OffscreenCanvas(w,W);r.getContext("2d").drawImage(et,0,0,S,s,0,0,w,W),et=r.transferToImageBitmap()}return et},fn=function(V,K){V=Math.ceil(V),K=Math.ceil(K);const $=t(this,b);if(!$||$.width===V&&$.height===K)return;$.width=V,$.height=K;const it=t(this,g)?t(this,P):Y(this,y,Xn).call(this,V,K),w=$.getContext("2d");w.filter=this._uiManager.hcmFilter,w.drawImage(it,0,0,it.width,it.height,0,0,V,K)},Fe=function(V){if(V){if(t(this,g)){const it=this._uiManager.imageManager.getSvgUrl(t(this,T));if(it)return it}const K=document.createElement("canvas");return{width:K.width,height:K.height}=t(this,P),K.getContext("2d").drawImage(t(this,P),0,0),K.toDataURL()}if(t(this,g)){const[K,$]=this.pageDimensions,it=Math.round(this.width*K*G.PixelsPerInch.PDF_TO_CSS_UNITS),w=Math.round(this.height*$*G.PixelsPerInch.PDF_TO_CSS_UNITS),W=new OffscreenCanvas(it,w);return W.getContext("2d").drawImage(t(this,P),0,0,t(this,P).width,t(this,P).height,0,0,it,w),W.transferToImageBitmap()}return structuredClone(t(this,P))},Yn=function(){ot(this,m,new ResizeObserver(V=>{const K=V[0].contentRect;K.width&&K.height&&Y(this,y,qn).call(this,K.width,K.height)})),t(this,m).observe(this.div)},Kt(v,"_type","stamp");let ht=v;e.StampEditor=ht}],__webpack_module_cache__={};function __w_pdfjs_require__(C){var e=__webpack_module_cache__[C];if(e!==void 0)return e.exports;var B=__webpack_module_cache__[C]={exports:{}};return __webpack_modules__[C](B,B.exports,__w_pdfjs_require__),B.exports}var __webpack_exports__={};return(()=>{var C=__webpack_exports__;Object.defineProperty(C,"__esModule",{value:!0}),Object.defineProperty(C,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(C,"AnnotationEditorLayer",{enumerable:!0,get:function(){return G.AnnotationEditorLayer}}),Object.defineProperty(C,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(C,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(C,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return H.AnnotationEditorUIManager}}),Object.defineProperty(C,"AnnotationLayer",{enumerable:!0,get:function(){return ht.AnnotationLayer}}),Object.defineProperty(C,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(C,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(C,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(C,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(C,"GlobalWorkerOptions",{enumerable:!0,get:function(){return P.GlobalWorkerOptions}}),Object.defineProperty(C,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(C,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(C,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(C,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(C,"PDFDataRangeTransport",{enumerable:!0,get:function(){return B.PDFDataRangeTransport}}),Object.defineProperty(C,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(C,"PDFWorker",{enumerable:!0,get:function(){return B.PDFWorker}}),Object.defineProperty(C,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(C,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(C,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(C,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(C,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(C,"SVGGraphics",{enumerable:!0,get:function(){return B.SVGGraphics}}),Object.defineProperty(C,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(C,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(C,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(C,"XfaLayer",{enumerable:!0,get:function(){return T.XfaLayer}}),Object.defineProperty(C,"build",{enumerable:!0,get:function(){return B.build}}),Object.defineProperty(C,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(C,"getDocument",{enumerable:!0,get:function(){return B.getDocument}}),Object.defineProperty(C,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(C,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(C,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(C,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(C,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(C,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(C,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(C,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(C,"renderTextLayer",{enumerable:!0,get:function(){return h.renderTextLayer}}),Object.defineProperty(C,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(C,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(C,"updateTextLayer",{enumerable:!0,get:function(){return h.updateTextLayer}}),Object.defineProperty(C,"version",{enumerable:!0,get:function(){return B.version}});var e=__w_pdfjs_require__(1),B=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),h=__w_pdfjs_require__(26),G=__w_pdfjs_require__(27),H=__w_pdfjs_require__(5),ht=__w_pdfjs_require__(29),P=__w_pdfjs_require__(14),T=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule;var __spreadArray=function(C,e,B){if(B||arguments.length===2)for(var n=0,h=e.length,G;n<h;n++)(G||!(n in e))&&(G||(G=Array.prototype.slice.call(e,0,n)),G[n]=e[n]);return C.concat(G||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(C,e){var B={};return allEvents.forEach(function(n){var h=C[n];h&&(e?B[n]=function(G){return h(G,e(n))}:B[n]=h)}),B}function makeCancellablePromise(C){var e=!1,B=new Promise(function(n,h){C.then(function(G){return!e&&n(G)}).catch(function(G){return!e&&h(G)})});return{promise:B,cancel:function(){e=!0}}}var prefix="Invariant failed";function invariant(C,e){if(!C)throw new Error(prefix)}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);var has=Object.prototype.hasOwnProperty;function find(C,e,B){for(B of C.keys())if(dequal(B,e))return B}function dequal(C,e){var B,n,h;if(C===e)return!0;if(C&&e&&(B=C.constructor)===e.constructor){if(B===Date)return C.getTime()===e.getTime();if(B===RegExp)return C.toString()===e.toString();if(B===Array){if((n=C.length)===e.length)for(;n--&&dequal(C[n],e[n]););return n===-1}if(B===Set){if(C.size!==e.size)return!1;for(n of C)if(h=n,h&&typeof h=="object"&&(h=find(e,h),!h)||!e.has(h))return!1;return!0}if(B===Map){if(C.size!==e.size)return!1;for(n of C)if(h=n[0],h&&typeof h=="object"&&(h=find(e,h),!h)||!dequal(n[1],e.get(h)))return!1;return!0}if(B===ArrayBuffer)C=new Uint8Array(C),e=new Uint8Array(e);else if(B===DataView){if((n=C.byteLength)===e.byteLength)for(;n--&&C.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(C)){if((n=C.byteLength)===e.byteLength)for(;n--&&C[n]===e[n];);return n===-1}if(!B||typeof C=="object"){n=0;for(B in C)if(has.call(C,B)&&++n&&!has.call(e,B)||!(B in e)||!dequal(C[B],e[B]))return!1;return Object.keys(e).length===n}}return C!==C&&e!==e}const DocumentContext=reactExports.createContext(null);function Message({children:C,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},C)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(B=>{invariant(this.pdfDocument),invariant(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(B):Array.isArray(e)?B(e):e.then(B)}).then(B=>{invariant(Array.isArray(B));const n=B[0];new Promise(h=>{invariant(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(G=>{h(G)}).catch(()=>{invariant(!1)}):typeof n=="number"?h(n):invariant(!1)}).then(h=>{const G=h+1;invariant(this.pdfViewer),invariant(G>=1&&G<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:B,pageIndex:h,pageNumber:G})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const B=e-1;invariant(this.pdfViewer),invariant(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:B,pageNumber:e})}addLinkAttributes(e,B,n){e.href=B,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(C){return typeof C<"u"}function isProvided(C){return isDefined(C)&&C!==null}function isString(C){return typeof C=="string"}function isArrayBuffer(C){return C instanceof ArrayBuffer}function isBlob(C){return invariant(isBrowser),C instanceof Blob}function isDataURI(C){return isString(C)&&/^data:/.test(C)}function dataURItoByteString(C){invariant(isDataURI(C));const[e="",B=""]=C.split(",");return e.split(";").indexOf("base64")!==-1?atob(B):unescape(B)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(C){C&&C.cancel&&C.cancel()}function makePageCallback(C,e){return Object.defineProperty(C,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(C,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(C,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(C,"originalHeight",{get(){return this.view[3]},configurable:!0}),C}function isCancelException(C){return C.name==="RenderingCancelledException"}function loadFromFile(C){return new Promise((e,B)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return B(new Error("Error while reading a file."));e(n.result)},n.onerror=h=>{if(!h.target)return B(new Error("Error while reading a file."));const{error:G}=h.target;if(!G)return B(new Error("Error while reading a file."));switch(G.code){case G.NOT_FOUND_ERR:return B(new Error("Error while reading a file: File not found."));case G.SECURITY_ERR:return B(new Error("Error while reading a file: Security error."));case G.ABORT_ERR:return B(new Error("Error while reading a file: Aborted."));default:return B(new Error("Error while reading a file."))}},n.readAsArrayBuffer(C)})}function reducer(C,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return C}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const C={};return allEvents.forEach(e=>{C[e]=PropTypes.func}),C})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function C(e,B,n){const{[B]:h,pageNumber:G,pdf:H}=e;if(!isDefined(H))return null;if(isDefined(h)){if(typeof h!="number")return new Error(`\`${B}\` of type \`${typeof h}\` supplied to \`${n}\`, expected \`number\`.`);if(h<0)return new Error(`Expected \`${B}\` to be greater or equal to 0.`);const{numPages:ht}=H;if(h+1>ht)return new Error(`Expected \`${B}\` to be less or equal to ${ht-1}.`)}else if(!isDefined(G))return new Error(`\`${B}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPageNumber=function C(e,B,n){const{[B]:h,pageIndex:G,pdf:H}=e;if(!isDefined(H))return null;if(isDefined(h)){if(typeof h!="number")return new Error(`\`${B}\` of type \`${typeof h}\` supplied to \`${n}\`, expected \`number\`.`);if(h<1)return new Error(`Expected \`${B}\` to be greater or equal to 1.`);const{numPages:ht}=H;if(h>ht)return new Error(`Expected \`${B}\` to be less or equal to ${ht}.`)}else if(!isDefined(G))return new Error(`\`${B}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(C,e,B,n){function h(G){return G instanceof B?G:new B(function(H){H(G)})}return new(B||(B=Promise))(function(G,H){function ht(f){try{T(n.next(f))}catch(j){H(j)}}function P(f){try{T(n.throw(f))}catch(j){H(j)}}function T(f){f.done?G(f.value):h(f.value).then(ht,P)}T((n=n.apply(C,e||[])).next())})},__rest$1=function(C,e){var B={};for(var n in C)Object.prototype.hasOwnProperty.call(C,n)&&e.indexOf(n)<0&&(B[n]=C[n]);if(C!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,n=Object.getOwnPropertySymbols(C);h<n.length;h++)e.indexOf(n[h])<0&&Object.prototype.propertyIsEnumerable.call(C,n[h])&&(B[n[h]]=C[n[h]]);return B};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(C,e)=>{switch(e){case PasswordResponses.NEED_PASSWORD:{const B=prompt("Enter the password to open this PDF file.");C(B);break}case PasswordResponses.INCORRECT_PASSWORD:{const B=prompt("Invalid password. Please try again.");C(B);break}}};function isParameterObject(C){return typeof C=="object"&&C!==null&&("data"in C||"range"in C||"url"in C)}const Document=reactExports.forwardRef(function C(e,B){var{children:n,className:h,error:G="Failed to load PDF file.",externalLinkRel:H,externalLinkTarget:ht,file:P,inputRef:T,imageResourcesPath:f,loading:j="Loading PDF…",noData:L="No PDF file specified.",onItemClick:b,onLoadError:m,onLoadProgress:E,onLoadSuccess:g,onPassword:u=defaultOnPassword,onSourceError:y,onSourceSuccess:M,options:A,renderMode:i,rotate:d}=e,o=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[l,c]=useResolver(),{value:I,error:a}=l,[v,R]=useResolver(),{value:tt,error:V}=v,K=reactExports.useRef(new LinkService),$=reactExports.useRef([]),it=reactExports.useRef(),w=reactExports.useRef();reactExports.useEffect(()=>{P&&P!==it.current&&isParameterObject(P)&&(warning$1(!dequal(P,it.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),it.current=P)},[P]),reactExports.useEffect(()=>{A&&A!==w.current&&(warning$1(!dequal(A,w.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),w.current=A)},[A]);const W=reactExports.useRef({scrollPageIntoView:J=>{const{dest:Q,pageNumber:_,pageIndex:N=_-1}=J;if(b){b({dest:Q,pageIndex:N,pageNumber:_});return}const X=$.current[N];if(X){X.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${_} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(B,()=>({linkService:K,pages:$,viewer:W}),[]);function et(){M&&M()}function S(){a&&(warning$1(!1,a.toString()),y&&y(a))}function s(){c({type:"RESET"})}reactExports.useEffect(s,[P,c]);const r=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!P)return null;if(typeof P=="string")return isDataURI(P)?{data:dataURItoByteString(P)}:(displayCORSWarning(),{url:P});if(P instanceof PDFDataRangeTransport)return{range:P};if(isArrayBuffer(P))return{data:P};if(isBrowser&&isBlob(P))return{data:yield loadFromFile(P)};if(invariant(typeof P=="object"),invariant(isParameterObject(P)),"url"in P&&typeof P.url=="string"){if(isDataURI(P.url)){const{url:J}=P,Q=__rest$1(P,["url"]),_=dataURItoByteString(J);return Object.assign({data:_},Q)}displayCORSWarning()}return P}),[P]);reactExports.useEffect(()=>{const J=makeCancellablePromise(r());return J.promise.then(Q=>{c({type:"RESOLVE",value:Q})}).catch(Q=>{c({type:"REJECT",error:Q})}),()=>{cancelRunningTask(J)}},[r,c]),reactExports.useEffect(()=>{if(!(typeof I>"u")){if(I===!1){S();return}et()}},[I]);function p(){tt&&(g&&g(tt),$.current=new Array(tt.numPages),K.current.setDocument(tt))}function F(){V&&(warning$1(!1,V.toString()),m&&m(V))}function D(){R({type:"RESET"})}reactExports.useEffect(D,[R,I]);function O(){if(!I)return;const J=Object.assign(Object.assign({},A),{isEvalSupported:!1}),Q=Object.assign(Object.assign({},I),J),_=pdfjs.getDocument(Q);E&&(_.onProgress=E),u&&(_.onPassword=u);const N=_;return N.promise.then(X=>{R({type:"RESOLVE",value:X})}).catch(X=>{N.destroyed||R({type:"REJECT",error:X})}),()=>{N.destroy()}}reactExports.useEffect(O,[A,R,I]),reactExports.useEffect(()=>{if(!(typeof tt>"u")){if(tt===!1){F();return}p()}},[tt]);function q(){K.current.setViewer(W.current),K.current.setExternalLinkRel(H),K.current.setExternalLinkTarget(ht)}reactExports.useEffect(q,[H,ht]);function nt(J,Q){$.current[J]=Q}function ct(J){delete $.current[J]}const ft=reactExports.useMemo(()=>({imageResourcesPath:f,linkService:K.current,onItemClick:b,pdf:tt,registerPage:nt,renderMode:i,rotate:d,unregisterPage:ct}),[f,b,tt,i,d]),bt=reactExports.useMemo(()=>makeEventProps(o,()=>tt),[o,tt]);function mt(){return React.createElement(DocumentContext.Provider,{value:ft},n)}function _t(){return P?tt==null?React.createElement(Message,{type:"loading"},typeof j=="function"?j():j):tt===!1?React.createElement(Message,{type:"error"},typeof G=="function"?G():G):mt():React.createElement(Message,{type:"no-data"},typeof L=="function"?L():L)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",h),ref:T,style:{"--scale-factor":"1"}},bt),_t())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var C=[],e=0;e<arguments.length;e++)C[e]=arguments[e];var B=C.filter(Boolean);if(B.length<=1){var n=B[0];return n||null}return function(G){B.forEach(function(H){typeof H=="function"?H(G):H&&(H.current=G)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(C){return C in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(C){return"children"in C}function isStructTreeNodeWithOnlyContentChild(C){return isStructTreeNode(C)?C.children.length===1&&0 in C.children&&"id"in C.children[0]:!1}function getRoleAttributes(C){const e={};if(isStructTreeNode(C)){const{role:B}=C,n=B.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(B)){const h=PDF_ROLE_TO_HTML_ROLE[B];h&&(e.role=h)}}return e}function getBaseAttributes(C){const e={};if(isStructTreeNode(C)){if(C.alt!==void 0&&(e["aria-label"]=C.alt),C.lang!==void 0&&(e.lang=C.lang),isStructTreeNodeWithOnlyContentChild(C)){const[B]=C.children;if(B){const n=getBaseAttributes(B);return Object.assign(Object.assign({},e),n)}}}else"id"in C&&(e["aria-owns"]=C.id);return e}function getAttributes(C){return C?Object.assign(Object.assign({},getRoleAttributes(C)),getBaseAttributes(C)):null}function StructTreeItem({className:C,node:e}){const B=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((h,G)=>React.createElement(StructTreeItem,{key:G,node:h})),[e]);return React.createElement("span",Object.assign({className:C},B),n)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const C=usePageContext();invariant(C);const{onGetStructTreeError:e,onGetStructTreeSuccess:B}=C,[n,h]=useResolver(),{value:G,error:H}=n,{customTextRenderer:ht,page:P}=C;function T(){G&&B&&B(G)}function f(){H&&(warning$1(!1,H.toString()),e&&e(H))}function j(){h({type:"RESET"})}reactExports.useEffect(j,[h,P]);function L(){if(ht||!P)return;const b=makeCancellablePromise(P.getStructTree()),m=b;return b.promise.then(E=>{h({type:"RESOLVE",value:E})}).catch(E=>{h({type:"REJECT",error:E})}),()=>cancelRunningTask(m)}return reactExports.useEffect(L,[ht,P,h]),reactExports.useEffect(()=>{if(G!==void 0){if(G===!1){f();return}T()}},[G]),G?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:G}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(C){const e=usePageContext();invariant(e);const B=Object.assign(Object.assign({},e),C),{_className:n,canvasBackground:h,devicePixelRatio:G=getDevicePixelRatio(),onRenderError:H,onRenderSuccess:ht,page:P,renderForms:T,renderTextLayer:f,rotate:j,scale:L}=B,{canvasRef:b}=C;invariant(P);const m=reactExports.useRef(null);function E(){P&&ht&&ht(makePageCallback(P,L))}function g(i){isCancelException(i)||(warning$1(!1,i.toString()),H&&H(i))}const u=reactExports.useMemo(()=>P.getViewport({scale:L*G,rotation:j}),[G,P,j,L]),y=reactExports.useMemo(()=>P.getViewport({scale:L,rotation:j}),[P,j,L]);function M(){if(!P)return;P.cleanup();const{current:i}=m;if(!i)return;i.width=u.width,i.height=u.height,i.style.width=`${Math.floor(y.width)}px`,i.style.height=`${Math.floor(y.height)}px`,i.style.visibility="hidden";const d={annotationMode:T?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:i.getContext("2d",{alpha:!1}),viewport:u};h&&(d.background=h);const o=P.render(d),l=o;return o.promise.then(()=>{i.style.visibility="",E()}).catch(g),()=>cancelRunningTask(l)}reactExports.useEffect(M,[h,m,G,P,T,u,y]);const A=reactExports.useCallback(()=>{const{current:i}=m;i&&(i.width=0,i.height=0)},[m]);return reactExports.useEffect(()=>A,[A]),React.createElement("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(b,m),style:{display:"block",userSelect:"none"}},f?React.createElement(StructTree,null):null)}function PageSVG(){const C=usePageContext();invariant(C);const{_className:e,onRenderSuccess:B,onRenderError:n,page:h,rotate:G,scale:H}=C;invariant(h);const[ht,P]=useResolver(),{value:T,error:f}=ht;function j(){h&&B&&B(makePageCallback(h,H))}function L(){f&&(isCancelException(f)||(warning$1(!1,f.toString()),n&&n(f)))}const b=reactExports.useMemo(()=>h.getViewport({scale:H,rotation:G}),[h,G,H]);function m(){P({type:"RESET"})}reactExports.useEffect(m,[h,P,b]);function E(){if(!h)return;const M=makeCancellablePromise(h.getOperatorList());return M.promise.then(A=>{new pdfjs.SVGGraphics(h.commonObjs,h.objs).getSVG(A,b).then(d=>{if(!(d instanceof SVGElement))throw new Error("getSVG returned unexpected result.");P({type:"RESOLVE",value:d})}).catch(d=>{P({type:"REJECT",error:d})})}).catch(A=>{P({type:"REJECT",error:A})}),()=>cancelRunningTask(M)}reactExports.useEffect(E,[h,P,b]),reactExports.useEffect(()=>{if(T!==void 0){if(T===!1){L();return}j()}},[T]);function g(M){if(!M||!T)return;M.firstElementChild||M.appendChild(T);const{width:A,height:i}=b;T.setAttribute("width",`${A}`),T.setAttribute("height",`${i}`)}const{width:u,height:y}=b;return React.createElement("div",{className:`${e}__svg`,ref:M=>g(M),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:u,height:y,userSelect:"none"}})}function isTextItem(C){return"str"in C}function TextLayer(){const C=usePageContext();invariant(C);const{customTextRenderer:e,onGetTextError:B,onGetTextSuccess:n,onRenderTextLayerError:h,onRenderTextLayerSuccess:G,page:H,pageIndex:ht,pageNumber:P,rotate:T,scale:f}=C;invariant(H);const[j,L]=useResolver(),{value:b,error:m}=j,E=reactExports.useRef(null),g=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function u(){b&&n&&n(b)}function y(){m&&(warning$1(!1,m.toString()),B&&B(m))}function M(){L({type:"RESET"})}reactExports.useEffect(M,[H,L]);function A(){if(!H)return;const a=makeCancellablePromise(H.getTextContent()),v=a;return a.promise.then(R=>{L({type:"RESOLVE",value:R})}).catch(R=>{L({type:"REJECT",error:R})}),()=>cancelRunningTask(v)}reactExports.useEffect(A,[H,L]),reactExports.useEffect(()=>{if(b!==void 0){if(b===!1){y();return}u()}},[b]);const i=reactExports.useCallback(()=>{G&&G()},[G]),d=reactExports.useCallback(a=>{warning$1(!1,a.toString()),h&&h(a)},[h]);function o(){const a=g.current;a&&a.classList.add("active")}function l(){const a=g.current;a&&a.classList.remove("active")}const c=reactExports.useMemo(()=>H.getViewport({scale:f,rotation:T}),[H,T,f]);function I(){if(!H||!b)return;const{current:a}=E;if(!a)return;a.innerHTML="";const v=H.streamTextContent({includeMarkedContent:!0}),R={container:a,textContentSource:v,viewport:c},tt=pdfjs.renderTextLayer(R),V=tt;return tt.promise.then(()=>{const K=document.createElement("div");K.className="endOfContent",a.append(K),g.current=K;const $=a.querySelectorAll('[role="presentation"]');if(e){let it=0;b.items.forEach((w,W)=>{if(!isTextItem(w))return;const et=$[it];if(!et)return;const S=e(Object.assign({pageIndex:ht,pageNumber:P,itemIndex:W},w));et.innerHTML=S,it+=w.str&&w.hasEOL?2:1})}i()}).catch(d),()=>cancelRunningTask(V)}return reactExports.useLayoutEffect(I,[e,d,i,H,ht,P,b,c]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:l,onMouseDown:o,ref:E})}function AnnotationLayer(){const C=useDocumentContext(),e=usePageContext();invariant(e);const B=Object.assign(Object.assign({},C),e),{imageResourcesPath:n,linkService:h,onGetAnnotationsError:G,onGetAnnotationsSuccess:H,onRenderAnnotationLayerError:ht,onRenderAnnotationLayerSuccess:P,page:T,pdf:f,renderForms:j,rotate:L,scale:b=1}=B;invariant(f),invariant(T),invariant(h);const[m,E]=useResolver(),{value:g,error:u}=m,y=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function M(){g&&H&&H(g)}function A(){u&&(warning$1(!1,u.toString()),G&&G(u))}function i(){E({type:"RESET"})}reactExports.useEffect(i,[E,T]);function d(){if(!T)return;const a=makeCancellablePromise(T.getAnnotations()),v=a;return a.promise.then(R=>{E({type:"RESOLVE",value:R})}).catch(R=>{E({type:"REJECT",error:R})}),()=>{cancelRunningTask(v)}}reactExports.useEffect(d,[E,T,j]),reactExports.useEffect(()=>{if(g!==void 0){if(g===!1){A();return}M()}},[g]);function o(){P&&P()}function l(a){warning$1(!1,`${a}`),ht&&ht(a)}const c=reactExports.useMemo(()=>T.getViewport({scale:b,rotation:L}),[T,L,b]);function I(){if(!f||!T||!h||!g)return;const{current:a}=y;if(!a)return;const v=c.clone({dontFlip:!0}),R={accessibilityManager:null,annotationCanvasMap:null,div:a,l10n:null,page:T,viewport:v},tt={annotations:g,annotationStorage:f.annotationStorage,div:a,downloadManager:null,imageResourcesPath:n,linkService:h,page:T,renderForms:j,viewport:v};a.innerHTML="";try{new pdfjs.AnnotationLayer(R).render(tt),o()}catch(V){l(V)}return()=>{}}return reactExports.useEffect(I,[g,n,h,T,j,c]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:y})}var __rest=function(C,e){var B={};for(var n in C)Object.prototype.hasOwnProperty.call(C,n)&&e.indexOf(n)<0&&(B[n]=C[n]);if(C!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,n=Object.getOwnPropertySymbols(C);h<n.length;h++)e.indexOf(n[h])<0&&Object.prototype.propertyIsEnumerable.call(C,n[h])&&(B[n[h]]=C[n[h]]);return B};const defaultScale=1,Page=function C(e){const B=useDocumentContext(),n=Object.assign(Object.assign({},B),e),{_className:h="react-pdf__Page",_enableRegisterUnregisterPage:G=!0,canvasBackground:H,canvasRef:ht,children:P,className:T,customRenderer:f,customTextRenderer:j,devicePixelRatio:L,error:b="Failed to load the page.",height:m,inputRef:E,loading:g="Loading page…",noData:u="No page specified.",onGetAnnotationsError:y,onGetAnnotationsSuccess:M,onGetStructTreeError:A,onGetStructTreeSuccess:i,onGetTextError:d,onGetTextSuccess:o,onLoadError:l,onLoadSuccess:c,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:a,onRenderError:v,onRenderSuccess:R,onRenderTextLayerError:tt,onRenderTextLayerSuccess:V,pageIndex:K,pageNumber:$,pdf:it,registerPage:w,renderAnnotationLayer:W=!0,renderForms:et=!1,renderMode:S="canvas",renderTextLayer:s=!0,rotate:r,scale:p=defaultScale,unregisterPage:F,width:D}=n,O=__rest(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[q,nt]=useResolver(),{value:ct,error:ft}=q,bt=reactExports.useRef(null);invariant(it);const mt=isProvided($)?$-1:K??null,_t=$??(isProvided(K)?K+1:null),J=r??(ct?ct.rotate:null),Q=reactExports.useMemo(()=>{if(!ct)return null;let It=1;const $t=p??defaultScale;if(D||m){const qt=ct.getViewport({scale:1,rotation:J});D?It=D/qt.width:m&&(It=m/qt.height)}return $t*It},[m,ct,J,p,D]);function _(){return()=>{isProvided(mt)&&G&&F&&F(mt)}}reactExports.useEffect(_,[G,it,mt,F]);function N(){if(c){if(!ct||!Q)return;c(makePageCallback(ct,Q))}if(G&&w){if(!isProvided(mt)||!bt.current)return;w(mt,bt.current)}}function X(){ft&&(warning$1(!1,ft.toString()),l&&l(ft))}function st(){nt({type:"RESET"})}reactExports.useEffect(st,[nt,it,mt]);function pt(){if(!it||!_t)return;const It=makeCancellablePromise(it.getPage(_t)),$t=It;return It.promise.then(qt=>{nt({type:"RESOLVE",value:qt})}).catch(qt=>{nt({type:"REJECT",error:qt})}),()=>cancelRunningTask($t)}reactExports.useEffect(pt,[nt,it,mt,_t,w]),reactExports.useEffect(()=>{if(ct!==void 0){if(ct===!1){X();return}N()}},[ct,Q]);const Et=reactExports.useMemo(()=>ct&&isProvided(mt)&&_t&&isProvided(J)&&isProvided(Q)?{_className:h,canvasBackground:H,customTextRenderer:j,devicePixelRatio:L,onGetAnnotationsError:y,onGetAnnotationsSuccess:M,onGetStructTreeError:A,onGetStructTreeSuccess:i,onGetTextError:d,onGetTextSuccess:o,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:a,onRenderError:v,onRenderSuccess:R,onRenderTextLayerError:tt,onRenderTextLayerSuccess:V,page:ct,pageIndex:mt,pageNumber:_t,renderForms:et,renderTextLayer:s,rotate:J,scale:Q}:null,[h,H,j,L,y,M,A,i,d,o,I,a,v,R,tt,V,ct,mt,_t,et,s,J,Q]),At=reactExports.useMemo(()=>makeEventProps(O,()=>ct&&(Q?makePageCallback(ct,Q):void 0)),[O,ct,Q]),Z=`${mt}@${Q}/${J}`,Tt=`${mt}/${J}`;function xt(){switch(S){case"custom":return invariant(f),React.createElement(f,{key:`${Z}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${Tt}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${Z}_canvas`,canvasRef:ht})}}function Ut(){return s?React.createElement(TextLayer,{key:`${Z}_text`}):null}function jt(){return W?React.createElement(AnnotationLayer,{key:`${Z}_annotations`}):null}function Vt(){return React.createElement(PageContext.Provider,{value:Et},xt(),Ut(),jt(),P)}function kt(){return _t?it===null||ct===void 0||ct===null?React.createElement(Message,{type:"loading"},typeof g=="function"?g():g):it===!1||ct===!1?React.createElement(Message,{type:"error"},typeof b=="function"?b():b):Vt():React.createElement(Message,{type:"no-data"},typeof u=="function"?u():u)}return React.createElement("div",Object.assign({className:clsx(h,T),"data-page-number":_t,ref:mergeRefs(E,bt),style:{"--scale-factor":`${Q}`,backgroundColor:H||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},At),kt())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";var Close={},_interopRequireDefault=interopRequireDefaultExports;Object.defineProperty(Close,"__esModule",{value:!0});var default_1=Close.default=void 0,_createSvgIcon=_interopRequireDefault(requireCreateSvgIcon()),_jsxRuntime=jsxRuntimeExports;default_1=Close.default=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");pdfjs.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;const PDFPreview=({open:C,onClose:e,pdfUrl:B,bookTitle:n})=>{const[h,G]=reactExports.useState(null),[H,ht]=reactExports.useState(1),[P,T]=reactExports.useState(null),f=({numPages:b})=>{G(b),T(null)},j=b=>{T("Erreur lors du chargement du PDF"),console.error("Error loading PDF:",b)},L=b=>{ht(m=>{const E=m+b;return Math.min(Math.max(1,E),h)})};return jsxRuntimeExports.jsxs(Dialog,{open:C,onClose:e,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"90vh",maxHeight:"90vh",display:"flex",flexDirection:"column"}},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderBottom:1,borderColor:"divider"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:n}),jsxRuntimeExports.jsx(IconButton,{onClick:e,children:jsxRuntimeExports.jsx(default_1,{})})]}),jsxRuntimeExports.jsx(DialogContent,{sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",overflow:"hidden"},children:P?jsxRuntimeExports.jsx(Typography,{color:"error",sx:{mt:2},children:P}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Document,{file:B,onLoadSuccess:f,onLoadError:j,loading:jsxRuntimeExports.jsx(Typography,{children:"Chargement du PDF..."}),children:jsxRuntimeExports.jsx(Page,{pageNumber:H,width:window.innerWidth*.7,loading:jsxRuntimeExports.jsx(Typography,{children:"Chargement de la page..."})})}),jsxRuntimeExports.jsxs(Box,{sx:{mt:2,display:"flex",alignItems:"center",gap:2},children:[jsxRuntimeExports.jsx(Button,{startIcon:jsxRuntimeExports.jsx(default_1$5,{}),onClick:()=>L(-1),disabled:H<=1,children:"Précédent"}),jsxRuntimeExports.jsxs(Typography,{children:["Page ",H," sur ",h]}),jsxRuntimeExports.jsx(Button,{endIcon:jsxRuntimeExports.jsx(default_1$6,{}),onClick:()=>L(1),disabled:H>=h,children:"Suivant"})]})]})})]})},SkeletonLoader=({count:C=6})=>jsxRuntimeExports.jsx(Grid,{container:!0,spacing:3,children:[...Array(C)].map((e,B)=>jsxRuntimeExports.jsx(Grid,{item:!0,xs:12,sm:6,md:4,children:jsxRuntimeExports.jsxs(Card,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[jsxRuntimeExports.jsx(Skeleton,{variant:"rectangular",height:200,animation:"wave",sx:{m:1}}),jsxRuntimeExports.jsxs(CardContent,{sx:{flexGrow:1},children:[jsxRuntimeExports.jsx(Skeleton,{variant:"text",height:32,width:"80%",sx:{mb:1}}),jsxRuntimeExports.jsx(Skeleton,{variant:"text",height:24,width:"60%",sx:{mb:2}}),jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",height:24,width:"40%",sx:{mb:1}}),jsxRuntimeExports.jsx(Box,{sx:{mb:2},children:jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",height:32,width:"100%"})}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",gap:1},children:[jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",height:32,width:"30%"}),jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",height:32,width:"30%"}),jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",height:32,width:"30%"})]})]}),jsxRuntimeExports.jsxs(CardActions,{sx:{p:2,justifyContent:"space-between"},children:[jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",width:100,height:36}),jsxRuntimeExports.jsx(Skeleton,{variant:"rounded",width:100,height:36})]})]})},`skeleton-${B}`))}),BookGrid=({books:C,onReadBook:e,onPreviewBook:B,theme:n})=>jsxRuntimeExports.jsx(Grid,{container:!0,spacing:3,children:C.map((h,G)=>jsxRuntimeExports.jsx(Grid,{item:!0,xs:12,sm:6,md:4,children:jsxRuntimeExports.jsxs(Card,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s","&:hover":{transform:(h==null?void 0:h.status)==="completed"?"translateY(-4px)":"none",boxShadow:(h==null?void 0:h.status)==="completed"?4:1}},children:[h.cover_image&&jsxRuntimeExports.jsx(CardMedia,{component:"img",height:"200",image:h.cover_image,alt:`Cover for ${h.title}`,sx:{objectFit:"contain",p:1}}),jsxRuntimeExports.jsxs(CardContent,{sx:{flexGrow:1},children:[jsxRuntimeExports.jsx(Typography,{gutterBottom:!0,variant:"h5",component:"h2",color:"text.primary",children:(h==null?void 0:h.title)||"Untitled Book"}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Author: ",(h==null?void 0:h.author)||"Unknown"]}),jsxRuntimeExports.jsx(BookStatus,{book:h}),jsxRuntimeExports.jsx(BookProgress,{book:h}),h.error_message&&jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"error",sx:{mt:1},children:["Error: ",h.error_message]})]}),jsxRuntimeExports.jsxs(CardActions,{sx:{padding:2,justifyContent:"space-between",backgroundColor:"background.paper",borderTop:1,borderColor:"divider"},children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"medium",color:"primary",startIcon:jsxRuntimeExports.jsx(default_1$3,{}),onClick:()=>B(h),disabled:(h==null?void 0:h.status)!=="completed",children:"Preview"}),jsxRuntimeExports.jsx(Button,{variant:"contained",size:"medium",color:"primary",startIcon:jsxRuntimeExports.jsx(default_1$7,{}),onClick:()=>e(h),disabled:(h==null?void 0:h.status)!=="completed",children:"Read"})]})]})},`book-${(h==null?void 0:h.id)||G}`))}),BookStatus=({book:C})=>C&&jsxRuntimeExports.jsx(Tooltip,{title:`Status: ${C.status}`,children:jsxRuntimeExports.jsx(Chip,{label:C.status,color:C.status==="completed"?"success":"default",size:"small",sx:{mb:1}})}),BookProgress=({book:C})=>C&&jsxRuntimeExports.jsxs(Stack,{direction:"row",spacing:1,sx:{mb:1},children:[jsxRuntimeExports.jsx(Tooltip,{title:"Pages",children:jsxRuntimeExports.jsx(Chip,{icon:jsxRuntimeExports.jsx(default_1$1,{}),label:`${C.current_page||0}/${C.total_pages||0} pages`,size:"small",variant:"outlined"})}),jsxRuntimeExports.jsx(Tooltip,{title:"Images",children:jsxRuntimeExports.jsx(Chip,{icon:jsxRuntimeExports.jsx(default_1$2,{}),label:`${C.processed_images||0} images`,size:"small",variant:"outlined"})}),C.processed_sections>0&&jsxRuntimeExports.jsx(Tooltip,{title:"Sections",children:jsxRuntimeExports.jsx(Chip,{label:`${C.processed_sections} sections`,size:"small",variant:"outlined"})})]}),HomePage=()=>{const[C,e]=reactExports.useState([]),[B,n]=reactExports.useState(!0),[h,G]=reactExports.useState(!1),[H,ht]=reactExports.useState(null),[P,T]=reactExports.useState(""),[f,j]=reactExports.useState(!1),[L,b]=reactExports.useState(null),m=useTheme(),E=useMediaQuery(m.breakpoints.down("sm")),g=useNavigate();reactExports.useEffect(()=>{u();const i=setInterval(u,5e3);return()=>clearInterval(i)},[]);const u=async()=>{try{ht(null);const i=await fetch("/api/books");if(!i.ok)throw new Error(`Server returned ${i.status}: ${await i.text()}`);const d=await i.json();if(!d||typeof d!="object")throw new Error("Invalid API response format");const l=(Array.isArray(d.books)?d.books:[]).map((c={})=>({id:c.id||c.filename||"",title:c.title||"Untitled Book",author:c.author||"Unknown",filename:c.filename||"",uploadDate:c.uploadDate,status:c.status||"unknown",current_page:c.current_page||0,total_pages:c.total_pages||0,processed_sections:c.processed_sections||0,processed_images:c.processed_images||0,error_message:c.error_message||null,cover_image:c.cover_image||null,...c}));e(l)}catch(i){console.error("Error fetching books:",i),ht(`Failed to load books: ${i.message}`),e([])}finally{n(!1)}},y=async i=>{const d=i.target.files[0];if(!d)return;if(d.type!=="application/pdf"){ht("Please select a valid PDF file");return}const o=new FormData;o.append("pdf_files",d);try{G(!0),ht(null);const l=await fetch("/api/books/upload",{method:"POST",body:o});if(!l.ok){const I=await l.json();throw new Error((I==null?void 0:I.message)||`Upload failed: ${l.status}`)}const c=await l.json();T(c.message||"PDF uploaded successfully"),i.target.value="",u()}catch(l){console.error("Error uploading PDF:",l),ht(l.message||"Error uploading file")}finally{G(!1)}},M=i=>{if((i==null?void 0:i.status)!=="completed"){ht("This book is not ready for reading yet");return}g(`/reader/${i.filename}`)},A=i=>{if((i==null?void 0:i.status)!=="completed"){ht("This book is not ready for preview yet");return}b(i),j(!0)};return jsxRuntimeExports.jsxs(Container,{maxWidth:"lg",sx:{py:4},children:[jsxRuntimeExports.jsxs(Box,{sx:{mb:4,textAlign:"center"},children:[jsxRuntimeExports.jsx(Typography,{variant:E?"h4":"h3",component:"h1",gutterBottom:!0,sx:{fontWeight:"bold",color:m.palette.secondary.main,mb:3},children:"Solo RPG AI Narrator"}),jsxRuntimeExports.jsx(ErrorBoundary,{fallbackMessage:"Error in file upload component",children:jsxRuntimeExports.jsxs(Button,{variant:"contained",component:"label",startIcon:jsxRuntimeExports.jsx(default_1$4,{}),sx:{mt:2,px:3,py:1.5,borderRadius:2},disabled:h,children:[h?"Uploading...":"Add PDF Book",jsxRuntimeExports.jsx("input",{type:"file",hidden:!0,accept:".pdf",onChange:y})]})})]}),jsxRuntimeExports.jsx(Snackbar,{open:!!P,autoHideDuration:6e3,onClose:()=>T(""),message:P}),H&&jsxRuntimeExports.jsx(Alert,{severity:"error",sx:{mb:3},onClose:()=>ht(null),action:jsxRuntimeExports.jsx(Button,{color:"inherit",size:"small",onClick:u,children:"Retry"}),children:H}),B?jsxRuntimeExports.jsx(ErrorBoundary,{fallbackMessage:"Error displaying skeleton loader",children:jsxRuntimeExports.jsx(SkeletonLoader,{count:6})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[Array.isArray(C)&&C.length===0&&jsxRuntimeExports.jsxs(Box,{sx:{textAlign:"center",mt:4,p:4,backgroundColor:"background.paper",borderRadius:2,border:1,borderColor:"divider"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",color:"text.secondary",children:"No books in library"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",color:"text.secondary",sx:{mt:1},children:"Start by uploading a PDF"})]}),Array.isArray(C)&&C.length>0&&jsxRuntimeExports.jsx(ErrorBoundary,{fallbackMessage:"Error displaying book grid",children:jsxRuntimeExports.jsx(BookGrid,{books:C,onReadBook:M,onPreviewBook:A,theme:m})})]}),L&&jsxRuntimeExports.jsx(ErrorBoundary,{fallbackMessage:"Error displaying PDF preview",children:jsxRuntimeExports.jsx(PDFPreview,{open:f,onClose:()=>{j(!1),b(null)},pdfUrl:`/api/books/${L.filename}`,bookTitle:L.title})})]})};export{HomePage as default};
//# sourceMappingURL=index-DBH-WAmw.js.map
